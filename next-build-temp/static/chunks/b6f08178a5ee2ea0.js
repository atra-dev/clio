(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,91034,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(38418),l=e.i(93096),r=e.i(77135),i=e.i(74923),n=e.i(12554),d=e.i(32295),o=e.i(97256),c=e.i(9968);let x=["Low","High"],m=["Open","Containment","Investigating","Escalated","Regulatory Review","Resolved","Closed"],u=["Not Started","In Progress","Contained"],p=["Pending","In Progress","Completed"],h=["Security","Compliance","HR","IT Operations","Unauthorized Access","Data Exposure","Credential Compromise","Insider Misuse","Malware / Ransomware","Policy Violation","System Misconfiguration","Other"],b=["Not Required","Pending","Notified","Overdue"],g={q:"",status:"all",severity:"all",incidentType:"all",regulatoryStatus:"all",restrictedPii:"all",breachConfirmed:"all",department:"all",dateFrom:"",dateTo:"",page:1,pageSize:12},f={title:"",summary:"",incidentType:"Unauthorized Access",severity:"Low",detectedAt:"",ownerEmail:"",affectedEmployeeEmail:"",department:"",involvedEmployees:"",restrictedPiiInvolved:!1,executiveNotificationRequired:!1,regulatoryNotificationRequired:!1,documentationLocation:"",notes:"",classificationStandard:"CLIO-IR-SEVERITY-V1"};function y(e){let t=new Date(e||"");return Number.isNaN(t.getTime())?"-":new Intl.DateTimeFormat("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(t)}function v(e){let t=new Date(e||Date.now());if(Number.isNaN(t.getTime()))return"";let s=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0"),r=String(t.getHours()).padStart(2,"0"),i=String(t.getMinutes()).padStart(2,"0");return`${s}-${a}-${l}T${r}:${i}`}function j(e){let t=String(e||"").trim();if(!t)return"";let s=new Date(t);return Number.isNaN(s.getTime())?"":s.toISOString()}function N(){return new Date().toISOString()}function w(e,t="Low"){let s=String(e||"").trim().toLowerCase();return"high"===s||"critical"===s?"High":"low"===s||"medium"===s?"Low":t}function S(e){return String(e?.title||"").trim()||String(e?.incidentCode||"").trim()||"Incident"}function k({session:e}){let k=(0,i.useToast)(),C=(0,n.useConfirm)(),A=String(e?.role||"").trim().toUpperCase(),E="GRC"===A||"SUPER_ADMIN"===A,[I,R]=(0,s.useState)("incident-dashboard"),[D,L]=(0,s.useState)(g),[M,T]=(0,s.useState)([]),[P,$]=(0,s.useState)({total:0,openCases:0,criticalOpen:0,containmentPending:0,dueWithin72Hours:0,overdue72HourNotifications:0}),[O,B]=(0,s.useState)({page:1,pageSize:12,total:0,totalPages:1}),[q,U]=(0,s.useState)(!0),[F,W]=(0,s.useState)(!1),[H,z]=(0,s.useState)(!1),[_,V]=(0,s.useState)({...f,ownerEmail:String(e?.email||"").trim().toLowerCase()}),[G,Y]=(0,s.useState)(""),[K,J]=(0,s.useState)(null),[Q,X]=(0,s.useState)(null),[Z,ee]=(0,s.useState)(!1),[et,es]=(0,s.useState)(!1),[ea,el]=(0,s.useState)(!1),[er,ei]=(0,s.useState)([]),en=(0,s.useRef)(null),ed=(0,s.useRef)(null),eo=(0,s.useCallback)(async()=>{U(!0);try{let e=await o.hrisApi.incidents.list(D),t=Array.isArray(e?.records)?e.records:[];t.sort((e,t)=>new Date(t?.updatedAt||t?.createdAt||0).getTime()-new Date(e?.updatedAt||e?.createdAt||0).getTime()),T(t),$(e?.summary||{}),B(e?.pagination||{page:1,pageSize:12,total:0,totalPages:1})}catch(e){T([]),k.error(e.message||"Unable to load incident records.")}finally{U(!1)}},[D,k]),ec=(0,s.useCallback)(async e=>{let t=String(e||"").trim();if(t){ee(!0);try{let e=await o.hrisApi.incidents.get(t),s=e?.record||null;J(s),X(s?{title:String(s?.title||""),summary:String(s?.summary||""),incidentType:String(s?.incidentType||"Other"),severity:w(s?.severity,"Low"),status:String(s?.status||"Open"),containmentStatus:String(s?.containmentStatus||"Not Started"),containmentSummary:String(s?.containmentSummary||""),impactAssessmentStatus:String(s?.impactAssessmentStatus||"Pending"),impactSummary:String(s?.impactSummary||""),ownerEmail:String(s?.ownerEmail||""),affectedEmployeeEmail:String(s?.affectedEmployeeEmail||""),department:String(s?.department||""),involvedEmployees:Array.isArray(s?.involvedEmployees)?s.involvedEmployees.join(", "):String(s?.involvedEmployees||""),restrictedPiiInvolved:!!s?.restrictedPiiInvolved,executiveNotificationRequired:!!s?.executiveNotificationRequired,regulatoryNotificationRequired:!!s?.regulatoryNotificationRequired,documentationRetained:!!s?.documentationRetained,documentationLocation:String(s?.documentationLocation||""),notes:String(s?.notes||""),classificationStandard:String(s?.classificationStandard||"CLIO-IR-SEVERITY-V1"),forensicWindowStart:v(s?.forensicWindowStart),forensicWindowEnd:v(s?.forensicWindowEnd),breachConfirmed:!!s?.breachConfirmed,breachConfirmedAt:String(s?.breachConfirmedAt||""),breachConfirmedBy:String(s?.breachConfirmedBy||""),correctiveActions:String(s?.correctiveActions||""),disciplinaryActions:String(s?.disciplinaryActions||""),resolutionNotes:String(s?.resolutionNotes||""),closureApprovalStatus:String(s?.closureApprovalStatus||"Pending Approval"),closureApprovedAt:String(s?.closureApprovedAt||""),closureApprovedBy:String(s?.closureApprovedBy||"")}:null)}catch(e){k.error(e.message||"Unable to load incident details.")}finally{ee(!1)}}},[k]);(0,s.useEffect)(()=>{eo()},[eo]),(0,s.useEffect)(()=>{G&&ec(G)},[G,ec]),(0,s.useEffect)(()=>{let e=(e=window.location.hash)=>{let t=String(e||"").replace(/^#/,"").trim().toLowerCase();if(!t)return;let s=["incident-dashboard","report-incident","incident-list","reports-analytics"].find(e=>(0,d.toSubTabAnchor)(e)===t);s&&R(s)},t=t=>{if(t?.detail?.moduleId&&"incident-management"!==t.detail.moduleId)return;let s=t?.detail?.anchor;s&&e(`#${s}`)};return e(),window.addEventListener("hashchange",e),window.addEventListener("popstate",e),window.addEventListener("clio:subtab-anchor",t),()=>{window.removeEventListener("hashchange",e),window.removeEventListener("popstate",e),window.removeEventListener("clio:subtab-anchor",t)}},[]);let ex=(e,t)=>{L(s=>({...s,[e]:t,page:1}))},em=()=>{V({...f,ownerEmail:String(e?.email||"").trim().toLowerCase(),detectedAt:v(N())}),ei([]),W(!0)},eu=(0,s.useCallback)(async(e,t)=>{if(E&&G){es(!0);try{await o.hrisApi.incidents.update(G,e),await ec(G),await eo(),t&&k.success(t)}catch(e){k.error(e.message||"Unable to update incident.")}finally{es(!1)}}},[E,G,ec,eo,k]),ep=async t=>{if(t.preventDefault(),E){if(!String(_.title||"").trim())return void k.error("Incident title is required.");z(!0);try{let t={..._,detectedAt:j(_.detectedAt)||N(),ownerEmail:String(_.ownerEmail||"").trim().toLowerCase(),affectedEmployeeEmail:String(_.affectedEmployeeEmail||"").trim().toLowerCase(),department:String(_.department||"").trim(),involvedEmployees:String(_.involvedEmployees||"").split(",").map(e=>e.trim()).filter(Boolean)},s=await o.hrisApi.incidents.create(t);if(k.success("Incident record created."),W(!1),await eo(),s?.record?.id&&Y(s.record.id),s?.record?.id&&er.length>0){let a=s.record.id,l=String(t.affectedEmployeeEmail||"").trim().toLowerCase(),r=[];for(let t of er){let s=await (0,c.uploadIncidentEvidenceToStorage)({file:t,incidentRecordId:a,affectedEmployeeEmail:l});r.push({id:`${Date.now()}-${Math.random().toString(36).slice(2,7)}`,name:t.name||"Incident Evidence",type:"Incident Evidence",ref:s.downloadUrl,storagePath:s.storagePath,contentType:s.contentType||t.type||"",fileExtension:String(t.name||"").split(".").pop()||"",sizeBytes:s.sizeBytes,uploadedAt:N(),uploadedBy:String(e?.email||"").trim().toLowerCase()})}r.length>0&&await o.hrisApi.incidents.update(a,{evidenceDocuments:r,documentationRetained:!0})}}catch(e){k.error(e.message||"Unable to create incident.")}finally{z(!1)}}},eh=async()=>{E&&Q&&await eu({...Q,ownerEmail:String(Q.ownerEmail||"").trim().toLowerCase(),affectedEmployeeEmail:String(Q.affectedEmployeeEmail||"").trim().toLowerCase(),forensicWindowStart:j(Q.forensicWindowStart),forensicWindowEnd:j(Q.forensicWindowEnd),involvedEmployees:String(Q.involvedEmployees||"").split(",").map(e=>e.trim()).filter(Boolean)},"Incident workflow updated.")},eb=async(e,t,s={})=>{await eu({[e]:N(),...s},t)},eg=async t=>{E&&G&&(!t||await C({title:"Confirm Breach",message:"Mark this incident as a confirmed breach?",confirmText:"Confirm Breach",tone:"danger"}))&&await eu({breachConfirmed:t,breachConfirmedAt:t?N():"",breachConfirmedBy:t?String(e?.email||"").trim().toLowerCase():""},t?"Breach confirmation recorded.":"Breach confirmation cleared.")},ef=async t=>{let s=t.target.files?.[0];if(t.target.value="",s&&K&&E){el(!0);try{let t=await (0,c.uploadIncidentEvidenceToStorage)({file:s,incidentRecordId:K.id,affectedEmployeeEmail:K.affectedEmployeeEmail}),a=[...Array.isArray(K.evidenceDocuments)?K.evidenceDocuments:[],{id:`${Date.now()}-${Math.random().toString(36).slice(2,7)}`,name:s.name||"Incident Evidence",type:"Incident Evidence",ref:t.downloadUrl,storagePath:t.storagePath,contentType:t.contentType||s.type||"",fileExtension:String(s.name||"").split(".").pop()||"",sizeBytes:t.sizeBytes,uploadedAt:N(),uploadedBy:String(e?.email||"").trim().toLowerCase()}];await eu({evidenceDocuments:a,documentationRetained:!0},"Incident evidence uploaded.")}catch(e){k.error(e.message||"Unable to upload evidence.")}finally{el(!1)}}},ey=async e=>{if(!K||!E||!await C({title:"Remove Evidence",message:`Remove evidence "${String(e?.name||"file")}"?`,confirmText:"Remove",tone:"danger"}))return;let t=(Array.isArray(K.evidenceDocuments)?K.evidenceDocuments:[]).filter(t=>String(t?.id||"").trim()!==String(e?.id||"").trim());await eu({evidenceDocuments:t},"Evidence removed."),e?.storagePath&&await (0,c.removeStorageObjectByPath)(e.storagePath)},ev=(0,s.useMemo)(()=>M,[M]),ej=(0,s.useMemo)(()=>"yes"===D.breachConfirmed?ev.filter(e=>!!e?.breachConfirmed):"no"===D.breachConfirmed?ev.filter(e=>!e?.breachConfirmed):ev,[ev,D.breachConfirmed]),eN=(0,s.useMemo)(()=>{let e=ej,t=String(D.department||"").trim().toLowerCase();t&&"all"!==t&&(e=e.filter(e=>String(e?.department||"").trim().toLowerCase()===t));let s=D.dateFrom?new Date(D.dateFrom):null,a=D.dateTo?new Date(D.dateTo):null;if(s&&!Number.isNaN(s.getTime())&&(e=e.filter(e=>new Date(e?.detectedAt||e?.createdAt||"").getTime()>=s.getTime())),a&&!Number.isNaN(a.getTime())){let t=new Date(a);t.setHours(23,59,59,999),e=e.filter(e=>new Date(e?.detectedAt||e?.createdAt||"").getTime()<=t.getTime())}return e},[ej,D.department,D.dateFrom,D.dateTo]),ew=(0,s.useMemo)(()=>[{key:"total",label:"Total Incidents",value:P.total||0},{key:"open",label:"Open Cases",value:P.openCases||0},{key:"critical",label:"Critical Open",value:P.criticalOpen||0},{key:"containment",label:"Containment Pending",value:P.containmentPending||0}],[P]),eS=0===O.total?0:(O.page-1)*O.pageSize+1,ek=Math.min(O.total||0,O.page*O.pageSize),eC=Array.isArray(K?.evidenceDocuments)?K.evidenceDocuments:[],eA=(0,s.useMemo)(()=>{if(!K?.forensicSnapshot)return null;let e=K.forensicSnapshot;for(let t of[e.accessLogs,e.exportLogs,e.administrativeActions,e.deletionActivities])if(Array.isArray(t)&&t.length>0)return t[0];return null},[K]),eE=(0,s.useMemo)(()=>{let e=eA||{},t=e.requestMethod&&e.requestPath?`${e.requestMethod} ${e.requestPath}`:e.requestPath||"",s=e.employeeEmail||e.targetEmployeeEmail||K?.affectedEmployeeEmail||"",a=e.resourceLabel||e.recordRef||"",l=Array.isArray(e.viewedFields)?e.viewedFields:[],r=l.length>0?`${l.slice(0,8).join(", ")}${l.length>8?"â€¦":""}`:"",i=Array.isArray(e.accessedDocuments)?e.accessedDocuments:[],n=i.length>0?i.map(e=>String(e?.name||e?.ref||e?.id||"").trim()).filter(Boolean).slice(0,6).join(", "):"";return[{label:"Alert Description",value:K?.alertDescription||K?.summary||"-"},{label:"Occurrences",value:Number(K?.alertOccurrenceCount||1)},{label:"Performed By",value:e.performedBy||K?.ownerEmail||"-"},{label:"Activity",value:e.activityName||K?.incidentType||"-"},{label:"Module",value:e.module||"-"},{label:"Request",value:t||"-"},{label:"Employee Email",value:s||"-"},{label:"Employee Record",value:a||"-"},{label:"Viewed Fields",value:r||(e.viewedFieldCount?`${e.viewedFieldCount} fields`:"-")},{label:"Documents Accessed",value:n||(e.accessedDocumentCount?`${e.accessedDocumentCount} document(s)`:"-")},{label:"Source IP",value:e.sourceIp||"-"},{label:"Device",value:e.device||"-"},{label:"User Agent",value:e.userAgent||"-"},{label:"Occurred At",value:y(e.occurredAt)}]},[eA,K]),eI=(0,s.useMemo)(()=>{let e={Open:0,"In Progress":0,Resolved:0,Closed:0};return M.forEach(t=>{let s=String(t?.status||"").trim();if("Containment"===s||"Investigating"===s||"Escalated"===s||"Regulatory Review"===s){e["In Progress"]+=1;return}if("Resolved"===s){e.Resolved+=1;return}if("Closed"===s){e.Closed+=1;return}e.Open+=1}),e},[M]),eR=(0,s.useMemo)(()=>{let e={Low:0,High:0};return M.forEach(t=>{let s=w(t?.severity,"Low");e[s]+=1}),e},[M]),eD=(0,s.useMemo)(()=>[...M].sort((e,t)=>new Date(t?.updatedAt||t?.createdAt||0).getTime()-new Date(e?.updatedAt||e?.createdAt||0).getTime()).slice(0,6),[M]),eL=(0,s.useMemo)(()=>{let e={};return M.forEach(t=>{let s=String(t?.incidentType||"Other").trim()||"Other";e[s]=(e[s]||0)+1}),Object.entries(e).sort((e,t)=>t[1]-e[1])},[M]),eM=(0,s.useMemo)(()=>{let e=eL.reduce((e,[,t])=>e+Number(t||0),0),t=["#0ea5e9","#14b8a6","#f97316","#6366f1","#ef4444","#a855f7","#22c55e","#06b6d4"],s=0,a=eL.map(([a,l],r)=>{let i=Number(l||0),n=e>0?i/e:0,d=s;return s+=n,{label:a,value:i,percentage:e>0?Math.round(100*n):0,color:t[r%t.length],fromDeg:(360*d).toFixed(2),toDeg:(360*s).toFixed(2)}}),l=a.length?`conic-gradient(${a.map(e=>`${e.color} ${e.fromDeg}deg ${e.toDeg}deg`).join(", ")})`:"";return{total:e,segments:a,gradient:l,dominant:a[0]||null}},[eL]),eT=(0,s.useMemo)(()=>{let e=Number(eR.Low||0),t=Number(eR.High||0),s=Math.max(e,t,1);return[{label:"Low",meta:"Lower impact incidents",value:e,color:"bg-sky-500"},{label:"High",meta:"High-impact incidents",value:t,color:"bg-rose-500"}].map(e=>({...e,width:`${Math.round(e.value/s*100)}%`}))},[eR]),eP=(0,s.useMemo)(()=>{let e=0,t=0,s=0,a=0;M.forEach(l=>{let r=l?.alertDispatchSummary;if(!r||"object"!=typeof r)return;e+=1;let i=r?.email&&"object"==typeof r.email?r.email:{};(Math.max(0,Number(i?.recipientCount||0))>0||String(i?.status||"").trim())&&(t+=1);let n=r?.sms&&"object"==typeof r.sms?r.sms:{},d=Math.max(0,Number(n?.deliveredCount||0));(Math.max(0,Number(n?.recipientCount||0))>0||d>0||String(n?.status||"").trim())&&(s+=1);let o=r?.webhooks&&"object"==typeof r.webhooks?r.webhooks:{};((Array.isArray(o?.targets)?o.targets.length:0)>0||Number(o?.successCount||0)>0||String(o?.status||"").trim())&&(a+=1)});let l=M.length,r=Math.max(0,l-e),i=Math.max(e,r,1),n=Math.max(t,s,a,1);return{totalIncidents:l,incidentsWithDispatch:e,incidentsWithoutDispatch:r,coverageBars:[{label:"With Dispatch",value:e,color:"bg-emerald-500",width:`${Math.round(e/i*100)}%`},{label:"Without Dispatch",value:r,color:"bg-slate-400",width:`${Math.round(r/i*100)}%`}],channelBars:[{label:"Email",value:t,color:"bg-sky-500",width:`${Math.round(t/n*100)}%`},{label:"SMS",value:s,color:"bg-indigo-500",width:`${Math.round(s/n*100)}%`},{label:"Webhook",value:a,color:"bg-violet-500",width:`${Math.round(a/n*100)}%`}]}},[M]);return(0,t.jsxs)("div",{className:"space-y-4",children:["incident-dashboard"===I?(0,t.jsx)(a.default,{title:"Incident Dashboard",subtitle:"Overview of active and historical incidents",children:(0,t.jsx)("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-4",children:ew.map(e=>(0,t.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500",children:e.label}),(0,t.jsx)("p",{className:"mt-0.5 text-lg font-semibold text-slate-900",children:e.value})]},e.key))})}):null,"incident-dashboard"===I?(0,t.jsxs)("div",{className:"grid gap-3 lg:grid-cols-2",children:[(0,t.jsx)(a.default,{title:"Status Summary",subtitle:"Open, in progress, resolved, and closed",children:(0,t.jsx)("div",{className:"grid gap-2 sm:grid-cols-2",children:Object.entries(eI).map(([e,s])=>(0,t.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[(0,t.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500",children:e}),(0,t.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:s})]},e))})}),(0,t.jsx)(a.default,{title:"Severity Distribution",subtitle:"Incident mix by severity (High / Low)",children:(0,t.jsx)("div",{className:"grid gap-2 sm:grid-cols-2",children:[{label:"Low",value:eR.Low,tone:"border-sky-200 bg-sky-50/50 text-sky-700"},{label:"High",value:eR.High,tone:"border-rose-200 bg-rose-50/50 text-rose-700"}].map(e=>(0,t.jsxs)("div",{className:`rounded-lg border px-3 py-2 ${e.tone}`,children:[(0,t.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em]",children:e.label}),(0,t.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:e.value})]},e.label))})})]}):null,"incident-dashboard"===I?(0,t.jsx)(a.default,{title:"Recent Activity",subtitle:"Latest incident updates",children:0===eD.length?(0,t.jsx)(l.default,{title:"No incidents yet",subtitle:"Once incidents are logged, they will appear here."}):(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full text-left text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-slate-200 text-xs uppercase tracking-[0.1em] text-slate-500",children:[(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"Incident"}),(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"Status"}),(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"Severity"}),(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"Updated"}),(0,t.jsx)("th",{className:"px-2 py-3 font-medium text-right",children:"Action"})]})}),(0,t.jsx)("tbody",{children:eD.map(e=>(0,t.jsxs)("tr",{className:"border-b border-slate-100 text-slate-700 last:border-b-0",children:[(0,t.jsxs)("td",{className:"px-2 py-3",children:[(0,t.jsx)("p",{className:"font-medium text-slate-900",children:S(e)}),(0,t.jsx)("p",{className:"text-xs text-slate-500",children:String(e?.incidentCode||"N/A")}),(0,t.jsx)("p",{className:"mt-1 text-xs text-slate-600",children:String(e?.alertDescription||e?.summary||"No description provided.")}),(0,t.jsxs)("p",{className:"mt-1 text-xs font-medium text-sky-700",children:["Occurrences: ",Number(e?.alertOccurrenceCount||1)]})]}),(0,t.jsx)("td",{className:"px-2 py-3",children:(0,t.jsx)(r.default,{value:e?.status||"Open"})}),(0,t.jsx)("td",{className:"px-2 py-3",children:(0,t.jsx)(r.default,{value:w(e?.severity,"Low")})}),(0,t.jsx)("td",{className:"px-2 py-3 text-xs text-slate-600",children:y(e?.updatedAt||e?.createdAt)}),(0,t.jsx)("td",{className:"px-2 py-3 text-right",children:(0,t.jsx)("button",{type:"button",onClick:()=>Y(e.id),className:"inline-flex h-8 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-medium text-slate-700 transition hover:bg-slate-50",children:"Open"})})]},e.id))})]})})}):null,"report-incident"===I?(0,t.jsx)(a.default,{title:"Report Incident / Create Case",subtitle:"Log a new incident, assign severity, and attach evidence.",action:E?(0,t.jsx)("button",{type:"button",onClick:em,className:"inline-flex h-9 items-center rounded-lg bg-sky-600 px-4 text-xs font-semibold text-white transition hover:bg-sky-700",children:"Open Full Form"}):null,children:(0,t.jsxs)("form",{className:"space-y-3",onSubmit:ep,children:[(0,t.jsxs)("div",{className:"grid gap-2 md:grid-cols-2",children:[(0,t.jsx)("input",{required:!0,value:_.title,onChange:e=>V(t=>({...t,title:e.target.value})),placeholder:"Incident title",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none md:col-span-2"}),(0,t.jsx)("select",{value:_.incidentType,onChange:e=>V(t=>({...t,incidentType:e.target.value})),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:h.map(e=>(0,t.jsx)("option",{value:e,children:e},`inline-type-${e}`))}),(0,t.jsx)("select",{value:_.severity,onChange:e=>V(t=>({...t,severity:e.target.value})),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:x.map(e=>(0,t.jsx)("option",{value:e,children:e},`inline-sev-${e}`))}),(0,t.jsx)("input",{type:"datetime-local",value:_.detectedAt,onChange:e=>V(t=>({...t,detectedAt:e.target.value})),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,t.jsx)("input",{value:_.department,onChange:e=>V(t=>({...t,department:e.target.value})),placeholder:"Department (optional)",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,t.jsx)("input",{value:_.affectedEmployeeEmail,onChange:e=>V(t=>({...t,affectedEmployeeEmail:e.target.value})),placeholder:"Involved employee email",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,t.jsx)("input",{value:_.involvedEmployees,onChange:e=>V(t=>({...t,involvedEmployees:e.target.value})),placeholder:"Additional involved employees (comma separated)",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none md:col-span-2"}),(0,t.jsx)("textarea",{value:_.summary,onChange:e=>V(t=>({...t,summary:e.target.value})),placeholder:"Incident description",rows:3,className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none md:col-span-2"})]}),(0,t.jsxs)("div",{className:"grid gap-2 sm:grid-cols-2",children:[(0,t.jsxs)("label",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:_.restrictedPiiInvolved,onChange:e=>V(t=>({...t,restrictedPiiInvolved:e.target.checked})),className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),(0,t.jsx)("span",{className:"text-xs text-slate-700",children:"Restricted PII involved"})]}),(0,t.jsxs)("label",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:_.regulatoryNotificationRequired,onChange:e=>V(t=>({...t,regulatoryNotificationRequired:e.target.checked})),className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),(0,t.jsx)("span",{className:"text-xs text-slate-700",children:"Regulatory notification required"})]})]}),(0,t.jsxs)("div",{className:"rounded-lg border border-dashed border-slate-200 bg-white p-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-900",children:"Attachments"}),(0,t.jsx)("p",{className:"text-[11px] text-slate-500",children:"Upload initial evidence (optional)."})]}),(0,t.jsx)("button",{type:"button",onClick:()=>ed.current?.click(),className:"inline-flex h-8 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-semibold text-slate-700 transition hover:bg-slate-50",children:"Add Files"})]}),(0,t.jsx)("input",{ref:ed,type:"file",className:"hidden",multiple:!0,onChange:e=>{let t=Array.from(e.target.files||[]);e.target.value="",0!==t.length&&ei(e=>[...e,...t])}}),er.length>0?(0,t.jsx)("ul",{className:"mt-2 space-y-1 text-xs text-slate-600",children:er.map((e,s)=>(0,t.jsxs)("li",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{children:e.name}),(0,t.jsx)("button",{type:"button",onClick:()=>ei(e=>e.filter((e,t)=>t!==s)),className:"text-rose-500",children:"Remove"})]},`${e.name}-${s}`))}):(0,t.jsx)("p",{className:"mt-2 text-xs text-slate-500",children:"No files attached."})]}),(0,t.jsx)("div",{className:"flex items-center justify-end gap-2",children:(0,t.jsx)("button",{type:"submit",disabled:!E||H,className:"inline-flex h-9 items-center rounded-lg bg-sky-600 px-4 text-xs font-semibold text-white transition hover:bg-sky-700 disabled:opacity-60",children:H?"Submitting...":"Submit Incident"})})]})}):null,"incident-list"===I?(0,t.jsxs)(a.default,{title:"Incident List / Case Management",subtitle:"Track cases, assign handling, and monitor status updates.",action:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[E?(0,t.jsx)("button",{type:"button",onClick:em,className:"inline-flex h-9 items-center rounded-lg bg-sky-600 px-4 text-xs font-semibold text-white transition hover:bg-sky-700",children:"Create Incident"}):null,(0,t.jsx)("button",{type:"button",onClick:eo,disabled:q,className:"inline-flex h-9 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60",children:"Refresh"})]}),children:[(0,t.jsxs)("div",{className:"grid gap-2 md:grid-cols-3 lg:grid-cols-6",children:[(0,t.jsx)("input",{value:D.q,onChange:e=>ex("q",e.target.value),placeholder:"Search incident",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 placeholder:text-slate-400 focus:border-sky-400 focus:outline-none md:col-span-2"}),(0,t.jsxs)("select",{value:D.status,onChange:e=>ex("status",e.target.value),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:[(0,t.jsx)("option",{value:"all",children:"All Status"}),m.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]}),(0,t.jsxs)("select",{value:D.severity,onChange:e=>ex("severity",e.target.value),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:[(0,t.jsx)("option",{value:"all",children:"All Severity"}),x.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]}),(0,t.jsxs)("select",{value:D.incidentType,onChange:e=>ex("incidentType",e.target.value),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:[(0,t.jsx)("option",{value:"all",children:"All Types"}),h.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]}),(0,t.jsxs)("select",{value:D.regulatoryStatus,onChange:e=>ex("regulatoryStatus",e.target.value),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:[(0,t.jsx)("option",{value:"all",children:"All Regulatory"}),b.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]}),(0,t.jsxs)("select",{value:D.restrictedPii,onChange:e=>ex("restrictedPii",e.target.value),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:[(0,t.jsx)("option",{value:"all",children:"PII: All"}),(0,t.jsx)("option",{value:"yes",children:"PII: Yes"}),(0,t.jsx)("option",{value:"no",children:"PII: No"})]}),(0,t.jsxs)("select",{value:D.breachConfirmed,onChange:e=>ex("breachConfirmed",e.target.value),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:[(0,t.jsx)("option",{value:"all",children:"Breach: All"}),(0,t.jsx)("option",{value:"yes",children:"Breach: Confirmed"}),(0,t.jsx)("option",{value:"no",children:"Breach: Not Confirmed"})]}),(0,t.jsx)("input",{value:D.department,onChange:e=>ex("department",e.target.value),placeholder:"Department",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,t.jsx)("input",{type:"date",value:D.dateFrom,onChange:e=>ex("dateFrom",e.target.value),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,t.jsx)("input",{type:"date",value:D.dateTo,onChange:e=>ex("dateTo",e.target.value),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"})]}),(0,t.jsx)("div",{className:"mt-4",children:q?(0,t.jsx)("div",{className:"flex justify-center py-6",children:(0,t.jsx)("span",{className:"inline-flex h-6 w-6 animate-spin rounded-full border-2 border-slate-300 border-t-sky-600","aria-hidden":"true"})}):0===eN.length?(0,t.jsx)(l.default,{title:"No incident records found",subtitle:"Create incidents or adjust filters to continue."}):(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full text-left text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-slate-200 text-xs uppercase tracking-[0.1em] text-slate-500",children:[(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"Incident"}),(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"Severity"}),(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"Status"}),(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"Escalation"}),(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"Regulatory"}),(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"Updated"}),(0,t.jsx)("th",{className:"px-2 py-3 font-medium text-right",children:"Action"})]})}),(0,t.jsx)("tbody",{children:eN.map(e=>(0,t.jsxs)("tr",{className:"border-b border-slate-100 text-slate-700 last:border-b-0",children:[(0,t.jsxs)("td",{className:"px-2 py-3",children:[(0,t.jsx)("p",{className:"font-medium text-slate-900",children:S(e)}),(0,t.jsx)("p",{className:"text-xs text-slate-500",children:String(e?.incidentCode||"N/A")}),(0,t.jsx)("p",{className:"mt-1 max-w-[32rem] text-xs text-slate-600",children:String(e?.alertDescription||e?.summary||"No description provided.")}),(0,t.jsxs)("p",{className:"mt-1 text-xs font-medium text-sky-700",children:["Occurrences: ",Number(e?.alertOccurrenceCount||1)]})]}),(0,t.jsx)("td",{className:"px-2 py-3",children:(0,t.jsx)(r.default,{value:w(e?.severity,"Low")})}),(0,t.jsx)("td",{className:"px-2 py-3",children:(0,t.jsx)(r.default,{value:e?.status||"Open"})}),(0,t.jsxs)("td",{className:"px-2 py-3 text-xs",children:[(0,t.jsx)("p",{className:"font-medium text-slate-800",children:String(e?.escalationLevel||"-")}),(0,t.jsxs)("p",{className:"text-slate-500",children:["GRC: ",e?.grcAlertedAt?"Yes":"No"]})]}),(0,t.jsxs)("td",{className:"px-2 py-3 text-xs",children:[(0,t.jsx)("p",{className:"font-medium text-slate-800",children:String(e?.regulatoryStatus||"Not Required")}),(0,t.jsxs)("p",{className:"text-slate-500",children:["Due: ",y(e?.regulatoryDueAt)]})]}),(0,t.jsx)("td",{className:"px-2 py-3 text-xs text-slate-600",children:y(e?.updatedAt||e?.createdAt)}),(0,t.jsx)("td",{className:"px-2 py-3 text-right",children:(0,t.jsx)("button",{type:"button",onClick:()=>Y(e.id),className:"inline-flex h-8 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-medium text-slate-700 transition hover:bg-slate-50",children:"Open"})})]},e.id))})]})})}),(0,t.jsxs)("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-600",children:[(0,t.jsxs)("p",{children:["Showing ",eS,"-",ek," of ",O.total||0," records"]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{type:"button",onClick:()=>L(e=>({...e,page:Math.max(1,e.page-1)})),disabled:1>=(O.page||1)||q,className:"inline-flex h-8 items-center rounded-lg border border-slate-300 bg-white px-3 font-medium text-slate-700 transition hover:bg-slate-100 disabled:opacity-60",children:"Previous"}),(0,t.jsxs)("span",{children:["Page ",O.page||1," of ",Math.max(1,O.totalPages||1)]}),(0,t.jsx)("button",{type:"button",onClick:()=>L(e=>({...e,page:Math.min(Math.max(1,O.totalPages||1),e.page+1)})),disabled:(O.page||1)>=(O.totalPages||1)||q,className:"inline-flex h-8 items-center rounded-lg border border-slate-300 bg-white px-3 font-medium text-slate-700 transition hover:bg-slate-100 disabled:opacity-60",children:"Next"})]})]})]}):null,"reports-analytics"===I?(0,t.jsxs)(a.default,{title:"Reports & Analytics",subtitle:"Incident trends and recurring issue severity",children:[(0,t.jsxs)("div",{className:"grid gap-3 lg:grid-cols-2",children:[(0,t.jsx)(a.default,{title:"Incident Trends",subtitle:"Pie chart by incident type",children:eM.total<=0?(0,t.jsx)(l.default,{title:"No data yet",subtitle:"Incident trends will appear after cases are logged."}):(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center gap-3 sm:flex-row sm:items-start",children:[(0,t.jsx)("div",{className:"h-44 w-44 shrink-0 rounded-full border border-slate-200 shadow-[0_14px_34px_-28px_rgba(15,23,42,0.5)]",style:{backgroundImage:eM.gradient},"aria-label":"Incident trends pie chart"}),(0,t.jsx)("ul",{className:"w-full space-y-2 text-xs text-slate-600",children:eM.segments.map(e=>(0,t.jsxs)("li",{className:"flex items-center justify-between rounded-lg border border-slate-200 bg-white px-3 py-2",children:[(0,t.jsxs)("span",{className:"inline-flex items-center gap-2",children:[(0,t.jsx)("span",{className:"h-2.5 w-2.5 rounded-full",style:{backgroundColor:e.color}}),(0,t.jsx)("span",{children:e.label})]}),(0,t.jsxs)("span",{className:"font-semibold text-slate-900",children:[e.value," (",e.percentage,"%)"]})]},e.label))})]}),eM.dominant?(0,t.jsxs)("p",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-700",children:["Top incident type: ",(0,t.jsx)("span",{className:"font-semibold text-slate-900",children:eM.dominant.label})]}):null]})}),(0,t.jsx)(a.default,{title:"Recurring Issues",subtitle:"High vs low incident volume",children:(0,t.jsx)("div",{className:"space-y-3",children:eT.map(e=>(0,t.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-600",children:[(0,t.jsx)("span",{className:"font-semibold text-slate-800",children:e.label}),(0,t.jsx)("span",{children:e.value})]}),(0,t.jsx)("div",{className:"mt-2 h-2.5 overflow-hidden rounded-full bg-slate-100",children:(0,t.jsx)("div",{className:`h-full rounded-full ${e.color}`,style:{width:e.width}})}),(0,t.jsx)("p",{className:"mt-1 text-[11px] text-slate-500",children:e.meta})]},e.label))})})]}),(0,t.jsx)(a.default,{title:"Alert Dispatch Coverage",subtitle:"Dispatch readiness and channel usage",children:eP.totalIncidents<=0?(0,t.jsx)(l.default,{title:"No alert dispatch data",subtitle:"Coverage and channel charts appear after incidents are logged."}):(0,t.jsx)("div",{className:"space-y-3",children:(0,t.jsxs)("div",{className:"grid gap-3 lg:grid-cols-2",children:[(0,t.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white p-3",children:[(0,t.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.08em] text-slate-500",children:"Coverage"}),(0,t.jsx)("div",{className:"mt-2 space-y-2",children:eP.coverageBars.map(e=>(0,t.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-700",children:[(0,t.jsx)("span",{className:"font-semibold",children:e.label}),(0,t.jsx)("span",{children:e.value})]}),(0,t.jsx)("div",{className:"mt-2 h-2.5 overflow-hidden rounded-full bg-slate-100",children:(0,t.jsx)("div",{className:`h-full rounded-full ${e.color}`,style:{width:e.width}})})]},e.label))})]}),(0,t.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white p-3",children:[(0,t.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.08em] text-slate-500",children:"Channel Mix"}),(0,t.jsx)("div",{className:"mt-2 space-y-2",children:eP.channelBars.map(e=>(0,t.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-700",children:[(0,t.jsx)("span",{className:"font-semibold",children:e.label}),(0,t.jsx)("span",{children:e.value})]}),(0,t.jsx)("div",{className:"mt-2 h-2.5 overflow-hidden rounded-full bg-slate-100",children:(0,t.jsx)("div",{className:`h-full rounded-full ${e.color}`,style:{width:e.width}})})]},e.label))})]})]})})}),(0,t.jsxs)("div",{className:"mt-3 flex flex-wrap gap-2",children:[(0,t.jsx)("button",{type:"button",className:"inline-flex h-9 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-semibold text-slate-700 transition hover:bg-slate-50",children:"Export PDF"}),(0,t.jsx)("button",{type:"button",className:"inline-flex h-9 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-semibold text-slate-700 transition hover:bg-slate-50",children:"Export Excel"})]})]}):null,F?(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/45 p-4",role:"dialog","aria-modal":"true","aria-label":"Create Incident",onClick:()=>!H&&W(!1),children:(0,t.jsxs)("div",{className:"w-full max-w-4xl rounded-2xl border border-slate-200 bg-white p-4 shadow-2xl sm:p-5",onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"mb-3 flex items-start justify-between gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-base font-semibold text-slate-900",children:"Create Incident"}),(0,t.jsx)("p",{className:"mt-0.5 text-sm text-slate-600",children:"Capture incident details and initialize compliance workflow."})]}),(0,t.jsx)("button",{type:"button",onClick:()=>!H&&W(!1),disabled:H,className:"inline-flex h-8 w-8 items-center justify-center rounded-lg border border-slate-300 bg-white text-slate-600 transition hover:bg-slate-50 disabled:opacity-60","aria-label":"Close create incident",children:(0,t.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.9",className:"h-4 w-4","aria-hidden":"true",children:(0,t.jsx)("path",{d:"m6 6 12 12M18 6 6 18"})})})]}),(0,t.jsxs)("form",{className:"space-y-3",onSubmit:ep,children:[(0,t.jsxs)("div",{className:"grid gap-2 md:grid-cols-2",children:[(0,t.jsx)("input",{required:!0,value:_.title,onChange:e=>V(t=>({...t,title:e.target.value})),placeholder:"Incident title",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none md:col-span-2"}),(0,t.jsx)("select",{value:_.severity,onChange:e=>V(t=>({...t,severity:e.target.value})),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:x.map(e=>(0,t.jsx)("option",{value:e,children:e},`create-severity-${e}`))}),(0,t.jsx)("select",{value:_.incidentType,onChange:e=>V(t=>({...t,incidentType:e.target.value})),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:h.map(e=>(0,t.jsx)("option",{value:e,children:e},`create-type-${e}`))}),(0,t.jsx)("input",{type:"datetime-local",value:_.detectedAt,onChange:e=>V(t=>({...t,detectedAt:e.target.value})),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,t.jsx)("input",{value:_.ownerEmail,onChange:e=>V(t=>({...t,ownerEmail:e.target.value})),placeholder:"Owner email",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,t.jsx)("input",{value:_.affectedEmployeeEmail,onChange:e=>V(t=>({...t,affectedEmployeeEmail:e.target.value})),placeholder:"Affected employee email",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none md:col-span-2"}),(0,t.jsx)("input",{value:_.department,onChange:e=>V(t=>({...t,department:e.target.value})),placeholder:"Department (optional)",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,t.jsx)("input",{value:_.involvedEmployees,onChange:e=>V(t=>({...t,involvedEmployees:e.target.value})),placeholder:"Additional involved employees (comma separated)",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none md:col-span-2"}),(0,t.jsx)("textarea",{rows:3,value:_.summary,onChange:e=>V(t=>({...t,summary:e.target.value})),placeholder:"Incident summary",className:"rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none md:col-span-2"})]}),(0,t.jsxs)("div",{className:"grid gap-2 sm:grid-cols-3",children:[(0,t.jsxs)("label",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:_.restrictedPiiInvolved,onChange:e=>V(t=>({...t,restrictedPiiInvolved:e.target.checked})),className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),(0,t.jsx)("span",{className:"text-xs text-slate-700",children:"Restricted PII"})]}),(0,t.jsxs)("label",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:_.executiveNotificationRequired,onChange:e=>V(t=>({...t,executiveNotificationRequired:e.target.checked})),className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),(0,t.jsx)("span",{className:"text-xs text-slate-700",children:"Executive Notice"})]}),(0,t.jsxs)("label",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:_.regulatoryNotificationRequired,onChange:e=>V(t=>({...t,regulatoryNotificationRequired:e.target.checked})),className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),(0,t.jsx)("span",{className:"text-xs text-slate-700",children:"Regulatory Notice"})]})]}),(0,t.jsxs)("div",{className:"rounded-lg border border-dashed border-slate-200 bg-white p-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-900",children:"Attachments"}),(0,t.jsx)("p",{className:"text-[11px] text-slate-500",children:"Upload initial evidence (optional)."})]}),(0,t.jsx)("button",{type:"button",onClick:()=>ed.current?.click(),className:"inline-flex h-8 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-semibold text-slate-700 transition hover:bg-slate-50",children:"Add Files"})]}),(0,t.jsx)("input",{ref:ed,type:"file",className:"hidden",multiple:!0,onChange:e=>{let t=Array.from(e.target.files||[]);e.target.value="",0!==t.length&&ei(e=>[...e,...t])}}),er.length>0?(0,t.jsx)("ul",{className:"mt-2 space-y-1 text-xs text-slate-600",children:er.map((e,s)=>(0,t.jsxs)("li",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{children:e.name}),(0,t.jsx)("button",{type:"button",onClick:()=>ei(e=>e.filter((e,t)=>t!==s)),className:"text-rose-500",children:"Remove"})]},`${e.name}-${s}`))}):(0,t.jsx)("p",{className:"mt-2 text-xs text-slate-500",children:"No files attached."})]}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-2 border-t border-slate-200 pt-3",children:[(0,t.jsx)("button",{type:"button",onClick:()=>W(!1),disabled:H,className:"inline-flex h-9 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-70",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",disabled:H,className:"inline-flex h-9 items-center rounded-lg bg-sky-600 px-4 text-xs font-semibold text-white transition hover:bg-sky-700 disabled:opacity-70",children:H?"Creating...":"Create Incident"})]})]})]})}):null,G?(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/45 p-4",role:"dialog","aria-modal":"true","aria-label":"Incident Workbench",onClick:()=>!et&&!ea&&Y(""),children:(0,t.jsxs)("div",{className:"w-full max-w-6xl rounded-2xl border border-slate-200 bg-white p-4 shadow-2xl sm:p-5",onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"mb-3 flex items-start justify-between gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-base font-semibold text-slate-900",children:"Incident Workbench"}),(0,t.jsx)("p",{className:"mt-0.5 text-sm text-slate-600",children:"Escalation, 72-hour actions, and forensic evidence."})]}),(0,t.jsx)("button",{type:"button",onClick:()=>!et&&!ea&&Y(""),disabled:et||ea,className:"inline-flex h-8 w-8 items-center justify-center rounded-lg border border-slate-300 bg-white text-slate-600 transition hover:bg-slate-50 disabled:opacity-60","aria-label":"Close incident workbench",children:(0,t.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.9",className:"h-4 w-4","aria-hidden":"true",children:(0,t.jsx)("path",{d:"m6 6 12 12M18 6 6 18"})})})]}),!Z&&K&&Q?(0,t.jsxs)("div",{className:"max-h-[72vh] space-y-3 overflow-y-auto pr-1",children:[(0,t.jsxs)("div",{className:"grid gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2.5 sm:grid-cols-2 lg:grid-cols-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500",children:"Incident"}),(0,t.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:S(K)}),(0,t.jsx)("p",{className:"text-xs text-slate-500",children:String(K?.incidentCode||"N/A")})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500",children:"Detected"}),(0,t.jsx)("p",{className:"text-xs text-slate-700",children:y(K?.detectedAt)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500",children:"Regulatory Due"}),(0,t.jsx)("p",{className:"text-xs text-slate-700",children:y(K?.regulatoryDueAt)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500",children:"Regulatory Status"}),(0,t.jsx)(r.default,{value:K?.regulatoryStatus||"Not Required"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500",children:"Occurrences"}),(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-900",children:Number(K?.alertOccurrenceCount||1)}),(0,t.jsxs)("p",{className:"text-xs text-slate-500",children:["Last: ",y(K?.alertLastObservedAt)]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500",children:"Alert Rule"}),(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-900",children:String(K?.detectionRuleId||"-")}),(0,t.jsx)("p",{className:"text-xs text-slate-500",children:String(K?.incidentType||"-")})]})]}),(0,t.jsx)(a.default,{title:"Alert Occurrence History",subtitle:"Consolidated alert hits for this incident (newest first)",children:Array.isArray(K?.alertOccurrences)&&K.alertOccurrences.length>0?(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full text-left text-xs text-slate-700",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-slate-200 text-[11px] uppercase tracking-[0.08em] text-slate-500",children:[(0,t.jsx)("th",{className:"px-2 py-2 font-semibold",children:"#"}),(0,t.jsx)("th",{className:"px-2 py-2 font-semibold",children:"When"}),(0,t.jsx)("th",{className:"px-2 py-2 font-semibold",children:"Activity"}),(0,t.jsx)("th",{className:"px-2 py-2 font-semibold",children:"Module"}),(0,t.jsx)("th",{className:"px-2 py-2 font-semibold",children:"Actor"}),(0,t.jsx)("th",{className:"px-2 py-2 font-semibold",children:"Source IP"}),(0,t.jsx)("th",{className:"px-2 py-2 font-semibold",children:"Path"})]})}),(0,t.jsx)("tbody",{children:[...K.alertOccurrences].reverse().map((e,s)=>{let a=String(e?.id||e?.occurredAt||`${e?.activityName||"entry"}-${s}`);return(0,t.jsxs)("tr",{className:"border-b border-slate-100 align-top",children:[(0,t.jsx)("td",{className:"px-2 py-2 text-slate-500",children:Number(K?.alertOccurrenceCount||K.alertOccurrences.length)-s}),(0,t.jsx)("td",{className:"px-2 py-2",children:y(e?.occurredAt)}),(0,t.jsx)("td",{className:"px-2 py-2",children:String(e?.activityName||"-")}),(0,t.jsx)("td",{className:"px-2 py-2",children:String(e?.module||"-")}),(0,t.jsx)("td",{className:"px-2 py-2",children:String(e?.actorEmail||"-")}),(0,t.jsx)("td",{className:"px-2 py-2",children:String(e?.sourceIp||"-")}),(0,t.jsx)("td",{className:"px-2 py-2",children:String(e?.requestPath||"-")})]},`occ-${a}-${s}`)})})]})}):(0,t.jsx)("p",{className:"text-xs text-slate-500",children:"No occurrence history recorded yet."})}),(0,t.jsxs)("div",{className:"grid gap-3 lg:grid-cols-2",children:[(0,t.jsxs)(a.default,{title:"Workflow Control",subtitle:"Severity, containment, impact, and status updates",children:[(0,t.jsxs)("div",{className:"grid gap-2 sm:grid-cols-2",children:[(0,t.jsx)("select",{value:Q.severity,onChange:e=>X(t=>({...t,severity:e.target.value})),disabled:!E||et,className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100",children:x.map(e=>(0,t.jsx)("option",{value:e,children:e},`d-sev-${e}`))}),(0,t.jsx)("select",{value:Q.status,onChange:e=>X(t=>({...t,status:e.target.value})),disabled:!E||et,className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100",children:m.map(e=>(0,t.jsx)("option",{value:e,children:e},`d-status-${e}`))}),(0,t.jsx)("select",{value:Q.containmentStatus,onChange:e=>X(t=>({...t,containmentStatus:e.target.value})),disabled:!E||et,className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100",children:u.map(e=>(0,t.jsx)("option",{value:e,children:e},`d-cont-${e}`))}),(0,t.jsx)("select",{value:Q.impactAssessmentStatus,onChange:e=>X(t=>({...t,impactAssessmentStatus:e.target.value})),disabled:!E||et,className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100",children:p.map(e=>(0,t.jsx)("option",{value:e,children:e},`d-impact-${e}`))})]}),(0,t.jsx)("textarea",{value:Q.summary,onChange:e=>X(t=>({...t,summary:e.target.value})),rows:2,placeholder:"Incident summary",disabled:!E||et,className:"mt-2 w-full rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100"}),(0,t.jsx)("textarea",{value:Q.containmentSummary,onChange:e=>X(t=>({...t,containmentSummary:e.target.value})),rows:2,placeholder:"Containment summary",disabled:!E||et,className:"mt-2 w-full rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100"}),(0,t.jsx)("textarea",{value:Q.impactSummary,onChange:e=>X(t=>({...t,impactSummary:e.target.value})),rows:2,placeholder:"Impact summary",disabled:!E||et,className:"mt-2 w-full rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100"})]}),(0,t.jsxs)(a.default,{title:"72-Hour Controls",subtitle:"Regulatory, executive, and affected-individual notifications",children:[(0,t.jsxs)("div",{className:"grid gap-2 sm:grid-cols-2",children:[(0,t.jsxs)("label",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:Q.regulatoryNotificationRequired,onChange:e=>X(t=>({...t,regulatoryNotificationRequired:e.target.checked})),disabled:!E||et,className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),(0,t.jsx)("span",{className:"text-xs text-slate-700",children:"Regulatory required"})]}),(0,t.jsxs)("label",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:Q.documentationRetained,onChange:e=>X(t=>({...t,documentationRetained:e.target.checked})),disabled:!E||et,className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),(0,t.jsx)("span",{className:"text-xs text-slate-700",children:"Documentation retained"})]})]}),(0,t.jsxs)("div",{className:"mt-2 grid gap-2 sm:grid-cols-2",children:[(0,t.jsx)("input",{value:Q.documentationLocation,onChange:e=>X(t=>({...t,documentationLocation:e.target.value})),placeholder:"Documentation location",disabled:!E||et,className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100"}),(0,t.jsx)("input",{value:Q.classificationStandard,onChange:e=>X(t=>({...t,classificationStandard:e.target.value})),placeholder:"Classification standard",disabled:!E||et,className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100"})]}),(0,t.jsxs)("div",{className:"mt-2 grid gap-2 sm:grid-cols-2 lg:grid-cols-3",children:[(0,t.jsx)("button",{type:"button",onClick:()=>eb("grcAlertedAt","GRC alerted.",{escalationRequired:!0}),disabled:!E||et,className:"inline-flex h-8 items-center justify-center rounded-md border border-slate-300 bg-white px-3 text-[11px] font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60",children:"Mark GRC Alerted"}),(0,t.jsx)("button",{type:"button",onClick:()=>eb("executiveNotifiedAt","Executive notification recorded.",{executiveNotificationRequired:!0}),disabled:!E||et,className:"inline-flex h-8 items-center justify-center rounded-md border border-slate-300 bg-white px-3 text-[11px] font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60",children:"Mark Executive Notified"}),(0,t.jsx)("button",{type:"button",onClick:()=>eb("regulatoryNotifiedAt","Regulatory notification recorded.",{regulatoryNotificationRequired:!0,status:"Regulatory Review"}),disabled:!E||et,className:"inline-flex h-8 items-center justify-center rounded-md border border-slate-300 bg-white px-3 text-[11px] font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60",children:"Mark Regulator Notified"}),(0,t.jsx)("button",{type:"button",onClick:()=>eb("affectedIndividualsNotifiedAt","Affected individuals notification recorded."),disabled:!E||et,className:"inline-flex h-8 items-center justify-center rounded-md border border-slate-300 bg-white px-3 text-[11px] font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60",children:"Mark Affected Individuals"}),(0,t.jsx)("button",{type:"button",onClick:()=>eu({refreshForensicSnapshot:!0},"Forensic snapshot refreshed."),disabled:!E||et,className:"inline-flex h-8 items-center justify-center rounded-md border border-sky-200 bg-sky-50 px-3 text-[11px] font-semibold text-sky-700 transition hover:bg-sky-100 disabled:opacity-60",children:"Refresh Forensic"})]})]}),(0,t.jsxs)(a.default,{title:"Breach Confirmation",subtitle:"Manual confirmation required for declared breaches",children:[(0,t.jsxs)("div",{className:"grid gap-2 sm:grid-cols-2",children:[(0,t.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Status"}),(0,t.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:Q?.breachConfirmed?"Confirmed breach":"Not confirmed"}),(0,t.jsx)("p",{className:"text-xs text-slate-500",children:Q?.breachConfirmedAt?`At ${y(Q.breachConfirmedAt)}`:"Awaiting confirmation"})]}),(0,t.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[(0,t.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Confirmed By"}),(0,t.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:Q?.breachConfirmedBy?Q.breachConfirmedBy:"-"}),(0,t.jsx)("p",{className:"text-xs text-slate-500",children:"Requires GRC approval"})]})]}),(0,t.jsxs)("div",{className:"mt-2 flex flex-wrap gap-2",children:[Q?.breachConfirmed?(0,t.jsx)("button",{type:"button",onClick:()=>eg(!1),disabled:!E||et,className:"inline-flex h-8 items-center justify-center rounded-md border border-rose-200 bg-rose-50 px-3 text-[11px] font-semibold text-rose-700 transition hover:bg-rose-100 disabled:opacity-60",children:"Revoke Confirmation"}):(0,t.jsx)("button",{type:"button",onClick:()=>eg(!0),disabled:!E||et,className:"inline-flex h-8 items-center justify-center rounded-md border border-emerald-200 bg-emerald-50 px-3 text-[11px] font-semibold text-emerald-700 transition hover:bg-emerald-100 disabled:opacity-60",children:"Mark Breach Confirmed"}),E?null:(0,t.jsx)("p",{className:"text-xs text-slate-500",children:"View-only. GRC can confirm breaches."})]})]})]}),(0,t.jsxs)(a.default,{title:"Incident Evidence",subtitle:"Retained case documents and attachments",children:[(0,t.jsx)("input",{ref:en,type:"file",className:"hidden",onChange:ef}),(0,t.jsx)("div",{className:"mb-2 flex justify-end",children:E?(0,t.jsx)("button",{type:"button",onClick:()=>en.current?.click(),disabled:ea||et,className:"inline-flex h-8 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60",children:ea?"Uploading...":"Upload Evidence"}):null}),0===eC.length?(0,t.jsx)(l.default,{title:"No evidence files attached",subtitle:"Upload incident files to retain case evidence."}):(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full text-left text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-slate-200 text-xs uppercase tracking-[0.1em] text-slate-500",children:[(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"Document"}),(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"Uploaded At"}),(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"Uploaded By"}),(0,t.jsx)("th",{className:"px-2 py-3 font-medium text-right",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:eC.map((e,s)=>(0,t.jsxs)("tr",{className:"border-b border-slate-100 text-slate-700 last:border-b-0",children:[(0,t.jsxs)("td",{className:"px-2 py-3",children:[(0,t.jsx)("p",{className:"font-medium text-slate-900",children:String(e?.name||"Incident Evidence")}),(0,t.jsx)("p",{className:"text-xs text-slate-500",children:String(e?.type||"Incident Evidence")})]}),(0,t.jsx)("td",{className:"px-2 py-3 text-xs text-slate-600",children:y(e?.uploadedAt)}),(0,t.jsx)("td",{className:"px-2 py-3 text-xs text-slate-600",children:String(e?.uploadedBy||"-")}),(0,t.jsx)("td",{className:"px-2 py-3 text-right",children:(0,t.jsxs)("div",{className:"inline-flex items-center gap-2",children:[e?.ref?(0,t.jsx)("a",{href:e.ref,target:"_blank",rel:"noreferrer",className:"inline-flex h-8 items-center rounded-lg border border-sky-200 bg-sky-50 px-3 text-xs font-semibold text-sky-700 transition hover:bg-sky-100",children:"Open"}):null,E?(0,t.jsx)("button",{type:"button",onClick:()=>ey(e),disabled:et||ea,className:"inline-flex h-8 items-center rounded-lg border border-rose-200 bg-rose-50 px-3 text-xs font-semibold text-rose-700 transition hover:bg-rose-100 disabled:opacity-60",children:"Remove"}):null]})})]},`${e?.id||"evidence"}-${s}`))})]})})]}),(0,t.jsx)(a.default,{title:"Audit Trail / Activity Logs",subtitle:"Change history, actions, and compliance traceability",children:Array.isArray(K?.traceability)&&K.traceability.length>0?(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full text-left text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-slate-200 text-xs uppercase tracking-[0.1em] text-slate-500",children:[(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"When"}),(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"By"}),(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"Action"}),(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"Status"}),(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"Severity"})]})}),(0,t.jsx)("tbody",{children:K.traceability.map((e,s)=>(0,t.jsxs)("tr",{className:"border-b border-slate-100 text-slate-700 last:border-b-0",children:[(0,t.jsx)("td",{className:"px-2 py-3 text-xs text-slate-600",children:y(e?.at)}),(0,t.jsx)("td",{className:"px-2 py-3 text-xs",children:String(e?.by||"-")}),(0,t.jsx)("td",{className:"px-2 py-3 text-xs",children:String(e?.action||"-")}),(0,t.jsx)("td",{className:"px-2 py-3 text-xs",children:String(e?.status||"-")}),(0,t.jsx)("td",{className:"px-2 py-3 text-xs",children:String(e?.severity||"-")})]},`${e?.at||"audit"}-${s}`))})]})}):(0,t.jsx)(l.default,{title:"No audit trail entries",subtitle:"Updates will appear here as actions occur."})}),(0,t.jsxs)(a.default,{title:"Forensic Logging",subtitle:"Scoped logs for access, export, administrative, and deletion events",children:[(0,t.jsxs)("div",{className:"grid gap-2 sm:grid-cols-2 lg:grid-cols-5",children:[(0,t.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Scoped Logs"}),(0,t.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:Number(K?.forensicSummary?.totalScopedLogs||0)})]}),(0,t.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Access"}),(0,t.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:Number(K?.forensicSummary?.accessLogsCount||0)})]}),(0,t.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Exports"}),(0,t.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:Number(K?.forensicSummary?.exportLogsCount||0)})]}),(0,t.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Administrative"}),(0,t.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:Number(K?.forensicSummary?.administrativeActionsCount||0)})]}),(0,t.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Deletion"}),(0,t.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:Number(K?.forensicSummary?.deletionActivitiesCount||0)})]})]}),(0,t.jsx)("div",{className:"mt-3 grid gap-3 lg:grid-cols-2",children:[{key:"accessLogs",label:"Access Logs"},{key:"exportLogs",label:"Export Logs"},{key:"administrativeActions",label:"Administrative Actions"},{key:"deletionActivities",label:"Deletion Activities"}].map(e=>{let s=Array.isArray(K?.forensicSnapshot?.[e.key])?K.forensicSnapshot[e.key].slice(0,20):[];return(0,t.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white",children:[(0,t.jsx)("div",{className:"border-b border-slate-200 px-3 py-2",children:(0,t.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.08em] text-slate-500",children:e.label})}),0===s.length?(0,t.jsx)("p",{className:"px-3 py-3 text-xs text-slate-500",children:"No entries."}):(0,t.jsx)("div",{className:"max-h-52 overflow-auto",children:(0,t.jsxs)("table",{className:"min-w-full text-left text-xs",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-slate-200 text-[11px] uppercase tracking-[0.08em] text-slate-500",children:[(0,t.jsx)("th",{className:"px-3 py-2 font-medium",children:"Action"}),(0,t.jsx)("th",{className:"px-3 py-2 font-medium",children:"Module"}),(0,t.jsx)("th",{className:"px-3 py-2 font-medium",children:"When"}),(0,t.jsx)("th",{className:"px-3 py-2 font-medium",children:"By"})]})}),(0,t.jsx)("tbody",{children:s.map((s,a)=>(0,t.jsxs)("tr",{className:"border-b border-slate-100 text-slate-700 last:border-b-0",children:[(0,t.jsx)("td",{className:"px-3 py-2",children:String(s?.activityName||"-")}),(0,t.jsx)("td",{className:"px-3 py-2",children:String(s?.module||"-")}),(0,t.jsx)("td",{className:"px-3 py-2",children:y(s?.occurredAt)}),(0,t.jsx)("td",{className:"px-3 py-2",children:String(s?.performedBy||"-")})]},`${e.key}-${s.id||s.occurredAt||"row"}-${a}`))})]})})]},e.key)})})]}),(0,t.jsx)(a.default,{title:"Notes",subtitle:"Additional incident context and forensic details",children:(0,t.jsxs)("div",{className:"grid gap-3 lg:grid-cols-[minmax(0,2fr)_minmax(0,1fr)]",children:[(0,t.jsx)("textarea",{value:Q.notes,onChange:e=>X(t=>({...t,notes:e.target.value})),rows:8,disabled:!E||et,className:"min-h-[180px] w-full rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100"}),(0,t.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 p-3",children:[(0,t.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.12em] text-slate-500",children:"Investigation Context"}),(0,t.jsx)("div",{className:"mt-2 space-y-2 text-xs text-slate-700",children:eE.map(e=>(0,t.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,t.jsx)("span",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:e.label}),(0,t.jsx)("span",{className:"font-medium text-slate-900",children:e.value||"-"})]},e.label))})]})]})}),E?(0,t.jsx)("div",{className:"sticky bottom-0 z-10 flex items-center justify-end gap-2 border-t border-slate-200 bg-white pt-3",children:(0,t.jsx)("button",{type:"button",onClick:eh,disabled:et||ea,className:"inline-flex h-9 items-center rounded-lg bg-sky-600 px-4 text-xs font-semibold text-white transition hover:bg-sky-700 disabled:opacity-70",children:et?"Saving...":"Save Incident Updates"})}):null]}):(0,t.jsx)("div",{className:"flex justify-center py-8",children:(0,t.jsx)("span",{className:"inline-flex h-6 w-6 animate-spin rounded-full border-2 border-slate-300 border-t-sky-600","aria-hidden":"true"})})]})}):null]})}e.s(["default",()=>k])}]);