module.exports=[18097,76342,15710,19e3,e=>{"use strict";let t,r,i,n,s,a,o=function(e){let t=[],r=0;for(let i=0;i<e.length;i++){let n=e.charCodeAt(i);n<128?t[r++]=n:(n<2048?t[r++]=n>>6|192:((64512&n)==55296&&i+1<e.length&&(64512&e.charCodeAt(i+1))==56320?(n=65536+((1023&n)<<10)+(1023&e.charCodeAt(++i)),t[r++]=n>>18|240,t[r++]=n>>12&63|128):t[r++]=n>>12|224,t[r++]=n>>6&63|128),t[r++]=63&n|128)}return t},l=function(e){let t=[],r=0,i=0;for(;r<e.length;){let n=e[r++];if(n<128)t[i++]=String.fromCharCode(n);else if(n>191&&n<224){let s=e[r++];t[i++]=String.fromCharCode((31&n)<<6|63&s)}else if(n>239&&n<365){let s=((7&n)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536;t[i++]=String.fromCharCode(55296+(s>>10)),t[i++]=String.fromCharCode(56320+(1023&s))}else{let s=e[r++],a=e[r++];t[i++]=String.fromCharCode((15&n)<<12|(63&s)<<6|63&a)}}return t.join("")},u={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();let r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let t=0;t<e.length;t+=3){let n=e[t],s=t+1<e.length,a=s?e[t+1]:0,o=t+2<e.length,l=o?e[t+2]:0,u=n>>2,c=(3&n)<<4|a>>4,h=(15&a)<<2|l>>6,d=63&l;!o&&(d=64,s||(h=64)),i.push(r[u],r[c],r[h],r[d])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(o(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):l(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();let r=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let t=0;t<e.length;){let n=r[e.charAt(t++)],s=t<e.length?r[e.charAt(t)]:0,a=++t<e.length?r[e.charAt(t)]:64,o=++t<e.length?r[e.charAt(t)]:64;if(++t,null==n||null==s||null==a||null==o)throw new c;let l=n<<2|s>>4;if(i.push(l),64!==a){let e=s<<4&240|a>>2;if(i.push(e),64!==o){let e=a<<6&192|o;i.push(e)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class c extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}let h=function(e){let t=o(e);return u.encodeByteArray(t,!0)},d=function(e){return h(e).replace(/\./g,"")},f=function(e){try{return u.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null},m=()=>{try{return("u">typeof self?self:e.g).__FIREBASE_DEFAULTS__||(()=>{if("u"<typeof process||void 0===process.env)return;let e=process.env.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)})()||(()=>{let e;if("u"<typeof document)return;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}let t=e&&f(e[1]);return t&&JSON.parse(t)})()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},p=e=>{let t=m()?.emulatorHosts?.[e];if(!t)return;let r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw Error(`Invalid host ${t} with no separate hostname and port!`);let i=parseInt(t.substring(r+1),10);return"["===t[0]?[t.substring(1,r-1),i]:[t.substring(0,r),i]},g=()=>m()?.config;class y{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,r))}}}function w(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function v(e){return(await fetch(e,{credentials:"include"})).ok}function _(e,t){if(e.uid)throw Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let r=t||"demo-project",i=e.iat||0,n=e.sub||e.user_id;if(!n)throw Error("mockUserToken must contain 'sub' or 'user_id' field!");let s={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:n,user_id:n,firebase:{sign_in_provider:"custom",identities:{}},...e};return[d(JSON.stringify({alg:"none",type:"JWT"})),d(JSON.stringify(s)),""].join(".")}function b(e,t){}function S(){return E()}function E(){return"u">typeof WorkerGlobalScope&&"u">typeof self&&self instanceof WorkerGlobalScope}function A(){try{return"object"==typeof indexedDB}catch(e){return!1}}function T(){return new Promise((e,t)=>{try{let r=!0,i="validate-browser-context-for-indexeddb-analytics-module",n=self.indexedDB.open(i);n.onsuccess=()=>{n.result.close(),r||self.indexedDB.deleteDatabase(i),e(!0)},n.onupgradeneeded=()=>{r=!1},n.onerror=()=>{t(n.error?.message||"")}}catch(e){t(e)}})}class I extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,I.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,k.prototype.create)}}class k{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){var r,i;let n=t[0]||{},s=`${this.service}/${e}`,a=this.errors[e],o=a?(r=a,i=n,r.replace(C,(e,t)=>{let r=i[t];return null!=r?String(r):`<${t}?>`})):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new I(s,l,n)}}let C=/\{\$([^}]+)}/g;function D(e,t){if(e===t)return!0;let r=Object.keys(e),i=Object.keys(t);for(let n of r){if(!i.includes(n))return!1;let r=e[n],s=t[n];if(x(r)&&x(s)){if(!D(r,s))return!1}else if(r!==s)return!1}for(let e of i)if(!r.includes(e))return!1;return!0}function x(e){return null!==e&&"object"==typeof e}function N(e){return e&&e._delegate?e._delegate:e}e.s(["Deferred",()=>y,"ErrorFactory",()=>k,"FirebaseError",()=>I,"base64Decode",()=>f,"base64urlEncodeWithoutPadding",()=>d,"createMockUserToken",()=>_,"deepEqual",()=>D,"getDefaultAppConfig",()=>g,"getDefaultEmulatorHostnameAndPort",()=>p,"getModularInstance",()=>N,"isBrowser",()=>S,"isCloudWorkstation",()=>w,"isIndexedDBAvailable",()=>A,"isWebWorker",()=>E,"pingServer",()=>v,"updateEmulatorBanner",()=>b,"validateIndexedDBOpenable",()=>T],76342);class F{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}let O="[DEFAULT]";class R{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let e=new y;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:t});r&&e.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(e){if(r)return null;throw e}if(r)return null;throw Error(`Service ${this.name} is not available`)}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:O})}catch(e){}for(let[e,t]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(e);try{let e=this.getOrInitializeService({instanceIdentifier:r});t.resolve(e)}catch(e){}}}}clearInstance(e=O){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=O){return this.instances.has(e)}getOptions(e=O){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[e,t]of this.instancesDeferred.entries())r===this.normalizeInstanceIdentifier(e)&&t.resolve(i);return i}onInit(e,t){let r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);let n=this.instances.get(r);return n&&e(n,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){var r;let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e)===O?void 0:r,options:t}),this.instances.set(e,i),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=O){return this.component?this.component.multipleInstances?e:O:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class P{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new R(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}let V=[];(ej=ez||(ez={}))[ej.DEBUG=0]="DEBUG",ej[ej.VERBOSE=1]="VERBOSE",ej[ej.INFO=2]="INFO",ej[ej.WARN=3]="WARN",ej[ej.ERROR=4]="ERROR",ej[ej.SILENT=5]="SILENT";let M={debug:ez.DEBUG,verbose:ez.VERBOSE,info:ez.INFO,warn:ez.WARN,error:ez.ERROR,silent:ez.SILENT},B=ez.INFO,L={[ez.DEBUG]:"log",[ez.VERBOSE]:"log",[ez.INFO]:"info",[ez.WARN]:"warn",[ez.ERROR]:"error"},$=(e,t,...r)=>{if(t<e.logLevel)return;let i=new Date().toISOString(),n=L[t];if(n)console[n](`[${i}]  ${e.name}:`,...r);else throw Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class U{constructor(e){this.name=e,this._logLevel=B,this._logHandler=$,this._userLogHandler=null,V.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ez))throw TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?M[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ez.DEBUG,...e),this._logHandler(this,ez.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ez.VERBOSE,...e),this._logHandler(this,ez.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ez.INFO,...e),this._logHandler(this,ez.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ez.WARN,...e),this._logHandler(this,ez.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ez.ERROR,...e),this._logHandler(this,ez.ERROR,...e)}}let j=new WeakMap,z=new WeakMap,q=new WeakMap,H=new WeakMap,W=new WeakMap,G={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return z.get(e);if("objectStoreNames"===t)return e.objectStoreNames||q.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return K(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function K(e){if(e instanceof IDBRequest){let t;return(t=new Promise((t,r)=>{let i=()=>{e.removeEventListener("success",n),e.removeEventListener("error",s)},n=()=>{t(K(e.result)),i()},s=()=>{r(e.error),i()};e.addEventListener("success",n),e.addEventListener("error",s)})).then(t=>{t instanceof IDBCursor&&j.set(t,e)}).catch(()=>{}),W.set(t,e),t}if(H.has(e))return H.get(e);let t=function(e){if("function"==typeof e)return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(i||(i=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(J(this),t),K(j.get(this))}:function(...t){return K(e.apply(J(this),t))}:function(t,...r){let i=e.call(J(this),t,...r);return q.set(i,t.sort?t.sort():[t]),K(i)};return e instanceof IDBTransaction&&function(e){if(z.has(e))return;let t=new Promise((t,r)=>{let i=()=>{e.removeEventListener("complete",n),e.removeEventListener("error",s),e.removeEventListener("abort",s)},n=()=>{t(),i()},s=()=>{r(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",n),e.addEventListener("error",s),e.addEventListener("abort",s)});z.set(e,t)}(e),(r||(r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(t=>e instanceof t)?new Proxy(e,G):e}(e);return t!==e&&(H.set(e,t),W.set(t,e)),t}let J=e=>W.get(e),Q=["get","getKey","getAll","getAllKeys","count"],Y=["put","add","delete","clear"],X=new Map;function Z(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(X.get(t))return X.get(t);let r=t.replace(/FromIndex$/,""),i=t!==r,n=Y.includes(r);if(!(r in(i?IDBIndex:IDBObjectStore).prototype)||!(n||Q.includes(r)))return;let s=async function(e,...t){let s=this.transaction(e,n?"readwrite":"readonly"),a=s.store;return i&&(a=a.index(t.shift())),(await Promise.all([a[r](...t),n&&s.done]))[0]};return X.set(t,s),s}G={...t=G,get:(e,r,i)=>Z(e,r)||t.get(e,r,i),has:(e,r)=>!!Z(e,r)||t.has(e,r)};class ee{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{let t;if(t=e.getComponent(),t?.type!=="VERSION")return null;{let t=e.getImmediate();return`${t.library}/${t.version}`}}).filter(e=>e).join(" ")}}let et="@firebase/app",er="0.14.8",ei=new U("@firebase/app"),en="[DEFAULT]",es={[et]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/ai":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},ea=new Map,eo=new Map,el=new Map;function eu(e,t){try{e.container.addComponent(t)}catch(r){ei.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function ec(e,t){e.container.addOrOverwriteComponent(t)}function eh(e){let t=e.name;if(el.has(t))return ei.debug(`There were multiple attempts to register component ${t}.`),!1;for(let r of(el.set(t,e),ea.values()))eu(r,e);for(let t of eo.values())eu(t,e);return!0}function ed(e,t){let r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function ef(e,t,r=en){ed(e,t).clearInstance(r)}function em(e){return void 0!==e.options}function ep(e){return!em(e)&&("authIdToken"in e||"appCheckToken"in e||"releaseOnDeref"in e||"automaticDataCollectionEnabled"in e)}function eg(e){return null!=e&&void 0!==e.settings}function ey(){el.clear()}let ew=new k("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class ev{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new F("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ew.create("app-deleted",{appName:this._name})}}function e_(e,t){let r=f(e.split(".")[1]);null===r?console.error(`FirebaseServerApp ${t} is invalid: second part could not be parsed.`):void 0===JSON.parse(r).exp?console.error(`FirebaseServerApp ${t} is invalid: expiration claim could not be parsed`):1e3*JSON.parse(r).exp-new Date().getTime()<=0&&console.error(`FirebaseServerApp ${t} is invalid: the token has expired.`)}class eb extends ev{constructor(e,t,r,i){const n=void 0===t.automaticDataCollectionEnabled||t.automaticDataCollectionEnabled,s={name:r,automaticDataCollectionEnabled:n};void 0!==e.apiKey?super(e,s,i):super(e.options,s,i),this._serverConfig={automaticDataCollectionEnabled:n,...t},this._serverConfig.authIdToken&&e_(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&e_(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,"u">typeof FinalizationRegistry&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,eC(et,er,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,void 0!==e&&null!==this._finalizationRegistry&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){ek(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw ew.create("server-app-deleted")}}let eS="12.9.0";function eE(e,t={}){let r=e;"object"!=typeof t&&(t={name:t});let i={name:en,automaticDataCollectionEnabled:!0,...t},n=i.name;if("string"!=typeof n||!n)throw ew.create("bad-app-name",{appName:String(n)});if(r||(r=g()),!r)throw ew.create("no-options");let s=ea.get(n);if(s)if(D(r,s.options)&&D(i,s.config))return s;else throw ew.create("duplicate-app",{appName:n});let a=new P(n);for(let e of el.values())a.addComponent(e);let o=new ev(r,i,a);return ea.set(n,o),o}function eA(e,t={}){let r;if(S()&&!E())throw ew.create("invalid-server-app-environment");let i=t||{};if(e&&(em(e)?r=e.options:ep(e)?i=e:r=e),void 0===i.automaticDataCollectionEnabled&&(i.automaticDataCollectionEnabled=!0),r||(r=g()),!r)throw ew.create("no-options");let n={...i,...r};if(void 0!==n.releaseOnDeref&&delete n.releaseOnDeref,void 0!==i.releaseOnDeref&&"u"<typeof FinalizationRegistry)throw ew.create("finalization-registry-not-supported",{});let s=""+[...JSON.stringify(n)].reduce((e,t)=>Math.imul(31,e)+t.charCodeAt(0)|0,0),a=eo.get(s);if(a)return a.incRefCount(i.releaseOnDeref),a;let o=new P(s);for(let e of el.values())o.addComponent(e);let l=new eb(r,i,s,o);return eo.set(s,l),l}function eT(e=en){let t=ea.get(e);if(!t&&e===en&&g())return eE();if(!t)throw ew.create("no-app",{appName:e});return t}function eI(){return Array.from(ea.values())}async function ek(e){let t=!1,r=e.name;ea.has(r)?(t=!0,ea.delete(r)):eo.has(r)&&0>=e.decRefCount()&&(eo.delete(r),t=!0),t&&(await Promise.all(e.container.getProviders().map(e=>e.delete())),e.isDeleted=!0)}function eC(e,t,r){let i=es[e]??e;r&&(i+=`-${r}`);let n=i.match(/\s|\//),s=t.match(/\s|\//);if(n||s){let e=[`Unable to register library "${i}" with version "${t}":`];n&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),n&&s&&e.push("and"),s&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),ei.warn(e.join(" "));return}eh(new F(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}function eD(e,t){if(null!==e&&"function"!=typeof e)throw ew.create("invalid-log-argument");for(let r of V){let i=null;t&&t.level&&(i=M[t.level]),null===e?r.userLogHandler=null:r.userLogHandler=(t,r,...n)=>{let s=n.map(e=>{if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}}).filter(e=>e).join(" ");r>=(i??t.logLevel)&&e({level:ez[r].toLowerCase(),message:s,args:n,type:t.name})}}}function ex(e){V.forEach(t=>{t.setLogLevel(e)})}let eN="firebase-heartbeat-store",eF=null;function eO(){return eF||(eF=(function(e,t,{blocked:r,upgrade:i,blocking:n,terminated:s}={}){let a=indexedDB.open(e,1),o=K(a);return i&&a.addEventListener("upgradeneeded",e=>{i(K(a.result),e.oldVersion,e.newVersion,K(a.transaction),e)}),r&&a.addEventListener("blocked",e=>r(e.oldVersion,e.newVersion,e)),o.then(e=>{s&&e.addEventListener("close",()=>s()),n&&e.addEventListener("versionchange",e=>n(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o})("firebase-heartbeat-database",0,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(eN)}catch(e){console.warn(e)}}}).catch(e=>{throw ew.create("idb-open",{originalErrorMessage:e.message})})),eF}async function eR(e){try{let t=(await eO()).transaction(eN),r=await t.objectStore(eN).get(eV(e));return await t.done,r}catch(e){if(e instanceof I)ei.warn(e.message);else{let t=ew.create("idb-get",{originalErrorMessage:e?.message});ei.warn(t.message)}}}async function eP(e,t){try{let r=(await eO()).transaction(eN,"readwrite"),i=r.objectStore(eN);await i.put(t,eV(e)),await r.done}catch(e){if(e instanceof I)ei.warn(e.message);else{let t=ew.create("idb-set",{originalErrorMessage:e?.message});ei.warn(t.message)}}}function eV(e){return`${e.name}!${e.options.appId}`}class eM{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new eL(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{let e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=eB();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===t||this._heartbeatsCache.heartbeats.some(e=>e.date===t))return;if(this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats.length>30){let e=function(e){if(0===e.length)return -1;let t=0,r=e[0].date;for(let i=1;i<e.length;i++)e[i].date<r&&(r=e[i].date,t=i);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){ei.warn(e)}}async getHeartbeatsHeader(){try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||0===this._heartbeatsCache.heartbeats.length)return"";let e=eB(),{heartbeatsToSend:t,unsentEntries:r}=function(e,t=1024){let r=[],i=e.slice();for(let n of e){let e=r.find(e=>e.agent===n.agent);if(e){if(e.dates.push(n.date),e$(r)>t){e.dates.pop();break}}else if(r.push({agent:n.agent,dates:[n.date]}),e$(r)>t){r.pop();break}i=i.slice(1)}return{heartbeatsToSend:r,unsentEntries:i}}(this._heartbeatsCache.heartbeats),i=d(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return ei.warn(e),""}}}function eB(){return new Date().toISOString().substring(0,10)}class eL{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!A()&&T().then(()=>!0).catch(()=>!1)}async read(){if(!await this._canUseIndexedDBPromise)return{heartbeats:[]};{let e=await eR(this.app);return e?.heartbeats?e:{heartbeats:[]}}}async overwrite(e){if(await this._canUseIndexedDBPromise){let t=await this.read();return eP(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){let t=await this.read();return eP(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:[...t.heartbeats,...e.heartbeats]})}}}function e$(e){return d(JSON.stringify({version:2,heartbeats:e})).length}eh(new F("platform-logger",e=>new ee(e),"PRIVATE")),eh(new F("heartbeat",e=>new eM(e),"PRIVATE")),eC(et,er,""),eC(et,er,"esm2020"),eC("fire-js",""),e.s(["SDK_VERSION",()=>eS,"_DEFAULT_ENTRY_NAME",()=>en,"_addComponent",()=>eu,"_addOrOverwriteComponent",()=>ec,"_apps",()=>ea,"_clearComponents",()=>ey,"_components",()=>el,"_getProvider",()=>ed,"_isFirebaseApp",()=>em,"_isFirebaseServerApp",()=>eg,"_isFirebaseServerAppSettings",()=>ep,"_registerComponent",()=>eh,"_removeServiceInstance",()=>ef,"_serverApps",()=>eo,"deleteApp",()=>ek,"getApp",()=>eT,"getApps",()=>eI,"initializeApp",()=>eE,"initializeServerApp",()=>eA,"onLog",()=>eD,"registerVersion",()=>eC,"setLogLevel",()=>ex],15710);var eU,ej,ez,eq,eH,eW=e.i(54799),eG=e.i(24361),eK="u">typeof globalThis?globalThis:e.g,eJ={};(function(){function e(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.C=Array(this.blockSize),this.o=this.h=0,this.u()}var t=function(){this.blockSize=-1};function r(){}function i(e,t,r){r||(r=0);let i=Array(16);if("string"==typeof t)for(var n=0;n<16;++n)i[n]=t.charCodeAt(r++)|t.charCodeAt(r++)<<8|t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<24;else for(n=0;n<16;++n)i[n]=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24;t=e.g[0],r=e.g[1],n=e.g[2];let s=e.g[3],a;a=t+(s^r&(n^s))+i[0]+0xd76aa478|0,a=s+(n^(t=r+(a<<7|a>>>25))&(r^n))+i[1]+0xe8c7b756|0,a=n+(r^(s=t+(a<<12|a>>>20))&(t^r))+i[2]+0x242070db|0,a=r+(t^(n=s+(a<<17|a>>>15))&(s^t))+i[3]+0xc1bdceee|0,a=t+(s^(r=n+(a<<22|a>>>10))&(n^s))+i[4]+0xf57c0faf|0,a=s+(n^(t=r+(a<<7|a>>>25))&(r^n))+i[5]+0x4787c62a|0,a=n+(r^(s=t+(a<<12|a>>>20))&(t^r))+i[6]+0xa8304613|0,a=r+(t^(n=s+(a<<17|a>>>15))&(s^t))+i[7]+0xfd469501|0,a=t+(s^(r=n+(a<<22|a>>>10))&(n^s))+i[8]+0x698098d8|0,a=s+(n^(t=r+(a<<7|a>>>25))&(r^n))+i[9]+0x8b44f7af|0,a=n+(r^(s=t+(a<<12|a>>>20))&(t^r))+i[10]+0xffff5bb1|0,a=r+(t^(n=s+(a<<17|a>>>15))&(s^t))+i[11]+0x895cd7be|0,a=t+(s^(r=n+(a<<22|a>>>10))&(n^s))+i[12]+0x6b901122|0,a=s+(n^(t=r+(a<<7|a>>>25))&(r^n))+i[13]+0xfd987193|0,a=n+(r^(s=t+(a<<12|a>>>20))&(t^r))+i[14]+0xa679438e|0,a=r+(t^(n=s+(a<<17|a>>>15))&(s^t))+i[15]+0x49b40821|0,r=n+(a<<22|a>>>10),a=t+(n^s&(r^n))+i[1]+0xf61e2562|0,t=r+(a<<5|a>>>27),a=s+(r^n&(t^r))+i[6]+0xc040b340|0,s=t+(a<<9|a>>>23),a=n+(t^r&(s^t))+i[11]+0x265e5a51|0,n=s+(a<<14|a>>>18),a=r+(s^t&(n^s))+i[0]+0xe9b6c7aa|0,r=n+(a<<20|a>>>12),a=t+(n^s&(r^n))+i[5]+0xd62f105d|0,t=r+(a<<5|a>>>27),a=s+(r^n&(t^r))+i[10]+0x2441453|0,s=t+(a<<9|a>>>23),a=n+(t^r&(s^t))+i[15]+0xd8a1e681|0,n=s+(a<<14|a>>>18),a=r+(s^t&(n^s))+i[4]+0xe7d3fbc8|0,r=n+(a<<20|a>>>12),a=t+(n^s&(r^n))+i[9]+0x21e1cde6|0,t=r+(a<<5|a>>>27),a=s+(r^n&(t^r))+i[14]+0xc33707d6|0,s=t+(a<<9|a>>>23),a=n+(t^r&(s^t))+i[3]+0xf4d50d87|0,n=s+(a<<14|a>>>18),a=r+(s^t&(n^s))+i[8]+0x455a14ed|0,r=n+(a<<20|a>>>12),a=t+(n^s&(r^n))+i[13]+0xa9e3e905|0,t=r+(a<<5|a>>>27),a=s+(r^n&(t^r))+i[2]+0xfcefa3f8|0,s=t+(a<<9|a>>>23),a=n+(t^r&(s^t))+i[7]+0x676f02d9|0,n=s+(a<<14|a>>>18),a=r+(s^t&(n^s))+i[12]+0x8d2a4c8a|0,a=t+((r=n+(a<<20|a>>>12))^n^s)+i[5]+0xfffa3942|0,a=s+((t=r+(a<<4|a>>>28))^r^n)+i[8]+0x8771f681|0,a=n+((s=t+(a<<11|a>>>21))^t^r)+i[11]+0x6d9d6122|0,a=r+((n=s+(a<<16|a>>>16))^s^t)+i[14]+0xfde5380c|0,a=t+((r=n+(a<<23|a>>>9))^n^s)+i[1]+0xa4beea44|0,a=s+((t=r+(a<<4|a>>>28))^r^n)+i[4]+0x4bdecfa9|0,a=n+((s=t+(a<<11|a>>>21))^t^r)+i[7]+0xf6bb4b60|0,a=r+((n=s+(a<<16|a>>>16))^s^t)+i[10]+0xbebfbc70|0,a=t+((r=n+(a<<23|a>>>9))^n^s)+i[13]+0x289b7ec6|0,a=s+((t=r+(a<<4|a>>>28))^r^n)+i[0]+0xeaa127fa|0,a=n+((s=t+(a<<11|a>>>21))^t^r)+i[3]+0xd4ef3085|0,a=r+((n=s+(a<<16|a>>>16))^s^t)+i[6]+0x4881d05|0,a=t+((r=n+(a<<23|a>>>9))^n^s)+i[9]+0xd9d4d039|0,a=s+((t=r+(a<<4|a>>>28))^r^n)+i[12]+0xe6db99e5|0,a=n+((s=t+(a<<11|a>>>21))^t^r)+i[15]+0x1fa27cf8|0,a=r+((n=s+(a<<16|a>>>16))^s^t)+i[2]+0xc4ac5665|0,r=n+(a<<23|a>>>9),a=t+(n^(r|~s))+i[0]+0xf4292244|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~n))+i[7]+0x432aff97|0,s=t+(a<<10|a>>>22),a=n+(t^(s|~r))+i[14]+0xab9423a7|0,n=s+(a<<15|a>>>17),a=r+(s^(n|~t))+i[5]+0xfc93a039|0,r=n+(a<<21|a>>>11),a=t+(n^(r|~s))+i[12]+0x655b59c3|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~n))+i[3]+0x8f0ccc92|0,s=t+(a<<10|a>>>22),a=n+(t^(s|~r))+i[10]+0xffeff47d|0,n=s+(a<<15|a>>>17),a=r+(s^(n|~t))+i[1]+0x85845dd1|0,r=n+(a<<21|a>>>11),a=t+(n^(r|~s))+i[8]+0x6fa87e4f|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~n))+i[15]+0xfe2ce6e0|0,s=t+(a<<10|a>>>22),a=n+(t^(s|~r))+i[6]+0xa3014314|0,n=s+(a<<15|a>>>17),a=r+(s^(n|~t))+i[13]+0x4e0811a1|0,r=n+(a<<21|a>>>11),a=t+(n^(r|~s))+i[4]+0xf7537e82|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~n))+i[11]+0xbd3af235|0,s=t+(a<<10|a>>>22),a=n+(t^(s|~r))+i[2]+0x2ad7d2bb|0,n=s+(a<<15|a>>>17),a=r+(s^(n|~t))+i[9]+0xeb86d391|0,e.g[0]=e.g[0]+t|0,e.g[1]=e.g[1]+(n+(a<<21|a>>>11))|0,e.g[2]=e.g[2]+n|0,e.g[3]=e.g[3]+s|0}function n(e,t){this.h=t;let r=[],i=!0;for(let n=e.length-1;n>=0;n--){let s=0|e[n];i&&s==t||(r[n]=s,i=!1)}this.g=r}r.prototype=t.prototype,e.F=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.D=function(e,r,i){for(var n=Array(arguments.length-2),s=2;s<arguments.length;s++)n[s-2]=arguments[s];return t.prototype[r].apply(e,n)},e.prototype.u=function(){this.g[0]=0x67452301,this.g[1]=0xefcdab89,this.g[2]=0x98badcfe,this.g[3]=0x10325476,this.o=this.h=0},e.prototype.v=function(e,t){void 0===t&&(t=e.length);let r=t-this.blockSize,n=this.C,s=this.h,a=0;for(;a<t;){if(0==s)for(;a<=r;)i(this,e,a),a+=this.blockSize;if("string"==typeof e){for(;a<t;)if(n[s++]=e.charCodeAt(a++),s==this.blockSize){i(this,n),s=0;break}}else for(;a<t;)if(n[s++]=e[a++],s==this.blockSize){i(this,n),s=0;break}}this.h=s,this.o+=t},e.prototype.A=function(){var e=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;t=8*this.o;for(var r=e.length-8;r<e.length;++r)e[r]=255&t,t/=256;for(this.v(e),e=Array(16),t=0,r=0;r<4;++r)for(let i=0;i<32;i+=8)e[t++]=this.g[r]>>>i&255;return e};var s,a={};function o(e){var t;return -128<=e&&e<128?(t=function(e){return new n([0|e],e<0?-1:0)},Object.prototype.hasOwnProperty.call(a,e)?a[e]:a[e]=t(e)):new n([0|e],e<0?-1:0)}function l(e){if(isNaN(e)||!isFinite(e))return u;if(e<0)return m(l(-e));let t=[],r=1;for(let i=0;e>=r;i++)t[i]=e/r|0,r*=0x100000000;return new n(t,0)}var u=o(0),c=o(1),h=o(0x1000000);function d(e){if(0!=e.h)return!1;for(let t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function f(e){return -1==e.h}function m(e){let t=e.g.length,r=[];for(let i=0;i<t;i++)r[i]=~e.g[i];return new n(r,~e.h).add(c)}function p(e,t){return e.add(m(t))}function g(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function y(e,t){this.g=e,this.h=t}function w(e,t){if(d(t))throw Error("division by zero");if(d(e))return new y(u,u);if(f(e))return t=w(m(e),t),new y(m(t.g),m(t.h));if(f(t))return t=w(e,m(t)),new y(m(t.g),t.h);if(e.g.length>30){if(f(e)||f(t))throw Error("slowDivide_ only works with positive integers.");for(var r=c,i=t;0>=i.l(e);)r=v(r),i=v(i);var n=_(r,1),s=_(i,1);for(i=_(i,2),r=_(r,2);!d(i);){var a=s.add(i);0>=a.l(e)&&(n=n.add(r),s=a),i=_(i,1),r=_(r,1)}return t=p(e,n.j(t)),new y(n,t)}for(n=u;e.l(t)>=0;){for(i=(i=Math.ceil(Math.log(r=Math.max(1,Math.floor(e.m()/t.m())))/Math.LN2))<=48?1:Math.pow(2,i-48),a=(s=l(r)).j(t);f(a)||a.l(e)>0;)r-=i,a=(s=l(r)).j(t);d(s)&&(s=c),n=n.add(s),e=p(e,a)}return new y(n,e)}function v(e){let t=e.g.length+1,r=[];for(let i=0;i<t;i++)r[i]=e.i(i)<<1|e.i(i-1)>>>31;return new n(r,e.h)}function _(e,t){let r=t>>5;t%=32;let i=e.g.length-r,s=[];for(let n=0;n<i;n++)s[n]=t>0?e.i(n+r)>>>t|e.i(n+r+1)<<32-t:e.i(n+r);return new n(s,e.h)}(s=n.prototype).m=function(){if(f(this))return-m(this).m();let e=0,t=1;for(let r=0;r<this.g.length;r++){let i=this.i(r);e+=(i>=0?i:0x100000000+i)*t,t*=0x100000000}return e},s.toString=function(e){if((e=e||10)<2||36<e)throw Error("radix out of range: "+e);if(d(this))return"0";if(f(this))return"-"+m(this).toString(e);let t=l(Math.pow(e,6));var r=this;let i="";for(;;){let n=w(r,t).g,s=(((r=p(r,n.j(t))).g.length>0?r.g[0]:r.h)>>>0).toString(e);if(d(r=n))return s+i;for(;s.length<6;)s="0"+s;i=s+i}},s.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h},s.l=function(e){return f(e=p(this,e))?-1:+!d(e)},s.abs=function(){return f(this)?m(this):this},s.add=function(e){let t=Math.max(this.g.length,e.g.length),r=[],i=0;for(let n=0;n<=t;n++){let t=i+(65535&this.i(n))+(65535&e.i(n)),s=(t>>>16)+(this.i(n)>>>16)+(e.i(n)>>>16);i=s>>>16,t&=65535,s&=65535,r[n]=s<<16|t}return new n(r,-0x80000000&r[r.length-1]?-1:0)},s.j=function(e){if(d(this)||d(e))return u;if(f(this))return f(e)?m(this).j(m(e)):m(m(this).j(e));if(f(e))return m(this.j(m(e)));if(0>this.l(h)&&0>e.l(h))return l(this.m()*e.m());let t=this.g.length+e.g.length,r=[];for(var i=0;i<2*t;i++)r[i]=0;for(i=0;i<this.g.length;i++)for(let t=0;t<e.g.length;t++){let n=this.i(i)>>>16,s=65535&this.i(i),a=e.i(t)>>>16,o=65535&e.i(t);r[2*i+2*t]+=s*o,g(r,2*i+2*t),r[2*i+2*t+1]+=n*o,g(r,2*i+2*t+1),r[2*i+2*t+1]+=s*a,g(r,2*i+2*t+1),r[2*i+2*t+2]+=n*a,g(r,2*i+2*t+2)}for(e=0;e<t;e++)r[e]=r[2*e+1]<<16|r[2*e];for(e=t;e<2*t;e++)r[e]=0;return new n(r,0)},s.B=function(e){return w(this,e).h},s.and=function(e){let t=Math.max(this.g.length,e.g.length),r=[];for(let i=0;i<t;i++)r[i]=this.i(i)&e.i(i);return new n(r,this.h&e.h)},s.or=function(e){let t=Math.max(this.g.length,e.g.length),r=[];for(let i=0;i<t;i++)r[i]=this.i(i)|e.i(i);return new n(r,this.h|e.h)},s.xor=function(e){let t=Math.max(this.g.length,e.g.length),r=[];for(let i=0;i<t;i++)r[i]=this.i(i)^e.i(i);return new n(r,this.h^e.h)},e.prototype.digest=e.prototype.A,e.prototype.reset=e.prototype.u,e.prototype.update=e.prototype.v,eJ.Md5=e,n.prototype.add=n.prototype.add,n.prototype.multiply=n.prototype.j,n.prototype.modulo=n.prototype.B,n.prototype.compare=n.prototype.l,n.prototype.toNumber=n.prototype.m,n.prototype.toString=n.prototype.toString,n.prototype.getBits=n.prototype.i,n.fromNumber=l,n.fromString=function e(t,r){if(0==t.length)throw Error("number format error: empty string");if((r=r||10)<2||36<r)throw Error("radix out of range: "+r);if("-"==t.charAt(0))return m(e(t.substring(1),r));if(t.indexOf("-")>=0)throw Error('number format error: interior "-" character');let i=l(Math.pow(r,8)),n=u;for(let e=0;e<t.length;e+=8){var s=Math.min(8,t.length-e);let a=parseInt(t.substring(e,e+s),r);s<8?(s=l(Math.pow(r,s)),n=n.j(s).add(l(a))):n=(n=n.j(i)).add(l(a))}return n},eq=eJ.Integer=n}).apply(void 0!==eK?eK:"u">typeof self?self:{});class eQ{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}eQ.UNAUTHENTICATED=new eQ(null),eQ.GOOGLE_CREDENTIALS=new eQ("google-credentials-uid"),eQ.FIRST_PARTY=new eQ("first-party-uid"),eQ.MOCK_USER=new eQ("mock-user");let eY="12.9.0",eX=new U("@firebase/firestore");function eZ(e,...t){if(eX.logLevel<=ez.DEBUG){let r=t.map(e2);eX.debug(`Firestore (${eY}): ${e}`,...r)}}function e0(e,...t){if(eX.logLevel<=ez.ERROR){let r=t.map(e2);eX.error(`Firestore (${eY}): ${e}`,...r)}}function e1(e,...t){if(eX.logLevel<=ez.WARN){let r=t.map(e2);eX.warn(`Firestore (${eY}): ${e}`,...r)}}function e2(e){if("string"==typeof e)return e;try{return(0,eG.inspect)(e,{depth:100})}catch(t){return e}}function e6(e,t,r){let i="Unexpected state";"string"==typeof t?i=t:r=t,e4(e,i,r)}function e4(e,t,r){let i=`FIRESTORE (${eY}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(void 0!==r)try{let e=JSON.stringify(r);i+=" CONTEXT: "+e}catch(e){i+=" CONTEXT: "+r}throw e0(i),Error(i)}function e3(e,t,r,i){let n="Unexpected state";"string"==typeof r?n=r:i=r,e||e4(t,n,i)}let e5="cancelled",e8="unknown",e7="invalid-argument",e9="deadline-exceeded",te="not-found",tt="permission-denied",tr="unauthenticated",ti="resource-exhausted",tn="failed-precondition",ts="aborted",ta="out-of-range",to="unimplemented",tl="internal",tu="unavailable";class tc extends I{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class th{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class td{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(eQ.UNAUTHENTICATED))}shutdown(){}}class tf{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class tm{constructor(e){this.auth=null,e.onInit(e=>{this.auth=e})}getToken(){return this.auth?this.auth.getToken().then(e=>e?(e3("string"==typeof e.accessToken,42297,{tokenData:e}),new th(e.accessToken,new eQ(this.auth.getUid()))):null):Promise.resolve(null)}invalidateToken(){}start(e,t){}shutdown(){}}class tp{constructor(e,t,r){this.sessionIndex=e,this.iamToken=t,this.authTokenFactory=r,this.type="FirstParty",this.user=eQ.FIRST_PARTY,this._headers=new Map}getAuthToken(){return this.authTokenFactory?this.authTokenFactory():null}get headers(){this._headers.set("X-Goog-AuthUser",this.sessionIndex);let e=this.getAuthToken();return e&&this._headers.set("Authorization",e),this.iamToken&&this._headers.set("X-Goog-Iam-Authorization-Token",this.iamToken),this._headers}}class tg{constructor(e,t,r){this.sessionIndex=e,this.iamToken=t,this.authTokenFactory=r}getToken(){return Promise.resolve(new tp(this.sessionIndex,this.iamToken,this.authTokenFactory))}start(e,t){e.enqueueRetryable(()=>t(eQ.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ty{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class tw{constructor(e,t){this.appCheckProvider=t,this.appCheck=null,this.serverAppAppCheckToken=null,eg(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),t.onInit(e=>{this.appCheck=e})}getToken(){return this.serverAppAppCheckToken?Promise.resolve(new ty(this.serverAppAppCheckToken)):this.appCheck?this.appCheck.getToken().then(e=>e?(e3("string"==typeof e.token,3470,{tokenResult:e}),new ty(e.token)):null):Promise.resolve(null)}invalidateToken(){}start(e,t){}shutdown(){}}class tv{constructor(e,t,r,i,n,s,a,o,l,u,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=n,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=o,this.useFetchStreams=l,this.isUsingEmulator=u,this.apiKey=c}}let t_="(default)";class tb{constructor(e,t){this.projectId=e,this.database=t||t_}static empty(){return new tb("","")}get isDefaultDatabase(){return this.database===t_}isEqual(e){return e instanceof tb&&e.projectId===this.projectId&&e.database===this.database}}class tS{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=(0,eW.randomBytes)(40);for(let n=0;n<i.length;++n)r.length<20&&i[n]<t&&(r+=e.charAt(i[n]%e.length))}return r}}function tE(e,t){return e<t?-1:+(e>t)}function tA(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let r=e.charAt(i),n=t.charAt(i);if(r!==n)return tT(r)===tT(n)?tE(r,n):tT(r)?1:-1}return tE(e.length,t.length)}function tT(e){let t=e.charCodeAt(0);return t>=55296&&t<=57343}function tI(e,t,r){return e.length===t.length&&e.every((e,i)=>r(e,t[i]))}let tk="__name__";class tC{constructor(e,t,r){void 0===t?t=0:t>e.length&&e6(637,{offset:t,range:e.length}),void 0===r?r=e.length-t:r>e.length-t&&e6(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===tC.comparator(this,e)}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof tC?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let r=tC.compareSegments(e.get(i),t.get(i));if(0!==r)return r}return tE(e.length,t.length)}static compareSegments(e,t){let r=tC.isNumericId(e),i=tC.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?tC.extractNumericId(e).compare(tC.extractNumericId(t)):tA(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return eq.fromString(e.substring(4,e.length-2))}}class tD extends tC{construct(e,t,r){return new tD(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new tc(e7,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(e=>e.length>0))}return new tD(t)}static emptyPath(){return new tD([])}}let tx=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class tN extends tC{construct(e,t,r){return new tN(e,t,r)}static isValidIdentifier(e){return tx.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),tN.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===tk}static keyField(){return new tN([tk])}static fromServerFormat(e){let t=[],r="",i=0,n=()=>{if(0===r.length)throw new tc(e7,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},s=!1;for(;i<e.length;){let t=e[i];if("\\"===t){if(i+1===e.length)throw new tc(e7,"Path has trailing escape character: "+e);let t=e[i+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new tc(e7,"Path has invalid escape sequence: "+e);r+=t,i+=2}else"`"===t?s=!s:"."!==t||s?r+=t:n(),i++}if(n(),s)throw new tc(e7,"Unterminated ` in path: "+e);return new tN(t)}static emptyPath(){return new tN([])}}class tF{constructor(e){this.path=e}static fromPath(e){return new tF(tD.fromString(e))}static fromName(e){return new tF(tD.fromString(e).popFirst(5))}static empty(){return new tF(tD.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===tD.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return tD.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new tF(new tD(e.slice()))}}function tO(e,t,r){if(!r)throw new tc(e7,`Function ${e}() cannot be called with an empty ${t}.`)}function tR(e){if(!tF.isDocumentKey(e))throw new tc(e7,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function tP(e){if(tF.isDocumentKey(e))throw new tc(e7,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function tV(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function tM(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e)if(e instanceof Array)return"an array";else{var t;let r=(t=e).constructor?t.constructor.name:null;return r?`a custom ${r} object`:"an object"}else if("function"==typeof e)return"a function";else return e6(12329,{type:typeof e})}function tB(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t))if(t.name===e.constructor.name)throw new tc(e7,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");else{let r=tM(e);throw new tc(e7,`Expected type '${t.name}', but it was: ${r}`)}return e}function tL(e){let t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}let t$=null,tU="RestConnection",tj={};tj.BatchGetDocuments="batchGet",tj.Commit="commit",tj.RunQuery="runQuery",tj.RunAggregationQuery="runAggregationQuery",tj.ExecutePipeline="executePipeline";class tz{get shouldResourcePathBeIncludedInRequest(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.baseUrl=t+"://"+e.host,this.databasePath=`projects/${r}/databases/${i}`,this.requestParams=this.databaseId.database===t_?`project_id=${r}`:`project_id=${r}&database_id=${i}`}invokeRPC(e,t,r,i,n){let s=(null===t$?t$=0x10000000+Math.round(0x80000000*Math.random()):t$++,"0x"+t$.toString(16)),a=this.makeUrl(e,t.toUriEncodedString());eZ(tU,`Sending RPC '${e}' ${s}:`,a,r);let o={"google-cloud-resource-prefix":this.databasePath,"x-goog-request-params":this.requestParams};this.modifyHeadersForRequest(o,i,n);let{host:l}=new URL(a),u=w(l);return this.performRPCRequest(e,a,o,r,u).then(t=>(eZ(tU,`Received RPC '${e}' ${s}: `,t),t),t=>{throw e1(tU,`RPC '${e}' ${s} failed with error: `,t,"url: ",a,"request:",r),t})}invokeStreamingRPC(e,t,r,i,n,s){return this.invokeRPC(e,t,r,i,n)}modifyHeadersForRequest(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+eY,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,r)=>e[r]=t),r&&r.headers.forEach((t,r)=>e[r]=t)}makeUrl(e,t){let r=tj[e],i=`${this.baseUrl}/v1/${t}:${r}`;return this.databaseInfo.apiKey&&(i=`${i}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),i}terminate(){}}function tq(e){if(void 0===e)return e0("RPC_ERROR","HTTP error has no status"),e8;switch(e){case 200:return"ok";case 400:return tn;case 401:return tr;case 403:return tt;case 404:return te;case 409:return ts;case 416:return ta;case 429:return ti;case 499:return e5;case 500:return e8;case 501:return to;case 503:return tu;case 504:return e9;default:if(e>=200&&e<300)return"ok";if(e>=400&&e<500)return tn;if(e>=500&&e<600)return tl;return e8}}(eU=eH||(eH={}))[eU.OK=0]="OK",eU[eU.CANCELLED=1]="CANCELLED",eU[eU.UNKNOWN=2]="UNKNOWN",eU[eU.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",eU[eU.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",eU[eU.NOT_FOUND=5]="NOT_FOUND",eU[eU.ALREADY_EXISTS=6]="ALREADY_EXISTS",eU[eU.PERMISSION_DENIED=7]="PERMISSION_DENIED",eU[eU.UNAUTHENTICATED=16]="UNAUTHENTICATED",eU[eU.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",eU[eU.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",eU[eU.ABORTED=10]="ABORTED",eU[eU.OUT_OF_RANGE=11]="OUT_OF_RANGE",eU[eU.UNIMPLEMENTED=12]="UNIMPLEMENTED",eU[eU.INTERNAL=13]="INTERNAL",eU[eU.UNAVAILABLE=14]="UNAVAILABLE",eU[eU.DATA_LOSS=15]="DATA_LOSS";class tH extends tz{openStream(e,t){throw Error("Not supported by FetchConnection")}async performRPCRequest(e,t,r,i,n){let s,a=JSON.stringify(i);try{let e={method:"POST",headers:r,body:a};n&&(e.credentials="include"),s=await fetch(t,e)}catch(e){throw new tc(tq(e.status),"Request failed with error: "+e.statusText)}if(!s.ok){let e=await s.json();Array.isArray(e)&&(e=e[0]);let t=e?.error?.message;throw new tc(tq(s.status),`Request failed with error: ${t??s.statusText}`)}return s.json()}}function tW(e){let t=0;for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function tG(e,t){for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function tK(e){return 0===e&&1/e==-1/0}class tJ{constructor(e){this.binaryString=e}static fromBase64String(e){return new tJ(Buffer.from(e,"base64").toString("binary"))}static fromUint8Array(e){return new tJ(function(e){let t="";for(let r=0;r<e.length;++r)t+=String.fromCharCode(e[r]);return t}(e))}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){var e;return e=this.binaryString,Buffer.from(e,"binary").toString("base64")}toUint8Array(){var e=this.binaryString;let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return tE(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}tJ.EMPTY_BYTE_STRING=new tJ("");let tQ=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function tY(e){if(e3(!!e,39018),"string"==typeof e){let t=0,r=tQ.exec(e);if(e3(!!r,46558,{timestamp:e}),r[1]){let e=r[1];t=Number(e=(e+"000000000").substr(0,9))}return{seconds:Math.floor(new Date(e).getTime()/1e3),nanos:t}}return{seconds:tX(e.seconds),nanos:tX(e.nanos)}}function tX(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function tZ(e){return"string"==typeof e?tJ.fromBase64String(e):tJ.fromUint8Array(e)}function t0(e,t){let r={typeString:e};return t&&(r.value=t),r}function t1(e,t){let r;if(!tV(e))throw new tc(e7,"JSON must be an object");for(let i in t)if(t[i]){let n=t[i].typeString,s="value"in t[i]?{value:t[i].value}:void 0;if(!(i in e)){r=`JSON missing required field: '${i}'`;break}let a=e[i];if(n&&typeof a!==n){r=`JSON field '${i}' must be a ${n}.`;break}if(void 0!==s&&a!==s.value){r=`Expected '${i}' field to equal '${s.value}'`;break}}if(r)throw new tc(e7,r);return!0}class t2{static now(){return t2.fromMillis(Date.now())}static fromDate(e){return t2.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*1e6);return new t2(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0||t>=1e9)throw new tc(e7,"Timestamp nanoseconds out of range: "+t);if(e<-0xe7791f700||e>=0x3afff44180)throw new tc(e7,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?tE(this.nanoseconds,e.nanoseconds):tE(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:t2._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(t1(e,t2._jsonSchema))return new t2(e.seconds,e.nanoseconds)}valueOf(){return String(this.seconds- -0xe7791f700).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}function t6(e){return(e?.mapValue?.fields||{}).__type__?.stringValue==="server_timestamp"}function t4(e){let t=tY(e.mapValue.fields.__local_write_time__.timestampValue);return new t2(t.seconds,t.nanos)}t2._jsonSchemaVersion="firestore/timestamp/1.0",t2._jsonSchema={type:t0("string",t2._jsonSchemaVersion),seconds:t0("number"),nanoseconds:t0("number")};let t3="__type__",t5="__max__",t8={},t7="__vector__",t9="value";function re(e){var t;if("nullValue"in e)return 0;if("booleanValue"in e)return 1;if("integerValue"in e||"doubleValue"in e)return 2;if("timestampValue"in e)return 3;if("stringValue"in e)return 5;if("bytesValue"in e)return 6;if("referenceValue"in e)return 7;if("geoPointValue"in e)return 8;if("arrayValue"in e)return 9;if(!("mapValue"in e))return e6(28295,{value:e});if(t6(e))return 4;if((((e.mapValue||{}).fields||{}).__type__||{}).stringValue===t5)return 0x1fffffffffffff;if(t=e,(t?.mapValue?.fields||{})[t3]?.stringValue===t7)return 10;return 11}function rt(e,t){if(e===t)return!0;let r=re(e);if(r!==re(t))return!1;switch(r){case 0:case 0x1fffffffffffff:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return t4(e).isEqual(t4(t));case 3:var i,n,s,a,o=e,l=t;if("string"==typeof o.timestampValue&&"string"==typeof l.timestampValue&&o.timestampValue.length===l.timestampValue.length)return o.timestampValue===l.timestampValue;let u=tY(o.timestampValue),c=tY(l.timestampValue);return u.seconds===c.seconds&&u.nanos===c.nanos;case 5:return e.stringValue===t.stringValue;case 6:return i=e,n=t,tZ(i.bytesValue).isEqual(tZ(n.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return s=e,a=t,tX(s.geoPointValue.latitude)===tX(a.geoPointValue.latitude)&&tX(s.geoPointValue.longitude)===tX(a.geoPointValue.longitude);case 2:var h=e,d=t;if("integerValue"in h&&"integerValue"in d)return tX(h.integerValue)===tX(d.integerValue);if("doubleValue"in h&&"doubleValue"in d){let e=tX(h.doubleValue),t=tX(d.doubleValue);return e===t?tK(e)===tK(t):isNaN(e)&&isNaN(t)}return!1;case 9:return tI(e.arrayValue.values||[],t.arrayValue.values||[],rt);case 10:case 11:var f=e,m=t;let p=f.mapValue.fields||{},g=m.mapValue.fields||{};if(tW(p)!==tW(g))return!1;for(let e in p)if(p.hasOwnProperty(e)&&(void 0===g[e]||!rt(p[e],g[e])))return!1;return!0;default:return e6(52216,{left:e})}}function rr(e,t){return void 0!==(e.values||[]).find(e=>rt(e,t))}function ri(e,t){var r,i,n,s,a,o,l,u;if(e===t)return 0;let c=re(e),h=re(t);if(c!==h)return tE(c,h);switch(c){case 0:case 0x1fffffffffffff:return 0;case 1:return tE(e.booleanValue,t.booleanValue);case 2:let d,f;return r=e,i=t,d=tX(r.integerValue||r.doubleValue),d<(f=tX(i.integerValue||i.doubleValue))?-1:d>f?1:d===f?0:isNaN(d)?isNaN(f)?0:-1:1;case 3:return rn(e.timestampValue,t.timestampValue);case 4:return rn(t4(e),t4(t));case 5:return tA(e.stringValue,t.stringValue);case 6:let m,p;return n=e.bytesValue,s=t.bytesValue,m=tZ(n),p=tZ(s),m.compareTo(p);case 7:return function(e,t){let r=e.split("/"),i=t.split("/");for(let e=0;e<r.length&&e<i.length;e++){let t=tE(r[e],i[e]);if(0!==t)return t}return tE(r.length,i.length)}(e.referenceValue,t.referenceValue);case 8:let g;return a=e.geoPointValue,o=t.geoPointValue,0!==(g=tE(tX(a.latitude),tX(o.latitude)))?g:tE(tX(a.longitude),tX(o.longitude));case 9:return rs(e.arrayValue,t.arrayValue);case 10:let y,w,v,_,b;return l=e.mapValue,u=t.mapValue,y=l.fields||{},w=u.fields||{},v=y[t9]?.arrayValue,_=w[t9]?.arrayValue,0!==(b=tE(v?.values?.length||0,_?.values?.length||0))?b:rs(v,_);case 11:return function(e,t){if(e===t8&&t===t8)return 0;if(e===t8)return 1;if(t===t8)return -1;let r=e.fields||{},i=Object.keys(r),n=t.fields||{},s=Object.keys(n);i.sort(),s.sort();for(let e=0;e<i.length&&e<s.length;++e){let t=tA(i[e],s[e]);if(0!==t)return t;let a=ri(r[i[e]],n[s[e]]);if(0!==a)return a}return tE(i.length,s.length)}(e.mapValue,t.mapValue);default:throw e6(23264,{leftType:c})}}function rn(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return tE(e,t);let r=tY(e),i=tY(t),n=tE(r.seconds,i.seconds);return 0!==n?n:tE(r.nanos,i.nanos)}function rs(e,t){let r=e.values||[],i=t.values||[];for(let e=0;e<r.length&&e<i.length;++e){let t=ri(r[e],i[e]);if(t)return t}return tE(r.length,i.length)}function ra(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function ro(e){return!!e&&"arrayValue"in e}function rl(e){return!!e&&"nullValue"in e}function ru(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function rc(e){return!!e&&"mapValue"in e}function rh(e){if(e.geoPointValue)return{geoPointValue:{...e.geoPointValue}};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:{...e.timestampValue}};if(e.mapValue){let t={mapValue:{fields:{}}};return tG(e.mapValue.fields,(e,r)=>t.mapValue.fields[e]=rh(r)),t}{if(!e.arrayValue)return{...e};let t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=rh(e.arrayValue.values[r]);return t}}class rd{constructor(e,t){this.position=e,this.inclusive=t}}function rf(e,t){if(null===e)return null===t;if(null===t||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!rt(e.position[r],t.position[r]))return!1;return!0}class rm{}class rp extends rm{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){if(e.isKeyField())if("in"===t||"not-in"===t)return this.createKeyFieldInFilter(e,t,r);else return new ry(e,t,r);if("array-contains"===t)return new rb(e,r);if("in"===t)return new rS(e,r);if("not-in"===t)return new rE(e,r);if("array-contains-any"===t)return new rA(e,r);else return new rp(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new rw(e,r):new rv(e,r)}matches(e){let t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(ri(t,this.value)):null!==t&&re(this.value)===re(t)&&this.matchesComparison(ri(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return e6(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class rg extends rm{constructor(e,t){super(),this.filters=e,this.op=t,this.memoizedFlattenedFilters=null}static create(e,t){return new rg(e,t)}matches(e){var t;return(t=this,"and"===t.op)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.memoizedFlattenedFilters||(this.memoizedFlattenedFilters=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.memoizedFlattenedFilters}getFilters(){return Object.assign([],this.filters)}}class ry extends rp{constructor(e,t,r){super(e,t,r),this.key=tF.fromName(r.referenceValue)}matches(e){let t=tF.comparator(e.key,this.key);return this.matchesComparison(t)}}class rw extends rp{constructor(e,t){super(e,"in",t),this.keys=r_("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class rv extends rp{constructor(e,t){super(e,"not-in",t),this.keys=r_("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function r_(e,t){return(t.arrayValue?.values||[]).map(e=>tF.fromName(e.referenceValue))}class rb extends rp{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return ro(t)&&rr(t.arrayValue,this.value)}}class rS extends rp{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return null!==t&&rr(this.value.arrayValue,t)}}class rE extends rp{constructor(e,t){super(e,"not-in",t)}matches(e){if(rr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!rr(this.value.arrayValue,t)}}class rA extends rp{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!!ro(t)&&!!t.arrayValue.values&&t.arrayValue.values.some(e=>rr(this.value.arrayValue,e))}}class rT{constructor(e,t="asc"){this.field=e,this.dir=t}}class rI{static fromTimestamp(e){return new rI(e)}static min(){return new rI(new t2(0,0))}static max(){return new rI(new t2(0x3afff4417f,1e9-1))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class rk{constructor(e,t){this.comparator=e,this.root=t||rD.EMPTY}insert(e,t){return new rk(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,rD.BLACK,null,null))}remove(e){return new rk(this.comparator,this.root.remove(e,this.comparator).copy(null,null,rD.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(0===i)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return -1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new rC(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new rC(this.root,e,this.comparator,!1)}getReverseIterator(){return new rC(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new rC(this.root,e,this.comparator,!0)}}class rC{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let n=1;for(;!e.isEmpty();)if(n=t?r(e.key,t):1,t&&i&&(n*=-1),n<0)e=this.isReverse?e.left:e.right;else if(0===n){this.nodeStack.push(e);break}else this.nodeStack.push(e),e=this.isReverse?e.right:e.left}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class rD{constructor(e,t,r,i,n){this.key=e,this.value=t,this.color=null!=r?r:rD.RED,this.left=null!=i?i:rD.EMPTY,this.right=null!=n?n:rD.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,n){return new rD(null!=e?e:this.key,null!=t?t:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=n?n:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,n=r(e,i.key);return(i=n<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===n?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r))).fixUp()}removeMin(){if(this.left.isEmpty())return rD.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()}remove(e,t){let r,i=this;if(0>t(e,i.key))i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key))if(i.right.isEmpty())return rD.EMPTY;else r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin());i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}rotateLeft(){let e=this.copy(null,null,rD.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,rD.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){return Math.pow(2,this.check())<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw e6(43730,{key:this.key,value:this.value});if(this.right.isRed())throw e6(14113,{key:this.key,value:this.value});let e=this.left.check();if(e===this.right.check())return e+ +!this.isRed();throw e6(27949)}}rD.EMPTY=null,rD.RED=!0,rD.BLACK=!1,rD.EMPTY=new class{constructor(){this.size=0}get key(){throw e6(57766)}get value(){throw e6(16141)}get color(){throw e6(16727)}get left(){throw e6(29726)}get right(){throw e6(36894)}copy(e,t,r,i,n){return this}insert(e,t,r){return new rD(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class rx{constructor(e){this.comparator=e,this.data=new rk(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new rN(this.data.getIterator())}getIteratorFrom(e){return new rN(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof rx)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let e=t.getNext().key,i=r.getNext().key;if(0!==this.comparator(e,i))return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new rx(this.comparator);return t.data=e,t}}class rN{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class rF{constructor(e){this.fields=e,e.sort(tN.comparator)}static empty(){return new rF([])}unionWith(e){let t=new rx(tN.comparator);for(let e of this.fields)t=t.add(e);for(let r of e)t=t.add(r);return new rF(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return tI(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class rO{constructor(e){this.value=e}static empty(){return new rO({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(!rc(t=(t.mapValue.fields||{})[e.get(r)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=rh(t)}setAll(e){let t=tN.emptyPath(),r={},i=[];e.forEach((e,n)=>{if(!t.isImmediateParentOf(n)){let e=this.getFieldsMap(t);this.applyChanges(e,r,i),r={},i=[],t=n.popLast()}e?r[n.lastSegment()]=rh(e):i.push(n.lastSegment())});let n=this.getFieldsMap(t);this.applyChanges(n,r,i)}delete(e){let t=this.field(e.popLast());rc(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return rt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];rc(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){for(let i of(tG(t,(t,r)=>e[t]=r),r))delete e[i]}clone(){return new rO(rh(this.value))}}class rR{constructor(e,t,r,i,n,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=n,this.data=s,this.documentState=a}static newInvalidDocument(e){return new rR(e,0,rI.min(),rI.min(),rI.min(),rO.empty(),0)}static newFoundDocument(e,t,r,i){return new rR(e,1,t,rI.min(),r,i,0)}static newNoDocument(e,t){return new rR(e,2,t,rI.min(),rI.min(),rO.empty(),0)}static newUnknownDocument(e,t){return new rR(e,3,t,rI.min(),rI.min(),rO.empty(),2)}convertToFoundDocument(e,t){return this.createTime.isEqual(rI.min())&&(2===this.documentType||0===this.documentType)&&(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=rO.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=rO.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=rI.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof rR&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new rR(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class rP{constructor(e,t=null,r=[],i=[],n=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=n,this.startAt=s,this.endAt=a,this.memoizedCanonicalId=null}}function rV(e,t=null,r=[],i=[],n=null,s=null,a=null){return new rP(e,t,r,i,n,s,a)}class rM{constructor(e,t=null,r=[],i=[],n=null,s="F",a=null,o=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=n,this.limitType=s,this.startAt=a,this.endAt=o,this.memoizedNormalizedOrderBy=null,this.memoizedTarget=null,this.memoizedAggregateTarget=null,this.startAt,this.endAt}}function rB(e){return e.memoizedTarget||(e.memoizedTarget=rL(e,function(e){if(null===e.memoizedNormalizedOrderBy){let t;e.memoizedNormalizedOrderBy=[];let r=new Set;for(let t of e.explicitOrderBy)e.memoizedNormalizedOrderBy.push(t),r.add(t.field.canonicalString());let i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(t=new rx(tN.comparator),e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t).forEach(t=>{r.has(t.canonicalString())||t.isKeyField()||e.memoizedNormalizedOrderBy.push(new rT(t,i))}),r.has(tN.keyField().canonicalString())||e.memoizedNormalizedOrderBy.push(new rT(tN.keyField(),i))}return e.memoizedNormalizedOrderBy}(e))),e.memoizedTarget}function rL(e,t){if("F"===e.limitType)return rV(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{let t="desc"===e.dir?"asc":"desc";return new rT(e.field,t)});let r=e.endAt?new rd(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new rd(e.startAt.position,e.startAt.inclusive):null;return rV(e.path,e.collectionGroup,t,e.filters,e.limit,r,i)}}function r$(e,t){let r=e.filters.concat([t]);return new rM(e.path,e.collectionGroup,e.explicitOrderBy.slice(),r,e.limit,e.limitType,e.startAt,e.endAt)}function rU(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};else if(t===1/0)return{doubleValue:"Infinity"};else if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:tK(t)?"-0":t}}class rj{constructor(){this._=void 0}}class rz extends rj{}class rq extends rj{constructor(e){super(),this.elements=e}}class rH extends rj{constructor(e){super(),this.elements=e}}class rW extends rj{constructor(e,t){super(),this.serializer=e,this.operand=t}}class rG{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new rG}static exists(e){return new rG(void 0,e)}static updateTime(e){return new rG(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}class rK{}class rJ extends rK{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class rQ extends rK{constructor(e,t,r,i,n=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=n,this.type=1}getFieldMask(){return this.fieldMask}}class rY extends rK{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class rX extends rK{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}let rZ=((n={}).asc="ASCENDING",n.desc="DESCENDING",n),r0=((s={})["<"]="LESS_THAN",s["<="]="LESS_THAN_OR_EQUAL",s[">"]="GREATER_THAN",s[">="]="GREATER_THAN_OR_EQUAL",s["=="]="EQUAL",s["!="]="NOT_EQUAL",s["array-contains"]="ARRAY_CONTAINS",s.in="IN",s["not-in"]="NOT_IN",s["array-contains-any"]="ARRAY_CONTAINS_ANY",s),r1=((a={}).and="AND",a.or="OR",a);function r2(e,t){}class r6{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function r4(e,t){if(!e.useProto3Json)return{seconds:""+t.seconds,nanos:t.nanoseconds};{let e=new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),r=("000000000"+t.nanoseconds).slice(-9);return`${e}.${r}Z`}}function r3(e){let t;return e3(!!e,49232),rI.fromTimestamp(new t2((t=tY(e)).seconds,t.nanos))}function r5(e,t){return r8(e,t).canonicalString()}function r8(e,t){var r;let i=new tD(["projects",(r=e).projectId,"databases",r.database]).child("documents");return void 0===t?i:i.child(t)}function r7(e,t){return r5(e.databaseId,t.path)}function r9(e,t){var r;let i,n=(e3(ii(i=tD.fromString(t)),10190,{key:i.toString()}),i);if(n.get(1)!==e.databaseId.projectId)throw new tc(e7,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new tc(e7,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new tF((e3((r=n).length>4&&"documents"===r.get(4),29091,{key:r.toString()}),r.popFirst(5)))}function ie(e,t,r){return{name:r7(e,t),fields:r.value.mapValue.fields}}function it(e,t){var r,i,n,s;let a,o={structuredQuery:{}},l=t.path;null!==t.collectionGroup?(a=l,o.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(a=l.popLast(),o.structuredQuery.from=[{collectionId:l.lastSegment()}]),r=a,o.parent=r5(e.databaseId,r);let u=function(e){if(0!==e.length)return function e(t){var r;let i;return t instanceof rp?function(e){if("=="===e.op){if(ru(e.value))return{unaryFilter:{field:ir(e.field),op:"IS_NAN"}};else if(rl(e.value))return{unaryFilter:{field:ir(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(ru(e.value))return{unaryFilter:{field:ir(e.field),op:"IS_NOT_NAN"}};else if(rl(e.value))return{unaryFilter:{field:ir(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ir(e.field),op:r0[e.op],value:e.value}}}(t):t instanceof rg?1===(i=(r=t).getFilters().map(t=>e(t))).length?i[0]:{compositeFilter:{op:r1[r.op],filters:i}}:e6(54877,{filter:t})}(rg.create(e,"and"))}(t.filters);u&&(o.structuredQuery.where=u);let c=function(e){if(0!==e.length)return e.map(e=>{var t;return{field:ir((t=e).field),direction:rZ[t.dir]}})}(t.orderBy);c&&(o.structuredQuery.orderBy=c);let h=(i=t.limit,e.useProto3Json||null==i?i:{value:i});return null!==h&&(o.structuredQuery.limit=h),t.startAt&&(o.structuredQuery.startAt={before:(n=t.startAt).inclusive,values:n.position}),t.endAt&&(o.structuredQuery.endAt={before:!(s=t.endAt).inclusive,values:s.position}),{queryTarget:o,parent:a}}function ir(e){return{fieldPath:e.canonicalString()}}function ii(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}function is(e){return!!e&&"function"==typeof e._toProto&&"ProtoValue"===e._protoValueType}function ia(e){return new r6(e,!0)}class io{}class il extends io{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.terminated=!1}verifyInitialized(){if(this.terminated)throw new tc(tn,"The client has already been terminated.")}invokeRPC(e,t,r,i){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([n,s])=>this.connection.invokeRPC(e,r8(t,r),i,n,s)).catch(e=>{if("FirebaseError"===e.name)throw e.code===tr&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e;throw new tc(e8,e.toString())})}invokeStreamingRPC(e,t,r,i,n){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.invokeStreamingRPC(e,r8(t,r),i,s,a,n)).catch(e=>{if("FirebaseError"===e.name)throw e.code===tr&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e;throw new tc(e8,e.toString())})}terminate(){this.terminated=!0,this.connection.terminate()}}async function iu(e,t){let r={writes:t.map(t=>(function(e,t){var r,i,n;let s;if(t instanceof rJ)s={update:ie(e,t.key,t.value)};else if(t instanceof rY)s={delete:r7(e,t.key)};else if(t instanceof rQ){let i;s={update:ie(e,t.key,t.data),updateMask:(r=t.fieldMask,i=[],r.fields.forEach(e=>i.push(e.canonicalString())),{fieldPaths:i})}}else{if(!(t instanceof rX))return e6(16599,{mutationType:t.type});s={verify:r7(e,t.key)}}return t.fieldTransforms.length>0&&(s.updateTransforms=t.fieldTransforms.map(e=>(function(e,t){let r=t.transform;if(r instanceof rz)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(r instanceof rq)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:r.elements}};if(r instanceof rH)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:r.elements}};if(r instanceof rW)return{fieldPath:t.field.canonicalString(),increment:r.operand};throw e6(20930,{transform:t.transform})})(0,e))),t.precondition.isNone||(s.currentDocument=(i=e,void 0!==(n=t.precondition).updateTime?{updateTime:r4(i,n.updateTime.toTimestamp())}:void 0!==n.exists?{exists:n.exists}:e6(27497))),s})(e.serializer,t))};await e.invokeRPC("Commit",e.serializer.databaseId,tD.emptyPath(),r)}async function ic(e,t){let r={documents:t.map(t=>r7(e.serializer,t))},i=await e.invokeStreamingRPC("BatchGetDocuments",e.serializer.databaseId,tD.emptyPath(),r,t.length),n=new Map;i.forEach(t=>{let r=function(e,t){if("found"in t){let r,i,n,s;return e3(!!t.found,43571),r2(t.found.name),r2(t.found.updateTime),r=r9(e,t.found.name),i=r3(t.found.updateTime),n=t.found.createTime?r3(t.found.createTime):rI.min(),s=new rO({mapValue:{fields:t.found.fields}}),rR.newFoundDocument(r,i,n,s)}if("missing"in t){let r,i;return e3(!!t.missing,3894),e3(!!t.readTime,22933),r=r9(e,t.missing),i=r3(t.readTime),rR.newNoDocument(r,i)}return e6(7234,{result:t})}(e.serializer,t);n.set(r.key.toString(),r)});let s=[];return t.forEach(e=>{let t=n.get(e.toString());e3(!!t,55234,{key:e}),s.push(t)}),s}async function ih(e,t){let{queryTarget:r,parent:i}=it(e.serializer,rB(t));return(await e.invokeStreamingRPC("RunQuery",e.serializer.databaseId,i,{structuredQuery:r.structuredQuery})).filter(e=>!!e.document).map(t=>{var r,i,n;let s,a,o,l,u;return r=e.serializer,i=t.document,n=void 0,s=r9(r,i.name),a=r3(i.updateTime),o=i.createTime?r3(i.createTime):rI.min(),l=new rO({mapValue:{fields:i.fields}}),u=rR.newFoundDocument(s,a,o,l),n&&u.setHasCommittedMutations(),n?u.setHasCommittedMutations():u})}async function id(e,t,r){let{request:i,aliasMap:n,parent:s}=function(e,t,r,i){let{queryTarget:n,parent:s}=it(e,t),a={},o=[],l=0;return r.forEach(e=>{let t=`aggregate_${l++}`;a[t]=e.alias,"count"===e.aggregateType?o.push({alias:t,count:{}}):"avg"===e.aggregateType?o.push({alias:t,avg:{field:ir(e.fieldPath)}}):"sum"===e.aggregateType&&o.push({alias:t,sum:{field:ir(e.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:o,structuredQuery:n.structuredQuery},parent:n.parent},aliasMap:a,parent:s}}(e.serializer,(t.memoizedAggregateTarget||(t.memoizedAggregateTarget=rL(t,t.explicitOrderBy)),t.memoizedAggregateTarget),r);e.connection.shouldResourcePathBeIncludedInRequest||delete i.parent;let a=(await e.invokeStreamingRPC("RunAggregationQuery",e.serializer.databaseId,s,i,1)).filter(e=>!!e.result);e3(1===a.length,64727);let o=a[0].result?.aggregateFields;return Object.keys(o).reduce((e,t)=>(e[n[t]]=o[t],e),{})}let im="ComponentProvider",ip=new Map;function ig(e){if(e._terminated)throw new tc(tn,"The client has already been terminated.");if(!ip.has(e)){var t,r,i,n,s,a;eZ(im,"Initializing Datastore");let o=new tH((r=e._databaseId,i=e.app.options.appId||"",n=e._persistenceKey,s=e.app.options.apiKey,new tv(r,i,n,(a=e._freezeSettings()).host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,tL(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator,s))),l=ia(e._databaseId),u=(t=e._authCredentials,new il(t,e._appCheckCredentials,o,l));ip.set(e,u)}return ip.get(e)}let iy="firestore.googleapis.com";class iw{constructor(e){if(void 0===e.host){if(void 0!==e.ssl)throw new tc(e7,"Can't provide ssl option if host option is not set");this.host=iy,this.ssl=!0}else this.host=e.host,this.ssl=e.ssl??!0;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=0x2800000;else if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new tc(e7,"cacheSizeBytes must be at least 1048576");else this.cacheSizeBytes=e.cacheSizeBytes;!function(e,t,r,i){if(!0===t&&!0===i)throw new tc(e7,`${e} and ${r} cannot be used together.`)}("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=tL(e.experimentalLongPollingOptions??{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new tc(e7,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new tc(e7,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new tc(e7,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){var t,r;return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,r=e.experimentalLongPollingOptions,t.timeoutSeconds===r.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class iv{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new iw({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new tc(tn,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new tc(tn,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new iw(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new td;switch(e.type){case"firstParty":return new tg(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new tc(e7,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){let e;return(e=ip.get(this))&&(eZ(im,"Removing Datastore"),ip.delete(this),e.terminate()),Promise.resolve()}}function i_(e,t){let r=ed("object"==typeof e?e:eT(),"firestore/lite").getImmediate({identifier:"string"==typeof e?e:t||"(default)"});if(!r._initialized){let e=p("firestore");e&&function(e,t,r,i={}){e=tB(e,iv);let n=w(t),s=e._getSettings(),a={...s,emulatorOptions:e._getEmulatorOptions()},o=`${t}:${r}`;n&&(v(`https://${o}`),b("Firestore",!0)),s.host!==iy&&s.host!==o&&e1("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let l={...s,host:o,ssl:n,emulatorOptions:i};if(!D(l,a)&&(e._setSettings(l),i.mockUserToken)){let t,r;if("string"==typeof i.mockUserToken)t=i.mockUserToken,r=eQ.MOCK_USER;else{t=_(i.mockUserToken,e._app?.options.projectId);let n=i.mockUserToken.sub||i.mockUserToken.user_id;if(!n)throw new tc(e7,"mockUserToken must contain 'sub' or 'user_id' field!");r=new eQ(n)}e._authCredentials=new tf(new th(t,r))}}(r,...e)}return r}class ib{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new ib(this.firestore,e,this._query)}}class iS{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new iE(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new iS(this.firestore,e,this._key)}toJSON(){return{type:iS._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(t1(t,iS._jsonSchema))return new iS(e,r||null,new tF(tD.fromString(t.referencePath)))}}iS._jsonSchemaVersion="firestore/documentReference/1.0",iS._jsonSchema={type:t0("string",iS._jsonSchemaVersion),referencePath:t0("string")};class iE extends ib{constructor(e,t,r){super(e,t,function(e){return new rM(e)}(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new iS(this.firestore,null,new tF(e))}withConverter(e){return new iE(this.firestore,e,this._path)}}function iA(e,t,...r){if(e=N(e),tO("collection","path",t),e instanceof iv){let i=tD.fromString(t,...r);return tP(i),new iE(e,null,i)}{if(!(e instanceof iS)&&!(e instanceof iE))throw new tc(e7,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=e._path.child(tD.fromString(t,...r));return tP(i),new iE(e.firestore,null,i)}}function iT(e,t,...r){if(e=N(e),1==arguments.length&&(t=tS.newId()),tO("doc","path",t),e instanceof iv){let i=tD.fromString(t,...r);return tR(i),new iS(e,null,new tF(i))}{if(!(e instanceof iS)&&!(e instanceof iE))throw new tc(e7,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=e._path.child(tD.fromString(t,...r));return tR(i),new iS(e.firestore,e instanceof iE?e.converter:null,new tF(i))}}class iI{constructor(e){this._byteString=e}static fromBase64String(e){try{return new iI(tJ.fromBase64String(e))}catch(e){throw new tc(e7,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new iI(tJ.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:iI._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(t1(e,iI._jsonSchema))return iI.fromBase64String(e.bytes)}}iI._jsonSchemaVersion="firestore/bytes/1.0",iI._jsonSchema={type:t0("string",iI._jsonSchemaVersion),bytes:t0("string")};class ik{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new tc(e7,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new tN(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class iC{constructor(e){this._methodName=e}}class iD{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new tc(e7,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new tc(e7,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return tE(this._lat,e._lat)||tE(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:iD._jsonSchemaVersion}}static fromJSON(e){if(t1(e,iD._jsonSchema))return new iD(e.latitude,e.longitude)}}iD._jsonSchemaVersion="firestore/geoPoint/1.0",iD._jsonSchema={type:t0("string",iD._jsonSchemaVersion),latitude:t0("number"),longitude:t0("number")};class ix{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ix._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(t1(e,ix._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new ix(e.vectorValues);throw new tc(e7,"Expected 'vectorValues' field to be a number array")}}}ix._jsonSchemaVersion="firestore/vectorValue/1.0",ix._jsonSchema={type:t0("string",ix._jsonSchemaVersion),vectorValues:t0("object")};let iN=/^__.*__$/;class iF{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new rQ(e,this.data,this.fieldMask,t,this.fieldTransforms):new rJ(e,this.data,t,this.fieldTransforms)}}class iO{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new rQ(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function iR(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw e6(40011,{dataSource:e})}}class iP{constructor(e,t,r,i,n,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,void 0===n&&this.validatePath(),this.fieldTransforms=n||[],this.fieldMask=s||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new iP({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){let t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){let t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return iJ(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(0===e.length)throw this.createError("Document fields must not be empty");if(iR(this.dataSource)&&iN.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class iV{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||ia(e)}createContext(e,t,r,i=!1){return new iP({dataSource:e,methodName:t,targetDoc:r,path:tN.emptyPath(),arrayElement:!1,hasConverter:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function iM(e){let t=e._freezeSettings(),r=ia(e._databaseId);return new iV(e._databaseId,!!t.ignoreUndefinedProperties,r)}function iB(e,t,r,i,n,s={}){let a,o,l=e.createContext(s.merge||s.mergeFields?2:0,t,r,n);iH("Data must be an object, but it was:",l,i);let u=iz(i,l);if(s.merge)a=new rF(l.fieldMask),o=l.fieldTransforms;else if(s.mergeFields){let e=[];for(let i of s.mergeFields){let n=iW(t,i,r);if(!l.contains(n))throw new tc(e7,`Field '${n}' is specified in your field mask but missing from your input data.`);iQ(e,n)||e.push(n)}a=new rF(e),o=l.fieldTransforms.filter(e=>a.covers(e.field))}else a=null,o=l.fieldTransforms;return new iF(new rO(u),a,o)}class iL extends iC{_toFieldTransform(e){if(2===e.dataSource)e.fieldMask.push(e.path);else if(1===e.dataSource)throw e.createError(`${this._methodName}() can only appear at the top level of your update data`);else throw e.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return null}isEqual(e){return e instanceof iL}}function i$(e,t,r,i){let n=e.createContext(1,t,r);iH("Data must be an object, but it was:",n,i);let s=[],a=rO.empty();return tG(i,(e,i)=>{let o=iK(t,e,r);i=N(i);let l=n.childContextForFieldPath(o);if(i instanceof iL)s.push(o);else{let e=ij(i,l);null!=e&&(s.push(o),a.set(o,e))}}),new iO(a,new rF(s),n.fieldTransforms)}function iU(e,t,r,i,n,s){let a=e.createContext(1,t,r),o=[iW(t,i,r)],l=[n];if(s.length%2!=0)throw new tc(e7,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<s.length;e+=2)o.push(iW(t,s[e])),l.push(s[e+1]);let u=[],c=rO.empty();for(let e=o.length-1;e>=0;--e)if(!iQ(u,o[e])){let t=o[e],r=l[e];r=N(r);let i=a.childContextForFieldPath(t);if(r instanceof iL)u.push(t);else{let e=ij(r,i);null!=e&&(u.push(t),c.set(t,e))}}return new iO(c,new rF(u),a.fieldTransforms)}function ij(e,t){if(iq(e=N(e)))return iH("Unsupported field value:",t,e),iz(e,t);if(e instanceof iC)return function(e,t){if(!iR(t.dataSource))throw t.createError(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.createError(`${e._methodName}() is not currently supported inside arrays`);let r=e._toFieldTransform(t);r&&t.fieldTransforms.push(r)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),!(e instanceof Array))return function(e,t){if(null===(e=N(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e){var r,i,n,s,a=t.serializer,o=e;return"number"==typeof o&&Number.isInteger(o)&&!tK(o)&&o<=Number.MAX_SAFE_INTEGER&&o>=Number.MIN_SAFE_INTEGER?{integerValue:""+o}:rU(a,o)}if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){let r=t2.fromDate(e);return{timestampValue:r4(t.serializer,r)}}else if(e instanceof t2){let r=new t2(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:r4(t.serializer,r)}}else if(e instanceof iD)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};else if(e instanceof iI)return{bytesValue:(n=t.serializer,s=e._byteString,n.useProto3Json?s.toBase64():s.toUint8Array())};else if(e instanceof iS){let r=t.databaseId,i=e.firestore._databaseId;if(!i.isEqual(r))throw t.createError(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:r5(e.firestore._databaseId||t.databaseId,e._key.path)}}else if(e instanceof ix){return r=e,i=t,{mapValue:{fields:{[t3]:{stringValue:t7},[t9]:{arrayValue:{values:(r instanceof ix?r.toArray():r).map(e=>{if("number"!=typeof e)throw i.createError("VectorValues must only contain numeric values.");return rU(i.serializer,e)})}}}}}}else if(is(e))return e._toProto(t.serializer);else throw t.createError(`Unsupported field value: ${tM(e)}`)}(e,t);if(t.settings.arrayElement&&4!==t.dataSource)throw t.createError("Nested arrays are not supported");var r=e,i=t;let n=[],s=0;for(let e of r){let t=ij(e,i.childContextForArray(s));null==t&&(t={nullValue:"NULL_VALUE"}),n.push(t),s++}return{arrayValue:{values:n}}}function iz(e,t){let r={};return!function(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(e)?tG(e,(e,i)=>{let n=ij(i,t.childContextForField(e));null!=n&&(r[e]=n)}):t.path&&t.path.length>0&&t.fieldMask.push(t.path),{mapValue:{fields:r}}}function iq(e){return"object"==typeof e&&null!==e&&!(e instanceof Array)&&!(e instanceof Date)&&!(e instanceof t2)&&!(e instanceof iD)&&!(e instanceof iI)&&!(e instanceof iS)&&!(e instanceof iC)&&!(e instanceof ix)&&!is(e)}function iH(e,t,r){if(!iq(r)||!tV(r)){let i=tM(r);if("an object"===i)throw t.createError(e+" a custom object");throw t.createError(e+" "+i)}}function iW(e,t,r){if((t=N(t))instanceof ik)return t._internalPath;if("string"==typeof t)return iK(e,t);throw iJ("Field path arguments must be of type string or ",e,!1,void 0,r)}let iG=RegExp("[~\\*/\\[\\]]");function iK(e,t,r){if(t.search(iG)>=0)throw iJ(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,r);try{return new ik(...t.split("."))._internalPath}catch(i){throw iJ(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,r)}}function iJ(e,t,r,i,n){let s=i&&!i.isEmpty(),a=void 0!==n,o=`Function ${t}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${i}`),a&&(l+=` in document ${n}`),l+=")"),new tc(e7,o+e+l)}function iQ(e,t){return e.some(e=>e.isEqual(t))}class iY{constructor(e,t,r,i,n){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=n}get id(){return this._key.path.lastSegment()}get ref(){return new iS(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(!this._converter)return this._userDataWriter.convertValue(this._document.data.value);{let e=new iX(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(e){if(this._document){let t=this._document.data.field(iW("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class iX extends iY{data(){return super.data()}}class iZ{constructor(e,t){this._docs=t,this.query=e}get docs(){return[...this._docs]}get size(){return this.docs.length}get empty(){return 0===this.docs.length}forEach(e,t){this._docs.forEach(e,t)}}class i0{}class i1 extends i0{}function i2(e,t,...r){let i=[];for(let n of(t instanceof i0&&i.push(t),function(e){let t=e.filter(e=>e instanceof i3).length,r=e.filter(e=>e instanceof i6).length;if(t>1||t>0&&r>0)throw new tc(e7,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i=i.concat(r)),i))e=n._apply(e);return e}class i6 extends i1{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new i6(e,t,r)}_apply(e){let t=this._parse(e);return nr(e._query,t),new ib(e.firestore,e.converter,r$(e._query,t))}_parse(e){let t=iM(e.firestore);return function(e,t,r,i,n,s,a){let o;if(n.isKeyField())if("array-contains"===s||"array-contains-any"===s)throw new tc(e7,`Invalid Query. You can't perform '${s}' queries on documentId().`);else if("in"===s||"not-in"===s){nt(a,s);let t=[];for(let r of a)t.push(ne(i,e,r));o={arrayValue:{values:t}}}else o=ne(i,e,a);else("in"===s||"not-in"===s||"array-contains-any"===s)&&nt(a,s),o=function(e,t,r,i=!1){return ij(r,e.createContext(i?4:3,t))}(r,t,a,"in"===s||"not-in"===s);return rp.create(n,s,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function i4(e,t,r){let i=iW("where",e);return i6._create(i,t,r)}class i3 extends i0{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new i3(e,t)}_parse(e){let t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:rg.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let r=e;for(let e of t.getFlattenedFilters())nr(r,e),r=r$(r,e)}(e._query,t),new ib(e.firestore,e.converter,r$(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class i5 extends i1{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new i5(e,t)}_apply(e){var t;let r,i=function(e,t,r){if(null!==e.startAt)throw new tc(e7,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new tc(e7,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new rT(t,r)}(e._query,this._field,this._direction);return new ib(e.firestore,e.converter,(t=e._query,r=t.explicitOrderBy.concat([i]),new rM(t.path,t.collectionGroup,r,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))}}function i8(e,t="asc"){let r=iW("orderBy",e);return i5._create(r,t)}class i7 extends i1{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new i7(e,t,r)}_apply(e){var t,r,i;return new ib(e.firestore,e.converter,(t=e._query,r=this._limit,i=this._limitType,new rM(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),r,i,t.startAt,t.endAt)))}}function i9(e){if(e<=0)throw new tc(e7,`Function limit() requires a positive number, but it was: ${e}.`);return i7._create("limit",e,"F")}function ne(e,t,r){if("string"==typeof(r=N(r))){if(""===r)throw new tc(e7,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(null===t.collectionGroup&&-1!==r.indexOf("/"))throw new tc(e7,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);let i=t.path.child(tD.fromString(r));if(!tF.isDocumentKey(i))throw new tc(e7,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return ra(e,new tF(i))}if(r instanceof iS)return ra(e,r._key);throw new tc(e7,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${tM(r)}.`)}function nt(e,t){if(!Array.isArray(e)||0===e.length)throw new tc(e7,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function nr(e,t){let r=function(e,t){for(let r of e)for(let e of r.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==r)if(r===t.op)throw new tc(e7,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`);else throw new tc(e7,`Invalid query. You cannot use '${t.op.toString()}' filters with '${r.toString()}' filters.`)}class ni{convertValue(e,t="none"){switch(re(e)){case 0:return null;case 1:return e.booleanValue;case 2:return tX(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(tZ(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw e6(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return tG(e,(e,i)=>{r[e]=this.convertValue(i,t)}),r}convertVectorValue(e){return new ix(e.fields?.[t9].arrayValue?.values?.map(e=>tX(e.doubleValue)))}convertGeoPoint(e){return new iD(tX(e.latitude),tX(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=function e(t){let r=t.mapValue.fields.__previous_value__;return t6(r)?e(r):r}(e);if(null==r)return null;return this.convertValue(r,t);case"estimate":return this.convertTimestamp(t4(e));default:return null}}convertTimestamp(e){let t=tY(e);return new t2(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=tD.fromString(e);e3(ii(r),9688,{name:e});let i=new tb(r.get(1),r.get(3)),n=new tF(r.popFirst(5));return i.isEqual(t)||e0(`Document ${n} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),n}}function nn(e,t,r){return e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t}class ns extends ni{constructor(e){super(),this.firestore=e}convertBytes(e){return new iI(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new iS(this.firestore,null,t)}}function na(e){let t=ig((e=tB(e,iS)).firestore),r=new ns(e.firestore);return ic(t,[e._key]).then(t=>{e3(1===t.length,15618);let i=t[0];return new iY(e.firestore,r,e._key,i.isFoundDocument()?i:null,e.converter)})}function no(e){var t=(e=tB(e,ib))._query;if("L"===t.limitType&&0===t.explicitOrderBy.length)throw new tc(to,"limitToLast() queries require specifying at least one orderBy() clause");let r=ig(e.firestore),i=new ns(e.firestore);return ih(r,e._query).then(t=>{let r=t.map(t=>new iX(e.firestore,i,t.key,t,e.converter));return"L"===e._query.limitType&&r.reverse(),new iZ(e,r)})}function nl(e,t,r){let i=nn((e=tB(e,iS)).converter,t,r),n=iB(iM(e.firestore),"setDoc",e._key,i,null!==e.converter,r);return iu(ig(e.firestore),[n.toMutation(e._key,rG.none())])}function nu(e,t,r,...i){let n,s=iM((e=tB(e,iS)).firestore);return n="string"==typeof(t=N(t))||t instanceof ik?iU(s,"updateDoc",e._key,t,r,i):i$(s,"updateDoc",e._key,t),iu(ig(e.firestore),[n.toMutation(e._key,rG.exists(!0))])}function nc(e){return iu(ig((e=tB(e,iS)).firestore),[new rY(e._key,rG.none())])}function nh(e,t){let r=iT(e=tB(e,iE)),i=nn(e.converter,t),n=iB(iM(e.firestore),"addDoc",r._key,i,null!==r.converter,{});return iu(ig(e.firestore),[n.toMutation(r._key,rG.exists(!1))]).then(()=>r)}function nd(){return new iL("deleteField")}let nf="4.11.0";class nm{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class np{constructor(e,t,r=1e3,i=1.5,n=6e4){this.queue=e,this.timerId=t,this.initialDelayMs=r,this.backoffFactor=i,this.maxDelayMs=n,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}reset(){this.currentBaseMs=0}resetToMax(){this.currentBaseMs=this.maxDelayMs}backoffAndRun(e){this.cancel();let t=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),i=Math.max(0,t-r);i>0&&eZ("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.currentBaseMs} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,i,()=>(this.lastAttemptTime=Date.now(),e())),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)}skipBackoff(){null!==this.timerPromise&&(this.timerPromise.skipDelay(),this.timerPromise=null)}cancel(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)}jitterDelayMs(){return(Math.random()-.5)*this.currentBaseMs}}class ng{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}}class ny{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class nw{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}_fieldsProto(){return new rO({mapValue:{fields:this._data}}).clone().value.mapValue.fields}}function nv(e){return n_(e,{count:nE()})}function n_(e,t){let r=tB(e.firestore,iv),i=ig(r),n=function(e,t){let r=[];for(let i in e)Object.prototype.hasOwnProperty.call(e,i)&&r.push(t(e[i],i,e));return r}(t,(e,t)=>new ng(t,e.aggregateType,e._internalFieldPath));return id(i,e._query,n).then(t=>{var i,n,s;return i=r,n=e,s=t,new nw(n,new ns(i),s)})}function nb(e){return new ny("sum",iW("sum",e))}function nS(e){return new ny("avg",iW("average",e))}function nE(){return new ny("count")}function nA(e,t){return e instanceof ny&&t instanceof ny&&e.aggregateType===t.aggregateType&&e._internalFieldPath?.canonicalString()===t._internalFieldPath?.canonicalString()}function nT(e,t){return function(e,t){if(e=N(e),t=N(t),e instanceof ib&&t instanceof ib){var r,i;return e.firestore===t.firestore&&(r=e._query,i=t._query,function(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++){var r,i;if(r=e.orderBy[n],i=t.orderBy[n],!(r.dir===i.dir&&r.field.isEqual(i.field)))return!1}if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!function e(t,r){var i,n,s,a;if(t instanceof rp){return i=t,(n=r)instanceof rp&&i.op===n.op&&i.field.isEqual(n.field)&&rt(i.value,n.value)}if(t instanceof rg){return s=t,(a=r)instanceof rg&&s.op===a.op&&s.filters.length===a.filters.length&&s.filters.reduce((t,r,i)=>t&&e(r,a.filters[i]),!0)}e6(19439)}(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!rf(e.startAt,t.startAt)&&rf(e.endAt,t.endAt)}(rB(r),rB(i))&&r.limitType===i.limitType)&&e.converter===t.converter}return!1}(e.query,t.query)&&D(e.data(),t.data())}class nI{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=iM(e)}set(e,t,r){this._verifyNotCommitted();let i=nk(e,this._firestore),n=nn(i.converter,t,r),s=iB(this._dataReader,"WriteBatch.set",i._key,n,null!==i.converter,r);return this._mutations.push(s.toMutation(i._key,rG.none())),this}update(e,t,r,...i){let n;this._verifyNotCommitted();let s=nk(e,this._firestore);return n="string"==typeof(t=N(t))||t instanceof ik?iU(this._dataReader,"WriteBatch.update",s._key,t,r,i):i$(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(n.toMutation(s._key,rG.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=nk(e,this._firestore);return this._mutations=this._mutations.concat(new rY(t._key,rG.none())),this}commit(){return(this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0)?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new tc(tn,"A write batch can no longer be used after commit() has been called.")}}function nk(e,t){if((e=N(e)).firestore===t)return e;throw new tc(e7,"Provided document reference is from a different Firestore instance.")}function nC(e){let t=ig(e=tB(e,iv));return new nI(e,e=>iu(t,e))}let nD={maxAttempts:5};class nx{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new tc(e7,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let t=await ic(this.datastore,e);return t.forEach(e=>this.recordVersion(e)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastTransactionError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new rY(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((e,t)=>{let r=tF.fromPath(t);this.mutations.push(new rX(r,this.precondition(r)))}),await iu(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else if(e.isNoDocument())t=rI.min();else throw e6(50498,{documentName:e.constructor.name});let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new tc(ts,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return this.writtenDocs.has(e.toString())||!t?rG.none():t.isEqual(rI.min())?rG.exists(!1):rG.updateTime(t)}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(this.writtenDocs.has(e.toString())||!t)return rG.exists(!0);if(t.isEqual(rI.min()))throw new tc(e7,"Can't update a document that doesn't exist.");return rG.updateTime(t)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class nN{constructor(e,t,r,i,n){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=n,this.attemptsRemaining=r.maxAttempts,this.backoff=new np(this.asyncQueue,"transaction_retry")}run(){this.attemptsRemaining-=1,this.runWithBackOff()}runWithBackOff(){this.backoff.backoffAndRun(async()=>{let e=new nx(this.datastore),t=this.tryRunUpdateFunction(e);t&&t.then(t=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(t)}).catch(e=>{this.handleTransactionError(e)}))}).catch(e=>{this.handleTransactionError(e)})})}tryRunUpdateFunction(e){try{let t=this.updateFunction(e);if(null==t||!t.catch||!t.then)return this.deferred.reject(Error("Transaction callback must return a Promise")),null;return t}catch(e){return this.deferred.reject(e),null}}handleTransactionError(e){this.attemptsRemaining>0&&this.isRetryableTransactionError(e)?(this.attemptsRemaining-=1,this.asyncQueue.enqueueAndForget(()=>(this.runWithBackOff(),Promise.resolve()))):this.deferred.reject(e)}isRetryableTransactionError(e){if(e?.name==="FirebaseError"){let t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!function(e){switch(e){case"ok":return e6(64938);case e5:case e8:case e9:case ti:case tl:case tu:case tr:return!1;case e7:case te:case"already-exists":case tt:case tn:case ts:case ta:case to:case"data-loss":return!0;default:return e6(15467,{code:e})}}(t)}return!1}}class nF{constructor(e,t,r,i,n){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=n,this.deferred=new nm,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,n){let s=new nF(e,t,Date.now()+r,i,n);return s.start(r),s}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new tc(e5,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}class nO{constructor(e=Promise.resolve()){this.retryableOps=[],this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.skipNonRestrictedTasks=!1,this.timerIdsToSkip=[],this.backoff=new np(this,"async_queue_retry"),this.visibilityHandler=()=>{this.backoff.skipBackoff()},this.tail=e}get isShuttingDown(){return this._isShuttingDown}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.verifyNotFailed(),this.enqueueInternal(e)}enterRestrictedMode(e){this._isShuttingDown||(this._isShuttingDown=!0,this.skipNonRestrictedTasks=e||!1)}enqueue(e){if(this.verifyNotFailed(),this._isShuttingDown)return new Promise(()=>{});let t=new nm;return this.enqueueInternal(()=>this._isShuttingDown&&this.skipNonRestrictedTasks?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.retryableOps.push(e),this.retryNextOp()))}async retryNextOp(){if(0!==this.retryableOps.length){try{await this.retryableOps[0](),this.retryableOps.shift(),this.backoff.reset()}catch(e){if("IndexedDbTransactionError"===e.name)eZ("AsyncQueue","Operation failed with retryable error: "+e);else throw e}this.retryableOps.length>0&&this.backoff.backoffAndRun(()=>this.retryNextOp())}}enqueueInternal(e){let t=this.tail.then(()=>(this.operationInProgress=!0,e().catch(e=>{throw this.failure=e,this.operationInProgress=!1,e0("INTERNAL UNHANDLED ERROR: ",nR(e)),e}).then(e=>(this.operationInProgress=!1,e))));return this.tail=t,t}enqueueAfterDelay(e,t,r){this.verifyNotFailed(),this.timerIdsToSkip.indexOf(e)>-1&&(t=0);let i=nF.createAndSchedule(this,e,t,r,e=>this.removeDelayedOperation(e));return this.delayedOperations.push(i),i}verifyNotFailed(){this.failure&&e6(47125,{messageOrStack:nR(this.failure)})}verifyOperationInProgress(){}async drain(){let e;do e=this.tail,await e;while(e!==this.tail)}containsDelayedOperation(e){for(let t of this.delayedOperations)if(t.timerId===e)return!0;return!1}runAllDelayedOperationsUntil(e){return this.drain().then(()=>{for(let t of(this.delayedOperations.sort((e,t)=>e.targetTimeMs-t.targetTimeMs),this.delayedOperations))if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.drain()})}skipDelaysForTimerId(e){this.timerIdsToSkip.push(e)}removeDelayedOperation(e){let t=this.delayedOperations.indexOf(e);this.delayedOperations.splice(t,1)}}function nR(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}class nP{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=iM(e)}get(e){let t=nk(e,this._firestore),r=new ns(this._firestore);return this._transaction.lookup([t._key]).then(e=>{if(!e||1!==e.length)return e6(24041);let i=e[0];if(i.isFoundDocument())return new iY(this._firestore,r,i.key,i,t.converter);if(i.isNoDocument())return new iY(this._firestore,r,t._key,null,t.converter);throw e6(18433,{doc:i})})}set(e,t,r){let i=nk(e,this._firestore),n=nn(i.converter,t,r),s=iB(this._dataReader,"Transaction.set",i._key,n,null!==i.converter,r);return this._transaction.set(i._key,s),this}update(e,t,r,...i){let n,s=nk(e,this._firestore);return n="string"==typeof(t=N(t))||t instanceof ik?iU(this._dataReader,"Transaction.update",s._key,t,r,i):i$(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,n),this}delete(e){let t=nk(e,this._firestore);return this._transaction.delete(t._key),this}}function nV(e,t,r){let i=ig(e=tB(e,iv)),n={...nD,...r};if(n.maxAttempts<1)throw new tc(e7,"Max attempts must be at least 1");let s=new nm;return new nN(new nO,i,n,r=>t(new nP(e,r)),s).run(),s.promise}eY=`${eS}_lite`,eh(new F("firestore/lite",(e,{instanceIdentifier:t,options:r})=>{let i=e.getProvider("app").getImmediate(),n=new iv(new tm(e.getProvider("auth-internal")),new tw(i,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new tc(e7,'"projectId" not provided in firebase.initializeApp.');return new tb(e.options.projectId,t)}(i,t),i);return r&&n._setSettings(r),n},"PUBLIC").setMultipleInstances(!0)),eC("firestore-lite",nf,"node"),eC("firestore-lite",nf,"esm2020"),e.s(["AggregateField",()=>ny,"AggregateQuerySnapshot",()=>nw,"Transaction",()=>nP,"WriteBatch",()=>nI,"aggregateFieldEqual",()=>nA,"aggregateQuerySnapshotEqual",()=>nT,"average",()=>nS,"count",()=>nE,"getAggregate",()=>n_,"getCount",()=>nv,"runTransaction",()=>nV,"sum",()=>nb,"writeBatch",()=>nC],12871),e.s([],18097),e.i(12871),e.s(["addDoc",()=>nh,"collection",()=>iA,"deleteDoc",()=>nc,"deleteField",()=>nd,"doc",()=>iT,"getDoc",()=>na,"getDocs",()=>no,"getFirestore",()=>i_,"limit",()=>i9,"orderBy",()=>i8,"query",()=>i2,"setDoc",()=>nl,"updateDoc",()=>nu,"where",()=>i4],19e3)},55234,e=>{"use strict";function t(e){return{title:"Employee Self-Service Dashboard",subtitle:`${e} workspace with least-privilege access controls.`,metrics:[{id:"my-attendance",label:"My Attendance",value:"96.4%",trend:"+1.0% this month"},{id:"work-hours",label:"Work Hours",value:"160h",trend:"Month-to-date"},{id:"kpi-progress",label:"KPI Progress",value:"87%",trend:"Q1 in progress"}]}}t("Employee L1"),t("Employee L2"),t("Employee L3"),e.s(["ACTIVITY_LOG_ROWS",0,[{id:"ACT-6124",activityName:"Updated Employee Profile (CL-1038)",status:"Completed",relativeTime:"2 min ago",loggedAt:"Feb 18, 2026 08:41 AM",module:"Employee Records",performedBy:"hr.manager@gmail.com"},{id:"ACT-6123",activityName:"Approved Attendance Correction (CL-1289)",status:"Approved",relativeTime:"4 min ago",loggedAt:"Feb 18, 2026 08:39 AM",module:"Attendance",performedBy:"hr.manager@gmail.com"},{id:"ACT-6121",activityName:"Uploaded NDA Template Revision",status:"Completed",relativeTime:"6 min ago",loggedAt:"Feb 18, 2026 08:37 AM",module:"Template Repository",performedBy:"ea.office@gmail.com"},{id:"ACT-6118",activityName:"Exported Employee Master List",status:"Completed",relativeTime:"8 min ago",loggedAt:"Feb 18, 2026 08:35 AM",module:"Export Control",performedBy:"grc.analyst@gmail.com"},{id:"ACT-6117",activityName:"Corrected Attendance Log (Samira Reyes)",status:"Completed",relativeTime:"12 min ago",loggedAt:"Feb 18, 2026 08:31 AM",module:"Attendance",performedBy:"hr.assistant@gmail.com"},{id:"ACT-6116",activityName:"Created New Employee Record (CL-1312)",status:"Completed",relativeTime:"15 min ago",loggedAt:"Feb 18, 2026 08:28 AM",module:"Employee Records",performedBy:"hr.recruit@gmail.com"},{id:"ACT-6115",activityName:"Requested Shift Change Approval (CL-1204)",status:"Pending",relativeTime:"17 min ago",loggedAt:"Feb 18, 2026 08:26 AM",module:"Attendance",performedBy:"ea.office@gmail.com"},{id:"ACT-6114",activityName:"Failed Payroll Attendance Export",status:"Failed",relativeTime:"21 min ago",loggedAt:"Feb 18, 2026 08:22 AM",module:"Export Control",performedBy:"hr.manager@gmail.com"},{id:"ACT-6113",activityName:"Rejected Backdated Attendance Request",status:"Rejected",relativeTime:"26 min ago",loggedAt:"Feb 18, 2026 08:17 AM",module:"Attendance",performedBy:"grc.analyst@gmail.com"},{id:"ACT-6112",activityName:"Updated Emergency Contact (CL-1001)",status:"Completed",relativeTime:"31 min ago",loggedAt:"Feb 18, 2026 08:12 AM",module:"Employee Records",performedBy:"hr.admin@gmail.com"},{id:"ACT-6111",activityName:"Uploaded Signed NDA Document",status:"Completed",relativeTime:"36 min ago",loggedAt:"Feb 18, 2026 08:07 AM",module:"Template Repository",performedBy:"ea.office@gmail.com"},{id:"ACT-6110",activityName:"Locked Export Template: Attendance Weekly",status:"Failed",relativeTime:"40 min ago",loggedAt:"Feb 18, 2026 08:03 AM",module:"Export Control",performedBy:"grc.analyst@gmail.com"}]])},67658,e=>{"use strict";var t=e.i(15710);(0,t.registerVersion)("firebase","12.9.0","app");var r=t;e.i(76342);var r=t;e.i(18097);var i=e.i(19e3);function n(e){return String(process.env[e]||"").trim()}function s(){let e;return{apiKey:n("NEXT_PUBLIC_FIREBASE_API_KEY"),authDomain:n("NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN"),projectId:n("NEXT_PUBLIC_FIREBASE_PROJECT_ID"),storageBucket:(e=n("NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET_URL"))?e.replace(/^gs:\/\//,"").replace(/^\/+|\/+$/g,""):n("NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET"),messagingSenderId:n("NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID"),appId:n("NEXT_PUBLIC_FIREBASE_APP_ID"),measurementId:n("NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID")}}function a(){var e;return"false"!==String(process.env.CLIO_USE_FIRESTORE||"").trim().toLowerCase()&&!!((e=s()).apiKey&&e.authDomain&&e.projectId&&e.appId)}function o(){let e=function(){if(!a())return null;let e=s();return(0,r.getApps)().length>0?(0,r.getApp)():(0,r.initializeApp)(e)}();if(!e)return null;let t=function(){let e=n("CLIO_FIRESTORE_DATABASE_ID");if(!e)return"cliohris";let t=e.toLowerCase();return"default"===t||"(default)"===t?"cliohris":e}();return(0,i.getFirestore)(e,t)}e.s(["getFirestoreDb",()=>o,"isFirestoreEnabled",()=>a],67658)},96864,e=>{"use strict";let t,r;var i=e.i(2157),n=e.i(50227);e.i(18097);var s=e.i(19e3),a=e.i(55234),o=e.i(67658);let l=n.default.join(process.cwd(),"data"),u=n.default.join(l,"audit-log.ndjson");function c(e){let t=e?new Date(e):new Date;return Number.isNaN(t.getTime())?new Date().toISOString():t.toISOString()}function h(){let e=Date.now(),t=Math.random().toString(36).slice(2,8).toUpperCase();return`AUD-${e}-${t}`}function d(){return a.ACTIVITY_LOG_ROWS.map(e=>({id:e.id||h(),activityName:e.activityName||"Legacy Audit Event",status:e.status||"Completed",occurredAt:c(e.loggedAt),module:e.module||"System",performedBy:e.performedBy||"system@gmail.com",sensitivity:"Failed"===e.status||"Rejected"===e.status?"Sensitive":"Non-sensitive",metadata:{seeded:!0,relativeTime:e.relativeTime||"N/A"}}))}function f(){return String(process.env.CLIO_FIRESTORE_AUDIT_COLLECTION||"clio_audit_logs").trim()||"clio_audit_logs"}async function m(){return(0,o.isFirestoreEnabled)()?(0,o.getFirestoreDb)():null}function p(e){try{let t=JSON.parse(e);if(!t||"object"!=typeof t)return null;return t}catch{return null}}function g(e){return new Set(["Completed","Approved","Pending","Failed","Rejected"]).has(e)?e:"Completed"}function y(e){return"Sensitive"===e?"Sensitive":"Non-sensitive"}function w(e,t=""){return String(e||"").trim()||t}function v(e){return!e||"object"!=typeof e||Array.isArray(e)?{}:e}function _(e){let t=w(e).toLowerCase();return t&&"unknown"!==t?t.includes("edg/")?"Microsoft Edge":t.includes("opr/")||t.includes("opera")?"Opera":t.includes("firefox/")?"Firefox":t.includes("safari/")&&!t.includes("chrome/")?"Safari":t.includes("chrome/")?"Chrome":"Browser":"Unknown Browser"}function b(e){let t=w(e).toLowerCase();return t&&"unknown"!==t?t.includes("windows")?"Windows":t.includes("mac os x")||t.includes("macintosh")?"macOS":t.includes("android")?"Android":t.includes("iphone")||t.includes("ipad")||t.includes("ios")?"iOS":t.includes("linux")?"Linux":"OS":"Unknown OS"}function S(e,t,r){let i=w(e).toLowerCase(),n=w(t,"Unknown Browser"),s=w(r,"Unknown OS");return{deviceType:i.includes("mobile")?"Mobile":i.includes("tablet")?"Tablet":"Desktop",deviceSummary:`${n} on ${s}`}}function E(e){return Array.isArray(e)?e:[]}function A(e){return E(e).map(e=>String(e||"").trim()).filter(Boolean)}async function T(){return r||(r=e.A(11072)),r}function I(e){let t;!(!0===(t=v(e?.metadata)).skipAnomalyDetection||!0===t.autoGenerated||w(e?.module).toLowerCase().includes("incident management"))&&1&&(async()=>{let t=await T(),r=await t.processAuditEventForSecurityDetections(e);!(!r?.detected||r?.duplicate)&&r?.incidentRecord?.id&&await R({activityName:`Auto incident created by IDS (${w(r?.detection?.ruleId,"rule")})`,status:"Approved",module:"Incident Management",performedBy:String(process.env.CLIO_IDS_SYSTEM_ACTOR_EMAIL||"system@gmail.com").trim().toLowerCase()||"system@gmail.com",sensitivity:"Sensitive",metadata:{skipAnomalyDetection:!0,autoGenerated:!0,recordId:r.incidentRecord.id,incidentCode:r.incidentRecord.incidentCode||"",detectionRuleId:r?.detection?.ruleId||"",detectionFingerprint:r?.fingerprint||"",recipients:Array.isArray(r.recipients)?r.recipients:[],inAppNotificationCount:Number(r.inAppNotificationCount||0),webhookStatus:r?.deliverySummary?.webhooks?.status||"skipped",emailDispatchStatus:r?.deliverySummary?.email?.status||"skipped",smsDispatchStatus:r?.deliverySummary?.sms?.status||"skipped",auditNote:`IDS detected suspicious activity and opened incident ${r.incidentRecord.incidentCode||r.incidentRecord.id}.`,nextAction:"Review Incident Management workbench and execute containment workflow."}})})().catch(()=>null)}function k(e){let t=v(e?.metadata),r=t.userAgent||"unknown",i=w(t.browser)||_(r),n=w(t.operatingSystem)||b(r),{deviceType:s,deviceSummary:a}=S(r,i,n),o=A(t.changedFields||t.updatedFields),l=A(t.viewedFields),u=E(t.accessedDocuments||t.viewedDocuments||t.documentChanges?.added||t.documents).map(e=>{if(!e||"object"!=typeof e)return null;let t=w(e.name),r=w(e.id||e.recordId),i=w(e.type);return t||r||i?{name:t||"Employee Document",id:r||"",type:i||"General"}:null}).filter(Boolean);return{id:e.id||h(),activityName:e.activityName||"HRIS Action",status:g(e.status),occurredAt:e.occurredAt,relativeTime:function(e){let t=new Date(e);if(Number.isNaN(t.getTime()))return"N/A";let r=Math.floor(Math.max(0,Date.now()-t.getTime())/6e4);if(r<1)return"just now";if(r<60)return`${r} min ago`;let i=Math.floor(r/60);if(i<24)return`${i} hour${1===i?"":"s"} ago`;let n=Math.floor(i/24);return`${n} day${1===n?"":"s"} ago`}(e.occurredAt),loggedAt:function(e){let t=new Date(e);if(Number.isNaN(t.getTime()))return"Unknown";let r=new Intl.DateTimeFormat("en-US",{month:"short",day:"2-digit",year:"numeric"}).format(t),i=new Intl.DateTimeFormat("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}).format(t);return`${r} ${i}`}(e.occurredAt),module:e.module||"System",performedBy:e.performedBy||"system@gmail.com",sensitivity:y(e.sensitivity),sourceIp:t.sourceIp||"unknown",requestPath:t.requestPath||"unknown",requestMethod:t.requestMethod||"unknown",userAgent:r,browser:i,operatingSystem:n,deviceType:s,deviceSummary:a,recordRef:function(e){let t=v(e?.metadata);for(let e of[t.recordRef,t.recordId,t.employeeId,t.workflowId,t.templateId,t.exportId]){let t=w(e);if(t)return t}return"N/A"}(e),auditNote:w(t.auditNote,`Change logged under ${e.module||"System"} module and included in HRIS compliance trail.`),nextAction:w(t.nextAction,"Failed"===e.status||"Pending"===e.status||"Rejected"===e.status?"Review and resolve with assigned owner.":"No further action required."),changedFields:o,viewedFields:l,accessedDocuments:u,metadata:t}}async function C(){return t||(t=(async()=>{await i.promises.mkdir(l,{recursive:!0});try{await i.promises.access(u)}catch{let e=d().map(e=>JSON.stringify(e)).join("\n");await i.promises.writeFile(u,`${e}
`,"utf8")}})()),t}async function D(){await C();let e=await i.promises.readFile(u,"utf8").catch(()=>"");return e.trim()?e.split("\n").map(e=>e.trim()).filter(Boolean).map(p).filter(Boolean):[]}async function x(e){try{return await C(),await i.promises.appendFile(u,`${JSON.stringify(e)}
`,"utf8"),e}catch{return null}}async function N(e){let t=f();if((await (0,s.getDocs)((0,s.query)((0,s.collection)(e,t),(0,s.limit)(1)))).empty)for(let r of d())await (0,s.addDoc)((0,s.collection)(e,t),r)}async function F(e,t){let r=f();await N(e);let i=Math.min(Math.max(Number(t)||0,1),2500);return(await (0,s.getDocs)((0,s.query)((0,s.collection)(e,r),(0,s.orderBy)("occurredAt","desc"),(0,s.limit)(i)))).docs.map(e=>{let t=e.data();return{...t,id:t?.id||e.id}}).filter(e=>e?.occurredAt)}async function O(e,t){let r=f();return await (0,s.addDoc)((0,s.collection)(e,r),t),t}async function R({activityName:e,status:t="Completed",module:r="System",performedBy:i="system@gmail.com",sensitivity:n="Non-sensitive",metadata:s={},occurredAt:a,request:o}){let l,u={id:h(),activityName:e||"HRIS Action",status:g(t),occurredAt:c(a),module:r,performedBy:i,sensitivity:y(n),metadata:{...s,...function(e){if(!e)return{};let t=e.headers.get("x-forwarded-for"),r=t?t.split(",")[0]?.trim():e.headers.get("x-real-ip")||"unknown",i=e.headers.get("user-agent")||"unknown",n=_(i),s=b(i),{deviceType:a,deviceSummary:o}=S(i,n,s);return{requestMethod:e.method||"GET",requestPath:e.nextUrl?.pathname||"unknown",sourceIp:r||"unknown",userAgent:i,browser:n,operatingSystem:s,deviceType:a,deviceSummary:o}}(o)}},d=await m();if(d)try{return l=await O(d,u),I(l||u),l}catch{}return I((l=await x(u))||u),l}async function P({limit:e=400}={}){let t=await m();if(t)try{return(await F(t,e)).map(k)}catch{return(await D().catch(()=>[])).filter(e=>e?.occurredAt).sort((e,t)=>new Date(t.occurredAt).getTime()-new Date(e.occurredAt).getTime()).slice(0,Math.min(Math.max(Number(e)||0,1),2500)).map(k)}return(await D().catch(()=>[])).filter(e=>e?.occurredAt).sort((e,t)=>new Date(t.occurredAt).getTime()-new Date(e.occurredAt).getTime()).slice(0,Math.min(Math.max(Number(e)||0,1),2500)).map(k)}e.s(["listAuditEvents",()=>P,"recordAuditEvent",()=>R])}];

//# sourceMappingURL=_b26786c3._.js.map