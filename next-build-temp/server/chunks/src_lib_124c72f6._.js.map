{"version":3,"sources":["../../../src/lib/name-utils.js","../../../src/lib/invite-delivery.js","../../../src/lib/security-alert-delivery.js"],"sourcesContent":["function normalizeNamePart(value) {\r\n  return String(value ?? \"\").trim();\r\n}\r\n\r\nfunction capitalizeWord(word) {\r\n  const value = normalizeNamePart(word).toLowerCase();\r\n  if (!value) {\r\n    return \"\";\r\n  }\r\n  return `${value.charAt(0).toUpperCase()}${value.slice(1)}`;\r\n}\r\n\r\nexport function formatNameFromEmail(email, { fallbackLabel = \"User\", maxTokens = 3 } = {}) {\r\n  const normalizedEmail = normalizeNamePart(email).toLowerCase();\r\n  const safeFallback = normalizeNamePart(fallbackLabel) || \"User\";\r\n  if (!normalizedEmail.includes(\"@\")) {\r\n    return safeFallback;\r\n  }\r\n\r\n  const localPart = normalizedEmail.split(\"@\")[0] || \"\";\r\n  const tokens = localPart\r\n    .split(/[._-]+/g)\r\n    .map((item) => capitalizeWord(item))\r\n    .filter(Boolean)\r\n    .slice(0, Math.max(1, Number.isFinite(maxTokens) ? maxTokens : 3));\r\n\r\n  if (tokens.length === 0) {\r\n    return safeFallback;\r\n  }\r\n\r\n  return tokens.join(\" \");\r\n}\r\n\r\nfunction formatNameBody({ firstName, middleName, lastName, order }) {\r\n  const normalizedFirstName = normalizeNamePart(firstName);\r\n  const normalizedMiddleName = normalizeNamePart(middleName);\r\n  const normalizedLastName = normalizeNamePart(lastName);\r\n\r\n  if (order === \"last-first\") {\r\n    const firstBlock = [normalizedFirstName, normalizedMiddleName].filter(Boolean).join(\" \");\r\n    if (normalizedLastName) {\r\n      return `${normalizedLastName}${firstBlock ? `, ${firstBlock}` : \"\"}`;\r\n    }\r\n    return firstBlock;\r\n  }\r\n\r\n  return [normalizedFirstName, normalizedMiddleName, normalizedLastName].filter(Boolean).join(\" \");\r\n}\r\n\r\nfunction resolveFallbackName({ fallback, fallbackEmail, fallbackLabel }) {\r\n  const directFallback = normalizeNamePart(fallback);\r\n  if (directFallback) {\r\n    return directFallback;\r\n  }\r\n\r\n  const email = normalizeNamePart(fallbackEmail);\r\n  if (email) {\r\n    return formatNameFromEmail(email, { fallbackLabel });\r\n  }\r\n\r\n  return normalizeNamePart(fallbackLabel) || \"User\";\r\n}\r\n\r\nexport function formatPersonName({\r\n  firstName,\r\n  middleName,\r\n  lastName,\r\n  suffix,\r\n  fallback = \"\",\r\n  fallbackEmail = \"\",\r\n  fallbackLabel = \"User\",\r\n} = {}) {\r\n  const body = formatNameBody({\r\n    firstName,\r\n    middleName,\r\n    lastName,\r\n    order: \"first-last\",\r\n  });\r\n  const normalizedSuffix = normalizeNamePart(suffix);\r\n  const fullName = [body, normalizedSuffix].filter(Boolean).join(\" \").trim();\r\n  if (fullName) {\r\n    return fullName;\r\n  }\r\n\r\n  return resolveFallbackName({\r\n    fallback,\r\n    fallbackEmail,\r\n    fallbackLabel,\r\n  });\r\n}\r\n\r\nexport function formatEmployeeName({\r\n  firstName,\r\n  middleName,\r\n  lastName,\r\n  suffix,\r\n  fallback = \"\",\r\n  fallbackEmail = \"\",\r\n  fallbackLabel = \"Employee\",\r\n} = {}) {\r\n  const body = formatNameBody({\r\n    firstName,\r\n    middleName,\r\n    lastName,\r\n    order: \"last-first\",\r\n  });\r\n  const normalizedSuffix = normalizeNamePart(suffix);\r\n  const fullName = [body, normalizedSuffix].filter(Boolean).join(\" \").trim();\r\n  if (fullName) {\r\n    return fullName;\r\n  }\r\n\r\n  return resolveFallbackName({\r\n    fallback,\r\n    fallbackEmail,\r\n    fallbackLabel,\r\n  });\r\n}\r\n","function normalizeEmailProvider(rawValue) {\r\n  const raw = String(rawValue || \"\")\r\n    .trim()\r\n    .toLowerCase();\r\n  if (!raw) {\r\n    return \"\";\r\n  }\r\n\r\n  if (raw === \"firebase\" || raw.includes(\"firebase\")) {\r\n    return \"firebase\";\r\n  }\r\n\r\n  if (raw === \"resend\" || raw.includes(\"resend\")) {\r\n    return \"resend\";\r\n  }\r\n\r\n  if (raw === \"console\" || raw === \"dev\" || raw.includes(\"console\")) {\r\n    return \"console\";\r\n  }\r\n\r\n  return raw;\r\n}\r\n\r\nfunction getEmailProvider() {\r\n  const configured = normalizeEmailProvider(process.env.CLIO_EMAIL_PROVIDER);\r\n  if (configured) {\r\n    return configured;\r\n  }\r\n\r\n  const hasResendConfig =\r\n    String(process.env.RESEND_API_KEY || \"\").trim().startsWith(\"re_\") &&\r\n    String(process.env.CLIO_EMAIL_FROM || \"\").trim().length > 0;\r\n  if (hasResendConfig) {\r\n    return \"resend\";\r\n  }\r\n\r\n  return \"firebase\";\r\n}\r\n\r\nfunction isConsoleEmailAllowed() {\r\n  return String(process.env.CLIO_ALLOW_CONSOLE_EMAIL || \"\")\r\n    .trim()\r\n    .toLowerCase() === \"true\";\r\n}\r\n\r\nfunction normalizeBaseUrl(value) {\r\n  const raw = String(value || \"\").trim();\r\n  if (!raw) {\r\n    return \"\";\r\n  }\r\n\r\n  if (raw.startsWith(\"http://\") || raw.startsWith(\"https://\")) {\r\n    return raw.replace(/\\/+$/, \"\");\r\n  }\r\n\r\n  return `https://${raw.replace(/^\\/+/, \"\").replace(/\\/+$/, \"\")}`;\r\n}\r\n\r\nfunction assertSafeProductionBaseUrl(baseUrl) {\r\n  if (process.env.NODE_ENV !== \"production\") {\r\n    return;\r\n  }\r\n\r\n  let parsed;\r\n  try {\r\n    parsed = new URL(baseUrl);\r\n  } catch {\r\n    throw new Error(\"app_base_url_not_configured\");\r\n  }\r\n\r\n  const hostname = String(parsed.hostname || \"\").trim().toLowerCase();\r\n  const isLocalHost =\r\n    hostname === \"localhost\" ||\r\n    hostname === \"127.0.0.1\" ||\r\n    hostname === \"::1\" ||\r\n    hostname.endsWith(\".local\");\r\n\r\n  if (isLocalHost) {\r\n    throw new Error(\"unsafe_app_base_url_for_production\");\r\n  }\r\n}\r\n\r\nfunction getAppBaseUrl({ requestOrigin } = {}) {\r\n  const requestOriginUrl = normalizeBaseUrl(requestOrigin);\r\n  const firebaseAuthDomain = normalizeBaseUrl(\r\n    process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN || process.env.FIREBASE_AUTH_DOMAIN,\r\n  );\r\n  const vercelUrl = normalizeBaseUrl(\r\n    process.env.VERCEL_PROJECT_PRODUCTION_URL || process.env.VERCEL_URL,\r\n  );\r\n  const configured = normalizeBaseUrl(process.env.CLIO_APP_BASE_URL);\r\n  const publicSiteUrl = normalizeBaseUrl(process.env.NEXT_PUBLIC_APP_URL);\r\n\r\n  const candidates =\r\n    process.env.NODE_ENV === \"production\"\r\n      ? [requestOriginUrl, configured, publicSiteUrl, vercelUrl, firebaseAuthDomain]\r\n      : [requestOriginUrl, configured, publicSiteUrl, firebaseAuthDomain, vercelUrl];\r\n\r\n  for (const candidate of candidates) {\r\n    if (!candidate) {\r\n      continue;\r\n    }\r\n    assertSafeProductionBaseUrl(candidate);\r\n    return candidate;\r\n  }\r\n\r\n  throw new Error(\"app_base_url_not_configured\");\r\n}\r\n\r\nfunction getLoginPath() {\r\n  const configured = String(process.env.CLIO_LOGIN_PATH || \"\").trim();\r\n  if (!configured) {\r\n    return \"/login\";\r\n  }\r\n  return configured.startsWith(\"/\") ? configured : `/${configured}`;\r\n}\r\n\r\nfunction getInviteVerifyPath() {\r\n  const configured = String(process.env.CLIO_INVITE_VERIFY_PATH || \"\").trim();\r\n  if (!configured) {\r\n    return \"/verify-invite\";\r\n  }\r\n  return configured.startsWith(\"/\") ? configured : `/${configured}`;\r\n}\r\n\r\nfunction buildLoginUrl(baseUrl) {\r\n  return `${baseUrl}${getLoginPath()}`;\r\n}\r\n\r\nfunction buildInviteVerificationUrl(inviteToken, baseUrl) {\r\n  const path = getInviteVerifyPath();\r\n  const token = String(inviteToken || \"\").trim();\r\n  if (!token) {\r\n    throw new Error(\"invalid_invite_token\");\r\n  }\r\n  return `${baseUrl}${path}?token=${encodeURIComponent(token)}`;\r\n}\r\n\r\nfunction isDevelopmentPreviewEnabled() {\r\n  return process.env.NODE_ENV !== \"production\";\r\n}\r\n\r\nfunction escapeHtml(value) {\r\n  return String(value || \"\")\r\n    .replaceAll(\"&\", \"&amp;\")\r\n    .replaceAll(\"<\", \"&lt;\")\r\n    .replaceAll(\">\", \"&gt;\")\r\n    .replaceAll('\"', \"&quot;\")\r\n    .replaceAll(\"'\", \"&#39;\");\r\n}\r\n\r\nfunction buildEmailContent({ role, invitedBy, verifyUrl, loginUrl, expiresAt }) {\r\n  const expirationDate = new Date(expiresAt);\r\n  const readableExpiration = Number.isNaN(expirationDate.getTime())\r\n    ? expiresAt\r\n    : expirationDate.toLocaleString(\"en-US\", {\r\n        month: \"short\",\r\n        day: \"2-digit\",\r\n        year: \"numeric\",\r\n        hour: \"2-digit\",\r\n        minute: \"2-digit\",\r\n      });\r\n\r\n  const roleText = String(role || \"Employee\").trim() || \"Employee\";\r\n  const invitedByText = String(invitedBy || \"CLIO Administrator\").trim() || \"CLIO Administrator\";\r\n  const brandDomain = String(process.env.CLIO_EMAIL_BRAND_DOMAIN || \"cisoasaservice.io\").trim() || \"cisoasaservice.io\";\r\n  const safeRole = escapeHtml(roleText);\r\n  const safeInvitedBy = escapeHtml(invitedByText);\r\n  const safeVerifyUrl = escapeHtml(verifyUrl);\r\n  const safeLoginUrl = escapeHtml(loginUrl);\r\n  const safeReadableExpiration = escapeHtml(readableExpiration);\r\n  const safeBrandDomain = escapeHtml(brandDomain);\r\n\r\n  const subject = \"You're invited to verify your email and open your Clio account\";\r\n  const text = [\r\n    \"You have been invited to Clio Secured HRIS.\",\r\n    \"\",\r\n    \"To open your account, please verify your email first.\",\r\n    `Verify your Clio account: ${verifyUrl}`,\r\n    `Sign in after verification: ${loginUrl}`,\r\n    \"\",\r\n    `Assigned role: ${roleText}`,\r\n    `Invited by: ${invitedByText}`,\r\n    `Invitation expires: ${readableExpiration}`,\r\n    \"\",\r\n    \"For security, complete SMS OTP after email verification.\",\r\n    \"Use the same invited work email when signing in.\",\r\n    \"\",\r\n    `Domain: ${brandDomain}`,\r\n  ].join(\"\\n\");\r\n\r\n  return {\r\n    subject,\r\n    text,\r\n    html: [\r\n      \"<div style=\\\"font-family:Arial,sans-serif;line-height:1.6;color:#0f172a;max-width:620px\\\">\",\r\n      \"<p style=\\\"margin:0 0 12px 0\\\">Hello,</p>\",\r\n      \"<p style=\\\"margin:0 0 12px 0\\\">You have been invited to <strong>Clio Secured HRIS</strong>.</p>\",\r\n      \"<p style=\\\"margin:0 0 16px 0\\\">To open your account, please verify your email and complete secure onboarding.</p>\",\r\n      `<p style=\"margin:0 0 16px 0\"><a href=\"${safeVerifyUrl}\" style=\"display:inline-block;background:#0f6bcf;color:#ffffff;text-decoration:none;padding:10px 18px;border-radius:10px;font-weight:600\">Verify Clio Account</a></p>`,\r\n      `<p style=\"margin:0 0 12px 0\"><strong>Assigned role:</strong> ${safeRole}<br/>`,\r\n      `<strong>Invited by:</strong> ${safeInvitedBy}<br/>`,\r\n      `<strong>Invitation expires:</strong> ${safeReadableExpiration}</p>`,\r\n      `<p style=\"margin:0 0 12px 0\">After verification, sign in here: <a href=\"${safeLoginUrl}\">${safeLoginUrl}</a></p>`,\r\n      `<p style=\"margin:0 0 12px 0\">For security, complete SMS OTP after email verification and use the same invited work email.</p>`,\r\n      `<p style=\"margin:0;color:#475569;font-size:12px\">This invitation is intended for authorized recipients of ${safeBrandDomain}.</p>`,\r\n      \"</div>\",\r\n    ].join(\"\"),\r\n  };\r\n}\r\n\r\nfunction parseFirebaseAuthError(payload) {\r\n  const code = String(payload?.error?.message || \"\").trim();\r\n  if (!code) {\r\n    return \"email_delivery_failed\";\r\n  }\r\n  if (code === \"OPERATION_NOT_ALLOWED\") {\r\n    return \"firebase_email_provider_not_enabled\";\r\n  }\r\n  if (code === \"MISSING_CONTINUE_URI\" || code === \"INVALID_CONTINUE_URI\") {\r\n    return \"firebase_continue_url_invalid\";\r\n  }\r\n  if (code === \"INVALID_EMAIL\") {\r\n    return \"invalid_email\";\r\n  }\r\n  if (code === \"PROJECT_NOT_FOUND\" || code === \"API_KEY_INVALID\") {\r\n    return \"firebase_api_key_not_configured\";\r\n  }\r\n  return \"email_delivery_failed\";\r\n}\r\n\r\nasync function sendViaFirebaseAuth({ toEmail, verifyUrl }) {\r\n  const apiKey = String(process.env.NEXT_PUBLIC_FIREBASE_API_KEY || \"\").trim();\r\n  if (!apiKey) {\r\n    throw new Error(\"firebase_api_key_not_configured\");\r\n  }\r\n\r\n  const response = await fetch(`https://identitytoolkit.googleapis.com/v1/accounts:sendOobCode?key=${apiKey}`, {\r\n    method: \"POST\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n    },\r\n    body: JSON.stringify({\r\n      requestType: \"EMAIL_SIGNIN\",\r\n      email: toEmail,\r\n      continueUrl: verifyUrl,\r\n      canHandleCodeInApp: true,\r\n    }),\r\n  });\r\n\r\n  const payload = await response.json().catch(() => ({}));\r\n  if (!response.ok) {\r\n    throw new Error(parseFirebaseAuthError(payload));\r\n  }\r\n\r\n  return {\r\n    provider: \"firebase\",\r\n    status: \"sent\",\r\n    messageId: `firebase-${Date.now()}`,\r\n  };\r\n}\r\n\r\nasync function sendViaResend({ toEmail, subject, html, text }) {\r\n  const apiKey = String(process.env.RESEND_API_KEY || \"\").trim();\r\n  const fromAddress = String(process.env.CLIO_EMAIL_FROM || \"\").trim();\r\n  if (!apiKey || !fromAddress || !apiKey.startsWith(\"re_\")) {\r\n    throw new Error(\"email_provider_not_configured\");\r\n  }\r\n\r\n  const response = await fetch(\"https://api.resend.com/emails\", {\r\n    method: \"POST\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Authorization: `Bearer ${apiKey}`,\r\n    },\r\n    body: JSON.stringify({\r\n      from: fromAddress,\r\n      to: [toEmail],\r\n      subject,\r\n      html,\r\n      text,\r\n    }),\r\n  });\r\n\r\n  if (!response.ok) {\r\n    const payload = await response.json().catch(() => ({}));\r\n    const providerMessage =\r\n      typeof payload?.message === \"string\"\r\n        ? payload.message\r\n        : typeof payload?.error?.message === \"string\"\r\n          ? payload.error.message\r\n          : \"\";\r\n    throw new Error(\r\n      providerMessage ? `email_delivery_failed:${providerMessage}` : \"email_delivery_failed\",\r\n    );\r\n  }\r\n\r\n  const payload = await response.json().catch(() => ({}));\r\n  return {\r\n    provider: \"resend\",\r\n    status: \"sent\",\r\n    messageId: typeof payload?.id === \"string\" ? payload.id : `resend-${Date.now()}`,\r\n  };\r\n}\r\n\r\nfunction sendViaConsole({ toEmail, subject, verifyUrl, loginUrl }) {\r\n  const messageId = `console-${Date.now()}`;\r\n  if (isDevelopmentPreviewEnabled()) {\r\n    console.info(\"[CLIO:InviteEmail]\", {\r\n      toEmail,\r\n      subject,\r\n      verifyUrl,\r\n      loginUrl,\r\n      messageId,\r\n    });\r\n  }\r\n\r\n  return {\r\n    provider: \"console\",\r\n    status: \"simulated\",\r\n    messageId,\r\n    previewUrl: verifyUrl,\r\n    loginUrl,\r\n  };\r\n}\r\n\r\nexport async function deliverInviteEmail({\r\n  toEmail,\r\n  role,\r\n  invitedBy,\r\n  expiresAt,\r\n  inviteToken,\r\n  requestOrigin = \"\",\r\n}) {\r\n  const baseUrl = getAppBaseUrl({ requestOrigin });\r\n  const verifyUrl = buildInviteVerificationUrl(inviteToken, baseUrl);\r\n  const loginUrl = buildLoginUrl(baseUrl);\r\n  const content = buildEmailContent({\r\n    role,\r\n    invitedBy,\r\n    verifyUrl,\r\n    loginUrl,\r\n    expiresAt,\r\n  });\r\n  const provider = getEmailProvider();\r\n\r\n  if (provider === \"firebase\") {\r\n    return await sendViaFirebaseAuth({\r\n      toEmail,\r\n      verifyUrl,\r\n    });\r\n  }\r\n\r\n  if (provider === \"resend\") {\r\n    return await sendViaResend({\r\n      toEmail,\r\n      subject: content.subject,\r\n      html: content.html,\r\n      text: content.text,\r\n    });\r\n  }\r\n\r\n  if (provider === \"console\") {\r\n    if (!isConsoleEmailAllowed()) {\r\n      throw new Error(\"email_provider_not_configured\");\r\n    }\r\n\r\n    return sendViaConsole({\r\n      toEmail,\r\n      subject: content.subject,\r\n      verifyUrl,\r\n      loginUrl,\r\n    });\r\n  }\r\n\r\n  throw new Error(\"unsupported_email_provider\");\r\n}\r\n","const RESEND_API_BASE = \"https://api.resend.com\";\r\nconst TWILIO_API_BASE = \"https://api.twilio.com/2010-04-01\";\r\n\r\nfunction asString(value, fallback = \"\") {\r\n  const normalized = String(value || \"\").trim();\r\n  return normalized || fallback;\r\n}\r\n\r\nfunction asArray(value) {\r\n  return Array.isArray(value) ? value : [];\r\n}\r\n\r\nfunction parseBooleanEnv(name, fallbackValue = false) {\r\n  const raw = asString(process.env[name]).toLowerCase();\r\n  if (!raw) {\r\n    return fallbackValue;\r\n  }\r\n  return raw === \"true\" || raw === \"1\" || raw === \"yes\";\r\n}\r\n\r\nfunction normalizeEmail(value) {\r\n  return asString(value).toLowerCase();\r\n}\r\n\r\nfunction normalizePhone(value) {\r\n  return String(value || \"\").replace(/[^\\d+]/g, \"\").trim();\r\n}\r\n\r\nfunction parseCsvList(value) {\r\n  return asString(value)\r\n    .split(\",\")\r\n    .map((item) => item.trim())\r\n    .filter(Boolean);\r\n}\r\n\r\nfunction dedupe(values = []) {\r\n  return Array.from(new Set(values.filter(Boolean)));\r\n}\r\n\r\nfunction normalizeEmailProvider(value) {\r\n  const normalized = asString(value).toLowerCase();\r\n  if (!normalized) {\r\n    return \"\";\r\n  }\r\n  if (normalized.includes(\"resend\")) return \"resend\";\r\n  if (normalized.includes(\"firebase\")) return \"firebase\";\r\n  if (normalized.includes(\"console\") || normalized === \"dev\") return \"console\";\r\n  if (normalized === \"none\" || normalized === \"off\") return \"none\";\r\n  return normalized;\r\n}\r\n\r\nfunction normalizeSmsProvider(value) {\r\n  const normalized = asString(value).toLowerCase();\r\n  if (!normalized) {\r\n    return \"\";\r\n  }\r\n  if (normalized.includes(\"twilio\")) return \"twilio\";\r\n  if (normalized.includes(\"console\") || normalized === \"dev\") return \"console\";\r\n  if (normalized === \"none\" || normalized === \"off\") return \"none\";\r\n  return normalized;\r\n}\r\n\r\nfunction resolveAlertEmailProvider() {\r\n  const configured = normalizeEmailProvider(process.env.CLIO_ALERT_EMAIL_PROVIDER);\r\n  if (configured) {\r\n    return configured;\r\n  }\r\n  if (process.env.NODE_ENV === \"production\") {\r\n    return \"none\";\r\n  }\r\n  const hasResend = asString(process.env.RESEND_API_KEY).startsWith(\"re_\") && asString(process.env.CLIO_EMAIL_FROM);\r\n  return hasResend ? \"resend\" : \"console\";\r\n}\r\n\r\nfunction resolveAlertSmsProvider() {\r\n  const configured = normalizeSmsProvider(process.env.CLIO_ALERT_SMS_PROVIDER);\r\n  if (configured) {\r\n    return configured;\r\n  }\r\n  return \"none\";\r\n}\r\n\r\nfunction resolveSecurityAlertRecipients(explicitRecipients = []) {\r\n  const fromEnv = [\r\n    ...parseCsvList(process.env.CLIO_SECURITY_ALERT_RECIPIENTS),\r\n    ...parseCsvList(process.env.GRC_EMAILS),\r\n    ...parseCsvList(process.env.SUPER_ADMIN_EMAILS),\r\n  ];\r\n  return dedupe(\r\n    [...fromEnv, ...asArray(explicitRecipients)]\r\n      .map((value) => normalizeEmail(value))\r\n      .filter(Boolean),\r\n  );\r\n}\r\n\r\nfunction resolveSmsRecipients(explicitRecipients = []) {\r\n  const fromEnv = parseCsvList(process.env.CLIO_SMS_ALERT_RECIPIENTS);\r\n  return dedupe([...fromEnv, ...asArray(explicitRecipients)].map((value) => normalizePhone(value)).filter(Boolean));\r\n}\r\n\r\nfunction buildIncidentAlertSubject({ incident, detection }) {\r\n  const severity = asString(incident?.severity || detection?.severity || \"Medium\").toUpperCase();\r\n  const incidentCode = asString(incident?.incidentCode, \"INCIDENT\");\r\n  const title = asString(incident?.title, \"Security anomaly detected\");\r\n  return `[CLIO][${severity}] ${incidentCode} - ${title}`;\r\n}\r\n\r\nfunction buildIncidentAlertText({ incident, detection, sourceEvent }) {\r\n  const ruleId = asString(detection?.ruleId, \"N/A\");\r\n  const sourceIp = asString(sourceEvent?.metadata?.sourceIp || sourceEvent?.sourceIp, \"unknown\");\r\n  const actor = asString(sourceEvent?.performedBy, \"unknown\");\r\n  const requestPath = asString(sourceEvent?.metadata?.requestPath || sourceEvent?.requestPath, \"unknown\");\r\n  const observedCount = Number(detection?.observedCount || 0);\r\n  const detectedAt = asString(incident?.detectedAt || sourceEvent?.occurredAt, new Date().toISOString());\r\n  return [\r\n    \"CLIO security anomaly alert\",\r\n    `Incident: ${asString(incident?.incidentCode, \"-\")} | ${asString(incident?.title, \"-\")}`,\r\n    `Severity: ${asString(incident?.severity, \"-\")}`,\r\n    `Rule: ${ruleId}`,\r\n    `Detected At: ${detectedAt}`,\r\n    `Actor: ${actor}`,\r\n    `Source IP: ${sourceIp}`,\r\n    `Request Path: ${requestPath}`,\r\n    `Observed Count: ${observedCount > 0 ? observedCount : \"-\"}`,\r\n    `Summary: ${asString(incident?.summary || detection?.summary, \"-\")}`,\r\n    `Action URL: ${asString(incident?.actionUrl, \"/incident-management\")}`,\r\n  ].join(\"\\n\");\r\n}\r\n\r\nfunction buildIncidentAlertHtml(text) {\r\n  const escaped = String(text || \"\")\r\n    .replaceAll(\"&\", \"&amp;\")\r\n    .replaceAll(\"<\", \"&lt;\")\r\n    .replaceAll(\">\", \"&gt;\");\r\n  return `<pre style=\"font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; white-space:pre-wrap;\">${escaped}</pre>`;\r\n}\r\n\r\nasync function sendEmailViaResend({ recipients, subject, text, html }) {\r\n  const apiKey = asString(process.env.RESEND_API_KEY);\r\n  const fromAddress = asString(process.env.CLIO_EMAIL_FROM);\r\n  if (!apiKey || !fromAddress || !apiKey.startsWith(\"re_\")) {\r\n    throw new Error(\"email_provider_not_configured\");\r\n  }\r\n\r\n  const response = await fetch(`${RESEND_API_BASE}/emails`, {\r\n    method: \"POST\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      Authorization: `Bearer ${apiKey}`,\r\n    },\r\n    body: JSON.stringify({\r\n      from: fromAddress,\r\n      to: recipients,\r\n      subject,\r\n      text,\r\n      html,\r\n    }),\r\n  });\r\n\r\n  const payload = await response.json().catch(() => ({}));\r\n  if (!response.ok) {\r\n    const message =\r\n      asString(payload?.message) ||\r\n      asString(payload?.error?.message) ||\r\n      \"email_delivery_failed\";\r\n    throw new Error(`email_delivery_failed:${message}`);\r\n  }\r\n\r\n  return {\r\n    provider: \"resend\",\r\n    status: \"sent\",\r\n    messageId: asString(payload?.id, `resend-${Date.now()}`),\r\n    recipientCount: recipients.length,\r\n  };\r\n}\r\n\r\nfunction sendEmailViaConsole({ recipients, subject, text }) {\r\n  if (parseBooleanEnv(\"CLIO_ALLOW_CONSOLE_EMAIL\", true) || process.env.NODE_ENV !== \"production\") {\r\n    console.info(\"[CLIO:SecurityAlert:Email]\", {\r\n      recipients,\r\n      subject,\r\n      text,\r\n    });\r\n  }\r\n  return {\r\n    provider: \"console\",\r\n    status: \"simulated\",\r\n    recipientCount: recipients.length,\r\n  };\r\n}\r\n\r\nasync function dispatchEmailAlerts({ recipients, subject, text, html }) {\r\n  const safeRecipients = dedupe(asArray(recipients).map(normalizeEmail).filter(Boolean));\r\n  if (safeRecipients.length === 0) {\r\n    return {\r\n      provider: \"none\",\r\n      status: \"skipped\",\r\n      reason: \"no_recipients\",\r\n      recipientCount: 0,\r\n    };\r\n  }\r\n\r\n  const provider = resolveAlertEmailProvider();\r\n  if (provider === \"none\") {\r\n    return {\r\n      provider,\r\n      status: \"skipped\",\r\n      reason: \"provider_disabled\",\r\n      recipientCount: 0,\r\n    };\r\n  }\r\n  if (provider === \"firebase\") {\r\n    return {\r\n      provider,\r\n      status: \"skipped\",\r\n      reason: \"firebase_not_supported_for_custom_alert_email\",\r\n      recipientCount: 0,\r\n    };\r\n  }\r\n  if (provider === \"console\") {\r\n    return sendEmailViaConsole({\r\n      recipients: safeRecipients,\r\n      subject,\r\n      text,\r\n    });\r\n  }\r\n  if (provider === \"resend\") {\r\n    return await sendEmailViaResend({\r\n      recipients: safeRecipients,\r\n      subject,\r\n      text,\r\n      html,\r\n    });\r\n  }\r\n\r\n  return {\r\n    provider,\r\n    status: \"skipped\",\r\n    reason: \"unsupported_provider\",\r\n    recipientCount: 0,\r\n  };\r\n}\r\n\r\nasync function sendSmsViaTwilio({ recipients, body }) {\r\n  const accountSid = asString(process.env.TWILIO_ACCOUNT_SID);\r\n  const authToken = asString(process.env.TWILIO_AUTH_TOKEN);\r\n  const fromNumber = asString(process.env.TWILIO_FROM_NUMBER);\r\n  if (!accountSid || !authToken || !fromNumber) {\r\n    throw new Error(\"twilio_not_configured\");\r\n  }\r\n\r\n  const authHeader = Buffer.from(`${accountSid}:${authToken}`, \"utf8\").toString(\"base64\");\r\n  const requests = recipients.map(async (to) => {\r\n    const form = new URLSearchParams();\r\n    form.set(\"To\", to);\r\n    form.set(\"From\", fromNumber);\r\n    form.set(\"Body\", body);\r\n    const response = await fetch(`${TWILIO_API_BASE}/Accounts/${encodeURIComponent(accountSid)}/Messages.json`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        Authorization: `Basic ${authHeader}`,\r\n        \"Content-Type\": \"application/x-www-form-urlencoded\",\r\n      },\r\n      body: form.toString(),\r\n    });\r\n    const payload = await response.json().catch(() => ({}));\r\n    if (!response.ok) {\r\n      const message = asString(payload?.message, \"sms_delivery_failed\");\r\n      throw new Error(`twilio_delivery_failed:${message}`);\r\n    }\r\n    return {\r\n      to,\r\n      sid: asString(payload?.sid),\r\n    };\r\n  });\r\n\r\n  const settled = await Promise.allSettled(requests);\r\n  const delivered = settled\r\n    .filter((item) => item.status === \"fulfilled\")\r\n    .map((item) => item.value);\r\n  const failed = settled\r\n    .filter((item) => item.status === \"rejected\")\r\n    .map((item) => asString(item.reason?.message || \"sms_delivery_failed\"));\r\n\r\n  return {\r\n    provider: \"twilio\",\r\n    status: failed.length > 0 ? (delivered.length > 0 ? \"partial\" : \"failed\") : \"sent\",\r\n    deliveredCount: delivered.length,\r\n    recipientCount: recipients.length,\r\n    delivered,\r\n    failed,\r\n  };\r\n}\r\n\r\nfunction sendSmsViaConsole({ recipients, body }) {\r\n  if (process.env.NODE_ENV !== \"production\") {\r\n    console.info(\"[CLIO:SecurityAlert:SMS]\", {\r\n      recipients,\r\n      body,\r\n    });\r\n  }\r\n  return {\r\n    provider: \"console\",\r\n    status: \"simulated\",\r\n    deliveredCount: recipients.length,\r\n    recipientCount: recipients.length,\r\n    delivered: recipients.map((to) => ({ to, sid: `console-${Date.now()}` })),\r\n    failed: [],\r\n  };\r\n}\r\n\r\nasync function dispatchSmsAlerts({ recipients, body }) {\r\n  const safeRecipients = dedupe(asArray(recipients).map(normalizePhone).filter(Boolean));\r\n  if (safeRecipients.length === 0) {\r\n    return {\r\n      provider: \"none\",\r\n      status: \"skipped\",\r\n      reason: \"no_recipients\",\r\n      deliveredCount: 0,\r\n      recipientCount: 0,\r\n      failed: [],\r\n    };\r\n  }\r\n\r\n  const provider = resolveAlertSmsProvider();\r\n  if (provider === \"none\") {\r\n    return {\r\n      provider,\r\n      status: \"skipped\",\r\n      reason: \"provider_disabled\",\r\n      deliveredCount: 0,\r\n      recipientCount: safeRecipients.length,\r\n      failed: [],\r\n    };\r\n  }\r\n  if (provider === \"console\") {\r\n    return sendSmsViaConsole({\r\n      recipients: safeRecipients,\r\n      body,\r\n    });\r\n  }\r\n  if (provider === \"twilio\") {\r\n    return await sendSmsViaTwilio({\r\n      recipients: safeRecipients,\r\n      body,\r\n    });\r\n  }\r\n\r\n  return {\r\n    provider,\r\n    status: \"skipped\",\r\n    reason: \"unsupported_provider\",\r\n    deliveredCount: 0,\r\n    recipientCount: safeRecipients.length,\r\n    failed: [],\r\n  };\r\n}\r\n\r\nfunction getConfiguredWebhookTargets() {\r\n  const generic = parseCsvList(process.env.CLIO_SECURITY_WEBHOOK_URLS).map((url) => ({\r\n    label: \"security-webhook\",\r\n    url,\r\n    token: asString(process.env.CLIO_SECURITY_WEBHOOK_TOKEN),\r\n  }));\r\n  const siemUrl = asString(process.env.CLIO_SIEM_WEBHOOK_URL);\r\n  const edrUrl = asString(process.env.CLIO_EDR_WEBHOOK_URL);\r\n  const targets = [...generic];\r\n  if (siemUrl) {\r\n    targets.push({\r\n      label: \"siem\",\r\n      url: siemUrl,\r\n      token: asString(process.env.CLIO_SIEM_WEBHOOK_TOKEN),\r\n    });\r\n  }\r\n  if (edrUrl) {\r\n    targets.push({\r\n      label: \"edr\",\r\n      url: edrUrl,\r\n      token: asString(process.env.CLIO_EDR_WEBHOOK_TOKEN),\r\n    });\r\n  }\r\n  return targets.filter((target) => asString(target.url));\r\n}\r\n\r\nasync function postWebhook({ url, label, token, payload, timeoutMs }) {\r\n  const controller = new AbortController();\r\n  const timer = setTimeout(() => controller.abort(), timeoutMs);\r\n  try {\r\n    const headers = {\r\n      \"Content-Type\": \"application/json\",\r\n      \"X-CLIO-Source\": \"security-detection\",\r\n      \"X-CLIO-Target\": label,\r\n    };\r\n    if (token) {\r\n      headers.Authorization = `Bearer ${token}`;\r\n    }\r\n    const response = await fetch(url, {\r\n      method: \"POST\",\r\n      headers,\r\n      body: JSON.stringify(payload),\r\n      signal: controller.signal,\r\n    });\r\n    const body = await response.text().catch(() => \"\");\r\n    return {\r\n      label,\r\n      url,\r\n      ok: response.ok,\r\n      status: response.status,\r\n      body: asString(body),\r\n    };\r\n  } catch (error) {\r\n    return {\r\n      label,\r\n      url,\r\n      ok: false,\r\n      status: 0,\r\n      body: asString(error?.message, \"webhook_delivery_failed\"),\r\n    };\r\n  } finally {\r\n    clearTimeout(timer);\r\n  }\r\n}\r\n\r\nasync function dispatchWebhooks(payload) {\r\n  const targets = getConfiguredWebhookTargets();\r\n  if (targets.length === 0) {\r\n    return {\r\n      status: \"skipped\",\r\n      targets: [],\r\n      successCount: 0,\r\n    };\r\n  }\r\n\r\n  const timeoutMs = Number.parseInt(asString(process.env.CLIO_SECURITY_WEBHOOK_TIMEOUT_MS, \"5000\"), 10) || 5000;\r\n  const results = await Promise.all(\r\n    targets.map((target) =>\r\n      postWebhook({\r\n        ...target,\r\n        payload,\r\n        timeoutMs: Math.max(1000, Math.min(20000, timeoutMs)),\r\n      }),\r\n    ),\r\n  );\r\n  const successCount = results.filter((item) => item.ok).length;\r\n  return {\r\n    status: successCount === results.length ? \"sent\" : successCount > 0 ? \"partial\" : \"failed\",\r\n    targets: results,\r\n    successCount,\r\n  };\r\n}\r\n\r\nexport async function dispatchSecurityIncidentAlerts({\r\n  incident,\r\n  detection,\r\n  sourceEvent,\r\n  emailRecipients = [],\r\n  smsRecipients = [],\r\n} = {}) {\r\n  const recipients = resolveSecurityAlertRecipients(emailRecipients);\r\n  const smsTargets = resolveSmsRecipients(smsRecipients);\r\n  const subject = buildIncidentAlertSubject({ incident, detection });\r\n  const text = buildIncidentAlertText({ incident, detection, sourceEvent });\r\n  const html = buildIncidentAlertHtml(text);\r\n\r\n  const [emailResult, smsResult, webhookResult] = await Promise.all([\r\n    dispatchEmailAlerts({\r\n      recipients,\r\n      subject,\r\n      text,\r\n      html,\r\n    }).catch((error) => ({\r\n      provider: resolveAlertEmailProvider(),\r\n      status: \"failed\",\r\n      reason: asString(error?.message, \"email_delivery_failed\"),\r\n      recipientCount: recipients.length,\r\n    })),\r\n    dispatchSmsAlerts({\r\n      recipients: smsTargets,\r\n      body: `${subject}\\n${text}`.slice(0, 1200),\r\n    }).catch((error) => ({\r\n      provider: resolveAlertSmsProvider(),\r\n      status: \"failed\",\r\n      reason: asString(error?.message, \"sms_delivery_failed\"),\r\n      deliveredCount: 0,\r\n      recipientCount: smsTargets.length,\r\n      failed: [asString(error?.message, \"sms_delivery_failed\")],\r\n    })),\r\n    dispatchWebhooks({\r\n      eventType: \"clio.security.incident\",\r\n      generatedAt: new Date().toISOString(),\r\n      incident,\r\n      detection,\r\n      sourceEvent: {\r\n        id: asString(sourceEvent?.id),\r\n        module: asString(sourceEvent?.module),\r\n        activityName: asString(sourceEvent?.activityName),\r\n        status: asString(sourceEvent?.status),\r\n        occurredAt: asString(sourceEvent?.occurredAt),\r\n        sourceIp: asString(sourceEvent?.metadata?.sourceIp || sourceEvent?.sourceIp),\r\n        requestPath: asString(sourceEvent?.metadata?.requestPath || sourceEvent?.requestPath),\r\n      },\r\n    }),\r\n  ]);\r\n\r\n  return {\r\n    subject,\r\n    email: emailResult,\r\n    sms: smsResult,\r\n    webhooks: webhookResult,\r\n    recipients,\r\n    smsRecipients: smsTargets,\r\n  };\r\n}\r\n\r\nexport function resolveSecurityAlertEmailRecipients(explicitRecipients = []) {\r\n  return resolveSecurityAlertRecipients(explicitRecipients);\r\n}\r\n\r\nexport async function dispatchDirectSms({ recipients = [], body = \"\" } = {}) {\r\n  return await dispatchSmsAlerts({\r\n    recipients,\r\n    body: asString(body, \"\"),\r\n  });\r\n}\r\n"],"names":[],"mappings":"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"}