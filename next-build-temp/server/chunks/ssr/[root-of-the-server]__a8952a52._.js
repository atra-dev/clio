module.exports=[66680,(a,b,c)=>{b.exports=a.x("node:crypto",()=>require("node:crypto"))},2157,(a,b,c)=>{b.exports=a.x("node:fs",()=>require("node:fs"))},50227,(a,b,c)=>{b.exports=a.x("node:path",()=>require("node:path"))},54799,(a,b,c)=>{b.exports=a.x("crypto",()=>require("crypto"))},83982,a=>{"use strict";a.s(["MODULE_ACCESS",0,{SUPER_ADMIN:["dashboard","activity-log","user-management","settings"],GRC:["dashboard","employees","employment-lifecycle","attendance","performance","documents","activity-log","exports","user-management","retention-archive","incident-management","settings"],HR:["dashboard","employees","employment-lifecycle","attendance","performance","documents","exports","settings"],EA:["dashboard","employees","employment-lifecycle","attendance","performance","documents","exports","settings"],EMPLOYEE_L1:["dashboard","employees","attendance","performance","documents","settings"],EMPLOYEE_L2:["dashboard","employees","attendance","performance","documents","settings"],EMPLOYEE_L3:["dashboard","employees","attendance","performance","documents","settings"]},"ROLES",0,[{id:"SUPER_ADMIN",label:"Super Admin",description:"Full system access and administrative control"},{id:"GRC",label:"GRC",description:"Governance, Risk, and Compliance oversight"},{id:"HR",label:"HR",description:"Human Resources operations and employee lifecycle"},{id:"EA",label:"EA",description:"Executive assistance and department coordination"},{id:"EMPLOYEE_L1",label:"Employee (L1)",description:"Can access and update limited personal profile details"},{id:"EMPLOYEE_L2",label:"Employee (L2)",description:"Can access and update limited personal profile details"},{id:"EMPLOYEE_L3",label:"Employee (L3)",description:"Can access and update limited personal profile details"}]])},94606,a=>{"use strict";a.i(70396);var b=a.i(73727),c=a.i(16116),d=a.i(20948),e=a.i(83982);let f={SUPER_ADMIN:["*"],GRC:["dashboard:view","employees:view","employees:edit","employees:view:sensitive","lifecycle:view","lifecycle:edit","lifecycle:approve","attendance:view","attendance:edit","attendance:approve","performance:view","performance:edit","performance:approve","templates:view","templates:edit","exports:view","exports:manage","exports:approve","exports:request","activity_log:export","activity_log:view","audit:view","access_management:view","retention_archive:view","retention_archive:manage","incident_management:view","incident_management:edit","user_management:view","user_management:manage","settings:view","audit:write:nonsensitive","auth:logout","resource:own"],HR:["dashboard:view","employees:view","employees:edit","employees:view:sensitive","lifecycle:view","lifecycle:edit","lifecycle:approve","attendance:view","attendance:edit","attendance:approve","performance:view","performance:edit","performance:approve","templates:view","templates:edit","exports:view","exports:manage","exports:approve","exports:request","activity_log:export","settings:view","audit:write:nonsensitive","auth:logout","resource:own"],EA:["dashboard:view","employees:view","employees:edit","employees:view:sensitive","lifecycle:view","lifecycle:edit","lifecycle:approve","attendance:view","attendance:edit","attendance:approve","performance:view","performance:edit","performance:approve","templates:view","templates:edit","exports:view","exports:manage","exports:approve","exports:request","activity_log:export","settings:view","audit:write:nonsensitive","auth:logout","resource:own"],EMPLOYEE_L1:["dashboard:view","employees:view","employees:edit:self","attendance:view","attendance:edit:self","performance:view","templates:view","requests:view","requests:create:self","exports:request:self","settings:view","audit:write:nonsensitive","auth:logout","resource:own"],EMPLOYEE_L2:["dashboard:view","employees:view","employees:edit:self","attendance:view","attendance:edit:self","performance:view","templates:view","requests:view","requests:create:self","exports:request:self","settings:view","audit:write:nonsensitive","auth:logout","resource:own"],EMPLOYEE_L3:["dashboard:view","employees:view","employees:edit:self","attendance:view","attendance:edit:self","performance:view","templates:view","requests:view","requests:create:self","exports:request:self","settings:view","audit:write:nonsensitive","auth:logout","resource:own"]},g={dashboard:"dashboard:view",employees:"employees:view","employment-lifecycle":"lifecycle:view",attendance:"attendance:view",performance:"performance:view","activity-log":"activity_log:view",exports:"exports:view",documents:"templates:view","access-management":"access_management:view","retention-archive":"retention_archive:view","incident-management":"incident_management:view",requests:"requests:view",settings:"settings:view","user-management":"user_management:view"};var h=a.i(2252),i=a.i(64368),j=a.i(39748);async function k(){let a=await (0,c.getServerSession)();a||(0,b.redirect)("/login");let e={...a,role:(0,d.normalizeRole)(a.role)},f=await (0,j.getLoginAccount)(e.email).catch(()=>null),g=(0,d.normalizeRole)(f?.role),k=Number.parseInt(String(f?.sessionVersion??""),10)||1,l="SUPER_ADMIN"===g,m=e.role!==g,n=e.sessionVersion!==k;f&&"active"===f.status&&!n&&(!m||l)||(await (0,h.recordAuditEvent)({activityName:"Server session rejected",status:"Rejected",module:"Authorization",performedBy:e.email||"anonymous@gmail.com",sensitivity:"Sensitive",metadata:{reason:f?"active"!==f.status?"account_not_active":n?"session_version_mismatch":"session_role_mismatch":"account_not_found",accountStatus:f?.status||null,tokenRole:e.role,accountRole:g||null,tokenSessionVersion:e.sessionVersion,accountSessionVersion:k||null}}).catch(()=>null),(0,b.redirect)("/login"));let o=String(f?.firstName||"").trim(),p=String(f?.middleName||"").trim(),q=String(f?.lastName||"").trim();return{...e,firstName:o,middleName:p,lastName:q,displayName:(0,i.formatPersonName)({firstName:o,middleName:p,lastName:q,fallbackEmail:e.email,fallbackLabel:"Clio User"}),profilePhotoDataUrl:"string"==typeof f?.profilePhotoDataUrl?f.profilePhotoDataUrl:"",profilePhotoStoragePath:"string"==typeof f?.profilePhotoStoragePath?f.profilePhotoStoragePath:""}}async function l(a){let c=await k();return!function(a,b){let c,h=(0,d.normalizeRole)(a);if(!new Set(e.MODULE_ACCESS[h]??[]).has(b))return!1;let i=g[b];return!i||(c=f[(0,d.normalizeRole)(h)]??[]).includes("*")||c.includes(i)}(c.role,a)&&(await (0,h.recordAuditEvent)({activityName:`Blocked module access: ${a}`,status:"Rejected",module:"Authorization",performedBy:c.email,sensitivity:"Sensitive",metadata:{attemptedModule:a,role:c.role,reason:"module_permission_denied"}}),(0,b.redirect)("/unauthorized")),c}a.s(["requireAuthenticatedSession",()=>k,"requireModuleAccess",()=>l],94606)},49176,a=>{"use strict";a.s(["default",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/components/hris/HrisShell.jsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/hris/HrisShell.jsx <module evaluation>","default")},25293,a=>{"use strict";a.s(["default",()=>b]);let b=(0,a.i(11857).registerClientReference)(function(){throw Error("Attempted to call the default export of [project]/src/components/hris/HrisShell.jsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/components/hris/HrisShell.jsx","default")},20561,a=>{"use strict";a.i(49176);var b=a.i(25293);a.n(b)},44807,a=>{"use strict";var b=a.i(7997),c=a.i(20561),d=a.i(94606);async function e({children:a}){let e=await (0,d.requireAuthenticatedSession)();return(0,b.jsx)(c.default,{session:e,children:a})}a.s(["default",()=>e])},42273,a=>{a.v(b=>Promise.all(["server/chunks/ssr/src_lib_security-detection_fc1cf3d7.js"].map(b=>a.l(b))).then(()=>b(36725)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__a8952a52._.js.map