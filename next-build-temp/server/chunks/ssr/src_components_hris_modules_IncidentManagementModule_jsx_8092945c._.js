module.exports=[4956,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(44036),e=a.i(63824),f=a.i(3427),g=a.i(98719),h=a.i(95312);a.i(68248);var i=a.i(63609),j=a.i(74404);let k=["Low","High"],l=["Open","Containment","Investigating","Escalated","Regulatory Review","Resolved","Closed"],m=["Not Started","In Progress","Contained"],n=["Pending","In Progress","Completed"],o=["Security","Compliance","HR","IT Operations","Unauthorized Access","Data Exposure","Credential Compromise","Insider Misuse","Malware / Ransomware","Policy Violation","System Misconfiguration","Other"],p=["Not Required","Pending","Notified","Overdue"],q={q:"",status:"all",severity:"all",incidentType:"all",regulatoryStatus:"all",restrictedPii:"all",breachConfirmed:"all",department:"all",dateFrom:"",dateTo:"",page:1,pageSize:12},r={title:"",summary:"",incidentType:"Unauthorized Access",severity:"Low",detectedAt:"",ownerEmail:"",affectedEmployeeEmail:"",department:"",involvedEmployees:"",restrictedPiiInvolved:!1,executiveNotificationRequired:!1,regulatoryNotificationRequired:!1,documentationLocation:"",notes:"",classificationStandard:"CLIO-IR-SEVERITY-V1"};function s(a){let b=new Date(a||"");return Number.isNaN(b.getTime())?"-":new Intl.DateTimeFormat("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(b)}function t(a){let b=new Date(a||Date.now());if(Number.isNaN(b.getTime()))return"";let c=b.getFullYear(),d=String(b.getMonth()+1).padStart(2,"0"),e=String(b.getDate()).padStart(2,"0"),f=String(b.getHours()).padStart(2,"0"),g=String(b.getMinutes()).padStart(2,"0");return`${c}-${d}-${e}T${f}:${g}`}function u(a){let b=String(a||"").trim();if(!b)return"";let c=new Date(b);return Number.isNaN(c.getTime())?"":c.toISOString()}function v(){return new Date().toISOString()}function w(a,b="Low"){let c=String(a||"").trim().toLowerCase();return"high"===c||"critical"===c?"High":"low"===c||"medium"===c?"Low":b}function x(a){return String(a?.title||"").trim()||String(a?.incidentCode||"").trim()||"Incident"}function y({session:a}){let y=(0,g.useToast)(),z=(0,h.useConfirm)(),A=String(a?.role||"").trim().toUpperCase(),B="GRC"===A||"SUPER_ADMIN"===A,[C,D]=(0,c.useState)("incident-dashboard"),[E,F]=(0,c.useState)(q),[G,H]=(0,c.useState)([]),[I,J]=(0,c.useState)({total:0,openCases:0,criticalOpen:0,containmentPending:0,dueWithin72Hours:0,overdue72HourNotifications:0}),[K,L]=(0,c.useState)({page:1,pageSize:12,total:0,totalPages:1}),[M,N]=(0,c.useState)(!0),[O,P]=(0,c.useState)(!1),[Q,R]=(0,c.useState)(!1),[S,T]=(0,c.useState)({...r,ownerEmail:String(a?.email||"").trim().toLowerCase()}),[U,V]=(0,c.useState)(""),[W,X]=(0,c.useState)(null),[Y,Z]=(0,c.useState)(null),[$,_]=(0,c.useState)(!1),[aa,ab]=(0,c.useState)(!1),[ac,ad]=(0,c.useState)(!1),[ae,af]=(0,c.useState)([]),ag=(0,c.useRef)(null),ah=(0,c.useRef)(null),ai=(0,c.useCallback)(async()=>{N(!0);try{let a=await i.hrisApi.incidents.list(E),b=Array.isArray(a?.records)?a.records:[];b.sort((a,b)=>new Date(b?.updatedAt||b?.createdAt||0).getTime()-new Date(a?.updatedAt||a?.createdAt||0).getTime()),H(b),J(a?.summary||{}),L(a?.pagination||{page:1,pageSize:12,total:0,totalPages:1})}catch(a){H([]),y.error(a.message||"Unable to load incident records.")}finally{N(!1)}},[E,y]),aj=(0,c.useCallback)(async a=>{let b=String(a||"").trim();if(b){_(!0);try{let a=await i.hrisApi.incidents.get(b),c=a?.record||null;X(c),Z(c?{title:String(c?.title||""),summary:String(c?.summary||""),incidentType:String(c?.incidentType||"Other"),severity:w(c?.severity,"Low"),status:String(c?.status||"Open"),containmentStatus:String(c?.containmentStatus||"Not Started"),containmentSummary:String(c?.containmentSummary||""),impactAssessmentStatus:String(c?.impactAssessmentStatus||"Pending"),impactSummary:String(c?.impactSummary||""),ownerEmail:String(c?.ownerEmail||""),affectedEmployeeEmail:String(c?.affectedEmployeeEmail||""),department:String(c?.department||""),involvedEmployees:Array.isArray(c?.involvedEmployees)?c.involvedEmployees.join(", "):String(c?.involvedEmployees||""),restrictedPiiInvolved:!!c?.restrictedPiiInvolved,executiveNotificationRequired:!!c?.executiveNotificationRequired,regulatoryNotificationRequired:!!c?.regulatoryNotificationRequired,documentationRetained:!!c?.documentationRetained,documentationLocation:String(c?.documentationLocation||""),notes:String(c?.notes||""),classificationStandard:String(c?.classificationStandard||"CLIO-IR-SEVERITY-V1"),forensicWindowStart:t(c?.forensicWindowStart),forensicWindowEnd:t(c?.forensicWindowEnd),breachConfirmed:!!c?.breachConfirmed,breachConfirmedAt:String(c?.breachConfirmedAt||""),breachConfirmedBy:String(c?.breachConfirmedBy||""),correctiveActions:String(c?.correctiveActions||""),disciplinaryActions:String(c?.disciplinaryActions||""),resolutionNotes:String(c?.resolutionNotes||""),closureApprovalStatus:String(c?.closureApprovalStatus||"Pending Approval"),closureApprovedAt:String(c?.closureApprovedAt||""),closureApprovedBy:String(c?.closureApprovedBy||"")}:null)}catch(a){y.error(a.message||"Unable to load incident details.")}finally{_(!1)}}},[y]);(0,c.useEffect)(()=>{ai()},[ai]),(0,c.useEffect)(()=>{U&&aj(U)},[U,aj]),(0,c.useEffect)(()=>{},[]);let ak=(a,b)=>{F(c=>({...c,[a]:b,page:1}))},al=()=>{T({...r,ownerEmail:String(a?.email||"").trim().toLowerCase(),detectedAt:t(v())}),af([]),P(!0)},am=(0,c.useCallback)(async(a,b)=>{if(B&&U){ab(!0);try{await i.hrisApi.incidents.update(U,a),await aj(U),await ai(),b&&y.success(b)}catch(a){y.error(a.message||"Unable to update incident.")}finally{ab(!1)}}},[B,U,aj,ai,y]),an=async b=>{if(b.preventDefault(),B){if(!String(S.title||"").trim())return void y.error("Incident title is required.");R(!0);try{let b={...S,detectedAt:u(S.detectedAt)||v(),ownerEmail:String(S.ownerEmail||"").trim().toLowerCase(),affectedEmployeeEmail:String(S.affectedEmployeeEmail||"").trim().toLowerCase(),department:String(S.department||"").trim(),involvedEmployees:String(S.involvedEmployees||"").split(",").map(a=>a.trim()).filter(Boolean)},c=await i.hrisApi.incidents.create(b);if(y.success("Incident record created."),P(!1),await ai(),c?.record?.id&&V(c.record.id),c?.record?.id&&ae.length>0){let d=c.record.id,e=String(b.affectedEmployeeEmail||"").trim().toLowerCase(),f=[];for(let b of ae){let c=await (0,j.uploadIncidentEvidenceToStorage)({file:b,incidentRecordId:d,affectedEmployeeEmail:e});f.push({id:`${Date.now()}-${Math.random().toString(36).slice(2,7)}`,name:b.name||"Incident Evidence",type:"Incident Evidence",ref:c.downloadUrl,storagePath:c.storagePath,contentType:c.contentType||b.type||"",fileExtension:String(b.name||"").split(".").pop()||"",sizeBytes:c.sizeBytes,uploadedAt:v(),uploadedBy:String(a?.email||"").trim().toLowerCase()})}f.length>0&&await i.hrisApi.incidents.update(d,{evidenceDocuments:f,documentationRetained:!0})}}catch(a){y.error(a.message||"Unable to create incident.")}finally{R(!1)}}},ao=async()=>{B&&Y&&await am({...Y,ownerEmail:String(Y.ownerEmail||"").trim().toLowerCase(),affectedEmployeeEmail:String(Y.affectedEmployeeEmail||"").trim().toLowerCase(),forensicWindowStart:u(Y.forensicWindowStart),forensicWindowEnd:u(Y.forensicWindowEnd),involvedEmployees:String(Y.involvedEmployees||"").split(",").map(a=>a.trim()).filter(Boolean)},"Incident workflow updated.")},ap=async(a,b,c={})=>{await am({[a]:v(),...c},b)},aq=async b=>{B&&U&&(!b||await z({title:"Confirm Breach",message:"Mark this incident as a confirmed breach?",confirmText:"Confirm Breach",tone:"danger"}))&&await am({breachConfirmed:b,breachConfirmedAt:b?v():"",breachConfirmedBy:b?String(a?.email||"").trim().toLowerCase():""},b?"Breach confirmation recorded.":"Breach confirmation cleared.")},ar=async b=>{let c=b.target.files?.[0];if(b.target.value="",c&&W&&B){ad(!0);try{let b=await (0,j.uploadIncidentEvidenceToStorage)({file:c,incidentRecordId:W.id,affectedEmployeeEmail:W.affectedEmployeeEmail}),d=[...Array.isArray(W.evidenceDocuments)?W.evidenceDocuments:[],{id:`${Date.now()}-${Math.random().toString(36).slice(2,7)}`,name:c.name||"Incident Evidence",type:"Incident Evidence",ref:b.downloadUrl,storagePath:b.storagePath,contentType:b.contentType||c.type||"",fileExtension:String(c.name||"").split(".").pop()||"",sizeBytes:b.sizeBytes,uploadedAt:v(),uploadedBy:String(a?.email||"").trim().toLowerCase()}];await am({evidenceDocuments:d,documentationRetained:!0},"Incident evidence uploaded.")}catch(a){y.error(a.message||"Unable to upload evidence.")}finally{ad(!1)}}},as=async a=>{if(!W||!B||!await z({title:"Remove Evidence",message:`Remove evidence "${String(a?.name||"file")}"?`,confirmText:"Remove",tone:"danger"}))return;let b=(Array.isArray(W.evidenceDocuments)?W.evidenceDocuments:[]).filter(b=>String(b?.id||"").trim()!==String(a?.id||"").trim());await am({evidenceDocuments:b},"Evidence removed."),a?.storagePath&&await (0,j.removeStorageObjectByPath)(a.storagePath)},at=(0,c.useMemo)(()=>G,[G]),au=(0,c.useMemo)(()=>"yes"===E.breachConfirmed?at.filter(a=>!!a?.breachConfirmed):"no"===E.breachConfirmed?at.filter(a=>!a?.breachConfirmed):at,[at,E.breachConfirmed]),av=(0,c.useMemo)(()=>{let a=au,b=String(E.department||"").trim().toLowerCase();b&&"all"!==b&&(a=a.filter(a=>String(a?.department||"").trim().toLowerCase()===b));let c=E.dateFrom?new Date(E.dateFrom):null,d=E.dateTo?new Date(E.dateTo):null;if(c&&!Number.isNaN(c.getTime())&&(a=a.filter(a=>new Date(a?.detectedAt||a?.createdAt||"").getTime()>=c.getTime())),d&&!Number.isNaN(d.getTime())){let b=new Date(d);b.setHours(23,59,59,999),a=a.filter(a=>new Date(a?.detectedAt||a?.createdAt||"").getTime()<=b.getTime())}return a},[au,E.department,E.dateFrom,E.dateTo]),aw=(0,c.useMemo)(()=>[{key:"total",label:"Total Incidents",value:I.total||0},{key:"open",label:"Open Cases",value:I.openCases||0},{key:"critical",label:"Critical Open",value:I.criticalOpen||0},{key:"containment",label:"Containment Pending",value:I.containmentPending||0}],[I]),ax=0===K.total?0:(K.page-1)*K.pageSize+1,ay=Math.min(K.total||0,K.page*K.pageSize),az=Array.isArray(W?.evidenceDocuments)?W.evidenceDocuments:[],aA=(0,c.useMemo)(()=>{if(!W?.forensicSnapshot)return null;let a=W.forensicSnapshot;for(let b of[a.accessLogs,a.exportLogs,a.administrativeActions,a.deletionActivities])if(Array.isArray(b)&&b.length>0)return b[0];return null},[W]),aB=(0,c.useMemo)(()=>{let a=aA||{},b=a.requestMethod&&a.requestPath?`${a.requestMethod} ${a.requestPath}`:a.requestPath||"",c=a.employeeEmail||a.targetEmployeeEmail||W?.affectedEmployeeEmail||"",d=a.resourceLabel||a.recordRef||"",e=Array.isArray(a.viewedFields)?a.viewedFields:[],f=e.length>0?`${e.slice(0,8).join(", ")}${e.length>8?"â€¦":""}`:"",g=Array.isArray(a.accessedDocuments)?a.accessedDocuments:[],h=g.length>0?g.map(a=>String(a?.name||a?.ref||a?.id||"").trim()).filter(Boolean).slice(0,6).join(", "):"";return[{label:"Alert Description",value:W?.alertDescription||W?.summary||"-"},{label:"Occurrences",value:Number(W?.alertOccurrenceCount||1)},{label:"Performed By",value:a.performedBy||W?.ownerEmail||"-"},{label:"Activity",value:a.activityName||W?.incidentType||"-"},{label:"Module",value:a.module||"-"},{label:"Request",value:b||"-"},{label:"Employee Email",value:c||"-"},{label:"Employee Record",value:d||"-"},{label:"Viewed Fields",value:f||(a.viewedFieldCount?`${a.viewedFieldCount} fields`:"-")},{label:"Documents Accessed",value:h||(a.accessedDocumentCount?`${a.accessedDocumentCount} document(s)`:"-")},{label:"Source IP",value:a.sourceIp||"-"},{label:"Device",value:a.device||"-"},{label:"User Agent",value:a.userAgent||"-"},{label:"Occurred At",value:s(a.occurredAt)}]},[aA,W]),aC=(0,c.useMemo)(()=>{let a={Open:0,"In Progress":0,Resolved:0,Closed:0};return G.forEach(b=>{let c=String(b?.status||"").trim();if("Containment"===c||"Investigating"===c||"Escalated"===c||"Regulatory Review"===c){a["In Progress"]+=1;return}if("Resolved"===c){a.Resolved+=1;return}if("Closed"===c){a.Closed+=1;return}a.Open+=1}),a},[G]),aD=(0,c.useMemo)(()=>{let a={Low:0,High:0};return G.forEach(b=>{let c=w(b?.severity,"Low");a[c]+=1}),a},[G]),aE=(0,c.useMemo)(()=>[...G].sort((a,b)=>new Date(b?.updatedAt||b?.createdAt||0).getTime()-new Date(a?.updatedAt||a?.createdAt||0).getTime()).slice(0,6),[G]),aF=(0,c.useMemo)(()=>{let a={};return G.forEach(b=>{let c=String(b?.incidentType||"Other").trim()||"Other";a[c]=(a[c]||0)+1}),Object.entries(a).sort((a,b)=>b[1]-a[1])},[G]),aG=(0,c.useMemo)(()=>{let a=aF.reduce((a,[,b])=>a+Number(b||0),0),b=["#0ea5e9","#14b8a6","#f97316","#6366f1","#ef4444","#a855f7","#22c55e","#06b6d4"],c=0,d=aF.map(([d,e],f)=>{let g=Number(e||0),h=a>0?g/a:0,i=c;return c+=h,{label:d,value:g,percentage:a>0?Math.round(100*h):0,color:b[f%b.length],fromDeg:(360*i).toFixed(2),toDeg:(360*c).toFixed(2)}}),e=d.length?`conic-gradient(${d.map(a=>`${a.color} ${a.fromDeg}deg ${a.toDeg}deg`).join(", ")})`:"";return{total:a,segments:d,gradient:e,dominant:d[0]||null}},[aF]),aH=(0,c.useMemo)(()=>{let a=Number(aD.Low||0),b=Number(aD.High||0),c=Math.max(a,b,1);return[{label:"Low",meta:"Lower impact incidents",value:a,color:"bg-sky-500"},{label:"High",meta:"High-impact incidents",value:b,color:"bg-rose-500"}].map(a=>({...a,width:`${Math.round(a.value/c*100)}%`}))},[aD]),aI=(0,c.useMemo)(()=>{let a=0,b=0,c=0,d=0;G.forEach(e=>{let f=e?.alertDispatchSummary;if(!f||"object"!=typeof f)return;a+=1;let g=f?.email&&"object"==typeof f.email?f.email:{};(Math.max(0,Number(g?.recipientCount||0))>0||String(g?.status||"").trim())&&(b+=1);let h=f?.sms&&"object"==typeof f.sms?f.sms:{},i=Math.max(0,Number(h?.deliveredCount||0));(Math.max(0,Number(h?.recipientCount||0))>0||i>0||String(h?.status||"").trim())&&(c+=1);let j=f?.webhooks&&"object"==typeof f.webhooks?f.webhooks:{};((Array.isArray(j?.targets)?j.targets.length:0)>0||Number(j?.successCount||0)>0||String(j?.status||"").trim())&&(d+=1)});let e=G.length,f=Math.max(0,e-a),g=Math.max(a,f,1),h=Math.max(b,c,d,1);return{totalIncidents:e,incidentsWithDispatch:a,incidentsWithoutDispatch:f,coverageBars:[{label:"With Dispatch",value:a,color:"bg-emerald-500",width:`${Math.round(a/g*100)}%`},{label:"Without Dispatch",value:f,color:"bg-slate-400",width:`${Math.round(f/g*100)}%`}],channelBars:[{label:"Email",value:b,color:"bg-sky-500",width:`${Math.round(b/h*100)}%`},{label:"SMS",value:c,color:"bg-indigo-500",width:`${Math.round(c/h*100)}%`},{label:"Webhook",value:d,color:"bg-violet-500",width:`${Math.round(d/h*100)}%`}]}},[G]);return(0,b.jsxs)("div",{className:"space-y-4",children:["incident-dashboard"===C?(0,b.jsx)(d.default,{title:"Incident Dashboard",subtitle:"Overview of active and historical incidents",children:(0,b.jsx)("div",{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-4",children:aw.map(a=>(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500",children:a.label}),(0,b.jsx)("p",{className:"mt-0.5 text-lg font-semibold text-slate-900",children:a.value})]},a.key))})}):null,"incident-dashboard"===C?(0,b.jsxs)("div",{className:"grid gap-3 lg:grid-cols-2",children:[(0,b.jsx)(d.default,{title:"Status Summary",subtitle:"Open, in progress, resolved, and closed",children:(0,b.jsx)("div",{className:"grid gap-2 sm:grid-cols-2",children:Object.entries(aC).map(([a,c])=>(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500",children:a}),(0,b.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:c})]},a))})}),(0,b.jsx)(d.default,{title:"Severity Distribution",subtitle:"Incident mix by severity (High / Low)",children:(0,b.jsx)("div",{className:"grid gap-2 sm:grid-cols-2",children:[{label:"Low",value:aD.Low,tone:"border-sky-200 bg-sky-50/50 text-sky-700"},{label:"High",value:aD.High,tone:"border-rose-200 bg-rose-50/50 text-rose-700"}].map(a=>(0,b.jsxs)("div",{className:`rounded-lg border px-3 py-2 ${a.tone}`,children:[(0,b.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em]",children:a.label}),(0,b.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:a.value})]},a.label))})})]}):null,"incident-dashboard"===C?(0,b.jsx)(d.default,{title:"Recent Activity",subtitle:"Latest incident updates",children:0===aE.length?(0,b.jsx)(e.default,{title:"No incidents yet",subtitle:"Once incidents are logged, they will appear here."}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full text-left text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-slate-200 text-xs uppercase tracking-[0.1em] text-slate-500",children:[(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Incident"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Status"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Severity"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Updated"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium text-right",children:"Action"})]})}),(0,b.jsx)("tbody",{children:aE.map(a=>(0,b.jsxs)("tr",{className:"border-b border-slate-100 text-slate-700 last:border-b-0",children:[(0,b.jsxs)("td",{className:"px-2 py-3",children:[(0,b.jsx)("p",{className:"font-medium text-slate-900",children:x(a)}),(0,b.jsx)("p",{className:"text-xs text-slate-500",children:String(a?.incidentCode||"N/A")}),(0,b.jsx)("p",{className:"mt-1 text-xs text-slate-600",children:String(a?.alertDescription||a?.summary||"No description provided.")}),(0,b.jsxs)("p",{className:"mt-1 text-xs font-medium text-sky-700",children:["Occurrences: ",Number(a?.alertOccurrenceCount||1)]})]}),(0,b.jsx)("td",{className:"px-2 py-3",children:(0,b.jsx)(f.default,{value:a?.status||"Open"})}),(0,b.jsx)("td",{className:"px-2 py-3",children:(0,b.jsx)(f.default,{value:w(a?.severity,"Low")})}),(0,b.jsx)("td",{className:"px-2 py-3 text-xs text-slate-600",children:s(a?.updatedAt||a?.createdAt)}),(0,b.jsx)("td",{className:"px-2 py-3 text-right",children:(0,b.jsx)("button",{type:"button",onClick:()=>V(a.id),className:"inline-flex h-8 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-medium text-slate-700 transition hover:bg-slate-50",children:"Open"})})]},a.id))})]})})}):null,"report-incident"===C?(0,b.jsx)(d.default,{title:"Report Incident / Create Case",subtitle:"Log a new incident, assign severity, and attach evidence.",action:B?(0,b.jsx)("button",{type:"button",onClick:al,className:"inline-flex h-9 items-center rounded-lg bg-sky-600 px-4 text-xs font-semibold text-white transition hover:bg-sky-700",children:"Open Full Form"}):null,children:(0,b.jsxs)("form",{className:"space-y-3",onSubmit:an,children:[(0,b.jsxs)("div",{className:"grid gap-2 md:grid-cols-2",children:[(0,b.jsx)("input",{required:!0,value:S.title,onChange:a=>T(b=>({...b,title:a.target.value})),placeholder:"Incident title",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none md:col-span-2"}),(0,b.jsx)("select",{value:S.incidentType,onChange:a=>T(b=>({...b,incidentType:a.target.value})),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:o.map(a=>(0,b.jsx)("option",{value:a,children:a},`inline-type-${a}`))}),(0,b.jsx)("select",{value:S.severity,onChange:a=>T(b=>({...b,severity:a.target.value})),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:k.map(a=>(0,b.jsx)("option",{value:a,children:a},`inline-sev-${a}`))}),(0,b.jsx)("input",{type:"datetime-local",value:S.detectedAt,onChange:a=>T(b=>({...b,detectedAt:a.target.value})),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,b.jsx)("input",{value:S.department,onChange:a=>T(b=>({...b,department:a.target.value})),placeholder:"Department (optional)",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,b.jsx)("input",{value:S.affectedEmployeeEmail,onChange:a=>T(b=>({...b,affectedEmployeeEmail:a.target.value})),placeholder:"Involved employee email",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,b.jsx)("input",{value:S.involvedEmployees,onChange:a=>T(b=>({...b,involvedEmployees:a.target.value})),placeholder:"Additional involved employees (comma separated)",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none md:col-span-2"}),(0,b.jsx)("textarea",{value:S.summary,onChange:a=>T(b=>({...b,summary:a.target.value})),placeholder:"Incident description",rows:3,className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none md:col-span-2"})]}),(0,b.jsxs)("div",{className:"grid gap-2 sm:grid-cols-2",children:[(0,b.jsxs)("label",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:S.restrictedPiiInvolved,onChange:a=>T(b=>({...b,restrictedPiiInvolved:a.target.checked})),className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),(0,b.jsx)("span",{className:"text-xs text-slate-700",children:"Restricted PII involved"})]}),(0,b.jsxs)("label",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:S.regulatoryNotificationRequired,onChange:a=>T(b=>({...b,regulatoryNotificationRequired:a.target.checked})),className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),(0,b.jsx)("span",{className:"text-xs text-slate-700",children:"Regulatory notification required"})]})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-dashed border-slate-200 bg-white p-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs font-semibold text-slate-900",children:"Attachments"}),(0,b.jsx)("p",{className:"text-[11px] text-slate-500",children:"Upload initial evidence (optional)."})]}),(0,b.jsx)("button",{type:"button",onClick:()=>ah.current?.click(),className:"inline-flex h-8 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-semibold text-slate-700 transition hover:bg-slate-50",children:"Add Files"})]}),(0,b.jsx)("input",{ref:ah,type:"file",className:"hidden",multiple:!0,onChange:a=>{let b=Array.from(a.target.files||[]);a.target.value="",0!==b.length&&af(a=>[...a,...b])}}),ae.length>0?(0,b.jsx)("ul",{className:"mt-2 space-y-1 text-xs text-slate-600",children:ae.map((a,c)=>(0,b.jsxs)("li",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{children:a.name}),(0,b.jsx)("button",{type:"button",onClick:()=>af(a=>a.filter((a,b)=>b!==c)),className:"text-rose-500",children:"Remove"})]},`${a.name}-${c}`))}):(0,b.jsx)("p",{className:"mt-2 text-xs text-slate-500",children:"No files attached."})]}),(0,b.jsx)("div",{className:"flex items-center justify-end gap-2",children:(0,b.jsx)("button",{type:"submit",disabled:!B||Q,className:"inline-flex h-9 items-center rounded-lg bg-sky-600 px-4 text-xs font-semibold text-white transition hover:bg-sky-700 disabled:opacity-60",children:Q?"Submitting...":"Submit Incident"})})]})}):null,"incident-list"===C?(0,b.jsxs)(d.default,{title:"Incident List / Case Management",subtitle:"Track cases, assign handling, and monitor status updates.",action:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[B?(0,b.jsx)("button",{type:"button",onClick:al,className:"inline-flex h-9 items-center rounded-lg bg-sky-600 px-4 text-xs font-semibold text-white transition hover:bg-sky-700",children:"Create Incident"}):null,(0,b.jsx)("button",{type:"button",onClick:ai,disabled:M,className:"inline-flex h-9 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60",children:"Refresh"})]}),children:[(0,b.jsxs)("div",{className:"grid gap-2 md:grid-cols-3 lg:grid-cols-6",children:[(0,b.jsx)("input",{value:E.q,onChange:a=>ak("q",a.target.value),placeholder:"Search incident",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 placeholder:text-slate-400 focus:border-sky-400 focus:outline-none md:col-span-2"}),(0,b.jsxs)("select",{value:E.status,onChange:a=>ak("status",a.target.value),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:[(0,b.jsx)("option",{value:"all",children:"All Status"}),l.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]}),(0,b.jsxs)("select",{value:E.severity,onChange:a=>ak("severity",a.target.value),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:[(0,b.jsx)("option",{value:"all",children:"All Severity"}),k.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]}),(0,b.jsxs)("select",{value:E.incidentType,onChange:a=>ak("incidentType",a.target.value),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:[(0,b.jsx)("option",{value:"all",children:"All Types"}),o.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]}),(0,b.jsxs)("select",{value:E.regulatoryStatus,onChange:a=>ak("regulatoryStatus",a.target.value),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:[(0,b.jsx)("option",{value:"all",children:"All Regulatory"}),p.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]}),(0,b.jsxs)("select",{value:E.restrictedPii,onChange:a=>ak("restrictedPii",a.target.value),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:[(0,b.jsx)("option",{value:"all",children:"PII: All"}),(0,b.jsx)("option",{value:"yes",children:"PII: Yes"}),(0,b.jsx)("option",{value:"no",children:"PII: No"})]}),(0,b.jsxs)("select",{value:E.breachConfirmed,onChange:a=>ak("breachConfirmed",a.target.value),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:[(0,b.jsx)("option",{value:"all",children:"Breach: All"}),(0,b.jsx)("option",{value:"yes",children:"Breach: Confirmed"}),(0,b.jsx)("option",{value:"no",children:"Breach: Not Confirmed"})]}),(0,b.jsx)("input",{value:E.department,onChange:a=>ak("department",a.target.value),placeholder:"Department",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,b.jsx)("input",{type:"date",value:E.dateFrom,onChange:a=>ak("dateFrom",a.target.value),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,b.jsx)("input",{type:"date",value:E.dateTo,onChange:a=>ak("dateTo",a.target.value),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"})]}),(0,b.jsx)("div",{className:"mt-4",children:M?(0,b.jsx)("div",{className:"flex justify-center py-6",children:(0,b.jsx)("span",{className:"inline-flex h-6 w-6 animate-spin rounded-full border-2 border-slate-300 border-t-sky-600","aria-hidden":"true"})}):0===av.length?(0,b.jsx)(e.default,{title:"No incident records found",subtitle:"Create incidents or adjust filters to continue."}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full text-left text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-slate-200 text-xs uppercase tracking-[0.1em] text-slate-500",children:[(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Incident"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Severity"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Status"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Escalation"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Regulatory"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Updated"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium text-right",children:"Action"})]})}),(0,b.jsx)("tbody",{children:av.map(a=>(0,b.jsxs)("tr",{className:"border-b border-slate-100 text-slate-700 last:border-b-0",children:[(0,b.jsxs)("td",{className:"px-2 py-3",children:[(0,b.jsx)("p",{className:"font-medium text-slate-900",children:x(a)}),(0,b.jsx)("p",{className:"text-xs text-slate-500",children:String(a?.incidentCode||"N/A")}),(0,b.jsx)("p",{className:"mt-1 max-w-[32rem] text-xs text-slate-600",children:String(a?.alertDescription||a?.summary||"No description provided.")}),(0,b.jsxs)("p",{className:"mt-1 text-xs font-medium text-sky-700",children:["Occurrences: ",Number(a?.alertOccurrenceCount||1)]})]}),(0,b.jsx)("td",{className:"px-2 py-3",children:(0,b.jsx)(f.default,{value:w(a?.severity,"Low")})}),(0,b.jsx)("td",{className:"px-2 py-3",children:(0,b.jsx)(f.default,{value:a?.status||"Open"})}),(0,b.jsxs)("td",{className:"px-2 py-3 text-xs",children:[(0,b.jsx)("p",{className:"font-medium text-slate-800",children:String(a?.escalationLevel||"-")}),(0,b.jsxs)("p",{className:"text-slate-500",children:["GRC: ",a?.grcAlertedAt?"Yes":"No"]})]}),(0,b.jsxs)("td",{className:"px-2 py-3 text-xs",children:[(0,b.jsx)("p",{className:"font-medium text-slate-800",children:String(a?.regulatoryStatus||"Not Required")}),(0,b.jsxs)("p",{className:"text-slate-500",children:["Due: ",s(a?.regulatoryDueAt)]})]}),(0,b.jsx)("td",{className:"px-2 py-3 text-xs text-slate-600",children:s(a?.updatedAt||a?.createdAt)}),(0,b.jsx)("td",{className:"px-2 py-3 text-right",children:(0,b.jsx)("button",{type:"button",onClick:()=>V(a.id),className:"inline-flex h-8 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-medium text-slate-700 transition hover:bg-slate-50",children:"Open"})})]},a.id))})]})})}),(0,b.jsxs)("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-600",children:[(0,b.jsxs)("p",{children:["Showing ",ax,"-",ay," of ",K.total||0," records"]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>F(a=>({...a,page:Math.max(1,a.page-1)})),disabled:1>=(K.page||1)||M,className:"inline-flex h-8 items-center rounded-lg border border-slate-300 bg-white px-3 font-medium text-slate-700 transition hover:bg-slate-100 disabled:opacity-60",children:"Previous"}),(0,b.jsxs)("span",{children:["Page ",K.page||1," of ",Math.max(1,K.totalPages||1)]}),(0,b.jsx)("button",{type:"button",onClick:()=>F(a=>({...a,page:Math.min(Math.max(1,K.totalPages||1),a.page+1)})),disabled:(K.page||1)>=(K.totalPages||1)||M,className:"inline-flex h-8 items-center rounded-lg border border-slate-300 bg-white px-3 font-medium text-slate-700 transition hover:bg-slate-100 disabled:opacity-60",children:"Next"})]})]})]}):null,"reports-analytics"===C?(0,b.jsxs)(d.default,{title:"Reports & Analytics",subtitle:"Incident trends and recurring issue severity",children:[(0,b.jsxs)("div",{className:"grid gap-3 lg:grid-cols-2",children:[(0,b.jsx)(d.default,{title:"Incident Trends",subtitle:"Pie chart by incident type",children:aG.total<=0?(0,b.jsx)(e.default,{title:"No data yet",subtitle:"Incident trends will appear after cases are logged."}):(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex flex-col items-center gap-3 sm:flex-row sm:items-start",children:[(0,b.jsx)("div",{className:"h-44 w-44 shrink-0 rounded-full border border-slate-200 shadow-[0_14px_34px_-28px_rgba(15,23,42,0.5)]",style:{backgroundImage:aG.gradient},"aria-label":"Incident trends pie chart"}),(0,b.jsx)("ul",{className:"w-full space-y-2 text-xs text-slate-600",children:aG.segments.map(a=>(0,b.jsxs)("li",{className:"flex items-center justify-between rounded-lg border border-slate-200 bg-white px-3 py-2",children:[(0,b.jsxs)("span",{className:"inline-flex items-center gap-2",children:[(0,b.jsx)("span",{className:"h-2.5 w-2.5 rounded-full",style:{backgroundColor:a.color}}),(0,b.jsx)("span",{children:a.label})]}),(0,b.jsxs)("span",{className:"font-semibold text-slate-900",children:[a.value," (",a.percentage,"%)"]})]},a.label))})]}),aG.dominant?(0,b.jsxs)("p",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-700",children:["Top incident type: ",(0,b.jsx)("span",{className:"font-semibold text-slate-900",children:aG.dominant.label})]}):null]})}),(0,b.jsx)(d.default,{title:"Recurring Issues",subtitle:"High vs low incident volume",children:(0,b.jsx)("div",{className:"space-y-3",children:aH.map(a=>(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-600",children:[(0,b.jsx)("span",{className:"font-semibold text-slate-800",children:a.label}),(0,b.jsx)("span",{children:a.value})]}),(0,b.jsx)("div",{className:"mt-2 h-2.5 overflow-hidden rounded-full bg-slate-100",children:(0,b.jsx)("div",{className:`h-full rounded-full ${a.color}`,style:{width:a.width}})}),(0,b.jsx)("p",{className:"mt-1 text-[11px] text-slate-500",children:a.meta})]},a.label))})})]}),(0,b.jsx)(d.default,{title:"Alert Dispatch Coverage",subtitle:"Dispatch readiness and channel usage",children:aI.totalIncidents<=0?(0,b.jsx)(e.default,{title:"No alert dispatch data",subtitle:"Coverage and channel charts appear after incidents are logged."}):(0,b.jsx)("div",{className:"space-y-3",children:(0,b.jsxs)("div",{className:"grid gap-3 lg:grid-cols-2",children:[(0,b.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white p-3",children:[(0,b.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.08em] text-slate-500",children:"Coverage"}),(0,b.jsx)("div",{className:"mt-2 space-y-2",children:aI.coverageBars.map(a=>(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-700",children:[(0,b.jsx)("span",{className:"font-semibold",children:a.label}),(0,b.jsx)("span",{children:a.value})]}),(0,b.jsx)("div",{className:"mt-2 h-2.5 overflow-hidden rounded-full bg-slate-100",children:(0,b.jsx)("div",{className:`h-full rounded-full ${a.color}`,style:{width:a.width}})})]},a.label))})]}),(0,b.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white p-3",children:[(0,b.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.08em] text-slate-500",children:"Channel Mix"}),(0,b.jsx)("div",{className:"mt-2 space-y-2",children:aI.channelBars.map(a=>(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-700",children:[(0,b.jsx)("span",{className:"font-semibold",children:a.label}),(0,b.jsx)("span",{children:a.value})]}),(0,b.jsx)("div",{className:"mt-2 h-2.5 overflow-hidden rounded-full bg-slate-100",children:(0,b.jsx)("div",{className:`h-full rounded-full ${a.color}`,style:{width:a.width}})})]},a.label))})]})]})})}),(0,b.jsxs)("div",{className:"mt-3 flex flex-wrap gap-2",children:[(0,b.jsx)("button",{type:"button",className:"inline-flex h-9 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-semibold text-slate-700 transition hover:bg-slate-50",children:"Export PDF"}),(0,b.jsx)("button",{type:"button",className:"inline-flex h-9 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-semibold text-slate-700 transition hover:bg-slate-50",children:"Export Excel"})]})]}):null,O?(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/45 p-4",role:"dialog","aria-modal":"true","aria-label":"Create Incident",onClick:()=>!Q&&P(!1),children:(0,b.jsxs)("div",{className:"w-full max-w-4xl rounded-2xl border border-slate-200 bg-white p-4 shadow-2xl sm:p-5",onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"mb-3 flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-base font-semibold text-slate-900",children:"Create Incident"}),(0,b.jsx)("p",{className:"mt-0.5 text-sm text-slate-600",children:"Capture incident details and initialize compliance workflow."})]}),(0,b.jsx)("button",{type:"button",onClick:()=>!Q&&P(!1),disabled:Q,className:"inline-flex h-8 w-8 items-center justify-center rounded-lg border border-slate-300 bg-white text-slate-600 transition hover:bg-slate-50 disabled:opacity-60","aria-label":"Close create incident",children:(0,b.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.9",className:"h-4 w-4","aria-hidden":"true",children:(0,b.jsx)("path",{d:"m6 6 12 12M18 6 6 18"})})})]}),(0,b.jsxs)("form",{className:"space-y-3",onSubmit:an,children:[(0,b.jsxs)("div",{className:"grid gap-2 md:grid-cols-2",children:[(0,b.jsx)("input",{required:!0,value:S.title,onChange:a=>T(b=>({...b,title:a.target.value})),placeholder:"Incident title",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none md:col-span-2"}),(0,b.jsx)("select",{value:S.severity,onChange:a=>T(b=>({...b,severity:a.target.value})),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:k.map(a=>(0,b.jsx)("option",{value:a,children:a},`create-severity-${a}`))}),(0,b.jsx)("select",{value:S.incidentType,onChange:a=>T(b=>({...b,incidentType:a.target.value})),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:o.map(a=>(0,b.jsx)("option",{value:a,children:a},`create-type-${a}`))}),(0,b.jsx)("input",{type:"datetime-local",value:S.detectedAt,onChange:a=>T(b=>({...b,detectedAt:a.target.value})),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,b.jsx)("input",{value:S.ownerEmail,onChange:a=>T(b=>({...b,ownerEmail:a.target.value})),placeholder:"Owner email",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,b.jsx)("input",{value:S.affectedEmployeeEmail,onChange:a=>T(b=>({...b,affectedEmployeeEmail:a.target.value})),placeholder:"Affected employee email",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none md:col-span-2"}),(0,b.jsx)("input",{value:S.department,onChange:a=>T(b=>({...b,department:a.target.value})),placeholder:"Department (optional)",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,b.jsx)("input",{value:S.involvedEmployees,onChange:a=>T(b=>({...b,involvedEmployees:a.target.value})),placeholder:"Additional involved employees (comma separated)",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none md:col-span-2"}),(0,b.jsx)("textarea",{rows:3,value:S.summary,onChange:a=>T(b=>({...b,summary:a.target.value})),placeholder:"Incident summary",className:"rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none md:col-span-2"})]}),(0,b.jsxs)("div",{className:"grid gap-2 sm:grid-cols-3",children:[(0,b.jsxs)("label",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:S.restrictedPiiInvolved,onChange:a=>T(b=>({...b,restrictedPiiInvolved:a.target.checked})),className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),(0,b.jsx)("span",{className:"text-xs text-slate-700",children:"Restricted PII"})]}),(0,b.jsxs)("label",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:S.executiveNotificationRequired,onChange:a=>T(b=>({...b,executiveNotificationRequired:a.target.checked})),className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),(0,b.jsx)("span",{className:"text-xs text-slate-700",children:"Executive Notice"})]}),(0,b.jsxs)("label",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:S.regulatoryNotificationRequired,onChange:a=>T(b=>({...b,regulatoryNotificationRequired:a.target.checked})),className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),(0,b.jsx)("span",{className:"text-xs text-slate-700",children:"Regulatory Notice"})]})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-dashed border-slate-200 bg-white p-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs font-semibold text-slate-900",children:"Attachments"}),(0,b.jsx)("p",{className:"text-[11px] text-slate-500",children:"Upload initial evidence (optional)."})]}),(0,b.jsx)("button",{type:"button",onClick:()=>ah.current?.click(),className:"inline-flex h-8 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-semibold text-slate-700 transition hover:bg-slate-50",children:"Add Files"})]}),(0,b.jsx)("input",{ref:ah,type:"file",className:"hidden",multiple:!0,onChange:a=>{let b=Array.from(a.target.files||[]);a.target.value="",0!==b.length&&af(a=>[...a,...b])}}),ae.length>0?(0,b.jsx)("ul",{className:"mt-2 space-y-1 text-xs text-slate-600",children:ae.map((a,c)=>(0,b.jsxs)("li",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{children:a.name}),(0,b.jsx)("button",{type:"button",onClick:()=>af(a=>a.filter((a,b)=>b!==c)),className:"text-rose-500",children:"Remove"})]},`${a.name}-${c}`))}):(0,b.jsx)("p",{className:"mt-2 text-xs text-slate-500",children:"No files attached."})]}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2 border-t border-slate-200 pt-3",children:[(0,b.jsx)("button",{type:"button",onClick:()=>P(!1),disabled:Q,className:"inline-flex h-9 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-70",children:"Cancel"}),(0,b.jsx)("button",{type:"submit",disabled:Q,className:"inline-flex h-9 items-center rounded-lg bg-sky-600 px-4 text-xs font-semibold text-white transition hover:bg-sky-700 disabled:opacity-70",children:Q?"Creating...":"Create Incident"})]})]})]})}):null,U?(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/45 p-4",role:"dialog","aria-modal":"true","aria-label":"Incident Workbench",onClick:()=>!aa&&!ac&&V(""),children:(0,b.jsxs)("div",{className:"w-full max-w-6xl rounded-2xl border border-slate-200 bg-white p-4 shadow-2xl sm:p-5",onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"mb-3 flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-base font-semibold text-slate-900",children:"Incident Workbench"}),(0,b.jsx)("p",{className:"mt-0.5 text-sm text-slate-600",children:"Escalation, 72-hour actions, and forensic evidence."})]}),(0,b.jsx)("button",{type:"button",onClick:()=>!aa&&!ac&&V(""),disabled:aa||ac,className:"inline-flex h-8 w-8 items-center justify-center rounded-lg border border-slate-300 bg-white text-slate-600 transition hover:bg-slate-50 disabled:opacity-60","aria-label":"Close incident workbench",children:(0,b.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.9",className:"h-4 w-4","aria-hidden":"true",children:(0,b.jsx)("path",{d:"m6 6 12 12M18 6 6 18"})})})]}),!$&&W&&Y?(0,b.jsxs)("div",{className:"max-h-[72vh] space-y-3 overflow-y-auto pr-1",children:[(0,b.jsxs)("div",{className:"grid gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2.5 sm:grid-cols-2 lg:grid-cols-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500",children:"Incident"}),(0,b.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:x(W)}),(0,b.jsx)("p",{className:"text-xs text-slate-500",children:String(W?.incidentCode||"N/A")})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500",children:"Detected"}),(0,b.jsx)("p",{className:"text-xs text-slate-700",children:s(W?.detectedAt)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500",children:"Regulatory Due"}),(0,b.jsx)("p",{className:"text-xs text-slate-700",children:s(W?.regulatoryDueAt)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500",children:"Regulatory Status"}),(0,b.jsx)(f.default,{value:W?.regulatoryStatus||"Not Required"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500",children:"Occurrences"}),(0,b.jsx)("p",{className:"text-xs font-semibold text-slate-900",children:Number(W?.alertOccurrenceCount||1)}),(0,b.jsxs)("p",{className:"text-xs text-slate-500",children:["Last: ",s(W?.alertLastObservedAt)]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500",children:"Alert Rule"}),(0,b.jsx)("p",{className:"text-xs font-semibold text-slate-900",children:String(W?.detectionRuleId||"-")}),(0,b.jsx)("p",{className:"text-xs text-slate-500",children:String(W?.incidentType||"-")})]})]}),(0,b.jsx)(d.default,{title:"Alert Occurrence History",subtitle:"Consolidated alert hits for this incident (newest first)",children:Array.isArray(W?.alertOccurrences)&&W.alertOccurrences.length>0?(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full text-left text-xs text-slate-700",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-slate-200 text-[11px] uppercase tracking-[0.08em] text-slate-500",children:[(0,b.jsx)("th",{className:"px-2 py-2 font-semibold",children:"#"}),(0,b.jsx)("th",{className:"px-2 py-2 font-semibold",children:"When"}),(0,b.jsx)("th",{className:"px-2 py-2 font-semibold",children:"Activity"}),(0,b.jsx)("th",{className:"px-2 py-2 font-semibold",children:"Module"}),(0,b.jsx)("th",{className:"px-2 py-2 font-semibold",children:"Actor"}),(0,b.jsx)("th",{className:"px-2 py-2 font-semibold",children:"Source IP"}),(0,b.jsx)("th",{className:"px-2 py-2 font-semibold",children:"Path"})]})}),(0,b.jsx)("tbody",{children:[...W.alertOccurrences].reverse().map((a,c)=>{let d=String(a?.id||a?.occurredAt||`${a?.activityName||"entry"}-${c}`);return(0,b.jsxs)("tr",{className:"border-b border-slate-100 align-top",children:[(0,b.jsx)("td",{className:"px-2 py-2 text-slate-500",children:Number(W?.alertOccurrenceCount||W.alertOccurrences.length)-c}),(0,b.jsx)("td",{className:"px-2 py-2",children:s(a?.occurredAt)}),(0,b.jsx)("td",{className:"px-2 py-2",children:String(a?.activityName||"-")}),(0,b.jsx)("td",{className:"px-2 py-2",children:String(a?.module||"-")}),(0,b.jsx)("td",{className:"px-2 py-2",children:String(a?.actorEmail||"-")}),(0,b.jsx)("td",{className:"px-2 py-2",children:String(a?.sourceIp||"-")}),(0,b.jsx)("td",{className:"px-2 py-2",children:String(a?.requestPath||"-")})]},`occ-${d}-${c}`)})})]})}):(0,b.jsx)("p",{className:"text-xs text-slate-500",children:"No occurrence history recorded yet."})}),(0,b.jsxs)("div",{className:"grid gap-3 lg:grid-cols-2",children:[(0,b.jsxs)(d.default,{title:"Workflow Control",subtitle:"Severity, containment, impact, and status updates",children:[(0,b.jsxs)("div",{className:"grid gap-2 sm:grid-cols-2",children:[(0,b.jsx)("select",{value:Y.severity,onChange:a=>Z(b=>({...b,severity:a.target.value})),disabled:!B||aa,className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100",children:k.map(a=>(0,b.jsx)("option",{value:a,children:a},`d-sev-${a}`))}),(0,b.jsx)("select",{value:Y.status,onChange:a=>Z(b=>({...b,status:a.target.value})),disabled:!B||aa,className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100",children:l.map(a=>(0,b.jsx)("option",{value:a,children:a},`d-status-${a}`))}),(0,b.jsx)("select",{value:Y.containmentStatus,onChange:a=>Z(b=>({...b,containmentStatus:a.target.value})),disabled:!B||aa,className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100",children:m.map(a=>(0,b.jsx)("option",{value:a,children:a},`d-cont-${a}`))}),(0,b.jsx)("select",{value:Y.impactAssessmentStatus,onChange:a=>Z(b=>({...b,impactAssessmentStatus:a.target.value})),disabled:!B||aa,className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100",children:n.map(a=>(0,b.jsx)("option",{value:a,children:a},`d-impact-${a}`))})]}),(0,b.jsx)("textarea",{value:Y.summary,onChange:a=>Z(b=>({...b,summary:a.target.value})),rows:2,placeholder:"Incident summary",disabled:!B||aa,className:"mt-2 w-full rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100"}),(0,b.jsx)("textarea",{value:Y.containmentSummary,onChange:a=>Z(b=>({...b,containmentSummary:a.target.value})),rows:2,placeholder:"Containment summary",disabled:!B||aa,className:"mt-2 w-full rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100"}),(0,b.jsx)("textarea",{value:Y.impactSummary,onChange:a=>Z(b=>({...b,impactSummary:a.target.value})),rows:2,placeholder:"Impact summary",disabled:!B||aa,className:"mt-2 w-full rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100"})]}),(0,b.jsxs)(d.default,{title:"72-Hour Controls",subtitle:"Regulatory, executive, and affected-individual notifications",children:[(0,b.jsxs)("div",{className:"grid gap-2 sm:grid-cols-2",children:[(0,b.jsxs)("label",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:Y.regulatoryNotificationRequired,onChange:a=>Z(b=>({...b,regulatoryNotificationRequired:a.target.checked})),disabled:!B||aa,className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),(0,b.jsx)("span",{className:"text-xs text-slate-700",children:"Regulatory required"})]}),(0,b.jsxs)("label",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:Y.documentationRetained,onChange:a=>Z(b=>({...b,documentationRetained:a.target.checked})),disabled:!B||aa,className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),(0,b.jsx)("span",{className:"text-xs text-slate-700",children:"Documentation retained"})]})]}),(0,b.jsxs)("div",{className:"mt-2 grid gap-2 sm:grid-cols-2",children:[(0,b.jsx)("input",{value:Y.documentationLocation,onChange:a=>Z(b=>({...b,documentationLocation:a.target.value})),placeholder:"Documentation location",disabled:!B||aa,className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100"}),(0,b.jsx)("input",{value:Y.classificationStandard,onChange:a=>Z(b=>({...b,classificationStandard:a.target.value})),placeholder:"Classification standard",disabled:!B||aa,className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100"})]}),(0,b.jsxs)("div",{className:"mt-2 grid gap-2 sm:grid-cols-2 lg:grid-cols-3",children:[(0,b.jsx)("button",{type:"button",onClick:()=>ap("grcAlertedAt","GRC alerted.",{escalationRequired:!0}),disabled:!B||aa,className:"inline-flex h-8 items-center justify-center rounded-md border border-slate-300 bg-white px-3 text-[11px] font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60",children:"Mark GRC Alerted"}),(0,b.jsx)("button",{type:"button",onClick:()=>ap("executiveNotifiedAt","Executive notification recorded.",{executiveNotificationRequired:!0}),disabled:!B||aa,className:"inline-flex h-8 items-center justify-center rounded-md border border-slate-300 bg-white px-3 text-[11px] font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60",children:"Mark Executive Notified"}),(0,b.jsx)("button",{type:"button",onClick:()=>ap("regulatoryNotifiedAt","Regulatory notification recorded.",{regulatoryNotificationRequired:!0,status:"Regulatory Review"}),disabled:!B||aa,className:"inline-flex h-8 items-center justify-center rounded-md border border-slate-300 bg-white px-3 text-[11px] font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60",children:"Mark Regulator Notified"}),(0,b.jsx)("button",{type:"button",onClick:()=>ap("affectedIndividualsNotifiedAt","Affected individuals notification recorded."),disabled:!B||aa,className:"inline-flex h-8 items-center justify-center rounded-md border border-slate-300 bg-white px-3 text-[11px] font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60",children:"Mark Affected Individuals"}),(0,b.jsx)("button",{type:"button",onClick:()=>am({refreshForensicSnapshot:!0},"Forensic snapshot refreshed."),disabled:!B||aa,className:"inline-flex h-8 items-center justify-center rounded-md border border-sky-200 bg-sky-50 px-3 text-[11px] font-semibold text-sky-700 transition hover:bg-sky-100 disabled:opacity-60",children:"Refresh Forensic"})]})]}),(0,b.jsxs)(d.default,{title:"Breach Confirmation",subtitle:"Manual confirmation required for declared breaches",children:[(0,b.jsxs)("div",{className:"grid gap-2 sm:grid-cols-2",children:[(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Status"}),(0,b.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:Y?.breachConfirmed?"Confirmed breach":"Not confirmed"}),(0,b.jsx)("p",{className:"text-xs text-slate-500",children:Y?.breachConfirmedAt?`At ${s(Y.breachConfirmedAt)}`:"Awaiting confirmation"})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Confirmed By"}),(0,b.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:Y?.breachConfirmedBy?Y.breachConfirmedBy:"-"}),(0,b.jsx)("p",{className:"text-xs text-slate-500",children:"Requires GRC approval"})]})]}),(0,b.jsxs)("div",{className:"mt-2 flex flex-wrap gap-2",children:[Y?.breachConfirmed?(0,b.jsx)("button",{type:"button",onClick:()=>aq(!1),disabled:!B||aa,className:"inline-flex h-8 items-center justify-center rounded-md border border-rose-200 bg-rose-50 px-3 text-[11px] font-semibold text-rose-700 transition hover:bg-rose-100 disabled:opacity-60",children:"Revoke Confirmation"}):(0,b.jsx)("button",{type:"button",onClick:()=>aq(!0),disabled:!B||aa,className:"inline-flex h-8 items-center justify-center rounded-md border border-emerald-200 bg-emerald-50 px-3 text-[11px] font-semibold text-emerald-700 transition hover:bg-emerald-100 disabled:opacity-60",children:"Mark Breach Confirmed"}),B?null:(0,b.jsx)("p",{className:"text-xs text-slate-500",children:"View-only. GRC can confirm breaches."})]})]})]}),(0,b.jsxs)(d.default,{title:"Incident Evidence",subtitle:"Retained case documents and attachments",children:[(0,b.jsx)("input",{ref:ag,type:"file",className:"hidden",onChange:ar}),(0,b.jsx)("div",{className:"mb-2 flex justify-end",children:B?(0,b.jsx)("button",{type:"button",onClick:()=>ag.current?.click(),disabled:ac||aa,className:"inline-flex h-8 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60",children:ac?"Uploading...":"Upload Evidence"}):null}),0===az.length?(0,b.jsx)(e.default,{title:"No evidence files attached",subtitle:"Upload incident files to retain case evidence."}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full text-left text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-slate-200 text-xs uppercase tracking-[0.1em] text-slate-500",children:[(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Document"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Uploaded At"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Uploaded By"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium text-right",children:"Actions"})]})}),(0,b.jsx)("tbody",{children:az.map((a,c)=>(0,b.jsxs)("tr",{className:"border-b border-slate-100 text-slate-700 last:border-b-0",children:[(0,b.jsxs)("td",{className:"px-2 py-3",children:[(0,b.jsx)("p",{className:"font-medium text-slate-900",children:String(a?.name||"Incident Evidence")}),(0,b.jsx)("p",{className:"text-xs text-slate-500",children:String(a?.type||"Incident Evidence")})]}),(0,b.jsx)("td",{className:"px-2 py-3 text-xs text-slate-600",children:s(a?.uploadedAt)}),(0,b.jsx)("td",{className:"px-2 py-3 text-xs text-slate-600",children:String(a?.uploadedBy||"-")}),(0,b.jsx)("td",{className:"px-2 py-3 text-right",children:(0,b.jsxs)("div",{className:"inline-flex items-center gap-2",children:[a?.ref?(0,b.jsx)("a",{href:a.ref,target:"_blank",rel:"noreferrer",className:"inline-flex h-8 items-center rounded-lg border border-sky-200 bg-sky-50 px-3 text-xs font-semibold text-sky-700 transition hover:bg-sky-100",children:"Open"}):null,B?(0,b.jsx)("button",{type:"button",onClick:()=>as(a),disabled:aa||ac,className:"inline-flex h-8 items-center rounded-lg border border-rose-200 bg-rose-50 px-3 text-xs font-semibold text-rose-700 transition hover:bg-rose-100 disabled:opacity-60",children:"Remove"}):null]})})]},`${a?.id||"evidence"}-${c}`))})]})})]}),(0,b.jsx)(d.default,{title:"Audit Trail / Activity Logs",subtitle:"Change history, actions, and compliance traceability",children:Array.isArray(W?.traceability)&&W.traceability.length>0?(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full text-left text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-slate-200 text-xs uppercase tracking-[0.1em] text-slate-500",children:[(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"When"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"By"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Action"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Status"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Severity"})]})}),(0,b.jsx)("tbody",{children:W.traceability.map((a,c)=>(0,b.jsxs)("tr",{className:"border-b border-slate-100 text-slate-700 last:border-b-0",children:[(0,b.jsx)("td",{className:"px-2 py-3 text-xs text-slate-600",children:s(a?.at)}),(0,b.jsx)("td",{className:"px-2 py-3 text-xs",children:String(a?.by||"-")}),(0,b.jsx)("td",{className:"px-2 py-3 text-xs",children:String(a?.action||"-")}),(0,b.jsx)("td",{className:"px-2 py-3 text-xs",children:String(a?.status||"-")}),(0,b.jsx)("td",{className:"px-2 py-3 text-xs",children:String(a?.severity||"-")})]},`${a?.at||"audit"}-${c}`))})]})}):(0,b.jsx)(e.default,{title:"No audit trail entries",subtitle:"Updates will appear here as actions occur."})}),(0,b.jsxs)(d.default,{title:"Forensic Logging",subtitle:"Scoped logs for access, export, administrative, and deletion events",children:[(0,b.jsxs)("div",{className:"grid gap-2 sm:grid-cols-2 lg:grid-cols-5",children:[(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Scoped Logs"}),(0,b.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:Number(W?.forensicSummary?.totalScopedLogs||0)})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Access"}),(0,b.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:Number(W?.forensicSummary?.accessLogsCount||0)})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Exports"}),(0,b.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:Number(W?.forensicSummary?.exportLogsCount||0)})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Administrative"}),(0,b.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:Number(W?.forensicSummary?.administrativeActionsCount||0)})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Deletion"}),(0,b.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:Number(W?.forensicSummary?.deletionActivitiesCount||0)})]})]}),(0,b.jsx)("div",{className:"mt-3 grid gap-3 lg:grid-cols-2",children:[{key:"accessLogs",label:"Access Logs"},{key:"exportLogs",label:"Export Logs"},{key:"administrativeActions",label:"Administrative Actions"},{key:"deletionActivities",label:"Deletion Activities"}].map(a=>{let c=Array.isArray(W?.forensicSnapshot?.[a.key])?W.forensicSnapshot[a.key].slice(0,20):[];return(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white",children:[(0,b.jsx)("div",{className:"border-b border-slate-200 px-3 py-2",children:(0,b.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.08em] text-slate-500",children:a.label})}),0===c.length?(0,b.jsx)("p",{className:"px-3 py-3 text-xs text-slate-500",children:"No entries."}):(0,b.jsx)("div",{className:"max-h-52 overflow-auto",children:(0,b.jsxs)("table",{className:"min-w-full text-left text-xs",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-slate-200 text-[11px] uppercase tracking-[0.08em] text-slate-500",children:[(0,b.jsx)("th",{className:"px-3 py-2 font-medium",children:"Action"}),(0,b.jsx)("th",{className:"px-3 py-2 font-medium",children:"Module"}),(0,b.jsx)("th",{className:"px-3 py-2 font-medium",children:"When"}),(0,b.jsx)("th",{className:"px-3 py-2 font-medium",children:"By"})]})}),(0,b.jsx)("tbody",{children:c.map((c,d)=>(0,b.jsxs)("tr",{className:"border-b border-slate-100 text-slate-700 last:border-b-0",children:[(0,b.jsx)("td",{className:"px-3 py-2",children:String(c?.activityName||"-")}),(0,b.jsx)("td",{className:"px-3 py-2",children:String(c?.module||"-")}),(0,b.jsx)("td",{className:"px-3 py-2",children:s(c?.occurredAt)}),(0,b.jsx)("td",{className:"px-3 py-2",children:String(c?.performedBy||"-")})]},`${a.key}-${c.id||c.occurredAt||"row"}-${d}`))})]})})]},a.key)})})]}),(0,b.jsx)(d.default,{title:"Notes",subtitle:"Additional incident context and forensic details",children:(0,b.jsxs)("div",{className:"grid gap-3 lg:grid-cols-[minmax(0,2fr)_minmax(0,1fr)]",children:[(0,b.jsx)("textarea",{value:Y.notes,onChange:a=>Z(b=>({...b,notes:a.target.value})),rows:8,disabled:!B||aa,className:"min-h-[180px] w-full rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100"}),(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 p-3",children:[(0,b.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.12em] text-slate-500",children:"Investigation Context"}),(0,b.jsx)("div",{className:"mt-2 space-y-2 text-xs text-slate-700",children:aB.map(a=>(0,b.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,b.jsx)("span",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:a.label}),(0,b.jsx)("span",{className:"font-medium text-slate-900",children:a.value||"-"})]},a.label))})]})]})}),B?(0,b.jsx)("div",{className:"sticky bottom-0 z-10 flex items-center justify-end gap-2 border-t border-slate-200 bg-white pt-3",children:(0,b.jsx)("button",{type:"button",onClick:ao,disabled:aa||ac,className:"inline-flex h-9 items-center rounded-lg bg-sky-600 px-4 text-xs font-semibold text-white transition hover:bg-sky-700 disabled:opacity-70",children:aa?"Saving...":"Save Incident Updates"})}):null]}):(0,b.jsx)("div",{className:"flex justify-center py-8",children:(0,b.jsx)("span",{className:"inline-flex h-6 w-6 animate-spin rounded-full border-2 border-slate-300 border-t-sky-600","aria-hidden":"true"})})]})}):null]})}a.s(["default",()=>y])}];

//# sourceMappingURL=src_components_hris_modules_IncidentManagementModule_jsx_8092945c._.js.map