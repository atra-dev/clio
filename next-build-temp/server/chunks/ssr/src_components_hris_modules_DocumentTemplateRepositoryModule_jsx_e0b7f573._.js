module.exports=[93575,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(44036),e=a.i(63824),f=a.i(38014),g=a.i(3427),h=a.i(51084),i=a.i(63609);let j=[{id:"library",label:"Templates Library"},{id:"employee-docs",label:"Employee Documents"},{id:"contracts",label:"Contracts & Agreements"},{id:"versions",label:"Version History"},{id:"upload-audit",label:"Upload Audit Logs"}],k=[{id:"employee-docs",label:"Documents"}],l={templateName:"",category:"HR Template",documentType:"Template",classification:"Restricted PII",version:"v1.0",status:"Active",tags:"",contentRef:"",changeNote:""};function m(a){let b=new Date(a||"");return Number.isNaN(b.getTime())?"-":new Intl.DateTimeFormat("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(b)}function n(a,b){let c=String(a||"").trim();if(c)return c;let d=String(b||"").trim();return d.includes("@")?(0,h.formatNameFromEmail)(d,{fallbackLabel:"-"}):d||"-"}function o(a){let b=String(a||"").trim();return b.includes("@")?b.toLowerCase():""}function p({session:a}){let p=String(a?.role||"EMPLOYEE_L1").trim().toUpperCase().startsWith("EMPLOYEE_"),q=!p,[r,s]=(0,c.useState)(p?"employee-docs":"library"),[t,u]=(0,c.useState)([]),[v,w]=(0,c.useState)([]),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(l),[B,C]=(0,c.useState)(!0),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)(""),[H,I]=(0,c.useState)(""),J=(0,c.useMemo)(()=>p?k:j,[p]);(0,c.useEffect)(()=>{J.some(a=>a.id===r)||s(J[0]?.id||"employee-docs")},[r,J]);let K=(0,c.useCallback)(async()=>{C(!0),G("");try{let[a,b]=await Promise.all([i.hrisApi.templates.list(),i.hrisApi.employees.list({page:1,pageSize:200,includeDocuments:!0})]),c=Array.isArray(a.records)?a.records:[];u(c),w(Array.isArray(b.records)?b.records:[]),!x&&c[0]?.id&&y(c[0].id)}catch(a){G(a.message||"Unable to load template repository.")}finally{C(!1)}},[x]);(0,c.useEffect)(()=>{K()},[K]);let L=(0,c.useMemo)(()=>t.find(a=>a.id===x)||null,[t,x]),M=(0,c.useMemo)(()=>{let a=[];return v.forEach(b=>{(b.documents||[]).forEach((c,d)=>{a.push({id:`${b.id}-${d}`,employeeRecordId:b.id,documentId:String(c.id||c.recordId||d),employee:(0,h.formatEmployeeName)({firstName:b.firstName,middleName:b.middleName,lastName:b.lastName,suffix:b.suffix,fallback:b.name,fallbackEmail:b.email,fallbackLabel:"Employee"}),employeeEmail:b.email,name:c.name||"Document",type:c.type||"General",ref:c.ref||"",storagePath:c.storagePath||"",uploadedAt:c.uploadedAt||b.updatedAt||b.createdAt,uploadedBy:c.uploadedBy||b.updatedBy||"-",uploadedByName:c.uploadedByName||b.updatedByName||"",uploadedByEmail:c.uploadedByEmail||b.updatedByEmail||c.uploadedBy||b.updatedBy||""})})}),a},[v]),N=(0,c.useMemo)(()=>t.filter(a=>{let b=`${a.category||""} ${a.documentType||""}`.toLowerCase();return b.includes("contract")||b.includes("agreement")||b.includes("nda")}),[t]),O=a=>b=>{A(c=>({...c,[a]:b.target.value}))},P=async a=>{if(a.preventDefault(),q){E(!0),G(""),I("");try{var b;await i.hrisApi.templates.create({templateName:z.templateName,category:z.category,documentType:z.documentType,classification:z.classification,version:z.version,status:z.status,tags:(b=z.tags,String(b||"").split(",").map(a=>a.trim()).filter(Boolean)),contentRef:z.contentRef,changeNote:z.changeNote}),A(l),I("Template uploaded and versioned."),await K()}catch(a){G(a.message||"Unable to create template.")}finally{E(!1)}}},Q=async(a,b)=>{if(x&&q){E(!0),G(""),I("");try{await i.hrisApi.templates.update(x,a),I(b),await K()}catch(a){G(a.message||"Unable to update template.")}finally{E(!1)}}},R=async a=>{if(a&&q){E(!0),G(""),I("");try{await i.hrisApi.templates.archive(a),I("Template archived."),a===x&&y(""),await K()}catch(a){G(a.message||"Unable to archive template.")}finally{E(!1)}}},S=async a=>{let b=String(a?.employeeRecordId||"").trim();if(!b)return void G("Unable to open document. Missing employee record reference.");try{let c=await i.hrisApi.employees.logDocumentAccess(b,{documentId:String(a?.documentId||"").trim(),documentName:String(a?.name||"").trim(),documentType:String(a?.type||"").trim(),documentRef:String(a?.ref||"").trim(),documentStoragePath:String(a?.storagePath||"").trim()}),d=String(c?.accessUrl||"").trim();if(!d)throw Error("Document access URL is unavailable.");window.open(d,"_blank","noopener,noreferrer")}catch(a){G(a?.message||"Document access is blocked by security policy.")}};return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(f.default,{tabs:J,value:r,onChange:s}),F?(0,b.jsx)("p",{className:"rounded-lg border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:F}):null,H?(0,b.jsx)("p",{className:"rounded-lg border border-emerald-200 bg-emerald-50 px-3 py-2 text-xs text-emerald-700",children:H}):null,q?(0,b.jsx)(d.default,{title:"Upload / Manage Template",subtitle:"Version-controlled templates with tagging and restricted classifications",children:(0,b.jsxs)("form",{className:"grid gap-2 md:grid-cols-3",onSubmit:P,children:[(0,b.jsx)("input",{required:!0,value:z.templateName,onChange:O("templateName"),placeholder:"Template name",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,b.jsx)("input",{value:z.category,onChange:O("category"),placeholder:"Category",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,b.jsx)("input",{value:z.documentType,onChange:O("documentType"),placeholder:"Type",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,b.jsx)("input",{value:z.version,onChange:O("version"),placeholder:"Version",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,b.jsx)("input",{value:z.tags,onChange:O("tags"),placeholder:"Tags (comma separated)",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,b.jsx)("input",{value:z.contentRef,onChange:O("contentRef"),placeholder:"File URL / reference",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,b.jsx)("input",{value:z.changeNote,onChange:O("changeNote"),placeholder:"Change note",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,b.jsx)("div",{className:"md:col-span-3",children:(0,b.jsx)("button",{type:"submit",disabled:D,className:"inline-flex h-9 items-center justify-center rounded-lg bg-sky-600 px-4 text-xs font-semibold text-white transition hover:bg-sky-700 disabled:opacity-70",children:D?"Saving...":"Upload Template"})})]})}):null,(0,b.jsx)(d.default,{title:"employee-docs"===r?p?"Documents":"Employee Documents":"contracts"===r?"Contracts & Agreements":"versions"===r?"Version History":"upload-audit"===r?"Upload Audit Logs":"Templates Library",subtitle:p?"Attached files from your employee record.":"Permission-based template and document access",children:B?(0,b.jsx)("p",{className:"text-sm text-slate-600",children:"Loading template repository..."}):"employee-docs"===r?0===M.length?(0,b.jsx)(e.default,{title:p?"No files yet":"No employee documents yet",subtitle:p?"Files attached to your profile will appear here.":"Uploaded employee documents will appear here."}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full text-left text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-slate-200 text-xs uppercase tracking-[0.1em] text-slate-500",children:[p?null:(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Employee"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Document"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Type"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Uploaded"}),p?null:(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Uploaded By"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium text-right",children:"Action"})]})}),(0,b.jsx)("tbody",{children:M.map(a=>(0,b.jsxs)("tr",{className:"border-b border-slate-100 text-slate-700 last:border-b-0",children:[p?null:(0,b.jsxs)("td",{className:"px-2 py-3",children:[(0,b.jsx)("p",{className:"font-medium text-slate-900",children:a.employee}),(0,b.jsx)("p",{className:"text-xs text-slate-500",children:a.employeeEmail})]}),(0,b.jsx)("td",{className:"px-2 py-3",children:a.name}),(0,b.jsx)("td",{className:"px-2 py-3",children:a.type}),(0,b.jsx)("td",{className:"px-2 py-3",children:m(a.uploadedAt)}),p?null:(0,b.jsxs)("td",{className:"px-2 py-3 text-xs text-slate-600",children:[(0,b.jsx)("p",{className:"font-medium text-slate-800",children:n(a.uploadedByName,a.uploadedBy)}),o(a.uploadedByEmail||a.uploadedBy)?(0,b.jsx)("p",{className:"truncate text-[11px] text-slate-500",children:o(a.uploadedByEmail||a.uploadedBy)}):null]}),(0,b.jsx)("td",{className:"px-2 py-3 text-right",children:String(a.ref||a.storagePath||"").trim()?(0,b.jsx)("button",{type:"button",onClick:()=>S(a),className:"inline-flex h-7 items-center rounded-md border border-sky-200 bg-sky-50 px-2.5 text-[11px] font-semibold text-sky-700 transition hover:bg-sky-100",children:"Open"}):(0,b.jsx)("span",{className:"text-xs text-slate-400",children:"No file link"})})]},a.id))})]})}):"contracts"===r?0===N.length?(0,b.jsx)(e.default,{title:"No contracts or agreements found",subtitle:"Contract-type templates will appear in this section."}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full text-left text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-slate-200 text-xs uppercase tracking-[0.1em] text-slate-500",children:[(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Template"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Category"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Version"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Status"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Updated"})]})}),(0,b.jsx)("tbody",{children:N.map(a=>(0,b.jsxs)("tr",{className:"border-b border-slate-100 text-slate-700 last:border-b-0",children:[(0,b.jsx)("td",{className:"px-2 py-3 font-medium text-slate-900",children:a.templateName||"-"}),(0,b.jsx)("td",{className:"px-2 py-3",children:a.category||"-"}),(0,b.jsx)("td",{className:"px-2 py-3",children:a.version||"-"}),(0,b.jsx)("td",{className:"px-2 py-3",children:(0,b.jsx)(g.default,{value:a.status||"-"})}),(0,b.jsx)("td",{className:"px-2 py-3",children:m(a.updatedAt||a.createdAt)})]},a.id))})]})}):"versions"===r?L?0===(L.versionHistory||[]).length?(0,b.jsx)(e.default,{title:"No historical versions yet",subtitle:"Version changes will be recorded after updates."}):(0,b.jsx)("div",{className:"space-y-2",children:(L.versionHistory||[]).map((a,c)=>(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-700",children:[(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"font-semibold text-slate-900",children:a.version||"v1.0"})," changed by"," ",(0,b.jsx)("span",{className:"font-medium",children:n(a.changedByName,a.changedBy)}),o(a.changedByEmail||a.changedBy)?(0,b.jsxs)("span",{className:"text-slate-500",children:[" (",o(a.changedByEmail||a.changedBy),")"]}):null]}),(0,b.jsx)("p",{className:"mt-1 text-slate-500",children:m(a.changedAt)}),(0,b.jsx)("p",{className:"mt-1",children:a.note||"-"})]},`${a.changedAt}-${c}`))}):(0,b.jsx)(e.default,{title:"No template selected",subtitle:"Select a template from the library to inspect version history."}):"upload-audit"===r?L?0===(L.modificationLog||[]).length?(0,b.jsx)(e.default,{title:"No upload logs yet",subtitle:"Template upload and update logs will appear here."}):(0,b.jsx)("div",{className:"space-y-2",children:(L.modificationLog||[]).map((a,c)=>(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-700",children:[(0,b.jsxs)("p",{children:[(0,b.jsx)("span",{className:"font-semibold text-slate-900",children:a.action||"update"})," by"," ",(0,b.jsx)("span",{className:"font-medium",children:n(a.byName,a.by)}),o(a.byEmail||a.by)?(0,b.jsxs)("span",{className:"text-slate-500",children:[" (",o(a.byEmail||a.by),")"]}):null," ","| version ",a.version||"-"]}),(0,b.jsx)("p",{className:"mt-1 text-slate-500",children:m(a.at)})]},`${a.at}-${c}`))}):(0,b.jsx)(e.default,{title:"No template selected",subtitle:"Select a template from the library to inspect upload logs."}):0===t.length?(0,b.jsx)(e.default,{title:"No templates yet",subtitle:"Upload template files and metadata to populate the repository."}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full text-left text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-slate-200 text-xs uppercase tracking-[0.1em] text-slate-500",children:[(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Template"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Category"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Version"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Classification"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Tags"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Status"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium text-right",children:"Actions"})]})}),(0,b.jsx)("tbody",{children:t.map(a=>(0,b.jsxs)("tr",{className:`border-b border-slate-100 text-slate-700 last:border-b-0 ${a.id===x?"bg-sky-50/50":""}`,children:[(0,b.jsx)("td",{className:"px-2 py-3 font-medium text-slate-900",children:a.templateName||"-"}),(0,b.jsx)("td",{className:"px-2 py-3",children:a.category||"-"}),(0,b.jsx)("td",{className:"px-2 py-3",children:a.version||"-"}),(0,b.jsx)("td",{className:"px-2 py-3",children:a.classification||"-"}),(0,b.jsx)("td",{className:"px-2 py-3 text-xs text-slate-600",children:(a.tags||[]).join(", ")||"-"}),(0,b.jsx)("td",{className:"px-2 py-3",children:(0,b.jsx)(g.default,{value:a.status||"-"})}),(0,b.jsx)("td",{className:"px-2 py-3 text-right",children:(0,b.jsxs)("div",{className:"inline-flex flex-wrap items-center justify-end gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>y(a.id),className:"rounded-lg border border-slate-300 bg-white px-2.5 py-1.5 text-xs font-medium text-slate-700 transition hover:bg-slate-50",children:"Select"}),q?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("button",{type:"button",onClick:()=>Q({version:"v1.0"===a.version?"v1.1":a.version,changeNote:"Template metadata update"},"Template version updated."),disabled:D,className:"rounded-lg border border-sky-200 bg-sky-50 px-2.5 py-1.5 text-xs font-medium text-sky-700 transition hover:bg-sky-100 disabled:opacity-60",children:"New Version"}),(0,b.jsx)("button",{type:"button",onClick:()=>R(a.id),disabled:D,className:"rounded-lg border border-rose-200 bg-rose-50 px-2.5 py-1.5 text-xs font-medium text-rose-700 transition hover:bg-rose-100 disabled:opacity-60",children:"Archive"})]}):null]})})]},a.id))})]})})})]})}a.s(["default",()=>p])}];

//# sourceMappingURL=src_components_hris_modules_DocumentTemplateRepositoryModule_jsx_e0b7f573._.js.map