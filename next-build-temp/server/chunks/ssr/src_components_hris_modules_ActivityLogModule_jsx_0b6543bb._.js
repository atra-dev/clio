module.exports=[57965,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(71987),e=a.i(51084),f=a.i(97630);let g={Completed:"bg-sky-100 text-sky-700",Approved:"bg-emerald-100 text-emerald-700",Pending:"bg-amber-100 text-amber-700",Failed:"bg-rose-100 text-rose-700",Rejected:"bg-rose-100 text-rose-700"},h={Completed:"bg-sky-500",Approved:"bg-emerald-500",Pending:"bg-amber-500",Failed:"bg-rose-500",Rejected:"bg-rose-500"};function i(a){var b;let c,d="string"==typeof a?.performedByName?a.performedByName.trim():"";return d?d:(c="string"==typeof(b=a?.performedBy)?b.trim():"")?c.includes("@")?(0,e.formatNameFromEmail)(c,{fallbackLabel:"Unknown User",maxTokens:2}):c:"Unknown User"}function j(a){return Array.isArray(a)?a.map(a=>String(a||"").trim()).filter(Boolean):[]}function k({expanded:a}){return(0,b.jsx)("svg",{viewBox:"0 0 20 20",fill:"none",stroke:"currentColor",strokeWidth:"2",className:(0,f.cn)("h-3.5 w-3.5 text-slate-500 transition-transform duration-300 ease-out",a?"rotate-90":"rotate-0"),"aria-hidden":"true",children:(0,b.jsx)("path",{d:"M7 4.5 13 10l-6 5.5"})})}function l({rows:a}){let[e,l]=(0,c.useState)(null),[m,n]=(0,c.useState)("All"),[o,p]=(0,c.useState)("All"),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(""),u=["All",...new Set(a.map(a=>a.module))],v=a=>{if("string"!=typeof a||0===a.trim().length)return null;let b=new Date(a);return Number.isNaN(b.getTime())?null:b.getTime()},w=a.filter(a=>{if("All"!==m&&a.module!==m||"All"!==o&&a.sensitivity!==o)return!1;let b=v(a.occurredAt||a.loggedAt),c=v(q),d=v(s);return(!c||!b||!(b<c))&&(!d||!b||!(b>d))});return(0,b.jsxs)("section",{className:"overflow-hidden rounded-xl border border-slate-300 bg-white",children:[(0,b.jsx)("div",{className:"border-b border-slate-200 bg-slate-50/80 px-3 py-3",children:(0,b.jsxs)("div",{className:"flex flex-wrap items-end gap-3",children:[(0,b.jsxs)("label",{className:"grid gap-1 text-xs font-medium text-slate-600",children:["Filter Type",(0,b.jsx)("select",{value:m,onChange:a=>n(a.target.value),className:"h-9 min-w-[12rem] rounded-lg border border-slate-300 bg-white px-3 text-sm text-slate-800 focus:border-sky-400 focus:outline-none",children:u.map(a=>(0,b.jsx)("option",{value:a,children:a},a))})]}),(0,b.jsxs)("label",{className:"grid gap-1 text-xs font-medium text-slate-600",children:["Action Class",(0,b.jsx)("select",{value:o,onChange:a=>p(a.target.value),className:"h-9 min-w-[10rem] rounded-lg border border-slate-300 bg-white px-3 text-sm text-slate-800 focus:border-sky-400 focus:outline-none",children:["All","Sensitive","Non-sensitive"].map(a=>(0,b.jsx)("option",{value:a,children:a},a))})]}),(0,b.jsxs)("label",{className:"grid gap-1 text-xs font-medium text-slate-600",children:["Date & Time (From)",(0,b.jsx)("input",{type:"datetime-local",value:q,onChange:a=>r(a.target.value),className:"h-9 min-w-[14rem] rounded-lg border border-slate-300 bg-white px-3 text-sm text-slate-800 focus:border-sky-400 focus:outline-none"})]}),(0,b.jsxs)("label",{className:"grid gap-1 text-xs font-medium text-slate-600",children:["Date & Time (To)",(0,b.jsx)("input",{type:"datetime-local",value:s,onChange:a=>t(a.target.value),className:"h-9 min-w-[14rem] rounded-lg border border-slate-300 bg-white px-3 text-sm text-slate-800 focus:border-sky-400 focus:outline-none"})]}),(0,b.jsx)("button",{type:"button",onClick:()=>{n("All"),p("All"),r(""),t("")},className:"h-9 rounded-lg border border-slate-300 bg-white px-3 text-sm font-medium text-slate-700 transition hover:bg-slate-100",children:"Reset"}),(0,b.jsxs)("p",{className:"ml-auto text-xs text-slate-500",children:["Showing ",(0,b.jsx)("span",{className:"font-semibold text-slate-700",children:w.length})," of"," ",(0,b.jsx)("span",{className:"font-semibold text-slate-700",children:a.length})," activities"]})]})}),(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-[980px] w-full text-left text-sm",children:[(0,b.jsx)("thead",{className:"bg-slate-100",children:(0,b.jsxs)("tr",{className:"border-b border-slate-300 text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-700",children:[(0,b.jsx)("th",{className:"w-[35%] px-3 py-2.5",children:"HRIS Activity"}),(0,b.jsx)("th",{className:"w-[10%] px-3 py-2.5",children:"Result"}),(0,b.jsx)("th",{className:"w-[10%] px-3 py-2.5",children:"When"}),(0,b.jsx)("th",{className:"w-[16%] px-3 py-2.5",children:"Logged At"}),(0,b.jsx)("th",{className:"w-[14%] px-3 py-2.5",children:"Module"}),(0,b.jsx)("th",{className:"w-[15%] px-3 py-2.5",children:"Performed By"})]})}),(0,b.jsxs)("tbody",{children:[w.map(a=>{var c;let m,n="Failed"===a.status||"Rejected"===a.status,o=e===a.id,p=j(a.changedFields),q=j(a.viewedFields),r=Array.isArray(c=a.accessedDocuments)?c.map(a=>{if(!a||"object"!=typeof a)return null;let b=String(a.name||"").trim(),c=String(a.type||"").trim(),d=String(a.id||"").trim();return b||c||d?{name:b||"Employee Document",type:c||"General",id:d}:null}).filter(Boolean):[];return(0,b.jsx)("tr",{className:"border-b border-slate-200 bg-white text-[13px] text-slate-700",children:(0,b.jsx)("td",{colSpan:6,className:"p-0",children:(0,b.jsxs)("div",{className:"w-full",children:[(0,b.jsxs)("div",{className:"grid grid-cols-[35%_10%_10%_16%_14%_15%]",children:[(0,b.jsx)("div",{className:"px-3 py-2.5",children:(0,b.jsxs)("button",{type:"button",onClick:()=>{var b;return b=a.id,void l(a=>a===b?null:b)},className:"inline-flex items-center gap-2","aria-expanded":o,"aria-controls":`activity-details-${a.id}`,children:[(0,b.jsx)(k,{expanded:o}),(0,b.jsx)("span",{className:(0,f.cn)("inline-flex h-3 w-3 rounded-full",h[a.status]||(n?"bg-rose-500":"bg-sky-500")),"aria-hidden":"true"}),(0,b.jsx)("span",{className:"font-medium text-slate-800",children:a.activityName})]})}),(0,b.jsx)("div",{className:"px-3 py-2.5",children:(0,b.jsx)("span",{className:(0,f.cn)("inline-flex rounded-md px-2 py-1 text-xs font-semibold",g[a.status]||(n?"bg-rose-100 text-rose-700":"bg-sky-100 text-sky-700")),children:a.status})}),(0,b.jsx)("div",{className:"px-3 py-2.5 text-slate-600",children:a.relativeTime}),(0,b.jsx)("div",{className:"px-3 py-2.5 text-slate-600",children:a.loggedAt}),(0,b.jsx)("div",{className:"px-3 py-2.5",children:(0,b.jsx)("span",{className:"text-sky-700 hover:underline",children:a.module})}),(0,b.jsx)("div",{className:"px-3 py-2.5",children:(0,b.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,b.jsx)(d.default,{src:("string"==typeof a?.performedByAvatar?a.performedByAvatar.trim():"")||"/avatars/default-user.svg",alt:`${i(a)} profile picture`,width:32,height:32,className:"h-8 w-8 rounded-full border border-slate-300 bg-white"}),(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("p",{className:"truncate text-xs font-semibold text-slate-800",children:i(a)}),(0,b.jsx)("p",{className:"truncate text-xs text-slate-500",children:(m="string"==typeof a?.performedByEmail?a.performedByEmail.trim():"")||("string"==typeof a?.performedBy?a.performedBy:"-")})]})]})})]}),(0,b.jsx)("div",{id:`activity-details-${a.id}`,className:(0,f.cn)("overflow-hidden transition-all duration-300 ease-out",o?"max-h-[56rem] opacity-100":"max-h-0 opacity-0"),children:(0,b.jsx)("div",{className:"border-t border-slate-200 bg-slate-50/80 px-3 py-3",children:(0,b.jsxs)("div",{className:"grid gap-2 sm:grid-cols-2 xl:grid-cols-4",children:[(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Activity ID"}),(0,b.jsx)("p",{className:"mt-1 text-xs font-semibold text-slate-800",children:a.id})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Record Ref"}),(0,b.jsx)("p",{className:"mt-1 text-xs font-semibold text-slate-800",children:function(a){let b="string"==typeof a?.recordRef?a.recordRef.trim():"";if(b)return b;let c="string"==typeof a?.activityName?a.activityName:"";if(!c)return"N/A";let d=c.match(/\(([^)]+)\)/);if(d?.[1])return d[1];let e=c.match(/CL-\d+/);return e?.[0]||"N/A"}(a)})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Audit Note"}),(0,b.jsx)("p",{className:"mt-1 text-xs text-slate-700",children:a.auditNote||"No audit note."})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Next Action"}),(0,b.jsx)("p",{className:"mt-1 text-xs text-slate-700",children:a.nextAction||"No further action required."})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Action Class"}),(0,b.jsx)("p",{className:"mt-1 text-xs font-semibold text-slate-800",children:a.sensitivity||"Non-sensitive"})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Request Path"}),(0,b.jsx)("p",{className:"mt-1 text-xs text-slate-700",children:a.requestPath||"N/A"})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Request Method"}),(0,b.jsx)("p",{className:"mt-1 text-xs text-slate-700",children:a.requestMethod||"N/A"})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Source IP"}),(0,b.jsx)("p",{className:"mt-1 text-xs text-slate-700",children:a.sourceIp||"N/A"})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Browser"}),(0,b.jsx)("p",{className:"mt-1 text-xs text-slate-700",children:a.browser||"Unknown Browser"})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Operating System"}),(0,b.jsx)("p",{className:"mt-1 text-xs text-slate-700",children:a.operatingSystem||"Unknown OS"})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Device"}),(0,b.jsx)("p",{className:"mt-1 text-xs text-slate-700",children:a.deviceSummary||"Unknown device"})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Changed Fields"}),p.length>0?(0,b.jsx)("p",{className:"mt-1 text-xs text-slate-700",children:p.join(", ")}):(0,b.jsx)("p",{className:"mt-1 text-xs text-slate-400",children:"No field updates recorded."})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Viewed Fields"}),q.length>0?(0,b.jsx)("p",{className:"mt-1 text-xs text-slate-700",children:q.join(", ")}):(0,b.jsx)("p",{className:"mt-1 text-xs text-slate-400",children:"No field view details."})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white px-3 py-2 sm:col-span-2 xl:col-span-2",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Document Access"}),r.length>0?(0,b.jsx)("div",{className:"mt-1 space-y-1",children:r.slice(0,6).map((a,c)=>(0,b.jsxs)("p",{className:"text-xs text-slate-700",children:[a.name,(0,b.jsxs)("span",{className:"text-slate-500",children:[" (",a.type,")"]}),a.id?(0,b.jsxs)("span",{className:"text-slate-400",children:[" #",a.id]}):null]},`${a.id||a.name}-${c}`))}):(0,b.jsx)("p",{className:"mt-1 text-xs text-slate-400",children:"No document access details."})]})]})})})]})})},a.id)}),0===w.length?(0,b.jsx)("tr",{children:(0,b.jsx)("td",{colSpan:6,className:"px-3 py-8 text-center text-sm text-slate-500",children:"No activity logs match the selected filters."})}):null]})]})})]})}var m=a.i(44036),n=a.i(38014),o=a.i(93363),p=a.i(63609);let q=[{id:"user_activity_logs",label:"User Activity Logs"},{id:"data_change_logs",label:"Data Change Logs"},{id:"login_history",label:"Login History"},{id:"export_events",label:"Export Events"},{id:"document_access_logs",label:"Document Access Logs"}];function r(){let[a,d]=(0,c.useState)("user_activity_logs"),[e,f]=(0,c.useState)(""),[g,h]=(0,c.useState)(""),[i,j]=(0,c.useState)(""),[k,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)(1),[y,z]=(0,c.useState)([]),[A,B]=(0,c.useState)(null),[C,D]=(0,c.useState)(!0),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(""),I=(0,c.useRef)(new Map);(0,c.useEffect)(()=>{let a=window.setTimeout(()=>{r(e),t(g),v(i)},300);return()=>{window.clearTimeout(a)}},[g,e,i]);let J=(0,c.useCallback)(async()=>{D(!0),H("");try{let b=JSON.stringify({category:a,q:k,from:s,to:u,page:w,pageSize:120}),c=I.current.get(b);if(c&&Date.now()-c.at<6e4){z(c.rows),B(c.pagination||null),D(!1);return}let d=await p.hrisApi.activityLogs.list({category:a,q:k,from:s,to:u,page:w,pageSize:120}),e=Array.isArray(d.records)?d.records:[];z(e),B(d.pagination||null),I.current.set(b,{rows:e,pagination:d.pagination||null,at:Date.now()})}catch(a){H(a.message||"Unable to load activity logs.")}finally{D(!1)}},[a,s,k,u,w]);(0,c.useEffect)(()=>{J()},[J]);let K=async()=>{F(!0),H("");try{var b;let c,d,f,h=await p.hrisApi.activityLogs.exportCsv({category:a,q:e,from:g,to:i});b=`clio-activity-logs-${a}.csv`,c=new Blob([h],{type:"text/csv;charset=utf-8;"}),d=URL.createObjectURL(c),(f=document.createElement("a")).href=d,f.download=b,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(d)}catch(a){H(a.message||"Unable to export activity logs.")}finally{F(!1)}};return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(n.default,{tabs:q,value:a,onChange:a=>{x(1),d(a)}}),(0,b.jsxs)(m.default,{title:"Investigation Workbench",subtitle:"Advanced filtering, date-range search, and export-ready audit evidence",action:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("input",{value:e,onChange:a=>{x(1),f(a.target.value)},placeholder:"Search activity",className:"h-9 rounded-lg border border-slate-300 bg-white px-3 text-xs text-slate-800 focus:border-sky-400 focus:outline-none"}),(0,b.jsx)("input",{type:"datetime-local",value:g,onChange:a=>{x(1),h(a.target.value)},className:"h-9 rounded-lg border border-slate-300 bg-white px-3 text-xs text-slate-800 focus:border-sky-400 focus:outline-none"}),(0,b.jsx)("input",{type:"datetime-local",value:i,onChange:a=>{x(1),j(a.target.value)},className:"h-9 rounded-lg border border-slate-300 bg-white px-3 text-xs text-slate-800 focus:border-sky-400 focus:outline-none"}),(0,b.jsx)("button",{type:"button",onClick:K,disabled:E,className:"h-9 rounded-lg bg-sky-600 px-3 text-xs font-semibold text-white transition hover:bg-sky-700 disabled:opacity-70",children:E?"Exporting...":"Export Logs"})]}),children:[G?(0,b.jsx)("p",{className:"mb-3 rounded-lg border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:G}):null,C?(0,b.jsx)("p",{className:"text-sm text-slate-600",children:"Loading activity logs..."}):(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(l,{rows:y}),(0,b.jsx)(o.default,{pagination:A,onPageChange:x})]})]})]})}a.s(["default",()=>r],57965)}];

//# sourceMappingURL=src_components_hris_modules_ActivityLogModule_jsx_0b6543bb._.js.map