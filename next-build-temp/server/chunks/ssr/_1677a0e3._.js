module.exports=[2446,35027,11481,73004,a=>{"use strict";let b,c,d,e,f,g,h=function(a){let b=[],c=0;for(let d=0;d<a.length;d++){let e=a.charCodeAt(d);e<128?b[c++]=e:(e<2048?b[c++]=e>>6|192:((64512&e)==55296&&d+1<a.length&&(64512&a.charCodeAt(d+1))==56320?(e=65536+((1023&e)<<10)+(1023&a.charCodeAt(++d)),b[c++]=e>>18|240,b[c++]=e>>12&63|128):b[c++]=e>>12|224,b[c++]=e>>6&63|128),b[c++]=63&e|128)}return b},i=function(a){let b=[],c=0,d=0;for(;c<a.length;){let e=a[c++];if(e<128)b[d++]=String.fromCharCode(e);else if(e>191&&e<224){let f=a[c++];b[d++]=String.fromCharCode((31&e)<<6|63&f)}else if(e>239&&e<365){let f=((7&e)<<18|(63&a[c++])<<12|(63&a[c++])<<6|63&a[c++])-65536;b[d++]=String.fromCharCode(55296+(f>>10)),b[d++]=String.fromCharCode(56320+(1023&f))}else{let f=a[c++],g=a[c++];b[d++]=String.fromCharCode((15&e)<<12|(63&f)<<6|63&g)}}return b.join("")},j={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(a,b){if(!Array.isArray(a))throw Error("encodeByteArray takes an array as a parameter");this.init_();let c=b?this.byteToCharMapWebSafe_:this.byteToCharMap_,d=[];for(let b=0;b<a.length;b+=3){let e=a[b],f=b+1<a.length,g=f?a[b+1]:0,h=b+2<a.length,i=h?a[b+2]:0,j=e>>2,k=(3&e)<<4|g>>4,l=(15&g)<<2|i>>6,m=63&i;!h&&(m=64,f||(l=64)),d.push(c[j],c[k],c[l],c[m])}return d.join("")},encodeString(a,b){return this.HAS_NATIVE_SUPPORT&&!b?btoa(a):this.encodeByteArray(h(a),b)},decodeString(a,b){return this.HAS_NATIVE_SUPPORT&&!b?atob(a):i(this.decodeStringToByteArray(a,b))},decodeStringToByteArray(a,b){this.init_();let c=b?this.charToByteMapWebSafe_:this.charToByteMap_,d=[];for(let b=0;b<a.length;){let e=c[a.charAt(b++)],f=b<a.length?c[a.charAt(b)]:0,g=++b<a.length?c[a.charAt(b)]:64,h=++b<a.length?c[a.charAt(b)]:64;if(++b,null==e||null==f||null==g||null==h)throw new k;let i=e<<2|f>>4;if(d.push(i),64!==g){let a=f<<4&240|g>>2;if(d.push(a),64!==h){let a=g<<6&192|h;d.push(a)}}}return d},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let a=0;a<this.ENCODED_VALS.length;a++)this.byteToCharMap_[a]=this.ENCODED_VALS.charAt(a),this.charToByteMap_[this.byteToCharMap_[a]]=a,this.byteToCharMapWebSafe_[a]=this.ENCODED_VALS_WEBSAFE.charAt(a),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[a]]=a,a>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(a)]=a,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(a)]=a)}}};class k extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}let l=function(a){let b=h(a);return j.encodeByteArray(b,!0)},m=function(a){return l(a).replace(/\./g,"")},n=function(a){try{return j.decodeString(a,!0)}catch(a){console.error("base64Decode failed: ",a)}return null},o=()=>{try{return("u">typeof self?self:a.g).__FIREBASE_DEFAULTS__||(()=>{if("u"<typeof process||void 0===process.env)return;let a=process.env.__FIREBASE_DEFAULTS__;if(a)return JSON.parse(a)})()||(()=>{let a;if("u"<typeof document)return;try{a=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(a){return}let b=a&&n(a[1]);return b&&JSON.parse(b)})()}catch(a){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${a}`);return}},p=a=>{let b=o()?.emulatorHosts?.[a];if(!b)return;let c=b.lastIndexOf(":");if(c<=0||c+1===b.length)throw Error(`Invalid host ${b} with no separate hostname and port!`);let d=parseInt(b.substring(c+1),10);return"["===b[0]?[b.substring(1,c-1),d]:[b.substring(0,c),d]},q=()=>o()?.config;class r{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((a,b)=>{this.resolve=a,this.reject=b})}wrapCallback(a){return(b,c)=>{b?this.reject(b):this.resolve(c),"function"==typeof a&&(this.promise.catch(()=>{}),1===a.length?a(b):a(b,c))}}}function s(a){try{return(a.startsWith("http://")||a.startsWith("https://")?new URL(a).hostname:a).endsWith(".cloudworkstations.dev")}catch{return!1}}async function t(a){return(await fetch(a,{credentials:"include"})).ok}function u(a,b){if(a.uid)throw Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let c=b||"demo-project",d=a.iat||0,e=a.sub||a.user_id;if(!e)throw Error("mockUserToken must contain 'sub' or 'user_id' field!");let f={iss:`https://securetoken.google.com/${c}`,aud:c,iat:d,exp:d+3600,auth_time:d,sub:e,user_id:e,firebase:{sign_in_provider:"custom",identities:{}},...a};return[m(JSON.stringify({alg:"none",type:"JWT"})),m(JSON.stringify(f)),""].join(".")}function v(a,b){}function w(){return x()}function x(){return"u">typeof WorkerGlobalScope&&"u">typeof self&&self instanceof WorkerGlobalScope}function y(){try{return"object"==typeof indexedDB}catch(a){return!1}}function z(){return new Promise((a,b)=>{try{let c=!0,d="validate-browser-context-for-indexeddb-analytics-module",e=self.indexedDB.open(d);e.onsuccess=()=>{e.result.close(),c||self.indexedDB.deleteDatabase(d),a(!0)},e.onupgradeneeded=()=>{c=!1},e.onerror=()=>{b(e.error?.message||"")}}catch(a){b(a)}})}class A extends Error{constructor(a,b,c){super(b),this.code=a,this.customData=c,this.name="FirebaseError",Object.setPrototypeOf(this,A.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,B.prototype.create)}}class B{constructor(a,b,c){this.service=a,this.serviceName=b,this.errors=c}create(a,...b){var c,d;let e=b[0]||{},f=`${this.service}/${a}`,g=this.errors[a],h=g?(c=g,d=e,c.replace(C,(a,b)=>{let c=d[b];return null!=c?String(c):`<${b}?>`})):"Error",i=`${this.serviceName}: ${h} (${f}).`;return new A(f,i,e)}}let C=/\{\$([^}]+)}/g;function D(a,b){if(a===b)return!0;let c=Object.keys(a),d=Object.keys(b);for(let e of c){if(!d.includes(e))return!1;let c=a[e],f=b[e];if(E(c)&&E(f)){if(!D(c,f))return!1}else if(c!==f)return!1}for(let a of d)if(!c.includes(a))return!1;return!0}function E(a){return null!==a&&"object"==typeof a}function F(a){return a&&a._delegate?a._delegate:a}a.s(["Deferred",()=>r,"ErrorFactory",()=>B,"FirebaseError",()=>A,"base64Decode",()=>n,"base64urlEncodeWithoutPadding",()=>m,"createMockUserToken",()=>u,"deepEqual",()=>D,"getDefaultAppConfig",()=>q,"getDefaultEmulatorHostnameAndPort",()=>p,"getModularInstance",()=>F,"isBrowser",()=>w,"isCloudWorkstation",()=>s,"isIndexedDBAvailable",()=>y,"isWebWorker",()=>x,"pingServer",()=>t,"updateEmulatorBanner",()=>v,"validateIndexedDBOpenable",()=>z],35027);class G{constructor(a,b,c){this.name=a,this.instanceFactory=b,this.type=c,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(a){return this.instantiationMode=a,this}setMultipleInstances(a){return this.multipleInstances=a,this}setServiceProps(a){return this.serviceProps=a,this}setInstanceCreatedCallback(a){return this.onInstanceCreated=a,this}}let H="[DEFAULT]";class I{constructor(a,b){this.name=a,this.container=b,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(a){let b=this.normalizeInstanceIdentifier(a);if(!this.instancesDeferred.has(b)){let a=new r;if(this.instancesDeferred.set(b,a),this.isInitialized(b)||this.shouldAutoInitialize())try{let c=this.getOrInitializeService({instanceIdentifier:b});c&&a.resolve(c)}catch(a){}}return this.instancesDeferred.get(b).promise}getImmediate(a){let b=this.normalizeInstanceIdentifier(a?.identifier),c=a?.optional??!1;if(this.isInitialized(b)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:b})}catch(a){if(c)return null;throw a}if(c)return null;throw Error(`Service ${this.name} is not available`)}getComponent(){return this.component}setComponent(a){if(a.name!==this.name)throw Error(`Mismatching Component ${a.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=a,this.shouldAutoInitialize()){if("EAGER"===a.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:H})}catch(a){}for(let[a,b]of this.instancesDeferred.entries()){let c=this.normalizeInstanceIdentifier(a);try{let a=this.getOrInitializeService({instanceIdentifier:c});b.resolve(a)}catch(a){}}}}clearInstance(a=H){this.instancesDeferred.delete(a),this.instancesOptions.delete(a),this.instances.delete(a)}async delete(){let a=Array.from(this.instances.values());await Promise.all([...a.filter(a=>"INTERNAL"in a).map(a=>a.INTERNAL.delete()),...a.filter(a=>"_delete"in a).map(a=>a._delete())])}isComponentSet(){return null!=this.component}isInitialized(a=H){return this.instances.has(a)}getOptions(a=H){return this.instancesOptions.get(a)||{}}initialize(a={}){let{options:b={}}=a,c=this.normalizeInstanceIdentifier(a.instanceIdentifier);if(this.isInitialized(c))throw Error(`${this.name}(${c}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let d=this.getOrInitializeService({instanceIdentifier:c,options:b});for(let[a,b]of this.instancesDeferred.entries())c===this.normalizeInstanceIdentifier(a)&&b.resolve(d);return d}onInit(a,b){let c=this.normalizeInstanceIdentifier(b),d=this.onInitCallbacks.get(c)??new Set;d.add(a),this.onInitCallbacks.set(c,d);let e=this.instances.get(c);return e&&a(e,c),()=>{d.delete(a)}}invokeOnInitCallbacks(a,b){let c=this.onInitCallbacks.get(b);if(c)for(let d of c)try{d(a,b)}catch{}}getOrInitializeService({instanceIdentifier:a,options:b={}}){var c;let d=this.instances.get(a);if(!d&&this.component&&(d=this.component.instanceFactory(this.container,{instanceIdentifier:(c=a)===H?void 0:c,options:b}),this.instances.set(a,d),this.instancesOptions.set(a,b),this.invokeOnInitCallbacks(d,a),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,a,d)}catch{}return d||null}normalizeInstanceIdentifier(a=H){return this.component?this.component.multipleInstances?a:H:a}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class J{constructor(a){this.name=a,this.providers=new Map}addComponent(a){let b=this.getProvider(a.name);if(b.isComponentSet())throw Error(`Component ${a.name} has already been registered with ${this.name}`);b.setComponent(a)}addOrOverwriteComponent(a){this.getProvider(a.name).isComponentSet()&&this.providers.delete(a.name),this.addComponent(a)}getProvider(a){if(this.providers.has(a))return this.providers.get(a);let b=new I(a,this);return this.providers.set(a,b),b}getProviders(){return Array.from(this.providers.values())}}let K=[];(aQ=aR||(aR={}))[aQ.DEBUG=0]="DEBUG",aQ[aQ.VERBOSE=1]="VERBOSE",aQ[aQ.INFO=2]="INFO",aQ[aQ.WARN=3]="WARN",aQ[aQ.ERROR=4]="ERROR",aQ[aQ.SILENT=5]="SILENT";let L={debug:aR.DEBUG,verbose:aR.VERBOSE,info:aR.INFO,warn:aR.WARN,error:aR.ERROR,silent:aR.SILENT},M=aR.INFO,N={[aR.DEBUG]:"log",[aR.VERBOSE]:"log",[aR.INFO]:"info",[aR.WARN]:"warn",[aR.ERROR]:"error"},O=(a,b,...c)=>{if(b<a.logLevel)return;let d=new Date().toISOString(),e=N[b];if(e)console[e](`[${d}]  ${a.name}:`,...c);else throw Error(`Attempted to log a message with an invalid logType (value: ${b})`)};class P{constructor(a){this.name=a,this._logLevel=M,this._logHandler=O,this._userLogHandler=null,K.push(this)}get logLevel(){return this._logLevel}set logLevel(a){if(!(a in aR))throw TypeError(`Invalid value "${a}" assigned to \`logLevel\``);this._logLevel=a}setLogLevel(a){this._logLevel="string"==typeof a?L[a]:a}get logHandler(){return this._logHandler}set logHandler(a){if("function"!=typeof a)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=a}get userLogHandler(){return this._userLogHandler}set userLogHandler(a){this._userLogHandler=a}debug(...a){this._userLogHandler&&this._userLogHandler(this,aR.DEBUG,...a),this._logHandler(this,aR.DEBUG,...a)}log(...a){this._userLogHandler&&this._userLogHandler(this,aR.VERBOSE,...a),this._logHandler(this,aR.VERBOSE,...a)}info(...a){this._userLogHandler&&this._userLogHandler(this,aR.INFO,...a),this._logHandler(this,aR.INFO,...a)}warn(...a){this._userLogHandler&&this._userLogHandler(this,aR.WARN,...a),this._logHandler(this,aR.WARN,...a)}error(...a){this._userLogHandler&&this._userLogHandler(this,aR.ERROR,...a),this._logHandler(this,aR.ERROR,...a)}}let Q=new WeakMap,R=new WeakMap,S=new WeakMap,T=new WeakMap,U=new WeakMap,V={get(a,b,c){if(a instanceof IDBTransaction){if("done"===b)return R.get(a);if("objectStoreNames"===b)return a.objectStoreNames||S.get(a);if("store"===b)return c.objectStoreNames[1]?void 0:c.objectStore(c.objectStoreNames[0])}return W(a[b])},set:(a,b,c)=>(a[b]=c,!0),has:(a,b)=>a instanceof IDBTransaction&&("done"===b||"store"===b)||b in a};function W(a){if(a instanceof IDBRequest){let b;return(b=new Promise((b,c)=>{let d=()=>{a.removeEventListener("success",e),a.removeEventListener("error",f)},e=()=>{b(W(a.result)),d()},f=()=>{c(a.error),d()};a.addEventListener("success",e),a.addEventListener("error",f)})).then(b=>{b instanceof IDBCursor&&Q.set(b,a)}).catch(()=>{}),U.set(b,a),b}if(T.has(a))return T.get(a);let b=function(a){if("function"==typeof a)return a!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(d||(d=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(a)?function(...b){return a.apply(X(this),b),W(Q.get(this))}:function(...b){return W(a.apply(X(this),b))}:function(b,...c){let d=a.call(X(this),b,...c);return S.set(d,b.sort?b.sort():[b]),W(d)};return a instanceof IDBTransaction&&function(a){if(R.has(a))return;let b=new Promise((b,c)=>{let d=()=>{a.removeEventListener("complete",e),a.removeEventListener("error",f),a.removeEventListener("abort",f)},e=()=>{b(),d()},f=()=>{c(a.error||new DOMException("AbortError","AbortError")),d()};a.addEventListener("complete",e),a.addEventListener("error",f),a.addEventListener("abort",f)});R.set(a,b)}(a),(c||(c=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(b=>a instanceof b)?new Proxy(a,V):a}(a);return b!==a&&(T.set(a,b),U.set(b,a)),b}let X=a=>U.get(a),Y=["get","getKey","getAll","getAllKeys","count"],Z=["put","add","delete","clear"],$=new Map;function _(a,b){if(!(a instanceof IDBDatabase&&!(b in a)&&"string"==typeof b))return;if($.get(b))return $.get(b);let c=b.replace(/FromIndex$/,""),d=b!==c,e=Z.includes(c);if(!(c in(d?IDBIndex:IDBObjectStore).prototype)||!(e||Y.includes(c)))return;let f=async function(a,...b){let f=this.transaction(a,e?"readwrite":"readonly"),g=f.store;return d&&(g=g.index(b.shift())),(await Promise.all([g[c](...b),e&&f.done]))[0]};return $.set(b,f),f}V={...b=V,get:(a,c,d)=>_(a,c)||b.get(a,c,d),has:(a,c)=>!!_(a,c)||b.has(a,c)};class aa{constructor(a){this.container=a}getPlatformInfoString(){return this.container.getProviders().map(a=>{let b;if(b=a.getComponent(),b?.type!=="VERSION")return null;{let b=a.getImmediate();return`${b.library}/${b.version}`}}).filter(a=>a).join(" ")}}let ab="@firebase/app",ac="0.14.8",ad=new P("@firebase/app"),ae="[DEFAULT]",af={[ab]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/ai":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},ag=new Map,ah=new Map,ai=new Map;function aj(a,b){try{a.container.addComponent(b)}catch(c){ad.debug(`Component ${b.name} failed to register with FirebaseApp ${a.name}`,c)}}function ak(a,b){a.container.addOrOverwriteComponent(b)}function al(a){let b=a.name;if(ai.has(b))return ad.debug(`There were multiple attempts to register component ${b}.`),!1;for(let c of(ai.set(b,a),ag.values()))aj(c,a);for(let b of ah.values())aj(b,a);return!0}function am(a,b){let c=a.container.getProvider("heartbeat").getImmediate({optional:!0});return c&&c.triggerHeartbeat(),a.container.getProvider(b)}function an(a,b,c=ae){am(a,b).clearInstance(c)}function ao(a){return void 0!==a.options}function ap(a){return!ao(a)&&("authIdToken"in a||"appCheckToken"in a||"releaseOnDeref"in a||"automaticDataCollectionEnabled"in a)}function aq(a){return null!=a&&void 0!==a.settings}function ar(){ai.clear()}let as=new B("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class at{constructor(a,b,c){this._isDeleted=!1,this._options={...a},this._config={...b},this._name=b.name,this._automaticDataCollectionEnabled=b.automaticDataCollectionEnabled,this._container=c,this.container.addComponent(new G("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(a){this.checkDestroyed(),this._automaticDataCollectionEnabled=a}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(a){this._isDeleted=a}checkDestroyed(){if(this.isDeleted)throw as.create("app-deleted",{appName:this._name})}}function au(a,b){let c=n(a.split(".")[1]);null===c?console.error(`FirebaseServerApp ${b} is invalid: second part could not be parsed.`):void 0===JSON.parse(c).exp?console.error(`FirebaseServerApp ${b} is invalid: expiration claim could not be parsed`):1e3*JSON.parse(c).exp-new Date().getTime()<=0&&console.error(`FirebaseServerApp ${b} is invalid: the token has expired.`)}class av extends at{constructor(a,b,c,d){const e=void 0===b.automaticDataCollectionEnabled||b.automaticDataCollectionEnabled,f={name:c,automaticDataCollectionEnabled:e};void 0!==a.apiKey?super(a,f,d):super(a.options,f,d),this._serverConfig={automaticDataCollectionEnabled:e,...b},this._serverConfig.authIdToken&&au(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&au(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,"u">typeof FinalizationRegistry&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,b.releaseOnDeref=void 0,aC(ab,ac,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(a){this.isDeleted||(this._refCount++,void 0!==a&&null!==this._finalizationRegistry&&this._finalizationRegistry.register(a,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){aB(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw as.create("server-app-deleted")}}let aw="12.9.0";function ax(a,b={}){let c=a;"object"!=typeof b&&(b={name:b});let d={name:ae,automaticDataCollectionEnabled:!0,...b},e=d.name;if("string"!=typeof e||!e)throw as.create("bad-app-name",{appName:String(e)});if(c||(c=q()),!c)throw as.create("no-options");let f=ag.get(e);if(f)if(D(c,f.options)&&D(d,f.config))return f;else throw as.create("duplicate-app",{appName:e});let g=new J(e);for(let a of ai.values())g.addComponent(a);let h=new at(c,d,g);return ag.set(e,h),h}function ay(a,b={}){let c;if(w()&&!x())throw as.create("invalid-server-app-environment");let d=b||{};if(a&&(ao(a)?c=a.options:ap(a)?d=a:c=a),void 0===d.automaticDataCollectionEnabled&&(d.automaticDataCollectionEnabled=!0),c||(c=q()),!c)throw as.create("no-options");let e={...d,...c};if(void 0!==e.releaseOnDeref&&delete e.releaseOnDeref,void 0!==d.releaseOnDeref&&"u"<typeof FinalizationRegistry)throw as.create("finalization-registry-not-supported",{});let f=""+[...JSON.stringify(e)].reduce((a,b)=>Math.imul(31,a)+b.charCodeAt(0)|0,0),g=ah.get(f);if(g)return g.incRefCount(d.releaseOnDeref),g;let h=new J(f);for(let a of ai.values())h.addComponent(a);let i=new av(c,d,f,h);return ah.set(f,i),i}function az(a=ae){let b=ag.get(a);if(!b&&a===ae&&q())return ax();if(!b)throw as.create("no-app",{appName:a});return b}function aA(){return Array.from(ag.values())}async function aB(a){let b=!1,c=a.name;ag.has(c)?(b=!0,ag.delete(c)):ah.has(c)&&0>=a.decRefCount()&&(ah.delete(c),b=!0),b&&(await Promise.all(a.container.getProviders().map(a=>a.delete())),a.isDeleted=!0)}function aC(a,b,c){let d=af[a]??a;c&&(d+=`-${c}`);let e=d.match(/\s|\//),f=b.match(/\s|\//);if(e||f){let a=[`Unable to register library "${d}" with version "${b}":`];e&&a.push(`library name "${d}" contains illegal characters (whitespace or "/")`),e&&f&&a.push("and"),f&&a.push(`version name "${b}" contains illegal characters (whitespace or "/")`),ad.warn(a.join(" "));return}al(new G(`${d}-version`,()=>({library:d,version:b}),"VERSION"))}function aD(a,b){if(null!==a&&"function"!=typeof a)throw as.create("invalid-log-argument");for(let c of K){let d=null;b&&b.level&&(d=L[b.level]),null===a?c.userLogHandler=null:c.userLogHandler=(b,c,...e)=>{let f=e.map(a=>{if(null==a)return null;if("string"==typeof a)return a;if("number"==typeof a||"boolean"==typeof a)return a.toString();if(a instanceof Error)return a.message;try{return JSON.stringify(a)}catch(a){return null}}).filter(a=>a).join(" ");c>=(d??b.logLevel)&&a({level:aR[c].toLowerCase(),message:f,args:e,type:b.name})}}}function aE(a){K.forEach(b=>{b.setLogLevel(a)})}let aF="firebase-heartbeat-store",aG=null;function aH(){return aG||(aG=(function(a,b,{blocked:c,upgrade:d,blocking:e,terminated:f}={}){let g=indexedDB.open(a,1),h=W(g);return d&&g.addEventListener("upgradeneeded",a=>{d(W(g.result),a.oldVersion,a.newVersion,W(g.transaction),a)}),c&&g.addEventListener("blocked",a=>c(a.oldVersion,a.newVersion,a)),h.then(a=>{f&&a.addEventListener("close",()=>f()),e&&a.addEventListener("versionchange",a=>e(a.oldVersion,a.newVersion,a))}).catch(()=>{}),h})("firebase-heartbeat-database",0,{upgrade:(a,b)=>{if(0===b)try{a.createObjectStore(aF)}catch(a){console.warn(a)}}}).catch(a=>{throw as.create("idb-open",{originalErrorMessage:a.message})})),aG}async function aI(a){try{let b=(await aH()).transaction(aF),c=await b.objectStore(aF).get(aK(a));return await b.done,c}catch(a){if(a instanceof A)ad.warn(a.message);else{let b=as.create("idb-get",{originalErrorMessage:a?.message});ad.warn(b.message)}}}async function aJ(a,b){try{let c=(await aH()).transaction(aF,"readwrite"),d=c.objectStore(aF);await d.put(b,aK(a)),await c.done}catch(a){if(a instanceof A)ad.warn(a.message);else{let b=as.create("idb-set",{originalErrorMessage:a?.message});ad.warn(b.message)}}}function aK(a){return`${a.name}!${a.options.appId}`}class aL{constructor(a){this.container=a,this._heartbeatsCache=null;const b=this.container.getProvider("app").getImmediate();this._storage=new aN(b),this._heartbeatsCachePromise=this._storage.read().then(a=>(this._heartbeatsCache=a,a))}async triggerHeartbeat(){try{let a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),b=aM();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===b||this._heartbeatsCache.heartbeats.some(a=>a.date===b))return;if(this._heartbeatsCache.heartbeats.push({date:b,agent:a}),this._heartbeatsCache.heartbeats.length>30){let a=function(a){if(0===a.length)return -1;let b=0,c=a[0].date;for(let d=1;d<a.length;d++)a[d].date<c&&(c=a[d].date,b=d);return b}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(a){ad.warn(a)}}async getHeartbeatsHeader(){try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||0===this._heartbeatsCache.heartbeats.length)return"";let a=aM(),{heartbeatsToSend:b,unsentEntries:c}=function(a,b=1024){let c=[],d=a.slice();for(let e of a){let a=c.find(a=>a.agent===e.agent);if(a){if(a.dates.push(e.date),aO(c)>b){a.dates.pop();break}}else if(c.push({agent:e.agent,dates:[e.date]}),aO(c)>b){c.pop();break}d=d.slice(1)}return{heartbeatsToSend:c,unsentEntries:d}}(this._heartbeatsCache.heartbeats),d=m(JSON.stringify({version:2,heartbeats:b}));return this._heartbeatsCache.lastSentHeartbeatDate=a,c.length>0?(this._heartbeatsCache.heartbeats=c,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),d}catch(a){return ad.warn(a),""}}}function aM(){return new Date().toISOString().substring(0,10)}class aN{constructor(a){this.app=a,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!y()&&z().then(()=>!0).catch(()=>!1)}async read(){if(!await this._canUseIndexedDBPromise)return{heartbeats:[]};{let a=await aI(this.app);return a?.heartbeats?a:{heartbeats:[]}}}async overwrite(a){if(await this._canUseIndexedDBPromise){let b=await this.read();return aJ(this.app,{lastSentHeartbeatDate:a.lastSentHeartbeatDate??b.lastSentHeartbeatDate,heartbeats:a.heartbeats})}}async add(a){if(await this._canUseIndexedDBPromise){let b=await this.read();return aJ(this.app,{lastSentHeartbeatDate:a.lastSentHeartbeatDate??b.lastSentHeartbeatDate,heartbeats:[...b.heartbeats,...a.heartbeats]})}}}function aO(a){return m(JSON.stringify({version:2,heartbeats:a})).length}al(new G("platform-logger",a=>new aa(a),"PRIVATE")),al(new G("heartbeat",a=>new aL(a),"PRIVATE")),aC(ab,ac,""),aC(ab,ac,"esm2020"),aC("fire-js",""),a.s(["SDK_VERSION",()=>aw,"_DEFAULT_ENTRY_NAME",()=>ae,"_addComponent",()=>aj,"_addOrOverwriteComponent",()=>ak,"_apps",()=>ag,"_clearComponents",()=>ar,"_components",()=>ai,"_getProvider",()=>am,"_isFirebaseApp",()=>ao,"_isFirebaseServerApp",()=>aq,"_isFirebaseServerAppSettings",()=>ap,"_registerComponent",()=>al,"_removeServiceInstance",()=>an,"_serverApps",()=>ah,"deleteApp",()=>aB,"getApp",()=>az,"getApps",()=>aA,"initializeApp",()=>ax,"initializeServerApp",()=>ay,"onLog",()=>aD,"registerVersion",()=>aC,"setLogLevel",()=>aE],11481);var aP,aQ,aR,aS,aT,aU=a.i(54799),aV=a.i(24361),aW="u">typeof globalThis?globalThis:a.g,aX={};(function(){function a(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.C=Array(this.blockSize),this.o=this.h=0,this.u()}var b=function(){this.blockSize=-1};function c(){}function d(a,b,c){c||(c=0);let d=Array(16);if("string"==typeof b)for(var e=0;e<16;++e)d[e]=b.charCodeAt(c++)|b.charCodeAt(c++)<<8|b.charCodeAt(c++)<<16|b.charCodeAt(c++)<<24;else for(e=0;e<16;++e)d[e]=b[c++]|b[c++]<<8|b[c++]<<16|b[c++]<<24;b=a.g[0],c=a.g[1],e=a.g[2];let f=a.g[3],g;g=b+(f^c&(e^f))+d[0]+0xd76aa478|0,g=f+(e^(b=c+(g<<7|g>>>25))&(c^e))+d[1]+0xe8c7b756|0,g=e+(c^(f=b+(g<<12|g>>>20))&(b^c))+d[2]+0x242070db|0,g=c+(b^(e=f+(g<<17|g>>>15))&(f^b))+d[3]+0xc1bdceee|0,g=b+(f^(c=e+(g<<22|g>>>10))&(e^f))+d[4]+0xf57c0faf|0,g=f+(e^(b=c+(g<<7|g>>>25))&(c^e))+d[5]+0x4787c62a|0,g=e+(c^(f=b+(g<<12|g>>>20))&(b^c))+d[6]+0xa8304613|0,g=c+(b^(e=f+(g<<17|g>>>15))&(f^b))+d[7]+0xfd469501|0,g=b+(f^(c=e+(g<<22|g>>>10))&(e^f))+d[8]+0x698098d8|0,g=f+(e^(b=c+(g<<7|g>>>25))&(c^e))+d[9]+0x8b44f7af|0,g=e+(c^(f=b+(g<<12|g>>>20))&(b^c))+d[10]+0xffff5bb1|0,g=c+(b^(e=f+(g<<17|g>>>15))&(f^b))+d[11]+0x895cd7be|0,g=b+(f^(c=e+(g<<22|g>>>10))&(e^f))+d[12]+0x6b901122|0,g=f+(e^(b=c+(g<<7|g>>>25))&(c^e))+d[13]+0xfd987193|0,g=e+(c^(f=b+(g<<12|g>>>20))&(b^c))+d[14]+0xa679438e|0,g=c+(b^(e=f+(g<<17|g>>>15))&(f^b))+d[15]+0x49b40821|0,c=e+(g<<22|g>>>10),g=b+(e^f&(c^e))+d[1]+0xf61e2562|0,b=c+(g<<5|g>>>27),g=f+(c^e&(b^c))+d[6]+0xc040b340|0,f=b+(g<<9|g>>>23),g=e+(b^c&(f^b))+d[11]+0x265e5a51|0,e=f+(g<<14|g>>>18),g=c+(f^b&(e^f))+d[0]+0xe9b6c7aa|0,c=e+(g<<20|g>>>12),g=b+(e^f&(c^e))+d[5]+0xd62f105d|0,b=c+(g<<5|g>>>27),g=f+(c^e&(b^c))+d[10]+0x2441453|0,f=b+(g<<9|g>>>23),g=e+(b^c&(f^b))+d[15]+0xd8a1e681|0,e=f+(g<<14|g>>>18),g=c+(f^b&(e^f))+d[4]+0xe7d3fbc8|0,c=e+(g<<20|g>>>12),g=b+(e^f&(c^e))+d[9]+0x21e1cde6|0,b=c+(g<<5|g>>>27),g=f+(c^e&(b^c))+d[14]+0xc33707d6|0,f=b+(g<<9|g>>>23),g=e+(b^c&(f^b))+d[3]+0xf4d50d87|0,e=f+(g<<14|g>>>18),g=c+(f^b&(e^f))+d[8]+0x455a14ed|0,c=e+(g<<20|g>>>12),g=b+(e^f&(c^e))+d[13]+0xa9e3e905|0,b=c+(g<<5|g>>>27),g=f+(c^e&(b^c))+d[2]+0xfcefa3f8|0,f=b+(g<<9|g>>>23),g=e+(b^c&(f^b))+d[7]+0x676f02d9|0,e=f+(g<<14|g>>>18),g=c+(f^b&(e^f))+d[12]+0x8d2a4c8a|0,g=b+((c=e+(g<<20|g>>>12))^e^f)+d[5]+0xfffa3942|0,g=f+((b=c+(g<<4|g>>>28))^c^e)+d[8]+0x8771f681|0,g=e+((f=b+(g<<11|g>>>21))^b^c)+d[11]+0x6d9d6122|0,g=c+((e=f+(g<<16|g>>>16))^f^b)+d[14]+0xfde5380c|0,g=b+((c=e+(g<<23|g>>>9))^e^f)+d[1]+0xa4beea44|0,g=f+((b=c+(g<<4|g>>>28))^c^e)+d[4]+0x4bdecfa9|0,g=e+((f=b+(g<<11|g>>>21))^b^c)+d[7]+0xf6bb4b60|0,g=c+((e=f+(g<<16|g>>>16))^f^b)+d[10]+0xbebfbc70|0,g=b+((c=e+(g<<23|g>>>9))^e^f)+d[13]+0x289b7ec6|0,g=f+((b=c+(g<<4|g>>>28))^c^e)+d[0]+0xeaa127fa|0,g=e+((f=b+(g<<11|g>>>21))^b^c)+d[3]+0xd4ef3085|0,g=c+((e=f+(g<<16|g>>>16))^f^b)+d[6]+0x4881d05|0,g=b+((c=e+(g<<23|g>>>9))^e^f)+d[9]+0xd9d4d039|0,g=f+((b=c+(g<<4|g>>>28))^c^e)+d[12]+0xe6db99e5|0,g=e+((f=b+(g<<11|g>>>21))^b^c)+d[15]+0x1fa27cf8|0,g=c+((e=f+(g<<16|g>>>16))^f^b)+d[2]+0xc4ac5665|0,c=e+(g<<23|g>>>9),g=b+(e^(c|~f))+d[0]+0xf4292244|0,b=c+(g<<6|g>>>26),g=f+(c^(b|~e))+d[7]+0x432aff97|0,f=b+(g<<10|g>>>22),g=e+(b^(f|~c))+d[14]+0xab9423a7|0,e=f+(g<<15|g>>>17),g=c+(f^(e|~b))+d[5]+0xfc93a039|0,c=e+(g<<21|g>>>11),g=b+(e^(c|~f))+d[12]+0x655b59c3|0,b=c+(g<<6|g>>>26),g=f+(c^(b|~e))+d[3]+0x8f0ccc92|0,f=b+(g<<10|g>>>22),g=e+(b^(f|~c))+d[10]+0xffeff47d|0,e=f+(g<<15|g>>>17),g=c+(f^(e|~b))+d[1]+0x85845dd1|0,c=e+(g<<21|g>>>11),g=b+(e^(c|~f))+d[8]+0x6fa87e4f|0,b=c+(g<<6|g>>>26),g=f+(c^(b|~e))+d[15]+0xfe2ce6e0|0,f=b+(g<<10|g>>>22),g=e+(b^(f|~c))+d[6]+0xa3014314|0,e=f+(g<<15|g>>>17),g=c+(f^(e|~b))+d[13]+0x4e0811a1|0,c=e+(g<<21|g>>>11),g=b+(e^(c|~f))+d[4]+0xf7537e82|0,b=c+(g<<6|g>>>26),g=f+(c^(b|~e))+d[11]+0xbd3af235|0,f=b+(g<<10|g>>>22),g=e+(b^(f|~c))+d[2]+0x2ad7d2bb|0,e=f+(g<<15|g>>>17),g=c+(f^(e|~b))+d[9]+0xeb86d391|0,a.g[0]=a.g[0]+b|0,a.g[1]=a.g[1]+(e+(g<<21|g>>>11))|0,a.g[2]=a.g[2]+e|0,a.g[3]=a.g[3]+f|0}function e(a,b){this.h=b;let c=[],d=!0;for(let e=a.length-1;e>=0;e--){let f=0|a[e];d&&f==b||(c[e]=f,d=!1)}this.g=c}c.prototype=b.prototype,a.F=b.prototype,a.prototype=new c,a.prototype.constructor=a,a.D=function(a,c,d){for(var e=Array(arguments.length-2),f=2;f<arguments.length;f++)e[f-2]=arguments[f];return b.prototype[c].apply(a,e)},a.prototype.u=function(){this.g[0]=0x67452301,this.g[1]=0xefcdab89,this.g[2]=0x98badcfe,this.g[3]=0x10325476,this.o=this.h=0},a.prototype.v=function(a,b){void 0===b&&(b=a.length);let c=b-this.blockSize,e=this.C,f=this.h,g=0;for(;g<b;){if(0==f)for(;g<=c;)d(this,a,g),g+=this.blockSize;if("string"==typeof a){for(;g<b;)if(e[f++]=a.charCodeAt(g++),f==this.blockSize){d(this,e),f=0;break}}else for(;g<b;)if(e[f++]=a[g++],f==this.blockSize){d(this,e),f=0;break}}this.h=f,this.o+=b},a.prototype.A=function(){var a=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);a[0]=128;for(var b=1;b<a.length-8;++b)a[b]=0;b=8*this.o;for(var c=a.length-8;c<a.length;++c)a[c]=255&b,b/=256;for(this.v(a),a=Array(16),b=0,c=0;c<4;++c)for(let d=0;d<32;d+=8)a[b++]=this.g[c]>>>d&255;return a};var f,g={};function h(a){var b;return -128<=a&&a<128?(b=function(a){return new e([0|a],a<0?-1:0)},Object.prototype.hasOwnProperty.call(g,a)?g[a]:g[a]=b(a)):new e([0|a],a<0?-1:0)}function i(a){if(isNaN(a)||!isFinite(a))return j;if(a<0)return o(i(-a));let b=[],c=1;for(let d=0;a>=c;d++)b[d]=a/c|0,c*=0x100000000;return new e(b,0)}var j=h(0),k=h(1),l=h(0x1000000);function m(a){if(0!=a.h)return!1;for(let b=0;b<a.g.length;b++)if(0!=a.g[b])return!1;return!0}function n(a){return -1==a.h}function o(a){let b=a.g.length,c=[];for(let d=0;d<b;d++)c[d]=~a.g[d];return new e(c,~a.h).add(k)}function p(a,b){return a.add(o(b))}function q(a,b){for(;(65535&a[b])!=a[b];)a[b+1]+=a[b]>>>16,a[b]&=65535,b++}function r(a,b){this.g=a,this.h=b}function s(a,b){if(m(b))throw Error("division by zero");if(m(a))return new r(j,j);if(n(a))return b=s(o(a),b),new r(o(b.g),o(b.h));if(n(b))return b=s(a,o(b)),new r(o(b.g),b.h);if(a.g.length>30){if(n(a)||n(b))throw Error("slowDivide_ only works with positive integers.");for(var c=k,d=b;0>=d.l(a);)c=t(c),d=t(d);var e=u(c,1),f=u(d,1);for(d=u(d,2),c=u(c,2);!m(d);){var g=f.add(d);0>=g.l(a)&&(e=e.add(c),f=g),d=u(d,1),c=u(c,1)}return b=p(a,e.j(b)),new r(e,b)}for(e=j;a.l(b)>=0;){for(d=(d=Math.ceil(Math.log(c=Math.max(1,Math.floor(a.m()/b.m())))/Math.LN2))<=48?1:Math.pow(2,d-48),g=(f=i(c)).j(b);n(g)||g.l(a)>0;)c-=d,g=(f=i(c)).j(b);m(f)&&(f=k),e=e.add(f),a=p(a,g)}return new r(e,a)}function t(a){let b=a.g.length+1,c=[];for(let d=0;d<b;d++)c[d]=a.i(d)<<1|a.i(d-1)>>>31;return new e(c,a.h)}function u(a,b){let c=b>>5;b%=32;let d=a.g.length-c,f=[];for(let e=0;e<d;e++)f[e]=b>0?a.i(e+c)>>>b|a.i(e+c+1)<<32-b:a.i(e+c);return new e(f,a.h)}(f=e.prototype).m=function(){if(n(this))return-o(this).m();let a=0,b=1;for(let c=0;c<this.g.length;c++){let d=this.i(c);a+=(d>=0?d:0x100000000+d)*b,b*=0x100000000}return a},f.toString=function(a){if((a=a||10)<2||36<a)throw Error("radix out of range: "+a);if(m(this))return"0";if(n(this))return"-"+o(this).toString(a);let b=i(Math.pow(a,6));var c=this;let d="";for(;;){let e=s(c,b).g,f=(((c=p(c,e.j(b))).g.length>0?c.g[0]:c.h)>>>0).toString(a);if(m(c=e))return f+d;for(;f.length<6;)f="0"+f;d=f+d}},f.i=function(a){return a<0?0:a<this.g.length?this.g[a]:this.h},f.l=function(a){return n(a=p(this,a))?-1:+!m(a)},f.abs=function(){return n(this)?o(this):this},f.add=function(a){let b=Math.max(this.g.length,a.g.length),c=[],d=0;for(let e=0;e<=b;e++){let b=d+(65535&this.i(e))+(65535&a.i(e)),f=(b>>>16)+(this.i(e)>>>16)+(a.i(e)>>>16);d=f>>>16,b&=65535,f&=65535,c[e]=f<<16|b}return new e(c,-0x80000000&c[c.length-1]?-1:0)},f.j=function(a){if(m(this)||m(a))return j;if(n(this))return n(a)?o(this).j(o(a)):o(o(this).j(a));if(n(a))return o(this.j(o(a)));if(0>this.l(l)&&0>a.l(l))return i(this.m()*a.m());let b=this.g.length+a.g.length,c=[];for(var d=0;d<2*b;d++)c[d]=0;for(d=0;d<this.g.length;d++)for(let b=0;b<a.g.length;b++){let e=this.i(d)>>>16,f=65535&this.i(d),g=a.i(b)>>>16,h=65535&a.i(b);c[2*d+2*b]+=f*h,q(c,2*d+2*b),c[2*d+2*b+1]+=e*h,q(c,2*d+2*b+1),c[2*d+2*b+1]+=f*g,q(c,2*d+2*b+1),c[2*d+2*b+2]+=e*g,q(c,2*d+2*b+2)}for(a=0;a<b;a++)c[a]=c[2*a+1]<<16|c[2*a];for(a=b;a<2*b;a++)c[a]=0;return new e(c,0)},f.B=function(a){return s(this,a).h},f.and=function(a){let b=Math.max(this.g.length,a.g.length),c=[];for(let d=0;d<b;d++)c[d]=this.i(d)&a.i(d);return new e(c,this.h&a.h)},f.or=function(a){let b=Math.max(this.g.length,a.g.length),c=[];for(let d=0;d<b;d++)c[d]=this.i(d)|a.i(d);return new e(c,this.h|a.h)},f.xor=function(a){let b=Math.max(this.g.length,a.g.length),c=[];for(let d=0;d<b;d++)c[d]=this.i(d)^a.i(d);return new e(c,this.h^a.h)},a.prototype.digest=a.prototype.A,a.prototype.reset=a.prototype.u,a.prototype.update=a.prototype.v,aX.Md5=a,e.prototype.add=e.prototype.add,e.prototype.multiply=e.prototype.j,e.prototype.modulo=e.prototype.B,e.prototype.compare=e.prototype.l,e.prototype.toNumber=e.prototype.m,e.prototype.toString=e.prototype.toString,e.prototype.getBits=e.prototype.i,e.fromNumber=i,e.fromString=function a(b,c){if(0==b.length)throw Error("number format error: empty string");if((c=c||10)<2||36<c)throw Error("radix out of range: "+c);if("-"==b.charAt(0))return o(a(b.substring(1),c));if(b.indexOf("-")>=0)throw Error('number format error: interior "-" character');let d=i(Math.pow(c,8)),e=j;for(let a=0;a<b.length;a+=8){var f=Math.min(8,b.length-a);let g=parseInt(b.substring(a,a+f),c);f<8?(f=i(Math.pow(c,f)),e=e.j(f).add(i(g))):e=(e=e.j(d)).add(i(g))}return e},aS=aX.Integer=e}).apply(void 0!==aW?aW:"u">typeof self?self:{});class aY{constructor(a){this.uid=a}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(a){return a.uid===this.uid}}aY.UNAUTHENTICATED=new aY(null),aY.GOOGLE_CREDENTIALS=new aY("google-credentials-uid"),aY.FIRST_PARTY=new aY("first-party-uid"),aY.MOCK_USER=new aY("mock-user");let aZ="12.9.0",a$=new P("@firebase/firestore");function a_(a,...b){if(a$.logLevel<=aR.DEBUG){let c=b.map(a2);a$.debug(`Firestore (${aZ}): ${a}`,...c)}}function a0(a,...b){if(a$.logLevel<=aR.ERROR){let c=b.map(a2);a$.error(`Firestore (${aZ}): ${a}`,...c)}}function a1(a,...b){if(a$.logLevel<=aR.WARN){let c=b.map(a2);a$.warn(`Firestore (${aZ}): ${a}`,...c)}}function a2(a){if("string"==typeof a)return a;try{return(0,aV.inspect)(a,{depth:100})}catch(b){return a}}function a3(a,b,c){let d="Unexpected state";"string"==typeof b?d=b:c=b,a4(a,d,c)}function a4(a,b,c){let d=`FIRESTORE (${aZ}) INTERNAL ASSERTION FAILED: ${b} (ID: ${a.toString(16)})`;if(void 0!==c)try{let a=JSON.stringify(c);d+=" CONTEXT: "+a}catch(a){d+=" CONTEXT: "+c}throw a0(d),Error(d)}function a5(a,b,c,d){let e="Unexpected state";"string"==typeof c?e=c:d=c,a||a4(b,e,d)}let a6="cancelled",a7="unknown",a8="invalid-argument",a9="deadline-exceeded",ba="not-found",bb="permission-denied",bc="unauthenticated",bd="resource-exhausted",be="failed-precondition",bf="aborted",bg="out-of-range",bh="unimplemented",bi="internal",bj="unavailable";class bk extends A{constructor(a,b){super(a,b),this.code=a,this.message=b,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class bl{constructor(a,b){this.user=b,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${a}`)}}class bm{getToken(){return Promise.resolve(null)}invalidateToken(){}start(a,b){a.enqueueRetryable(()=>b(aY.UNAUTHENTICATED))}shutdown(){}}class bn{constructor(a){this.token=a,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(a,b){this.changeListener=b,a.enqueueRetryable(()=>b(this.token.user))}shutdown(){this.changeListener=null}}class bo{constructor(a){this.auth=null,a.onInit(a=>{this.auth=a})}getToken(){return this.auth?this.auth.getToken().then(a=>a?(a5("string"==typeof a.accessToken,42297,{tokenData:a}),new bl(a.accessToken,new aY(this.auth.getUid()))):null):Promise.resolve(null)}invalidateToken(){}start(a,b){}shutdown(){}}class bp{constructor(a,b,c){this.sessionIndex=a,this.iamToken=b,this.authTokenFactory=c,this.type="FirstParty",this.user=aY.FIRST_PARTY,this._headers=new Map}getAuthToken(){return this.authTokenFactory?this.authTokenFactory():null}get headers(){this._headers.set("X-Goog-AuthUser",this.sessionIndex);let a=this.getAuthToken();return a&&this._headers.set("Authorization",a),this.iamToken&&this._headers.set("X-Goog-Iam-Authorization-Token",this.iamToken),this._headers}}class bq{constructor(a,b,c){this.sessionIndex=a,this.iamToken=b,this.authTokenFactory=c}getToken(){return Promise.resolve(new bp(this.sessionIndex,this.iamToken,this.authTokenFactory))}start(a,b){a.enqueueRetryable(()=>b(aY.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class br{constructor(a){this.value=a,this.type="AppCheck",this.headers=new Map,a&&a.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class bs{constructor(a,b){this.appCheckProvider=b,this.appCheck=null,this.serverAppAppCheckToken=null,aq(a)&&a.settings.appCheckToken&&(this.serverAppAppCheckToken=a.settings.appCheckToken),b.onInit(a=>{this.appCheck=a})}getToken(){return this.serverAppAppCheckToken?Promise.resolve(new br(this.serverAppAppCheckToken)):this.appCheck?this.appCheck.getToken().then(a=>a?(a5("string"==typeof a.token,3470,{tokenResult:a}),new br(a.token)):null):Promise.resolve(null)}invalidateToken(){}start(a,b){}shutdown(){}}class bt{constructor(a,b,c,d,e,f,g,h,i,j,k){this.databaseId=a,this.appId=b,this.persistenceKey=c,this.host=d,this.ssl=e,this.forceLongPolling=f,this.autoDetectLongPolling=g,this.longPollingOptions=h,this.useFetchStreams=i,this.isUsingEmulator=j,this.apiKey=k}}let bu="(default)";class bv{constructor(a,b){this.projectId=a,this.database=b||bu}static empty(){return new bv("","")}get isDefaultDatabase(){return this.database===bu}isEqual(a){return a instanceof bv&&a.projectId===this.projectId&&a.database===this.database}}class bw{static newId(){let a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",b=Math.floor(256/a.length)*a.length,c="";for(;c.length<20;){let d=(0,aU.randomBytes)(40);for(let e=0;e<d.length;++e)c.length<20&&d[e]<b&&(c+=a.charAt(d[e]%a.length))}return c}}function bx(a,b){return a<b?-1:+(a>b)}function by(a,b){let c=Math.min(a.length,b.length);for(let d=0;d<c;d++){let c=a.charAt(d),e=b.charAt(d);if(c!==e)return bz(c)===bz(e)?bx(c,e):bz(c)?1:-1}return bx(a.length,b.length)}function bz(a){let b=a.charCodeAt(0);return b>=55296&&b<=57343}function bA(a,b,c){return a.length===b.length&&a.every((a,d)=>c(a,b[d]))}let bB="__name__";class bC{constructor(a,b,c){void 0===b?b=0:b>a.length&&a3(637,{offset:b,range:a.length}),void 0===c?c=a.length-b:c>a.length-b&&a3(1746,{length:c,range:a.length-b}),this.segments=a,this.offset=b,this.len=c}get length(){return this.len}isEqual(a){return 0===bC.comparator(this,a)}child(a){let b=this.segments.slice(this.offset,this.limit());return a instanceof bC?a.forEach(a=>{b.push(a)}):b.push(a),this.construct(b)}limit(){return this.offset+this.length}popFirst(a){return a=void 0===a?1:a,this.construct(this.segments,this.offset+a,this.length-a)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(a){return this.segments[this.offset+a]}isEmpty(){return 0===this.length}isPrefixOf(a){if(a.length<this.length)return!1;for(let b=0;b<this.length;b++)if(this.get(b)!==a.get(b))return!1;return!0}isImmediateParentOf(a){if(this.length+1!==a.length)return!1;for(let b=0;b<this.length;b++)if(this.get(b)!==a.get(b))return!1;return!0}forEach(a){for(let b=this.offset,c=this.limit();b<c;b++)a(this.segments[b])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(a,b){let c=Math.min(a.length,b.length);for(let d=0;d<c;d++){let c=bC.compareSegments(a.get(d),b.get(d));if(0!==c)return c}return bx(a.length,b.length)}static compareSegments(a,b){let c=bC.isNumericId(a),d=bC.isNumericId(b);return c&&!d?-1:!c&&d?1:c&&d?bC.extractNumericId(a).compare(bC.extractNumericId(b)):by(a,b)}static isNumericId(a){return a.startsWith("__id")&&a.endsWith("__")}static extractNumericId(a){return aS.fromString(a.substring(4,a.length-2))}}class bD extends bC{construct(a,b,c){return new bD(a,b,c)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...a){let b=[];for(let c of a){if(c.indexOf("//")>=0)throw new bk(a8,`Invalid segment (${c}). Paths must not contain // in them.`);b.push(...c.split("/").filter(a=>a.length>0))}return new bD(b)}static emptyPath(){return new bD([])}}let bE=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class bF extends bC{construct(a,b,c){return new bF(a,b,c)}static isValidIdentifier(a){return bE.test(a)}canonicalString(){return this.toArray().map(a=>(a=a.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),bF.isValidIdentifier(a)||(a="`"+a+"`"),a)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===bB}static keyField(){return new bF([bB])}static fromServerFormat(a){let b=[],c="",d=0,e=()=>{if(0===c.length)throw new bk(a8,`Invalid field path (${a}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);b.push(c),c=""},f=!1;for(;d<a.length;){let b=a[d];if("\\"===b){if(d+1===a.length)throw new bk(a8,"Path has trailing escape character: "+a);let b=a[d+1];if("\\"!==b&&"."!==b&&"`"!==b)throw new bk(a8,"Path has invalid escape sequence: "+a);c+=b,d+=2}else"`"===b?f=!f:"."!==b||f?c+=b:e(),d++}if(e(),f)throw new bk(a8,"Unterminated ` in path: "+a);return new bF(b)}static emptyPath(){return new bF([])}}class bG{constructor(a){this.path=a}static fromPath(a){return new bG(bD.fromString(a))}static fromName(a){return new bG(bD.fromString(a).popFirst(5))}static empty(){return new bG(bD.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(a){return this.path.length>=2&&this.path.get(this.path.length-2)===a}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(a){return null!==a&&0===bD.comparator(this.path,a.path)}toString(){return this.path.toString()}static comparator(a,b){return bD.comparator(a.path,b.path)}static isDocumentKey(a){return a.length%2==0}static fromSegments(a){return new bG(new bD(a.slice()))}}function bH(a,b,c){if(!c)throw new bk(a8,`Function ${a}() cannot be called with an empty ${b}.`)}function bI(a){if(!bG.isDocumentKey(a))throw new bk(a8,`Invalid document reference. Document references must have an even number of segments, but ${a} has ${a.length}.`)}function bJ(a){if(bG.isDocumentKey(a))throw new bk(a8,`Invalid collection reference. Collection references must have an odd number of segments, but ${a} has ${a.length}.`)}function bK(a){return"object"==typeof a&&null!==a&&(Object.getPrototypeOf(a)===Object.prototype||null===Object.getPrototypeOf(a))}function bL(a){if(void 0===a)return"undefined";if(null===a)return"null";if("string"==typeof a)return a.length>20&&(a=`${a.substring(0,20)}...`),JSON.stringify(a);if("number"==typeof a||"boolean"==typeof a)return""+a;if("object"==typeof a)if(a instanceof Array)return"an array";else{var b;let c=(b=a).constructor?b.constructor.name:null;return c?`a custom ${c} object`:"an object"}else if("function"==typeof a)return"a function";else return a3(12329,{type:typeof a})}function bM(a,b){if("_delegate"in a&&(a=a._delegate),!(a instanceof b))if(b.name===a.constructor.name)throw new bk(a8,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");else{let c=bL(a);throw new bk(a8,`Expected type '${b.name}', but it was: ${c}`)}return a}function bN(a){let b={};return void 0!==a.timeoutSeconds&&(b.timeoutSeconds=a.timeoutSeconds),b}let bO=null,bP="RestConnection",bQ={};bQ.BatchGetDocuments="batchGet",bQ.Commit="commit",bQ.RunQuery="runQuery",bQ.RunAggregationQuery="runAggregationQuery",bQ.ExecutePipeline="executePipeline";class bR{get shouldResourcePathBeIncludedInRequest(){return!1}constructor(a){this.databaseInfo=a,this.databaseId=a.databaseId;const b=a.ssl?"https":"http",c=encodeURIComponent(this.databaseId.projectId),d=encodeURIComponent(this.databaseId.database);this.baseUrl=b+"://"+a.host,this.databasePath=`projects/${c}/databases/${d}`,this.requestParams=this.databaseId.database===bu?`project_id=${c}`:`project_id=${c}&database_id=${d}`}invokeRPC(a,b,c,d,e){let f=(null===bO?bO=0x10000000+Math.round(0x80000000*Math.random()):bO++,"0x"+bO.toString(16)),g=this.makeUrl(a,b.toUriEncodedString());a_(bP,`Sending RPC '${a}' ${f}:`,g,c);let h={"google-cloud-resource-prefix":this.databasePath,"x-goog-request-params":this.requestParams};this.modifyHeadersForRequest(h,d,e);let{host:i}=new URL(g),j=s(i);return this.performRPCRequest(a,g,h,c,j).then(b=>(a_(bP,`Received RPC '${a}' ${f}: `,b),b),b=>{throw a1(bP,`RPC '${a}' ${f} failed with error: `,b,"url: ",g,"request:",c),b})}invokeStreamingRPC(a,b,c,d,e,f){return this.invokeRPC(a,b,c,d,e)}modifyHeadersForRequest(a,b,c){a["X-Goog-Api-Client"]="gl-js/ fire/"+aZ,a["Content-Type"]="text/plain",this.databaseInfo.appId&&(a["X-Firebase-GMPID"]=this.databaseInfo.appId),b&&b.headers.forEach((b,c)=>a[c]=b),c&&c.headers.forEach((b,c)=>a[c]=b)}makeUrl(a,b){let c=bQ[a],d=`${this.baseUrl}/v1/${b}:${c}`;return this.databaseInfo.apiKey&&(d=`${d}?key=${encodeURIComponent(this.databaseInfo.apiKey)}`),d}terminate(){}}function bS(a){if(void 0===a)return a0("RPC_ERROR","HTTP error has no status"),a7;switch(a){case 200:return"ok";case 400:return be;case 401:return bc;case 403:return bb;case 404:return ba;case 409:return bf;case 416:return bg;case 429:return bd;case 499:return a6;case 500:return a7;case 501:return bh;case 503:return bj;case 504:return a9;default:if(a>=200&&a<300)return"ok";if(a>=400&&a<500)return be;if(a>=500&&a<600)return bi;return a7}}(aP=aT||(aT={}))[aP.OK=0]="OK",aP[aP.CANCELLED=1]="CANCELLED",aP[aP.UNKNOWN=2]="UNKNOWN",aP[aP.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",aP[aP.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",aP[aP.NOT_FOUND=5]="NOT_FOUND",aP[aP.ALREADY_EXISTS=6]="ALREADY_EXISTS",aP[aP.PERMISSION_DENIED=7]="PERMISSION_DENIED",aP[aP.UNAUTHENTICATED=16]="UNAUTHENTICATED",aP[aP.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",aP[aP.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",aP[aP.ABORTED=10]="ABORTED",aP[aP.OUT_OF_RANGE=11]="OUT_OF_RANGE",aP[aP.UNIMPLEMENTED=12]="UNIMPLEMENTED",aP[aP.INTERNAL=13]="INTERNAL",aP[aP.UNAVAILABLE=14]="UNAVAILABLE",aP[aP.DATA_LOSS=15]="DATA_LOSS";class bT extends bR{openStream(a,b){throw Error("Not supported by FetchConnection")}async performRPCRequest(a,b,c,d,e){let f,g=JSON.stringify(d);try{let a={method:"POST",headers:c,body:g};e&&(a.credentials="include"),f=await fetch(b,a)}catch(a){throw new bk(bS(a.status),"Request failed with error: "+a.statusText)}if(!f.ok){let a=await f.json();Array.isArray(a)&&(a=a[0]);let b=a?.error?.message;throw new bk(bS(f.status),`Request failed with error: ${b??f.statusText}`)}return f.json()}}function bU(a){let b=0;for(let c in a)Object.prototype.hasOwnProperty.call(a,c)&&b++;return b}function bV(a,b){for(let c in a)Object.prototype.hasOwnProperty.call(a,c)&&b(c,a[c])}function bW(a){return 0===a&&1/a==-1/0}class bX{constructor(a){this.binaryString=a}static fromBase64String(a){return new bX(Buffer.from(a,"base64").toString("binary"))}static fromUint8Array(a){return new bX(function(a){let b="";for(let c=0;c<a.length;++c)b+=String.fromCharCode(a[c]);return b}(a))}[Symbol.iterator](){let a=0;return{next:()=>a<this.binaryString.length?{value:this.binaryString.charCodeAt(a++),done:!1}:{value:void 0,done:!0}}}toBase64(){var a;return a=this.binaryString,Buffer.from(a,"binary").toString("base64")}toUint8Array(){var a=this.binaryString;let b=new Uint8Array(a.length);for(let c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b}approximateByteSize(){return 2*this.binaryString.length}compareTo(a){return bx(this.binaryString,a.binaryString)}isEqual(a){return this.binaryString===a.binaryString}}bX.EMPTY_BYTE_STRING=new bX("");let bY=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function bZ(a){if(a5(!!a,39018),"string"==typeof a){let b=0,c=bY.exec(a);if(a5(!!c,46558,{timestamp:a}),c[1]){let a=c[1];b=Number(a=(a+"000000000").substr(0,9))}return{seconds:Math.floor(new Date(a).getTime()/1e3),nanos:b}}return{seconds:b$(a.seconds),nanos:b$(a.nanos)}}function b$(a){return"number"==typeof a?a:"string"==typeof a?Number(a):0}function b_(a){return"string"==typeof a?bX.fromBase64String(a):bX.fromUint8Array(a)}function b0(a,b){let c={typeString:a};return b&&(c.value=b),c}function b1(a,b){let c;if(!bK(a))throw new bk(a8,"JSON must be an object");for(let d in b)if(b[d]){let e=b[d].typeString,f="value"in b[d]?{value:b[d].value}:void 0;if(!(d in a)){c=`JSON missing required field: '${d}'`;break}let g=a[d];if(e&&typeof g!==e){c=`JSON field '${d}' must be a ${e}.`;break}if(void 0!==f&&g!==f.value){c=`Expected '${d}' field to equal '${f.value}'`;break}}if(c)throw new bk(a8,c);return!0}class b2{static now(){return b2.fromMillis(Date.now())}static fromDate(a){return b2.fromMillis(a.getTime())}static fromMillis(a){let b=Math.floor(a/1e3),c=Math.floor((a-1e3*b)*1e6);return new b2(b,c)}constructor(a,b){if(this.seconds=a,this.nanoseconds=b,b<0||b>=1e9)throw new bk(a8,"Timestamp nanoseconds out of range: "+b);if(a<-0xe7791f700||a>=0x3afff44180)throw new bk(a8,"Timestamp seconds out of range: "+a)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(a){return this.seconds===a.seconds?bx(this.nanoseconds,a.nanoseconds):bx(this.seconds,a.seconds)}isEqual(a){return a.seconds===this.seconds&&a.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:b2._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(a){if(b1(a,b2._jsonSchema))return new b2(a.seconds,a.nanoseconds)}valueOf(){return String(this.seconds- -0xe7791f700).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}function b3(a){return(a?.mapValue?.fields||{}).__type__?.stringValue==="server_timestamp"}function b4(a){let b=bZ(a.mapValue.fields.__local_write_time__.timestampValue);return new b2(b.seconds,b.nanos)}b2._jsonSchemaVersion="firestore/timestamp/1.0",b2._jsonSchema={type:b0("string",b2._jsonSchemaVersion),seconds:b0("number"),nanoseconds:b0("number")};let b5="__type__",b6="__max__",b7={},b8="__vector__",b9="value";function ca(a){var b;if("nullValue"in a)return 0;if("booleanValue"in a)return 1;if("integerValue"in a||"doubleValue"in a)return 2;if("timestampValue"in a)return 3;if("stringValue"in a)return 5;if("bytesValue"in a)return 6;if("referenceValue"in a)return 7;if("geoPointValue"in a)return 8;if("arrayValue"in a)return 9;if(!("mapValue"in a))return a3(28295,{value:a});if(b3(a))return 4;if((((a.mapValue||{}).fields||{}).__type__||{}).stringValue===b6)return 0x1fffffffffffff;if(b=a,(b?.mapValue?.fields||{})[b5]?.stringValue===b8)return 10;return 11}function cb(a,b){if(a===b)return!0;let c=ca(a);if(c!==ca(b))return!1;switch(c){case 0:case 0x1fffffffffffff:return!0;case 1:return a.booleanValue===b.booleanValue;case 4:return b4(a).isEqual(b4(b));case 3:var d,e,f,g,h=a,i=b;if("string"==typeof h.timestampValue&&"string"==typeof i.timestampValue&&h.timestampValue.length===i.timestampValue.length)return h.timestampValue===i.timestampValue;let j=bZ(h.timestampValue),k=bZ(i.timestampValue);return j.seconds===k.seconds&&j.nanos===k.nanos;case 5:return a.stringValue===b.stringValue;case 6:return d=a,e=b,b_(d.bytesValue).isEqual(b_(e.bytesValue));case 7:return a.referenceValue===b.referenceValue;case 8:return f=a,g=b,b$(f.geoPointValue.latitude)===b$(g.geoPointValue.latitude)&&b$(f.geoPointValue.longitude)===b$(g.geoPointValue.longitude);case 2:var l=a,m=b;if("integerValue"in l&&"integerValue"in m)return b$(l.integerValue)===b$(m.integerValue);if("doubleValue"in l&&"doubleValue"in m){let a=b$(l.doubleValue),b=b$(m.doubleValue);return a===b?bW(a)===bW(b):isNaN(a)&&isNaN(b)}return!1;case 9:return bA(a.arrayValue.values||[],b.arrayValue.values||[],cb);case 10:case 11:var n=a,o=b;let p=n.mapValue.fields||{},q=o.mapValue.fields||{};if(bU(p)!==bU(q))return!1;for(let a in p)if(p.hasOwnProperty(a)&&(void 0===q[a]||!cb(p[a],q[a])))return!1;return!0;default:return a3(52216,{left:a})}}function cc(a,b){return void 0!==(a.values||[]).find(a=>cb(a,b))}function cd(a,b){var c,d,e,f,g,h,i,j;if(a===b)return 0;let k=ca(a),l=ca(b);if(k!==l)return bx(k,l);switch(k){case 0:case 0x1fffffffffffff:return 0;case 1:return bx(a.booleanValue,b.booleanValue);case 2:let m,n;return c=a,d=b,m=b$(c.integerValue||c.doubleValue),m<(n=b$(d.integerValue||d.doubleValue))?-1:m>n?1:m===n?0:isNaN(m)?isNaN(n)?0:-1:1;case 3:return ce(a.timestampValue,b.timestampValue);case 4:return ce(b4(a),b4(b));case 5:return by(a.stringValue,b.stringValue);case 6:let o,p;return e=a.bytesValue,f=b.bytesValue,o=b_(e),p=b_(f),o.compareTo(p);case 7:return function(a,b){let c=a.split("/"),d=b.split("/");for(let a=0;a<c.length&&a<d.length;a++){let b=bx(c[a],d[a]);if(0!==b)return b}return bx(c.length,d.length)}(a.referenceValue,b.referenceValue);case 8:let q;return g=a.geoPointValue,h=b.geoPointValue,0!==(q=bx(b$(g.latitude),b$(h.latitude)))?q:bx(b$(g.longitude),b$(h.longitude));case 9:return cf(a.arrayValue,b.arrayValue);case 10:let r,s,t,u,v;return i=a.mapValue,j=b.mapValue,r=i.fields||{},s=j.fields||{},t=r[b9]?.arrayValue,u=s[b9]?.arrayValue,0!==(v=bx(t?.values?.length||0,u?.values?.length||0))?v:cf(t,u);case 11:return function(a,b){if(a===b7&&b===b7)return 0;if(a===b7)return 1;if(b===b7)return -1;let c=a.fields||{},d=Object.keys(c),e=b.fields||{},f=Object.keys(e);d.sort(),f.sort();for(let a=0;a<d.length&&a<f.length;++a){let b=by(d[a],f[a]);if(0!==b)return b;let g=cd(c[d[a]],e[f[a]]);if(0!==g)return g}return bx(d.length,f.length)}(a.mapValue,b.mapValue);default:throw a3(23264,{leftType:k})}}function ce(a,b){if("string"==typeof a&&"string"==typeof b&&a.length===b.length)return bx(a,b);let c=bZ(a),d=bZ(b),e=bx(c.seconds,d.seconds);return 0!==e?e:bx(c.nanos,d.nanos)}function cf(a,b){let c=a.values||[],d=b.values||[];for(let a=0;a<c.length&&a<d.length;++a){let b=cd(c[a],d[a]);if(b)return b}return bx(c.length,d.length)}function cg(a,b){return{referenceValue:`projects/${a.projectId}/databases/${a.database}/documents/${b.path.canonicalString()}`}}function ch(a){return!!a&&"arrayValue"in a}function ci(a){return!!a&&"nullValue"in a}function cj(a){return!!a&&"doubleValue"in a&&isNaN(Number(a.doubleValue))}function ck(a){return!!a&&"mapValue"in a}function cl(a){if(a.geoPointValue)return{geoPointValue:{...a.geoPointValue}};if(a.timestampValue&&"object"==typeof a.timestampValue)return{timestampValue:{...a.timestampValue}};if(a.mapValue){let b={mapValue:{fields:{}}};return bV(a.mapValue.fields,(a,c)=>b.mapValue.fields[a]=cl(c)),b}{if(!a.arrayValue)return{...a};let b={arrayValue:{values:[]}};for(let c=0;c<(a.arrayValue.values||[]).length;++c)b.arrayValue.values[c]=cl(a.arrayValue.values[c]);return b}}class cm{constructor(a,b){this.position=a,this.inclusive=b}}function cn(a,b){if(null===a)return null===b;if(null===b||a.inclusive!==b.inclusive||a.position.length!==b.position.length)return!1;for(let c=0;c<a.position.length;c++)if(!cb(a.position[c],b.position[c]))return!1;return!0}class co{}class cp extends co{constructor(a,b,c){super(),this.field=a,this.op=b,this.value=c}static create(a,b,c){if(a.isKeyField())if("in"===b||"not-in"===b)return this.createKeyFieldInFilter(a,b,c);else return new cr(a,b,c);if("array-contains"===b)return new cv(a,c);if("in"===b)return new cw(a,c);if("not-in"===b)return new cx(a,c);if("array-contains-any"===b)return new cy(a,c);else return new cp(a,b,c)}static createKeyFieldInFilter(a,b,c){return"in"===b?new cs(a,c):new ct(a,c)}matches(a){let b=a.data.field(this.field);return"!="===this.op?null!==b&&void 0===b.nullValue&&this.matchesComparison(cd(b,this.value)):null!==b&&ca(this.value)===ca(b)&&this.matchesComparison(cd(b,this.value))}matchesComparison(a){switch(this.op){case"<":return a<0;case"<=":return a<=0;case"==":return 0===a;case"!=":return 0!==a;case">":return a>0;case">=":return a>=0;default:return a3(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class cq extends co{constructor(a,b){super(),this.filters=a,this.op=b,this.memoizedFlattenedFilters=null}static create(a,b){return new cq(a,b)}matches(a){var b;return(b=this,"and"===b.op)?void 0===this.filters.find(b=>!b.matches(a)):void 0!==this.filters.find(b=>b.matches(a))}getFlattenedFilters(){return null!==this.memoizedFlattenedFilters||(this.memoizedFlattenedFilters=this.filters.reduce((a,b)=>a.concat(b.getFlattenedFilters()),[])),this.memoizedFlattenedFilters}getFilters(){return Object.assign([],this.filters)}}class cr extends cp{constructor(a,b,c){super(a,b,c),this.key=bG.fromName(c.referenceValue)}matches(a){let b=bG.comparator(a.key,this.key);return this.matchesComparison(b)}}class cs extends cp{constructor(a,b){super(a,"in",b),this.keys=cu("in",b)}matches(a){return this.keys.some(b=>b.isEqual(a.key))}}class ct extends cp{constructor(a,b){super(a,"not-in",b),this.keys=cu("not-in",b)}matches(a){return!this.keys.some(b=>b.isEqual(a.key))}}function cu(a,b){return(b.arrayValue?.values||[]).map(a=>bG.fromName(a.referenceValue))}class cv extends cp{constructor(a,b){super(a,"array-contains",b)}matches(a){let b=a.data.field(this.field);return ch(b)&&cc(b.arrayValue,this.value)}}class cw extends cp{constructor(a,b){super(a,"in",b)}matches(a){let b=a.data.field(this.field);return null!==b&&cc(this.value.arrayValue,b)}}class cx extends cp{constructor(a,b){super(a,"not-in",b)}matches(a){if(cc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let b=a.data.field(this.field);return null!==b&&void 0===b.nullValue&&!cc(this.value.arrayValue,b)}}class cy extends cp{constructor(a,b){super(a,"array-contains-any",b)}matches(a){let b=a.data.field(this.field);return!!ch(b)&&!!b.arrayValue.values&&b.arrayValue.values.some(a=>cc(this.value.arrayValue,a))}}class cz{constructor(a,b="asc"){this.field=a,this.dir=b}}class cA{static fromTimestamp(a){return new cA(a)}static min(){return new cA(new b2(0,0))}static max(){return new cA(new b2(0x3afff4417f,1e9-1))}constructor(a){this.timestamp=a}compareTo(a){return this.timestamp._compareTo(a.timestamp)}isEqual(a){return this.timestamp.isEqual(a.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class cB{constructor(a,b){this.comparator=a,this.root=b||cD.EMPTY}insert(a,b){return new cB(this.comparator,this.root.insert(a,b,this.comparator).copy(null,null,cD.BLACK,null,null))}remove(a){return new cB(this.comparator,this.root.remove(a,this.comparator).copy(null,null,cD.BLACK,null,null))}get(a){let b=this.root;for(;!b.isEmpty();){let c=this.comparator(a,b.key);if(0===c)return b.value;c<0?b=b.left:c>0&&(b=b.right)}return null}indexOf(a){let b=0,c=this.root;for(;!c.isEmpty();){let d=this.comparator(a,c.key);if(0===d)return b+c.left.size;d<0?c=c.left:(b+=c.left.size+1,c=c.right)}return -1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(a){return this.root.inorderTraversal(a)}forEach(a){this.inorderTraversal((b,c)=>(a(b,c),!1))}toString(){let a=[];return this.inorderTraversal((b,c)=>(a.push(`${b}:${c}`),!1)),`{${a.join(", ")}}`}reverseTraversal(a){return this.root.reverseTraversal(a)}getIterator(){return new cC(this.root,null,this.comparator,!1)}getIteratorFrom(a){return new cC(this.root,a,this.comparator,!1)}getReverseIterator(){return new cC(this.root,null,this.comparator,!0)}getReverseIteratorFrom(a){return new cC(this.root,a,this.comparator,!0)}}class cC{constructor(a,b,c,d){this.isReverse=d,this.nodeStack=[];let e=1;for(;!a.isEmpty();)if(e=b?c(a.key,b):1,b&&d&&(e*=-1),e<0)a=this.isReverse?a.left:a.right;else if(0===e){this.nodeStack.push(a);break}else this.nodeStack.push(a),a=this.isReverse?a.right:a.left}getNext(){let a=this.nodeStack.pop(),b={key:a.key,value:a.value};if(this.isReverse)for(a=a.left;!a.isEmpty();)this.nodeStack.push(a),a=a.right;else for(a=a.right;!a.isEmpty();)this.nodeStack.push(a),a=a.left;return b}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;let a=this.nodeStack[this.nodeStack.length-1];return{key:a.key,value:a.value}}}class cD{constructor(a,b,c,d,e){this.key=a,this.value=b,this.color=null!=c?c:cD.RED,this.left=null!=d?d:cD.EMPTY,this.right=null!=e?e:cD.EMPTY,this.size=this.left.size+1+this.right.size}copy(a,b,c,d,e){return new cD(null!=a?a:this.key,null!=b?b:this.value,null!=c?c:this.color,null!=d?d:this.left,null!=e?e:this.right)}isEmpty(){return!1}inorderTraversal(a){return this.left.inorderTraversal(a)||a(this.key,this.value)||this.right.inorderTraversal(a)}reverseTraversal(a){return this.right.reverseTraversal(a)||a(this.key,this.value)||this.left.reverseTraversal(a)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(a,b,c){let d=this,e=c(a,d.key);return(d=e<0?d.copy(null,null,null,d.left.insert(a,b,c),null):0===e?d.copy(null,b,null,null,null):d.copy(null,null,null,null,d.right.insert(a,b,c))).fixUp()}removeMin(){if(this.left.isEmpty())return cD.EMPTY;let a=this;return a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),(a=a.copy(null,null,null,a.left.removeMin(),null)).fixUp()}remove(a,b){let c,d=this;if(0>b(a,d.key))d.left.isEmpty()||d.left.isRed()||d.left.left.isRed()||(d=d.moveRedLeft()),d=d.copy(null,null,null,d.left.remove(a,b),null);else{if(d.left.isRed()&&(d=d.rotateRight()),d.right.isEmpty()||d.right.isRed()||d.right.left.isRed()||(d=d.moveRedRight()),0===b(a,d.key))if(d.right.isEmpty())return cD.EMPTY;else c=d.right.min(),d=d.copy(c.key,c.value,null,null,d.right.removeMin());d=d.copy(null,null,null,null,d.right.remove(a,b))}return d.fixUp()}isRed(){return this.color}fixUp(){let a=this;return a.right.isRed()&&!a.left.isRed()&&(a=a.rotateLeft()),a.left.isRed()&&a.left.left.isRed()&&(a=a.rotateRight()),a.left.isRed()&&a.right.isRed()&&(a=a.colorFlip()),a}moveRedLeft(){let a=this.colorFlip();return a.right.left.isRed()&&(a=(a=(a=a.copy(null,null,null,null,a.right.rotateRight())).rotateLeft()).colorFlip()),a}moveRedRight(){let a=this.colorFlip();return a.left.left.isRed()&&(a=(a=a.rotateRight()).colorFlip()),a}rotateLeft(){let a=this.copy(null,null,cD.RED,null,this.right.left);return this.right.copy(null,null,this.color,a,null)}rotateRight(){let a=this.copy(null,null,cD.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,a)}colorFlip(){let a=this.left.copy(null,null,!this.left.color,null,null),b=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,a,b)}checkMaxDepth(){return Math.pow(2,this.check())<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw a3(43730,{key:this.key,value:this.value});if(this.right.isRed())throw a3(14113,{key:this.key,value:this.value});let a=this.left.check();if(a===this.right.check())return a+ +!this.isRed();throw a3(27949)}}cD.EMPTY=null,cD.RED=!0,cD.BLACK=!1,cD.EMPTY=new class{constructor(){this.size=0}get key(){throw a3(57766)}get value(){throw a3(16141)}get color(){throw a3(16727)}get left(){throw a3(29726)}get right(){throw a3(36894)}copy(a,b,c,d,e){return this}insert(a,b,c){return new cD(a,b)}remove(a,b){return this}isEmpty(){return!0}inorderTraversal(a){return!1}reverseTraversal(a){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class cE{constructor(a){this.comparator=a,this.data=new cB(this.comparator)}has(a){return null!==this.data.get(a)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(a){return this.data.indexOf(a)}forEach(a){this.data.inorderTraversal((b,c)=>(a(b),!1))}forEachInRange(a,b){let c=this.data.getIteratorFrom(a[0]);for(;c.hasNext();){let d=c.getNext();if(this.comparator(d.key,a[1])>=0)return;b(d.key)}}forEachWhile(a,b){let c;for(c=void 0!==b?this.data.getIteratorFrom(b):this.data.getIterator();c.hasNext();)if(!a(c.getNext().key))return}firstAfterOrEqual(a){let b=this.data.getIteratorFrom(a);return b.hasNext()?b.getNext().key:null}getIterator(){return new cF(this.data.getIterator())}getIteratorFrom(a){return new cF(this.data.getIteratorFrom(a))}add(a){return this.copy(this.data.remove(a).insert(a,!0))}delete(a){return this.has(a)?this.copy(this.data.remove(a)):this}isEmpty(){return this.data.isEmpty()}unionWith(a){let b=this;return b.size<a.size&&(b=a,a=this),a.forEach(a=>{b=b.add(a)}),b}isEqual(a){if(!(a instanceof cE)||this.size!==a.size)return!1;let b=this.data.getIterator(),c=a.data.getIterator();for(;b.hasNext();){let a=b.getNext().key,d=c.getNext().key;if(0!==this.comparator(a,d))return!1}return!0}toArray(){let a=[];return this.forEach(b=>{a.push(b)}),a}toString(){let a=[];return this.forEach(b=>a.push(b)),"SortedSet("+a.toString()+")"}copy(a){let b=new cE(this.comparator);return b.data=a,b}}class cF{constructor(a){this.iter=a}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class cG{constructor(a){this.fields=a,a.sort(bF.comparator)}static empty(){return new cG([])}unionWith(a){let b=new cE(bF.comparator);for(let a of this.fields)b=b.add(a);for(let c of a)b=b.add(c);return new cG(b.toArray())}covers(a){for(let b of this.fields)if(b.isPrefixOf(a))return!0;return!1}isEqual(a){return bA(this.fields,a.fields,(a,b)=>a.isEqual(b))}}class cH{constructor(a){this.value=a}static empty(){return new cH({mapValue:{}})}field(a){if(a.isEmpty())return this.value;{let b=this.value;for(let c=0;c<a.length-1;++c)if(!ck(b=(b.mapValue.fields||{})[a.get(c)]))return null;return(b=(b.mapValue.fields||{})[a.lastSegment()])||null}}set(a,b){this.getFieldsMap(a.popLast())[a.lastSegment()]=cl(b)}setAll(a){let b=bF.emptyPath(),c={},d=[];a.forEach((a,e)=>{if(!b.isImmediateParentOf(e)){let a=this.getFieldsMap(b);this.applyChanges(a,c,d),c={},d=[],b=e.popLast()}a?c[e.lastSegment()]=cl(a):d.push(e.lastSegment())});let e=this.getFieldsMap(b);this.applyChanges(e,c,d)}delete(a){let b=this.field(a.popLast());ck(b)&&b.mapValue.fields&&delete b.mapValue.fields[a.lastSegment()]}isEqual(a){return cb(this.value,a.value)}getFieldsMap(a){let b=this.value;b.mapValue.fields||(b.mapValue={fields:{}});for(let c=0;c<a.length;++c){let d=b.mapValue.fields[a.get(c)];ck(d)&&d.mapValue.fields||(d={mapValue:{fields:{}}},b.mapValue.fields[a.get(c)]=d),b=d}return b.mapValue.fields}applyChanges(a,b,c){for(let d of(bV(b,(b,c)=>a[b]=c),c))delete a[d]}clone(){return new cH(cl(this.value))}}class cI{constructor(a,b,c,d,e,f,g){this.key=a,this.documentType=b,this.version=c,this.readTime=d,this.createTime=e,this.data=f,this.documentState=g}static newInvalidDocument(a){return new cI(a,0,cA.min(),cA.min(),cA.min(),cH.empty(),0)}static newFoundDocument(a,b,c,d){return new cI(a,1,b,cA.min(),c,d,0)}static newNoDocument(a,b){return new cI(a,2,b,cA.min(),cA.min(),cH.empty(),0)}static newUnknownDocument(a,b){return new cI(a,3,b,cA.min(),cA.min(),cH.empty(),2)}convertToFoundDocument(a,b){return this.createTime.isEqual(cA.min())&&(2===this.documentType||0===this.documentType)&&(this.createTime=a),this.version=a,this.documentType=1,this.data=b,this.documentState=0,this}convertToNoDocument(a){return this.version=a,this.documentType=2,this.data=cH.empty(),this.documentState=0,this}convertToUnknownDocument(a){return this.version=a,this.documentType=3,this.data=cH.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=cA.min(),this}setReadTime(a){return this.readTime=a,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(a){return a instanceof cI&&this.key.isEqual(a.key)&&this.version.isEqual(a.version)&&this.documentType===a.documentType&&this.documentState===a.documentState&&this.data.isEqual(a.data)}mutableCopy(){return new cI(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class cJ{constructor(a,b=null,c=[],d=[],e=null,f=null,g=null){this.path=a,this.collectionGroup=b,this.orderBy=c,this.filters=d,this.limit=e,this.startAt=f,this.endAt=g,this.memoizedCanonicalId=null}}function cK(a,b=null,c=[],d=[],e=null,f=null,g=null){return new cJ(a,b,c,d,e,f,g)}class cL{constructor(a,b=null,c=[],d=[],e=null,f="F",g=null,h=null){this.path=a,this.collectionGroup=b,this.explicitOrderBy=c,this.filters=d,this.limit=e,this.limitType=f,this.startAt=g,this.endAt=h,this.memoizedNormalizedOrderBy=null,this.memoizedTarget=null,this.memoizedAggregateTarget=null,this.startAt,this.endAt}}function cM(a){return a.memoizedTarget||(a.memoizedTarget=cN(a,function(a){if(null===a.memoizedNormalizedOrderBy){let b;a.memoizedNormalizedOrderBy=[];let c=new Set;for(let b of a.explicitOrderBy)a.memoizedNormalizedOrderBy.push(b),c.add(b.field.canonicalString());let d=a.explicitOrderBy.length>0?a.explicitOrderBy[a.explicitOrderBy.length-1].dir:"asc";(b=new cE(bF.comparator),a.filters.forEach(a=>{a.getFlattenedFilters().forEach(a=>{a.isInequality()&&(b=b.add(a.field))})}),b).forEach(b=>{c.has(b.canonicalString())||b.isKeyField()||a.memoizedNormalizedOrderBy.push(new cz(b,d))}),c.has(bF.keyField().canonicalString())||a.memoizedNormalizedOrderBy.push(new cz(bF.keyField(),d))}return a.memoizedNormalizedOrderBy}(a))),a.memoizedTarget}function cN(a,b){if("F"===a.limitType)return cK(a.path,a.collectionGroup,b,a.filters,a.limit,a.startAt,a.endAt);{b=b.map(a=>{let b="desc"===a.dir?"asc":"desc";return new cz(a.field,b)});let c=a.endAt?new cm(a.endAt.position,a.endAt.inclusive):null,d=a.startAt?new cm(a.startAt.position,a.startAt.inclusive):null;return cK(a.path,a.collectionGroup,b,a.filters,a.limit,c,d)}}function cO(a,b){let c=a.filters.concat([b]);return new cL(a.path,a.collectionGroup,a.explicitOrderBy.slice(),c,a.limit,a.limitType,a.startAt,a.endAt)}function cP(a,b){if(a.useProto3Json){if(isNaN(b))return{doubleValue:"NaN"};else if(b===1/0)return{doubleValue:"Infinity"};else if(b===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:bW(b)?"-0":b}}class cQ{constructor(){this._=void 0}}class cR extends cQ{}class cS extends cQ{constructor(a){super(),this.elements=a}}class cT extends cQ{constructor(a){super(),this.elements=a}}class cU extends cQ{constructor(a,b){super(),this.serializer=a,this.operand=b}}class cV{constructor(a,b){this.updateTime=a,this.exists=b}static none(){return new cV}static exists(a){return new cV(void 0,a)}static updateTime(a){return new cV(a)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(a){return this.exists===a.exists&&(this.updateTime?!!a.updateTime&&this.updateTime.isEqual(a.updateTime):!a.updateTime)}}class cW{}class cX extends cW{constructor(a,b,c,d=[]){super(),this.key=a,this.value=b,this.precondition=c,this.fieldTransforms=d,this.type=0}getFieldMask(){return null}}class cY extends cW{constructor(a,b,c,d,e=[]){super(),this.key=a,this.data=b,this.fieldMask=c,this.precondition=d,this.fieldTransforms=e,this.type=1}getFieldMask(){return this.fieldMask}}class cZ extends cW{constructor(a,b){super(),this.key=a,this.precondition=b,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class c$ extends cW{constructor(a,b){super(),this.key=a,this.precondition=b,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}let c_=((e={}).asc="ASCENDING",e.desc="DESCENDING",e),c0=((f={})["<"]="LESS_THAN",f["<="]="LESS_THAN_OR_EQUAL",f[">"]="GREATER_THAN",f[">="]="GREATER_THAN_OR_EQUAL",f["=="]="EQUAL",f["!="]="NOT_EQUAL",f["array-contains"]="ARRAY_CONTAINS",f.in="IN",f["not-in"]="NOT_IN",f["array-contains-any"]="ARRAY_CONTAINS_ANY",f),c1=((g={}).and="AND",g.or="OR",g);function c2(a,b){}class c3{constructor(a,b){this.databaseId=a,this.useProto3Json=b}}function c4(a,b){if(!a.useProto3Json)return{seconds:""+b.seconds,nanos:b.nanoseconds};{let a=new Date(1e3*b.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),c=("000000000"+b.nanoseconds).slice(-9);return`${a}.${c}Z`}}function c5(a){let b;return a5(!!a,49232),cA.fromTimestamp(new b2((b=bZ(a)).seconds,b.nanos))}function c6(a,b){return c7(a,b).canonicalString()}function c7(a,b){var c;let d=new bD(["projects",(c=a).projectId,"databases",c.database]).child("documents");return void 0===b?d:d.child(b)}function c8(a,b){return c6(a.databaseId,b.path)}function c9(a,b){var c;let d,e=(a5(dd(d=bD.fromString(b)),10190,{key:d.toString()}),d);if(e.get(1)!==a.databaseId.projectId)throw new bk(a8,"Tried to deserialize key from different project: "+e.get(1)+" vs "+a.databaseId.projectId);if(e.get(3)!==a.databaseId.database)throw new bk(a8,"Tried to deserialize key from different database: "+e.get(3)+" vs "+a.databaseId.database);return new bG((a5((c=e).length>4&&"documents"===c.get(4),29091,{key:c.toString()}),c.popFirst(5)))}function da(a,b,c){return{name:c8(a,b),fields:c.value.mapValue.fields}}function db(a,b){var c,d,e,f;let g,h={structuredQuery:{}},i=b.path;null!==b.collectionGroup?(g=i,h.structuredQuery.from=[{collectionId:b.collectionGroup,allDescendants:!0}]):(g=i.popLast(),h.structuredQuery.from=[{collectionId:i.lastSegment()}]),c=g,h.parent=c6(a.databaseId,c);let j=function(a){if(0!==a.length)return function a(b){var c;let d;return b instanceof cp?function(a){if("=="===a.op){if(cj(a.value))return{unaryFilter:{field:dc(a.field),op:"IS_NAN"}};else if(ci(a.value))return{unaryFilter:{field:dc(a.field),op:"IS_NULL"}}}else if("!="===a.op){if(cj(a.value))return{unaryFilter:{field:dc(a.field),op:"IS_NOT_NAN"}};else if(ci(a.value))return{unaryFilter:{field:dc(a.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:dc(a.field),op:c0[a.op],value:a.value}}}(b):b instanceof cq?1===(d=(c=b).getFilters().map(b=>a(b))).length?d[0]:{compositeFilter:{op:c1[c.op],filters:d}}:a3(54877,{filter:b})}(cq.create(a,"and"))}(b.filters);j&&(h.structuredQuery.where=j);let k=function(a){if(0!==a.length)return a.map(a=>{var b;return{field:dc((b=a).field),direction:c_[b.dir]}})}(b.orderBy);k&&(h.structuredQuery.orderBy=k);let l=(d=b.limit,a.useProto3Json||null==d?d:{value:d});return null!==l&&(h.structuredQuery.limit=l),b.startAt&&(h.structuredQuery.startAt={before:(e=b.startAt).inclusive,values:e.position}),b.endAt&&(h.structuredQuery.endAt={before:!(f=b.endAt).inclusive,values:f.position}),{queryTarget:h,parent:g}}function dc(a){return{fieldPath:a.canonicalString()}}function dd(a){return a.length>=4&&"projects"===a.get(0)&&"databases"===a.get(2)}function de(a){return!!a&&"function"==typeof a._toProto&&"ProtoValue"===a._protoValueType}function df(a){return new c3(a,!0)}class dg{}class dh extends dg{constructor(a,b,c,d){super(),this.authCredentials=a,this.appCheckCredentials=b,this.connection=c,this.serializer=d,this.terminated=!1}verifyInitialized(){if(this.terminated)throw new bk(be,"The client has already been terminated.")}invokeRPC(a,b,c,d){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([e,f])=>this.connection.invokeRPC(a,c7(b,c),d,e,f)).catch(a=>{if("FirebaseError"===a.name)throw a.code===bc&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a;throw new bk(a7,a.toString())})}invokeStreamingRPC(a,b,c,d,e){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([f,g])=>this.connection.invokeStreamingRPC(a,c7(b,c),d,f,g,e)).catch(a=>{if("FirebaseError"===a.name)throw a.code===bc&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a;throw new bk(a7,a.toString())})}terminate(){this.terminated=!0,this.connection.terminate()}}async function di(a,b){let c={writes:b.map(b=>(function(a,b){var c,d,e;let f;if(b instanceof cX)f={update:da(a,b.key,b.value)};else if(b instanceof cZ)f={delete:c8(a,b.key)};else if(b instanceof cY){let d;f={update:da(a,b.key,b.data),updateMask:(c=b.fieldMask,d=[],c.fields.forEach(a=>d.push(a.canonicalString())),{fieldPaths:d})}}else{if(!(b instanceof c$))return a3(16599,{mutationType:b.type});f={verify:c8(a,b.key)}}return b.fieldTransforms.length>0&&(f.updateTransforms=b.fieldTransforms.map(a=>(function(a,b){let c=b.transform;if(c instanceof cR)return{fieldPath:b.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof cS)return{fieldPath:b.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof cT)return{fieldPath:b.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof cU)return{fieldPath:b.field.canonicalString(),increment:c.operand};throw a3(20930,{transform:b.transform})})(0,a))),b.precondition.isNone||(f.currentDocument=(d=a,void 0!==(e=b.precondition).updateTime?{updateTime:c4(d,e.updateTime.toTimestamp())}:void 0!==e.exists?{exists:e.exists}:a3(27497))),f})(a.serializer,b))};await a.invokeRPC("Commit",a.serializer.databaseId,bD.emptyPath(),c)}async function dj(a,b){let c={documents:b.map(b=>c8(a.serializer,b))},d=await a.invokeStreamingRPC("BatchGetDocuments",a.serializer.databaseId,bD.emptyPath(),c,b.length),e=new Map;d.forEach(b=>{let c=function(a,b){if("found"in b){let c,d,e,f;return a5(!!b.found,43571),c2(b.found.name),c2(b.found.updateTime),c=c9(a,b.found.name),d=c5(b.found.updateTime),e=b.found.createTime?c5(b.found.createTime):cA.min(),f=new cH({mapValue:{fields:b.found.fields}}),cI.newFoundDocument(c,d,e,f)}if("missing"in b){let c,d;return a5(!!b.missing,3894),a5(!!b.readTime,22933),c=c9(a,b.missing),d=c5(b.readTime),cI.newNoDocument(c,d)}return a3(7234,{result:b})}(a.serializer,b);e.set(c.key.toString(),c)});let f=[];return b.forEach(a=>{let b=e.get(a.toString());a5(!!b,55234,{key:a}),f.push(b)}),f}async function dk(a,b){let{queryTarget:c,parent:d}=db(a.serializer,cM(b));return(await a.invokeStreamingRPC("RunQuery",a.serializer.databaseId,d,{structuredQuery:c.structuredQuery})).filter(a=>!!a.document).map(b=>{var c,d,e;let f,g,h,i,j;return c=a.serializer,d=b.document,e=void 0,f=c9(c,d.name),g=c5(d.updateTime),h=d.createTime?c5(d.createTime):cA.min(),i=new cH({mapValue:{fields:d.fields}}),j=cI.newFoundDocument(f,g,h,i),e&&j.setHasCommittedMutations(),e?j.setHasCommittedMutations():j})}async function dl(a,b,c){let{request:d,aliasMap:e,parent:f}=function(a,b,c,d){let{queryTarget:e,parent:f}=db(a,b),g={},h=[],i=0;return c.forEach(a=>{let b=`aggregate_${i++}`;g[b]=a.alias,"count"===a.aggregateType?h.push({alias:b,count:{}}):"avg"===a.aggregateType?h.push({alias:b,avg:{field:dc(a.fieldPath)}}):"sum"===a.aggregateType&&h.push({alias:b,sum:{field:dc(a.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:h,structuredQuery:e.structuredQuery},parent:e.parent},aliasMap:g,parent:f}}(a.serializer,(b.memoizedAggregateTarget||(b.memoizedAggregateTarget=cN(b,b.explicitOrderBy)),b.memoizedAggregateTarget),c);a.connection.shouldResourcePathBeIncludedInRequest||delete d.parent;let g=(await a.invokeStreamingRPC("RunAggregationQuery",a.serializer.databaseId,f,d,1)).filter(a=>!!a.result);a5(1===g.length,64727);let h=g[0].result?.aggregateFields;return Object.keys(h).reduce((a,b)=>(a[e[b]]=h[b],a),{})}let dm="ComponentProvider",dn=new Map;function dp(a){if(a._terminated)throw new bk(be,"The client has already been terminated.");if(!dn.has(a)){var b,c,d,e,f,g;a_(dm,"Initializing Datastore");let h=new bT((c=a._databaseId,d=a.app.options.appId||"",e=a._persistenceKey,f=a.app.options.apiKey,new bt(c,d,e,(g=a._freezeSettings()).host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,bN(g.experimentalLongPollingOptions),g.useFetchStreams,g.isUsingEmulator,f))),i=df(a._databaseId),j=(b=a._authCredentials,new dh(b,a._appCheckCredentials,h,i));dn.set(a,j)}return dn.get(a)}let dq="firestore.googleapis.com";class dr{constructor(a){if(void 0===a.host){if(void 0!==a.ssl)throw new bk(a8,"Can't provide ssl option if host option is not set");this.host=dq,this.ssl=!0}else this.host=a.host,this.ssl=a.ssl??!0;if(this.isUsingEmulator=void 0!==a.emulatorOptions,this.credentials=a.credentials,this.ignoreUndefinedProperties=!!a.ignoreUndefinedProperties,this.localCache=a.localCache,void 0===a.cacheSizeBytes)this.cacheSizeBytes=0x2800000;else if(-1!==a.cacheSizeBytes&&a.cacheSizeBytes<1048576)throw new bk(a8,"cacheSizeBytes must be at least 1048576");else this.cacheSizeBytes=a.cacheSizeBytes;!function(a,b,c,d){if(!0===b&&!0===d)throw new bk(a8,`${a} and ${c} cannot be used together.`)}("experimentalForceLongPolling",a.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",a.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!a.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===a.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!a.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=bN(a.experimentalLongPollingOptions??{}),function(a){if(void 0!==a.timeoutSeconds){if(isNaN(a.timeoutSeconds))throw new bk(a8,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new bk(a8,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new bk(a8,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!a.useFetchStreams}isEqual(a){var b,c;return this.host===a.host&&this.ssl===a.ssl&&this.credentials===a.credentials&&this.cacheSizeBytes===a.cacheSizeBytes&&this.experimentalForceLongPolling===a.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===a.experimentalAutoDetectLongPolling&&(b=this.experimentalLongPollingOptions,c=a.experimentalLongPollingOptions,b.timeoutSeconds===c.timeoutSeconds)&&this.ignoreUndefinedProperties===a.ignoreUndefinedProperties&&this.useFetchStreams===a.useFetchStreams}}class ds{constructor(a,b,c,d){this._authCredentials=a,this._appCheckCredentials=b,this._databaseId=c,this._app=d,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new dr({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new bk(be,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(a){if(this._settingsFrozen)throw new bk(be,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new dr(a),this._emulatorOptions=a.emulatorOptions||{},void 0!==a.credentials&&(this._authCredentials=function(a){if(!a)return new bm;switch(a.type){case"firstParty":return new bq(a.sessionIndex||"0",a.iamToken||null,a.authTokenFactory||null);case"provider":return a.client;default:throw new bk(a8,"makeAuthCredentialsProvider failed due to invalid credential type")}}(a.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){let a;return(a=dn.get(this))&&(a_(dm,"Removing Datastore"),dn.delete(this),a.terminate()),Promise.resolve()}}function dt(a,b){let c=am("object"==typeof a?a:az(),"firestore/lite").getImmediate({identifier:"string"==typeof a?a:b||"(default)"});if(!c._initialized){let a=p("firestore");a&&function(a,b,c,d={}){a=bM(a,ds);let e=s(b),f=a._getSettings(),g={...f,emulatorOptions:a._getEmulatorOptions()},h=`${b}:${c}`;e&&(t(`https://${h}`),v("Firestore",!0)),f.host!==dq&&f.host!==h&&a1("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let i={...f,host:h,ssl:e,emulatorOptions:d};if(!D(i,g)&&(a._setSettings(i),d.mockUserToken)){let b,c;if("string"==typeof d.mockUserToken)b=d.mockUserToken,c=aY.MOCK_USER;else{b=u(d.mockUserToken,a._app?.options.projectId);let e=d.mockUserToken.sub||d.mockUserToken.user_id;if(!e)throw new bk(a8,"mockUserToken must contain 'sub' or 'user_id' field!");c=new aY(e)}a._authCredentials=new bn(new bl(b,c))}}(c,...a)}return c}class du{constructor(a,b,c){this.converter=b,this._query=c,this.type="query",this.firestore=a}withConverter(a){return new du(this.firestore,a,this._query)}}class dv{constructor(a,b,c){this.converter=b,this._key=c,this.type="document",this.firestore=a}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new dw(this.firestore,this.converter,this._key.path.popLast())}withConverter(a){return new dv(this.firestore,a,this._key)}toJSON(){return{type:dv._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(a,b,c){if(b1(b,dv._jsonSchema))return new dv(a,c||null,new bG(bD.fromString(b.referencePath)))}}dv._jsonSchemaVersion="firestore/documentReference/1.0",dv._jsonSchema={type:b0("string",dv._jsonSchemaVersion),referencePath:b0("string")};class dw extends du{constructor(a,b,c){super(a,b,function(a){return new cL(a)}(c)),this._path=c,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let a=this._path.popLast();return a.isEmpty()?null:new dv(this.firestore,null,new bG(a))}withConverter(a){return new dw(this.firestore,a,this._path)}}function dx(a,b,...c){if(a=F(a),bH("collection","path",b),a instanceof ds){let d=bD.fromString(b,...c);return bJ(d),new dw(a,null,d)}{if(!(a instanceof dv)&&!(a instanceof dw))throw new bk(a8,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let d=a._path.child(bD.fromString(b,...c));return bJ(d),new dw(a.firestore,null,d)}}function dy(a,b,...c){if(a=F(a),1==arguments.length&&(b=bw.newId()),bH("doc","path",b),a instanceof ds){let d=bD.fromString(b,...c);return bI(d),new dv(a,null,new bG(d))}{if(!(a instanceof dv)&&!(a instanceof dw))throw new bk(a8,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let d=a._path.child(bD.fromString(b,...c));return bI(d),new dv(a.firestore,a instanceof dw?a.converter:null,new bG(d))}}class dz{constructor(a){this._byteString=a}static fromBase64String(a){try{return new dz(bX.fromBase64String(a))}catch(a){throw new bk(a8,"Failed to construct data from Base64 string: "+a)}}static fromUint8Array(a){return new dz(bX.fromUint8Array(a))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(a){return this._byteString.isEqual(a._byteString)}toJSON(){return{type:dz._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(a){if(b1(a,dz._jsonSchema))return dz.fromBase64String(a.bytes)}}dz._jsonSchemaVersion="firestore/bytes/1.0",dz._jsonSchema={type:b0("string",dz._jsonSchemaVersion),bytes:b0("string")};class dA{constructor(...a){for(let b=0;b<a.length;++b)if(0===a[b].length)throw new bk(a8,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bF(a)}isEqual(a){return this._internalPath.isEqual(a._internalPath)}}class dB{constructor(a){this._methodName=a}}class dC{constructor(a,b){if(!isFinite(a)||a<-90||a>90)throw new bk(a8,"Latitude must be a number between -90 and 90, but was: "+a);if(!isFinite(b)||b<-180||b>180)throw new bk(a8,"Longitude must be a number between -180 and 180, but was: "+b);this._lat=a,this._long=b}get latitude(){return this._lat}get longitude(){return this._long}isEqual(a){return this._lat===a._lat&&this._long===a._long}_compareTo(a){return bx(this._lat,a._lat)||bx(this._long,a._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:dC._jsonSchemaVersion}}static fromJSON(a){if(b1(a,dC._jsonSchema))return new dC(a.latitude,a.longitude)}}dC._jsonSchemaVersion="firestore/geoPoint/1.0",dC._jsonSchema={type:b0("string",dC._jsonSchemaVersion),latitude:b0("number"),longitude:b0("number")};class dD{constructor(a){this._values=(a||[]).map(a=>a)}toArray(){return this._values.map(a=>a)}isEqual(a){return function(a,b){if(a.length!==b.length)return!1;for(let c=0;c<a.length;++c)if(a[c]!==b[c])return!1;return!0}(this._values,a._values)}toJSON(){return{type:dD._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(a){if(b1(a,dD._jsonSchema)){if(Array.isArray(a.vectorValues)&&a.vectorValues.every(a=>"number"==typeof a))return new dD(a.vectorValues);throw new bk(a8,"Expected 'vectorValues' field to be a number array")}}}dD._jsonSchemaVersion="firestore/vectorValue/1.0",dD._jsonSchema={type:b0("string",dD._jsonSchemaVersion),vectorValues:b0("object")};let dE=/^__.*__$/;class dF{constructor(a,b,c){this.data=a,this.fieldMask=b,this.fieldTransforms=c}toMutation(a,b){return null!==this.fieldMask?new cY(a,this.data,this.fieldMask,b,this.fieldTransforms):new cX(a,this.data,b,this.fieldTransforms)}}class dG{constructor(a,b,c){this.data=a,this.fieldMask=b,this.fieldTransforms=c}toMutation(a,b){return new cY(a,this.data,this.fieldMask,b,this.fieldTransforms)}}function dH(a){switch(a){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw a3(40011,{dataSource:a})}}class dI{constructor(a,b,c,d,e,f){this.settings=a,this.databaseId=b,this.serializer=c,this.ignoreUndefinedProperties=d,void 0===e&&this.validatePath(),this.fieldTransforms=e||[],this.fieldMask=f||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(a){return new dI({...this.settings,...a},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(a){let b=this.path?.child(a),c=this.contextWith({path:b,arrayElement:!1});return c.validatePathSegment(a),c}childContextForFieldPath(a){let b=this.path?.child(a),c=this.contextWith({path:b,arrayElement:!1});return c.validatePath(),c}childContextForArray(a){return this.contextWith({path:void 0,arrayElement:!0})}createError(a){return dW(a,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(a){return void 0!==this.fieldMask.find(b=>a.isPrefixOf(b))||void 0!==this.fieldTransforms.find(b=>a.isPrefixOf(b.field))}validatePath(){if(this.path)for(let a=0;a<this.path.length;a++)this.validatePathSegment(this.path.get(a))}validatePathSegment(a){if(0===a.length)throw this.createError("Document fields must not be empty");if(dH(this.dataSource)&&dE.test(a))throw this.createError('Document fields cannot begin and end with "__"')}}class dJ{constructor(a,b,c){this.databaseId=a,this.ignoreUndefinedProperties=b,this.serializer=c||df(a)}createContext(a,b,c,d=!1){return new dI({dataSource:a,methodName:b,targetDoc:c,path:bF.emptyPath(),arrayElement:!1,hasConverter:d},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function dK(a){let b=a._freezeSettings(),c=df(a._databaseId);return new dJ(a._databaseId,!!b.ignoreUndefinedProperties,c)}function dL(a,b,c,d,e,f={}){let g,h,i=a.createContext(f.merge||f.mergeFields?2:0,b,c,e);dS("Data must be an object, but it was:",i,d);let j=dQ(d,i);if(f.merge)g=new cG(i.fieldMask),h=i.fieldTransforms;else if(f.mergeFields){let a=[];for(let d of f.mergeFields){let e=dT(b,d,c);if(!i.contains(e))throw new bk(a8,`Field '${e}' is specified in your field mask but missing from your input data.`);dX(a,e)||a.push(e)}g=new cG(a),h=i.fieldTransforms.filter(a=>g.covers(a.field))}else g=null,h=i.fieldTransforms;return new dF(new cH(j),g,h)}class dM extends dB{_toFieldTransform(a){if(2===a.dataSource)a.fieldMask.push(a.path);else if(1===a.dataSource)throw a.createError(`${this._methodName}() can only appear at the top level of your update data`);else throw a.createError(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return null}isEqual(a){return a instanceof dM}}function dN(a,b,c,d){let e=a.createContext(1,b,c);dS("Data must be an object, but it was:",e,d);let f=[],g=cH.empty();return bV(d,(a,d)=>{let h=dV(b,a,c);d=F(d);let i=e.childContextForFieldPath(h);if(d instanceof dM)f.push(h);else{let a=dP(d,i);null!=a&&(f.push(h),g.set(h,a))}}),new dG(g,new cG(f),e.fieldTransforms)}function dO(a,b,c,d,e,f){let g=a.createContext(1,b,c),h=[dT(b,d,c)],i=[e];if(f.length%2!=0)throw new bk(a8,`Function ${b}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let a=0;a<f.length;a+=2)h.push(dT(b,f[a])),i.push(f[a+1]);let j=[],k=cH.empty();for(let a=h.length-1;a>=0;--a)if(!dX(j,h[a])){let b=h[a],c=i[a];c=F(c);let d=g.childContextForFieldPath(b);if(c instanceof dM)j.push(b);else{let a=dP(c,d);null!=a&&(j.push(b),k.set(b,a))}}return new dG(k,new cG(j),g.fieldTransforms)}function dP(a,b){if(dR(a=F(a)))return dS("Unsupported field value:",b,a),dQ(a,b);if(a instanceof dB)return function(a,b){if(!dH(b.dataSource))throw b.createError(`${a._methodName}() can only be used with update() and set()`);if(!b.path)throw b.createError(`${a._methodName}() is not currently supported inside arrays`);let c=a._toFieldTransform(b);c&&b.fieldTransforms.push(c)}(a,b),null;if(void 0===a&&b.ignoreUndefinedProperties)return null;if(b.path&&b.fieldMask.push(b.path),!(a instanceof Array))return function(a,b){if(null===(a=F(a)))return{nullValue:"NULL_VALUE"};if("number"==typeof a){var c,d,e,f,g=b.serializer,h=a;return"number"==typeof h&&Number.isInteger(h)&&!bW(h)&&h<=Number.MAX_SAFE_INTEGER&&h>=Number.MIN_SAFE_INTEGER?{integerValue:""+h}:cP(g,h)}if("boolean"==typeof a)return{booleanValue:a};if("string"==typeof a)return{stringValue:a};if(a instanceof Date){let c=b2.fromDate(a);return{timestampValue:c4(b.serializer,c)}}else if(a instanceof b2){let c=new b2(a.seconds,1e3*Math.floor(a.nanoseconds/1e3));return{timestampValue:c4(b.serializer,c)}}else if(a instanceof dC)return{geoPointValue:{latitude:a.latitude,longitude:a.longitude}};else if(a instanceof dz)return{bytesValue:(e=b.serializer,f=a._byteString,e.useProto3Json?f.toBase64():f.toUint8Array())};else if(a instanceof dv){let c=b.databaseId,d=a.firestore._databaseId;if(!d.isEqual(c))throw b.createError(`Document reference is for database ${d.projectId}/${d.database} but should be for database ${c.projectId}/${c.database}`);return{referenceValue:c6(a.firestore._databaseId||b.databaseId,a._key.path)}}else if(a instanceof dD){return c=a,d=b,{mapValue:{fields:{[b5]:{stringValue:b8},[b9]:{arrayValue:{values:(c instanceof dD?c.toArray():c).map(a=>{if("number"!=typeof a)throw d.createError("VectorValues must only contain numeric values.");return cP(d.serializer,a)})}}}}}}else if(de(a))return a._toProto(b.serializer);else throw b.createError(`Unsupported field value: ${bL(a)}`)}(a,b);if(b.settings.arrayElement&&4!==b.dataSource)throw b.createError("Nested arrays are not supported");var c=a,d=b;let e=[],f=0;for(let a of c){let b=dP(a,d.childContextForArray(f));null==b&&(b={nullValue:"NULL_VALUE"}),e.push(b),f++}return{arrayValue:{values:e}}}function dQ(a,b){let c={};return!function(a){for(let b in a)if(Object.prototype.hasOwnProperty.call(a,b))return!1;return!0}(a)?bV(a,(a,d)=>{let e=dP(d,b.childContextForField(a));null!=e&&(c[a]=e)}):b.path&&b.path.length>0&&b.fieldMask.push(b.path),{mapValue:{fields:c}}}function dR(a){return"object"==typeof a&&null!==a&&!(a instanceof Array)&&!(a instanceof Date)&&!(a instanceof b2)&&!(a instanceof dC)&&!(a instanceof dz)&&!(a instanceof dv)&&!(a instanceof dB)&&!(a instanceof dD)&&!de(a)}function dS(a,b,c){if(!dR(c)||!bK(c)){let d=bL(c);if("an object"===d)throw b.createError(a+" a custom object");throw b.createError(a+" "+d)}}function dT(a,b,c){if((b=F(b))instanceof dA)return b._internalPath;if("string"==typeof b)return dV(a,b);throw dW("Field path arguments must be of type string or ",a,!1,void 0,c)}let dU=RegExp("[~\\*/\\[\\]]");function dV(a,b,c){if(b.search(dU)>=0)throw dW(`Invalid field path (${b}). Paths must not contain '~', '*', '/', '[', or ']'`,a,!1,void 0,c);try{return new dA(...b.split("."))._internalPath}catch(d){throw dW(`Invalid field path (${b}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,a,!1,void 0,c)}}function dW(a,b,c,d,e){let f=d&&!d.isEmpty(),g=void 0!==e,h=`Function ${b}() called with invalid data`;c&&(h+=" (via `toFirestore()`)"),h+=". ";let i="";return(f||g)&&(i+=" (found",f&&(i+=` in field ${d}`),g&&(i+=` in document ${e}`),i+=")"),new bk(a8,h+a+i)}function dX(a,b){return a.some(a=>a.isEqual(b))}class dY{constructor(a,b,c,d,e){this._firestore=a,this._userDataWriter=b,this._key=c,this._document=d,this._converter=e}get id(){return this._key.path.lastSegment()}get ref(){return new dv(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(!this._converter)return this._userDataWriter.convertValue(this._document.data.value);{let a=new dZ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(a)}}}_fieldsProto(){return this._document?.data.clone().value.mapValue.fields??void 0}get(a){if(this._document){let b=this._document.data.field(dT("DocumentSnapshot.get",a));if(null!==b)return this._userDataWriter.convertValue(b)}}}class dZ extends dY{data(){return super.data()}}class d${constructor(a,b){this._docs=b,this.query=a}get docs(){return[...this._docs]}get size(){return this.docs.length}get empty(){return 0===this.docs.length}forEach(a,b){this._docs.forEach(a,b)}}class d_{}class d0 extends d_{}function d1(a,b,...c){let d=[];for(let e of(b instanceof d_&&d.push(b),function(a){let b=a.filter(a=>a instanceof d4).length,c=a.filter(a=>a instanceof d2).length;if(b>1||b>0&&c>0)throw new bk(a8,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(d=d.concat(c)),d))a=e._apply(a);return a}class d2 extends d0{constructor(a,b,c){super(),this._field=a,this._op=b,this._value=c,this.type="where"}static _create(a,b,c){return new d2(a,b,c)}_apply(a){let b=this._parse(a);return eb(a._query,b),new du(a.firestore,a.converter,cO(a._query,b))}_parse(a){let b=dK(a.firestore);return function(a,b,c,d,e,f,g){let h;if(e.isKeyField())if("array-contains"===f||"array-contains-any"===f)throw new bk(a8,`Invalid Query. You can't perform '${f}' queries on documentId().`);else if("in"===f||"not-in"===f){ea(g,f);let b=[];for(let c of g)b.push(d9(d,a,c));h={arrayValue:{values:b}}}else h=d9(d,a,g);else("in"===f||"not-in"===f||"array-contains-any"===f)&&ea(g,f),h=function(a,b,c,d=!1){return dP(c,a.createContext(d?4:3,b))}(c,b,g,"in"===f||"not-in"===f);return cp.create(e,f,h)}(a._query,"where",b,a.firestore._databaseId,this._field,this._op,this._value)}}function d3(a,b,c){let d=dT("where",a);return d2._create(d,b,c)}class d4 extends d_{constructor(a,b){super(),this.type=a,this._queryConstraints=b}static _create(a,b){return new d4(a,b)}_parse(a){let b=this._queryConstraints.map(b=>b._parse(a)).filter(a=>a.getFilters().length>0);return 1===b.length?b[0]:cq.create(b,this._getOperator())}_apply(a){let b=this._parse(a);return 0===b.getFilters().length?a:(function(a,b){let c=a;for(let a of b.getFlattenedFilters())eb(c,a),c=cO(c,a)}(a._query,b),new du(a.firestore,a.converter,cO(a._query,b)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class d5 extends d0{constructor(a,b){super(),this._field=a,this._direction=b,this.type="orderBy"}static _create(a,b){return new d5(a,b)}_apply(a){var b;let c,d=function(a,b,c){if(null!==a.startAt)throw new bk(a8,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==a.endAt)throw new bk(a8,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new cz(b,c)}(a._query,this._field,this._direction);return new du(a.firestore,a.converter,(b=a._query,c=b.explicitOrderBy.concat([d]),new cL(b.path,b.collectionGroup,c,b.filters.slice(),b.limit,b.limitType,b.startAt,b.endAt)))}}function d6(a,b="asc"){let c=dT("orderBy",a);return d5._create(c,b)}class d7 extends d0{constructor(a,b,c){super(),this.type=a,this._limit=b,this._limitType=c}static _create(a,b,c){return new d7(a,b,c)}_apply(a){var b,c,d;return new du(a.firestore,a.converter,(b=a._query,c=this._limit,d=this._limitType,new cL(b.path,b.collectionGroup,b.explicitOrderBy.slice(),b.filters.slice(),c,d,b.startAt,b.endAt)))}}function d8(a){if(a<=0)throw new bk(a8,`Function limit() requires a positive number, but it was: ${a}.`);return d7._create("limit",a,"F")}function d9(a,b,c){if("string"==typeof(c=F(c))){if(""===c)throw new bk(a8,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(null===b.collectionGroup&&-1!==c.indexOf("/"))throw new bk(a8,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${c}' contains a '/' character.`);let d=b.path.child(bD.fromString(c));if(!bG.isDocumentKey(d))throw new bk(a8,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${d}' is not because it has an odd number of segments (${d.length}).`);return cg(a,new bG(d))}if(c instanceof dv)return cg(a,c._key);throw new bk(a8,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${bL(c)}.`)}function ea(a,b){if(!Array.isArray(a)||0===a.length)throw new bk(a8,`Invalid Query. A non-empty array is required for '${b.toString()}' filters.`)}function eb(a,b){let c=function(a,b){for(let c of a)for(let a of c.getFlattenedFilters())if(b.indexOf(a.op)>=0)return a.op;return null}(a.filters,function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(b.op));if(null!==c)if(c===b.op)throw new bk(a8,`Invalid query. You cannot use more than one '${b.op.toString()}' filter.`);else throw new bk(a8,`Invalid query. You cannot use '${b.op.toString()}' filters with '${c.toString()}' filters.`)}class ec{convertValue(a,b="none"){switch(ca(a)){case 0:return null;case 1:return a.booleanValue;case 2:return b$(a.integerValue||a.doubleValue);case 3:return this.convertTimestamp(a.timestampValue);case 4:return this.convertServerTimestamp(a,b);case 5:return a.stringValue;case 6:return this.convertBytes(b_(a.bytesValue));case 7:return this.convertReference(a.referenceValue);case 8:return this.convertGeoPoint(a.geoPointValue);case 9:return this.convertArray(a.arrayValue,b);case 11:return this.convertObject(a.mapValue,b);case 10:return this.convertVectorValue(a.mapValue);default:throw a3(62114,{value:a})}}convertObject(a,b){return this.convertObjectMap(a.fields,b)}convertObjectMap(a,b="none"){let c={};return bV(a,(a,d)=>{c[a]=this.convertValue(d,b)}),c}convertVectorValue(a){return new dD(a.fields?.[b9].arrayValue?.values?.map(a=>b$(a.doubleValue)))}convertGeoPoint(a){return new dC(b$(a.latitude),b$(a.longitude))}convertArray(a,b){return(a.values||[]).map(a=>this.convertValue(a,b))}convertServerTimestamp(a,b){switch(b){case"previous":let c=function a(b){let c=b.mapValue.fields.__previous_value__;return b3(c)?a(c):c}(a);if(null==c)return null;return this.convertValue(c,b);case"estimate":return this.convertTimestamp(b4(a));default:return null}}convertTimestamp(a){let b=bZ(a);return new b2(b.seconds,b.nanos)}convertDocumentKey(a,b){let c=bD.fromString(a);a5(dd(c),9688,{name:a});let d=new bv(c.get(1),c.get(3)),e=new bG(c.popFirst(5));return d.isEqual(b)||a0(`Document ${e} contains a document reference within a different database (${d.projectId}/${d.database}) which is not supported. It will be treated as a reference in the current database (${b.projectId}/${b.database}) instead.`),e}}function ed(a,b,c){return a?c&&(c.merge||c.mergeFields)?a.toFirestore(b,c):a.toFirestore(b):b}class ee extends ec{constructor(a){super(),this.firestore=a}convertBytes(a){return new dz(a)}convertReference(a){let b=this.convertDocumentKey(a,this.firestore._databaseId);return new dv(this.firestore,null,b)}}function ef(a){let b=dp((a=bM(a,dv)).firestore),c=new ee(a.firestore);return dj(b,[a._key]).then(b=>{a5(1===b.length,15618);let d=b[0];return new dY(a.firestore,c,a._key,d.isFoundDocument()?d:null,a.converter)})}function eg(a){var b=(a=bM(a,du))._query;if("L"===b.limitType&&0===b.explicitOrderBy.length)throw new bk(bh,"limitToLast() queries require specifying at least one orderBy() clause");let c=dp(a.firestore),d=new ee(a.firestore);return dk(c,a._query).then(b=>{let c=b.map(b=>new dZ(a.firestore,d,b.key,b,a.converter));return"L"===a._query.limitType&&c.reverse(),new d$(a,c)})}function eh(a,b,c){let d=ed((a=bM(a,dv)).converter,b,c),e=dL(dK(a.firestore),"setDoc",a._key,d,null!==a.converter,c);return di(dp(a.firestore),[e.toMutation(a._key,cV.none())])}function ei(a,b,c,...d){let e,f=dK((a=bM(a,dv)).firestore);return e="string"==typeof(b=F(b))||b instanceof dA?dO(f,"updateDoc",a._key,b,c,d):dN(f,"updateDoc",a._key,b),di(dp(a.firestore),[e.toMutation(a._key,cV.exists(!0))])}function ej(a){return di(dp((a=bM(a,dv)).firestore),[new cZ(a._key,cV.none())])}function ek(a,b){let c=dy(a=bM(a,dw)),d=ed(a.converter,b),e=dL(dK(a.firestore),"addDoc",c._key,d,null!==c.converter,{});return di(dp(a.firestore),[e.toMutation(c._key,cV.exists(!1))]).then(()=>c)}let el="4.11.0";class em{constructor(){this.promise=new Promise((a,b)=>{this.resolve=a,this.reject=b})}}class en{constructor(a,b,c=1e3,d=1.5,e=6e4){this.queue=a,this.timerId=b,this.initialDelayMs=c,this.backoffFactor=d,this.maxDelayMs=e,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}reset(){this.currentBaseMs=0}resetToMax(){this.currentBaseMs=this.maxDelayMs}backoffAndRun(a){this.cancel();let b=Math.floor(this.currentBaseMs+this.jitterDelayMs()),c=Math.max(0,Date.now()-this.lastAttemptTime),d=Math.max(0,b-c);d>0&&a_("ExponentialBackoff",`Backing off for ${d} ms (base delay: ${this.currentBaseMs} ms, delay with jitter: ${b} ms, last attempt: ${c} ms ago)`),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,d,()=>(this.lastAttemptTime=Date.now(),a())),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)}skipBackoff(){null!==this.timerPromise&&(this.timerPromise.skipDelay(),this.timerPromise=null)}cancel(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)}jitterDelayMs(){return(Math.random()-.5)*this.currentBaseMs}}class eo{constructor(a,b,c){this.alias=a,this.aggregateType=b,this.fieldPath=c}}class ep{constructor(a="count",b){this._internalFieldPath=b,this.type="AggregateField",this.aggregateType=a}}class eq{constructor(a,b,c){this._userDataWriter=b,this._data=c,this.type="AggregateQuerySnapshot",this.query=a}data(){return this._userDataWriter.convertObjectMap(this._data)}_fieldsProto(){return new cH({mapValue:{fields:this._data}}).clone().value.mapValue.fields}}function er(a){return es(a,{count:ev()})}function es(a,b){let c=bM(a.firestore,ds),d=dp(c),e=function(a,b){let c=[];for(let d in a)Object.prototype.hasOwnProperty.call(a,d)&&c.push(b(a[d],d,a));return c}(b,(a,b)=>new eo(b,a.aggregateType,a._internalFieldPath));return dl(d,a._query,e).then(b=>{var d,e,f;return d=c,e=a,f=b,new eq(e,new ee(d),f)})}function et(a){return new ep("sum",dT("sum",a))}function eu(a){return new ep("avg",dT("average",a))}function ev(){return new ep("count")}function ew(a,b){return a instanceof ep&&b instanceof ep&&a.aggregateType===b.aggregateType&&a._internalFieldPath?.canonicalString()===b._internalFieldPath?.canonicalString()}function ex(a,b){return function(a,b){if(a=F(a),b=F(b),a instanceof du&&b instanceof du){var c,d;return a.firestore===b.firestore&&(c=a._query,d=b._query,function(a,b){if(a.limit!==b.limit||a.orderBy.length!==b.orderBy.length)return!1;for(let e=0;e<a.orderBy.length;e++){var c,d;if(c=a.orderBy[e],d=b.orderBy[e],!(c.dir===d.dir&&c.field.isEqual(d.field)))return!1}if(a.filters.length!==b.filters.length)return!1;for(let c=0;c<a.filters.length;c++)if(!function a(b,c){var d,e,f,g;if(b instanceof cp){return d=b,(e=c)instanceof cp&&d.op===e.op&&d.field.isEqual(e.field)&&cb(d.value,e.value)}if(b instanceof cq){return f=b,(g=c)instanceof cq&&f.op===g.op&&f.filters.length===g.filters.length&&f.filters.reduce((b,c,d)=>b&&a(c,g.filters[d]),!0)}a3(19439)}(a.filters[c],b.filters[c]))return!1;return a.collectionGroup===b.collectionGroup&&!!a.path.isEqual(b.path)&&!!cn(a.startAt,b.startAt)&&cn(a.endAt,b.endAt)}(cM(c),cM(d))&&c.limitType===d.limitType)&&a.converter===b.converter}return!1}(a.query,b.query)&&D(a.data(),b.data())}class ey{constructor(a,b){this._firestore=a,this._commitHandler=b,this._mutations=[],this._committed=!1,this._dataReader=dK(a)}set(a,b,c){this._verifyNotCommitted();let d=ez(a,this._firestore),e=ed(d.converter,b,c),f=dL(this._dataReader,"WriteBatch.set",d._key,e,null!==d.converter,c);return this._mutations.push(f.toMutation(d._key,cV.none())),this}update(a,b,c,...d){let e;this._verifyNotCommitted();let f=ez(a,this._firestore);return e="string"==typeof(b=F(b))||b instanceof dA?dO(this._dataReader,"WriteBatch.update",f._key,b,c,d):dN(this._dataReader,"WriteBatch.update",f._key,b),this._mutations.push(e.toMutation(f._key,cV.exists(!0))),this}delete(a){this._verifyNotCommitted();let b=ez(a,this._firestore);return this._mutations=this._mutations.concat(new cZ(b._key,cV.none())),this}commit(){return(this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0)?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new bk(be,"A write batch can no longer be used after commit() has been called.")}}function ez(a,b){if((a=F(a)).firestore===b)return a;throw new bk(a8,"Provided document reference is from a different Firestore instance.")}function eA(a){let b=dp(a=bM(a,ds));return new ey(a,a=>di(b,a))}let eB={maxAttempts:5};class eC{constructor(a){this.datastore=a,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(a){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new bk(a8,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let b=await dj(this.datastore,a);return b.forEach(a=>this.recordVersion(a)),b}set(a,b){this.write(b.toMutation(a,this.precondition(a))),this.writtenDocs.add(a.toString())}update(a,b){try{this.write(b.toMutation(a,this.preconditionForUpdate(a)))}catch(a){this.lastTransactionError=a}this.writtenDocs.add(a.toString())}delete(a){this.write(new cZ(a,this.precondition(a))),this.writtenDocs.add(a.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let a=this.readVersions;this.mutations.forEach(b=>{a.delete(b.key.toString())}),a.forEach((a,b)=>{let c=bG.fromPath(b);this.mutations.push(new c$(c,this.precondition(c)))}),await di(this.datastore,this.mutations),this.committed=!0}recordVersion(a){let b;if(a.isFoundDocument())b=a.version;else if(a.isNoDocument())b=cA.min();else throw a3(50498,{documentName:a.constructor.name});let c=this.readVersions.get(a.key.toString());if(c){if(!b.isEqual(c))throw new bk(bf,"Document version changed between two reads.")}else this.readVersions.set(a.key.toString(),b)}precondition(a){let b=this.readVersions.get(a.toString());return this.writtenDocs.has(a.toString())||!b?cV.none():b.isEqual(cA.min())?cV.exists(!1):cV.updateTime(b)}preconditionForUpdate(a){let b=this.readVersions.get(a.toString());if(this.writtenDocs.has(a.toString())||!b)return cV.exists(!0);if(b.isEqual(cA.min()))throw new bk(a8,"Can't update a document that doesn't exist.");return cV.updateTime(b)}write(a){this.ensureCommitNotCalled(),this.mutations.push(a)}ensureCommitNotCalled(){}}class eD{constructor(a,b,c,d,e){this.asyncQueue=a,this.datastore=b,this.options=c,this.updateFunction=d,this.deferred=e,this.attemptsRemaining=c.maxAttempts,this.backoff=new en(this.asyncQueue,"transaction_retry")}run(){this.attemptsRemaining-=1,this.runWithBackOff()}runWithBackOff(){this.backoff.backoffAndRun(async()=>{let a=new eC(this.datastore),b=this.tryRunUpdateFunction(a);b&&b.then(b=>{this.asyncQueue.enqueueAndForget(()=>a.commit().then(()=>{this.deferred.resolve(b)}).catch(a=>{this.handleTransactionError(a)}))}).catch(a=>{this.handleTransactionError(a)})})}tryRunUpdateFunction(a){try{let b=this.updateFunction(a);if(null==b||!b.catch||!b.then)return this.deferred.reject(Error("Transaction callback must return a Promise")),null;return b}catch(a){return this.deferred.reject(a),null}}handleTransactionError(a){this.attemptsRemaining>0&&this.isRetryableTransactionError(a)?(this.attemptsRemaining-=1,this.asyncQueue.enqueueAndForget(()=>(this.runWithBackOff(),Promise.resolve()))):this.deferred.reject(a)}isRetryableTransactionError(a){if(a?.name==="FirebaseError"){let b=a.code;return"aborted"===b||"failed-precondition"===b||"already-exists"===b||!function(a){switch(a){case"ok":return a3(64938);case a6:case a7:case a9:case bd:case bi:case bj:case bc:return!1;case a8:case ba:case"already-exists":case bb:case be:case bf:case bg:case bh:case"data-loss":return!0;default:return a3(15467,{code:a})}}(b)}return!1}}class eE{constructor(a,b,c,d,e){this.asyncQueue=a,this.timerId=b,this.targetTimeMs=c,this.op=d,this.removalCallback=e,this.deferred=new em,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(a,b,c,d,e){let f=new eE(a,b,Date.now()+c,d,e);return f.start(c),f}start(a){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),a)}skipDelay(){return this.handleDelayElapsed()}cancel(a){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new bk(a6,"Operation cancelled"+(a?": "+a:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(a=>this.deferred.resolve(a))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}class eF{constructor(a=Promise.resolve()){this.retryableOps=[],this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.skipNonRestrictedTasks=!1,this.timerIdsToSkip=[],this.backoff=new en(this,"async_queue_retry"),this.visibilityHandler=()=>{this.backoff.skipBackoff()},this.tail=a}get isShuttingDown(){return this._isShuttingDown}enqueueAndForget(a){this.enqueue(a)}enqueueAndForgetEvenWhileRestricted(a){this.verifyNotFailed(),this.enqueueInternal(a)}enterRestrictedMode(a){this._isShuttingDown||(this._isShuttingDown=!0,this.skipNonRestrictedTasks=a||!1)}enqueue(a){if(this.verifyNotFailed(),this._isShuttingDown)return new Promise(()=>{});let b=new em;return this.enqueueInternal(()=>this._isShuttingDown&&this.skipNonRestrictedTasks?Promise.resolve():(a().then(b.resolve,b.reject),b.promise)).then(()=>b.promise)}enqueueRetryable(a){this.enqueueAndForget(()=>(this.retryableOps.push(a),this.retryNextOp()))}async retryNextOp(){if(0!==this.retryableOps.length){try{await this.retryableOps[0](),this.retryableOps.shift(),this.backoff.reset()}catch(a){if("IndexedDbTransactionError"===a.name)a_("AsyncQueue","Operation failed with retryable error: "+a);else throw a}this.retryableOps.length>0&&this.backoff.backoffAndRun(()=>this.retryNextOp())}}enqueueInternal(a){let b=this.tail.then(()=>(this.operationInProgress=!0,a().catch(a=>{throw this.failure=a,this.operationInProgress=!1,a0("INTERNAL UNHANDLED ERROR: ",eG(a)),a}).then(a=>(this.operationInProgress=!1,a))));return this.tail=b,b}enqueueAfterDelay(a,b,c){this.verifyNotFailed(),this.timerIdsToSkip.indexOf(a)>-1&&(b=0);let d=eE.createAndSchedule(this,a,b,c,a=>this.removeDelayedOperation(a));return this.delayedOperations.push(d),d}verifyNotFailed(){this.failure&&a3(47125,{messageOrStack:eG(this.failure)})}verifyOperationInProgress(){}async drain(){let a;do a=this.tail,await a;while(a!==this.tail)}containsDelayedOperation(a){for(let b of this.delayedOperations)if(b.timerId===a)return!0;return!1}runAllDelayedOperationsUntil(a){return this.drain().then(()=>{for(let b of(this.delayedOperations.sort((a,b)=>a.targetTimeMs-b.targetTimeMs),this.delayedOperations))if(b.skipDelay(),"all"!==a&&b.timerId===a)break;return this.drain()})}skipDelaysForTimerId(a){this.timerIdsToSkip.push(a)}removeDelayedOperation(a){let b=this.delayedOperations.indexOf(a);this.delayedOperations.splice(b,1)}}function eG(a){let b=a.message||"";return a.stack&&(b=a.stack.includes(a.message)?a.stack:a.message+"\n"+a.stack),b}class eH{constructor(a,b){this._firestore=a,this._transaction=b,this._dataReader=dK(a)}get(a){let b=ez(a,this._firestore),c=new ee(this._firestore);return this._transaction.lookup([b._key]).then(a=>{if(!a||1!==a.length)return a3(24041);let d=a[0];if(d.isFoundDocument())return new dY(this._firestore,c,d.key,d,b.converter);if(d.isNoDocument())return new dY(this._firestore,c,b._key,null,b.converter);throw a3(18433,{doc:d})})}set(a,b,c){let d=ez(a,this._firestore),e=ed(d.converter,b,c),f=dL(this._dataReader,"Transaction.set",d._key,e,null!==d.converter,c);return this._transaction.set(d._key,f),this}update(a,b,c,...d){let e,f=ez(a,this._firestore);return e="string"==typeof(b=F(b))||b instanceof dA?dO(this._dataReader,"Transaction.update",f._key,b,c,d):dN(this._dataReader,"Transaction.update",f._key,b),this._transaction.update(f._key,e),this}delete(a){let b=ez(a,this._firestore);return this._transaction.delete(b._key),this}}function eI(a,b,c){let d=dp(a=bM(a,ds)),e={...eB,...c};if(e.maxAttempts<1)throw new bk(a8,"Max attempts must be at least 1");let f=new em;return new eD(new eF,d,e,c=>b(new eH(a,c)),f).run(),f.promise}aZ=`${aw}_lite`,al(new G("firestore/lite",(a,{instanceIdentifier:b,options:c})=>{let d=a.getProvider("app").getImmediate(),e=new ds(new bo(a.getProvider("auth-internal")),new bs(d,a.getProvider("app-check-internal")),function(a,b){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new bk(a8,'"projectId" not provided in firebase.initializeApp.');return new bv(a.options.projectId,b)}(d,b),d);return c&&e._setSettings(c),e},"PUBLIC").setMultipleInstances(!0)),aC("firestore-lite",el,"node"),aC("firestore-lite",el,"esm2020"),a.s(["AggregateField",()=>ep,"AggregateQuerySnapshot",()=>eq,"Transaction",()=>eH,"WriteBatch",()=>ey,"aggregateFieldEqual",()=>ew,"aggregateQuerySnapshotEqual",()=>ex,"average",()=>eu,"count",()=>ev,"getAggregate",()=>es,"getCount",()=>er,"runTransaction",()=>eI,"sum",()=>et,"writeBatch",()=>eA],98717),a.s([],2446),a.i(98717),a.s(["addDoc",()=>ek,"collection",()=>dx,"deleteDoc",()=>ej,"doc",()=>dy,"getDoc",()=>ef,"getDocs",()=>eg,"getFirestore",()=>dt,"limit",()=>d8,"orderBy",()=>d6,"query",()=>d1,"setDoc",()=>eh,"updateDoc",()=>ei,"where",()=>d3],73004)},9296,a=>{"use strict";function b(a){return{title:"Employee Self-Service Dashboard",subtitle:`${a} workspace with least-privilege access controls.`,metrics:[{id:"my-attendance",label:"My Attendance",value:"96.4%",trend:"+1.0% this month"},{id:"work-hours",label:"Work Hours",value:"160h",trend:"Month-to-date"},{id:"kpi-progress",label:"KPI Progress",value:"87%",trend:"Q1 in progress"}]}}let c={SUPER_ADMIN:{title:"Super Admin Command Center",subtitle:"Unified operational and security oversight across all CLIO modules.",metrics:[{id:"active-users",label:"Active Users",value:"312",trend:"+12 this week"},{id:"open-incidents",label:"Open Security Incidents",value:"2",trend:"0 critical"},{id:"audit-events",label:"Audit Events (24h)",value:"1,482",trend:"+8%"},{id:"access-reviews",label:"Quarterly Reviews",value:"86%",trend:"In progress"}],priorities:["Validate role assignments for privileged accounts and temporary access grants.","Review export and printing activity exceeding threshold policy.","Track retention and archive jobs for resigned employee records."],table:{title:"Security Control Status",subtitle:"Current posture for highest-risk control groups",actionLabel:"Open user management",columns:["Control","Owner","Next Review","Status"],rows:[["Privileged Access Review","GRC","Mar 01","On Track"],["PII Export Threshold Rules","Security","Feb 24","In Review"],["Forensic Log Integrity","Infra","Feb 25","Healthy"],["Retention Deletion Queue","HR Ops","Feb 27","Pending"]]}},GRC:{title:"GRC Dashboard",subtitle:"Governance oversight, audit defensibility, and policy control monitoring.",metrics:[{id:"policy-score",label:"Policy Compliance",value:"96.1%",trend:"+0.9%"},{id:"audit-ready",label:"Audit-Ready Controls",value:"42",trend:"+4"},{id:"export-alerts",label:"Export Alerts",value:"3",trend:"2 unresolved"},{id:"retention-checks",label:"Retention Checks",value:"11",trend:"On schedule"}],priorities:["Review tamper-resistant logs for sensitive PII access patterns.","Validate quarterly access review evidence for all privileged roles.","Monitor mass export events and verify documented justifications."],table:{title:"Governance Queue",subtitle:"High-priority compliance checkpoints",actionLabel:"Open activity log",columns:["Checkpoint","Owner","Due Date","Status"],rows:[["Quarterly Access Review","IAM","Feb 26","In Progress"],["PIA Evidence Archive","Compliance","Feb 24","Pending"],["DLP Export Alert Triage","GRC","Today","Active"]]}},HR:{title:"HR Operations Dashboard",subtitle:"Employee operations with lifecycle, attendance, and performance control.",metrics:[{id:"active-headcount",label:"Active Headcount",value:"248",trend:"+6%"},{id:"onboarding",label:"Onboarding Cases",value:"7",trend:"3 in final step"},{id:"attendance-pending",label:"Attendance Pending",value:"14",trend:"-2"},{id:"review-cycle",label:"Performance Reviews",value:"61%",trend:"Cycle open"}],priorities:["Finalize onboarding tasks and role assignment approvals.","Resolve pending attendance corrections before payroll lock.","Document promotion justifications for review committee."],table:{title:"HR Priority Queue",subtitle:"Current high-impact operations",actionLabel:"Open lifecycle",columns:["Task","Module","Deadline","Status"],rows:[["Onboarding Completion: CL-1422","Lifecycle","Today","In Progress"],["Attendance Correction Review","Attendance","Feb 22","Pending"],["Promotion Pack: A. Reyes","Performance","Feb 28","Drafting"]]}},EA:{title:"Executive Assistant Dashboard",subtitle:"Executive-authorized workforce operations and document coordination.",metrics:[{id:"exec-requests",label:"Executive Requests",value:"9",trend:"4 due today"},{id:"doc-prep",label:"Template Drafts",value:"12",trend:"+3"},{id:"attendance-followup",label:"Attendance Follow-ups",value:"6",trend:"Stable"},{id:"review-briefs",label:"Performance Briefs",value:"5",trend:"2 urgent"}],priorities:["Coordinate authorized updates for executive office employee actions.","Prepare standardized document templates for approvals.","Track and consolidate attendance and KPI briefings."],table:{title:"EA Action Board",subtitle:"Executive office-approved activities",actionLabel:"Open templates",columns:["Request","Module","Deadline","Status"],rows:[["Employment Certificate Batch","Templates","Today","In Progress"],["Role Change Memo Pack","Lifecycle","Feb 23","Pending"],["KPI Summary Deck","Performance","Feb 24","Drafting"]]}},EMPLOYEE_L1:b("Employee L1"),EMPLOYEE_L2:b("Employee L2"),EMPLOYEE_L3:b("Employee L3")};a.s(["ACTIVITY_LOG_ROWS",0,[{id:"ACT-6124",activityName:"Updated Employee Profile (CL-1038)",status:"Completed",relativeTime:"2 min ago",loggedAt:"Feb 18, 2026 08:41 AM",module:"Employee Records",performedBy:"hr.manager@gmail.com"},{id:"ACT-6123",activityName:"Approved Attendance Correction (CL-1289)",status:"Approved",relativeTime:"4 min ago",loggedAt:"Feb 18, 2026 08:39 AM",module:"Attendance",performedBy:"hr.manager@gmail.com"},{id:"ACT-6121",activityName:"Uploaded NDA Template Revision",status:"Completed",relativeTime:"6 min ago",loggedAt:"Feb 18, 2026 08:37 AM",module:"Template Repository",performedBy:"ea.office@gmail.com"},{id:"ACT-6118",activityName:"Exported Employee Master List",status:"Completed",relativeTime:"8 min ago",loggedAt:"Feb 18, 2026 08:35 AM",module:"Export Control",performedBy:"grc.analyst@gmail.com"},{id:"ACT-6117",activityName:"Corrected Attendance Log (Samira Reyes)",status:"Completed",relativeTime:"12 min ago",loggedAt:"Feb 18, 2026 08:31 AM",module:"Attendance",performedBy:"hr.assistant@gmail.com"},{id:"ACT-6116",activityName:"Created New Employee Record (CL-1312)",status:"Completed",relativeTime:"15 min ago",loggedAt:"Feb 18, 2026 08:28 AM",module:"Employee Records",performedBy:"hr.recruit@gmail.com"},{id:"ACT-6115",activityName:"Requested Shift Change Approval (CL-1204)",status:"Pending",relativeTime:"17 min ago",loggedAt:"Feb 18, 2026 08:26 AM",module:"Attendance",performedBy:"ea.office@gmail.com"},{id:"ACT-6114",activityName:"Failed Payroll Attendance Export",status:"Failed",relativeTime:"21 min ago",loggedAt:"Feb 18, 2026 08:22 AM",module:"Export Control",performedBy:"hr.manager@gmail.com"},{id:"ACT-6113",activityName:"Rejected Backdated Attendance Request",status:"Rejected",relativeTime:"26 min ago",loggedAt:"Feb 18, 2026 08:17 AM",module:"Attendance",performedBy:"grc.analyst@gmail.com"},{id:"ACT-6112",activityName:"Updated Emergency Contact (CL-1001)",status:"Completed",relativeTime:"31 min ago",loggedAt:"Feb 18, 2026 08:12 AM",module:"Employee Records",performedBy:"hr.admin@gmail.com"},{id:"ACT-6111",activityName:"Uploaded Signed NDA Document",status:"Completed",relativeTime:"36 min ago",loggedAt:"Feb 18, 2026 08:07 AM",module:"Template Repository",performedBy:"ea.office@gmail.com"},{id:"ACT-6110",activityName:"Locked Export Template: Attendance Weekly",status:"Failed",relativeTime:"40 min ago",loggedAt:"Feb 18, 2026 08:03 AM",module:"Export Control",performedBy:"grc.analyst@gmail.com"}],"CORE_FUNCTIONAL_FEATURES",0,[{id:"employee-records",mainTab:"Employee Records",summary:"Employee profile center",subTabs:["Employee Master Data","Employment Status","Government IDs (Restricted PII)","Contact Information","Payroll Information","Documents Attached to Employee","Activity History (who edited)"]},{id:"employment-lifecycle",mainTab:"Employment Lifecycle Management",summary:"Employee journey timeline from hire to exit",subTabs:["Onboarding","Role Changes / Promotions","Disciplinary Records","Transfers / Position Updates","Offboarding","Access Revocation Tracking"]},{id:"attendance-management",mainTab:"Attendance Management",summary:"Time and leave system",subTabs:["Time Logs","Leave Requests","Leave Approvals","Attendance Reports","Attendance Adjustments","Modification Logs (audit trail)"]},{id:"performance-management",mainTab:"Performance Management",summary:"Evaluation and appraisal system",subTabs:["KPI Records","Evaluation Forms","Performance Reviews History","Promotion Justification","Performance Reports"]},{id:"document-templates",mainTab:"Document Template Repository",summary:"Document management system for HR",subTabs:["HR Templates","Contracts","NDAs","Acknowledgment Forms","Version History","Upload / Manage Templates","Usage Logs"]}],"ROLE_DASHBOARD_CONTENT",0,c,"ROLE_PRIVILEGE_MATRIX",0,[{role:"GRC",employeeRecords:"View and Edit All",lifecycle:"View and Edit All",attendance:"View and Edit All",performance:"View and Edit All",templates:"View and Edit All",exports:"Full Export (logged and justified)",audit:"Governance and full audit visibility"},{role:"HR",employeeRecords:"View and Edit All",lifecycle:"View and Edit All",attendance:"View and Edit All",performance:"View and Edit All",templates:"View and Edit All",exports:"Full Export (logged and justified)",audit:"Operational logs generated for all actions"},{role:"EA",employeeRecords:"View and Edit All (executive-authorized)",lifecycle:"View and Edit (authorized workflows)",attendance:"View and Edit (authorized workflows)",performance:"View and Edit (authorized workflows)",templates:"View and Edit",exports:"Full Export (logged and justified)",audit:"Operational logs generated for all actions"},{role:"EMPLOYEE (L1/L2/L3)",employeeRecords:"View own record + edit personal info",lifecycle:"No access",attendance:"Own attendance logs only",performance:"View own performance history",templates:"Download own documents only",exports:"No bulk export access",audit:"System-generated logging only"}]])},70767,a=>{"use strict";var b=a.i(11481);(0,b.registerVersion)("firebase","12.9.0","app");var c=b;a.i(35027);var c=b;a.i(2446);var d=a.i(73004);function e(a){return String(process.env[a]||"").trim()}function f(){let a;return{apiKey:e("NEXT_PUBLIC_FIREBASE_API_KEY"),authDomain:e("NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN"),projectId:e("NEXT_PUBLIC_FIREBASE_PROJECT_ID"),storageBucket:(a=e("NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET_URL"))?a.replace(/^gs:\/\//,"").replace(/^\/+|\/+$/g,""):e("NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET"),messagingSenderId:e("NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID"),appId:e("NEXT_PUBLIC_FIREBASE_APP_ID"),measurementId:e("NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID")}}function g(){var a;return"false"!==String(process.env.CLIO_USE_FIRESTORE||"").trim().toLowerCase()&&!!((a=f()).apiKey&&a.authDomain&&a.projectId&&a.appId)}function h(){let a=function(){if(!g())return null;let a=f();return(0,c.getApps)().length>0?(0,c.getApp)():(0,c.initializeApp)(a)}();if(!a)return null;let b=function(){let a=e("CLIO_FIRESTORE_DATABASE_ID");if(!a)return"cliohris";let b=a.toLowerCase();return"default"===b||"(default)"===b?"cliohris":a}();return(0,d.getFirestore)(a,b)}a.s(["getFirestoreDb",()=>h,"isFirestoreEnabled",()=>g],70767)},2252,a=>{"use strict";let b,c;var d=a.i(2157),e=a.i(50227);a.i(2446);var f=a.i(73004),g=a.i(9296),h=a.i(70767);let i=e.default.join(process.cwd(),"data"),j=e.default.join(i,"audit-log.ndjson");function k(a){let b=a?new Date(a):new Date;return Number.isNaN(b.getTime())?new Date().toISOString():b.toISOString()}function l(){let a=Date.now(),b=Math.random().toString(36).slice(2,8).toUpperCase();return`AUD-${a}-${b}`}function m(){return g.ACTIVITY_LOG_ROWS.map(a=>({id:a.id||l(),activityName:a.activityName||"Legacy Audit Event",status:a.status||"Completed",occurredAt:k(a.loggedAt),module:a.module||"System",performedBy:a.performedBy||"system@gmail.com",sensitivity:"Failed"===a.status||"Rejected"===a.status?"Sensitive":"Non-sensitive",metadata:{seeded:!0,relativeTime:a.relativeTime||"N/A"}}))}function n(){return String(process.env.CLIO_FIRESTORE_AUDIT_COLLECTION||"clio_audit_logs").trim()||"clio_audit_logs"}async function o(){return(0,h.isFirestoreEnabled)()?(0,h.getFirestoreDb)():null}function p(a){try{let b=JSON.parse(a);if(!b||"object"!=typeof b)return null;return b}catch{return null}}function q(a){return new Set(["Completed","Approved","Pending","Failed","Rejected"]).has(a)?a:"Completed"}function r(a){return"Sensitive"===a?"Sensitive":"Non-sensitive"}function s(a,b=""){return String(a||"").trim()||b}function t(a){return!a||"object"!=typeof a||Array.isArray(a)?{}:a}function u(a){let b=s(a).toLowerCase();return b&&"unknown"!==b?b.includes("edg/")?"Microsoft Edge":b.includes("opr/")||b.includes("opera")?"Opera":b.includes("firefox/")?"Firefox":b.includes("safari/")&&!b.includes("chrome/")?"Safari":b.includes("chrome/")?"Chrome":"Browser":"Unknown Browser"}function v(a){let b=s(a).toLowerCase();return b&&"unknown"!==b?b.includes("windows")?"Windows":b.includes("mac os x")||b.includes("macintosh")?"macOS":b.includes("android")?"Android":b.includes("iphone")||b.includes("ipad")||b.includes("ios")?"iOS":b.includes("linux")?"Linux":"OS":"Unknown OS"}function w(a,b,c){let d=s(a).toLowerCase(),e=s(b,"Unknown Browser"),f=s(c,"Unknown OS");return{deviceType:d.includes("mobile")?"Mobile":d.includes("tablet")?"Tablet":"Desktop",deviceSummary:`${e} on ${f}`}}function x(a){return Array.isArray(a)?a:[]}function y(a){return x(a).map(a=>String(a||"").trim()).filter(Boolean)}async function z(){return c||(c=a.A(42273)),c}function A(a){let b;!(!0===(b=t(a?.metadata)).skipAnomalyDetection||!0===b.autoGenerated||s(a?.module).toLowerCase().includes("incident management"))&&1&&(async()=>{let b=await z(),c=await b.processAuditEventForSecurityDetections(a);!(!c?.detected||c?.duplicate)&&c?.incidentRecord?.id&&await I({activityName:`Auto incident created by IDS (${s(c?.detection?.ruleId,"rule")})`,status:"Approved",module:"Incident Management",performedBy:String(process.env.CLIO_IDS_SYSTEM_ACTOR_EMAIL||"system@gmail.com").trim().toLowerCase()||"system@gmail.com",sensitivity:"Sensitive",metadata:{skipAnomalyDetection:!0,autoGenerated:!0,recordId:c.incidentRecord.id,incidentCode:c.incidentRecord.incidentCode||"",detectionRuleId:c?.detection?.ruleId||"",detectionFingerprint:c?.fingerprint||"",recipients:Array.isArray(c.recipients)?c.recipients:[],inAppNotificationCount:Number(c.inAppNotificationCount||0),webhookStatus:c?.deliverySummary?.webhooks?.status||"skipped",emailDispatchStatus:c?.deliverySummary?.email?.status||"skipped",smsDispatchStatus:c?.deliverySummary?.sms?.status||"skipped",auditNote:`IDS detected suspicious activity and opened incident ${c.incidentRecord.incidentCode||c.incidentRecord.id}.`,nextAction:"Review Incident Management workbench and execute containment workflow."}})})().catch(()=>null)}function B(a){let b=t(a?.metadata),c=b.userAgent||"unknown",d=s(b.browser)||u(c),e=s(b.operatingSystem)||v(c),{deviceType:f,deviceSummary:g}=w(c,d,e),h=y(b.changedFields||b.updatedFields),i=y(b.viewedFields),j=x(b.accessedDocuments||b.viewedDocuments||b.documentChanges?.added||b.documents).map(a=>{if(!a||"object"!=typeof a)return null;let b=s(a.name),c=s(a.id||a.recordId),d=s(a.type);return b||c||d?{name:b||"Employee Document",id:c||"",type:d||"General"}:null}).filter(Boolean);return{id:a.id||l(),activityName:a.activityName||"HRIS Action",status:q(a.status),occurredAt:a.occurredAt,relativeTime:function(a){let b=new Date(a);if(Number.isNaN(b.getTime()))return"N/A";let c=Math.floor(Math.max(0,Date.now()-b.getTime())/6e4);if(c<1)return"just now";if(c<60)return`${c} min ago`;let d=Math.floor(c/60);if(d<24)return`${d} hour${1===d?"":"s"} ago`;let e=Math.floor(d/24);return`${e} day${1===e?"":"s"} ago`}(a.occurredAt),loggedAt:function(a){let b=new Date(a);if(Number.isNaN(b.getTime()))return"Unknown";let c=new Intl.DateTimeFormat("en-US",{month:"short",day:"2-digit",year:"numeric"}).format(b),d=new Intl.DateTimeFormat("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}).format(b);return`${c} ${d}`}(a.occurredAt),module:a.module||"System",performedBy:a.performedBy||"system@gmail.com",sensitivity:r(a.sensitivity),sourceIp:b.sourceIp||"unknown",requestPath:b.requestPath||"unknown",requestMethod:b.requestMethod||"unknown",userAgent:c,browser:d,operatingSystem:e,deviceType:f,deviceSummary:g,recordRef:function(a){let b=t(a?.metadata);for(let a of[b.recordRef,b.recordId,b.employeeId,b.workflowId,b.templateId,b.exportId]){let b=s(a);if(b)return b}return"N/A"}(a),auditNote:s(b.auditNote,`Change logged under ${a.module||"System"} module and included in HRIS compliance trail.`),nextAction:s(b.nextAction,"Failed"===a.status||"Pending"===a.status||"Rejected"===a.status?"Review and resolve with assigned owner.":"No further action required."),changedFields:h,viewedFields:i,accessedDocuments:j,metadata:b}}async function C(){return b||(b=(async()=>{await d.promises.mkdir(i,{recursive:!0});try{await d.promises.access(j)}catch{let a=m().map(a=>JSON.stringify(a)).join("\n");await d.promises.writeFile(j,`${a}
`,"utf8")}})()),b}async function D(){await C();let a=await d.promises.readFile(j,"utf8").catch(()=>"");return a.trim()?a.split("\n").map(a=>a.trim()).filter(Boolean).map(p).filter(Boolean):[]}async function E(a){try{return await C(),await d.promises.appendFile(j,`${JSON.stringify(a)}
`,"utf8"),a}catch{return null}}async function F(a){let b=n();if((await (0,f.getDocs)((0,f.query)((0,f.collection)(a,b),(0,f.limit)(1)))).empty)for(let c of m())await (0,f.addDoc)((0,f.collection)(a,b),c)}async function G(a,b){let c=n();await F(a);let d=Math.min(Math.max(Number(b)||0,1),2500);return(await (0,f.getDocs)((0,f.query)((0,f.collection)(a,c),(0,f.orderBy)("occurredAt","desc"),(0,f.limit)(d)))).docs.map(a=>{let b=a.data();return{...b,id:b?.id||a.id}}).filter(a=>a?.occurredAt)}async function H(a,b){let c=n();return await (0,f.addDoc)((0,f.collection)(a,c),b),b}async function I({activityName:a,status:b="Completed",module:c="System",performedBy:d="system@gmail.com",sensitivity:e="Non-sensitive",metadata:f={},occurredAt:g,request:h}){let i,j={id:l(),activityName:a||"HRIS Action",status:q(b),occurredAt:k(g),module:c,performedBy:d,sensitivity:r(e),metadata:{...f,...function(a){if(!a)return{};let b=a.headers.get("x-forwarded-for"),c=b?b.split(",")[0]?.trim():a.headers.get("x-real-ip")||"unknown",d=a.headers.get("user-agent")||"unknown",e=u(d),f=v(d),{deviceType:g,deviceSummary:h}=w(d,e,f);return{requestMethod:a.method||"GET",requestPath:a.nextUrl?.pathname||"unknown",sourceIp:c||"unknown",userAgent:d,browser:e,operatingSystem:f,deviceType:g,deviceSummary:h}}(h)}},m=await o();if(m)try{return i=await H(m,j),A(i||j),i}catch{}return A((i=await E(j))||j),i}async function J({limit:a=400}={}){let b=await o();if(b)try{return(await G(b,a)).map(B)}catch{return(await D().catch(()=>[])).filter(a=>a?.occurredAt).sort((a,b)=>new Date(b.occurredAt).getTime()-new Date(a.occurredAt).getTime()).slice(0,Math.min(Math.max(Number(a)||0,1),2500)).map(B)}return(await D().catch(()=>[])).filter(a=>a?.occurredAt).sort((a,b)=>new Date(b.occurredAt).getTime()-new Date(a.occurredAt).getTime()).slice(0,Math.min(Math.max(Number(a)||0,1),2500)).map(B)}a.s(["listAuditEvents",()=>J,"recordAuditEvent",()=>I])},64368,a=>{"use strict";function b(a){return String(a??"").trim()}function c({firstName:a,middleName:d,lastName:e,suffix:f,fallback:g="",fallbackEmail:h="",fallbackLabel:i="User"}={}){let j=[function({firstName:a,middleName:c,lastName:d,order:e}){let f=b(a),g=b(c),h=b(d);if("last-first"===e){let a=[f,g].filter(Boolean).join(" ");return h?`${h}${a?`, ${a}`:""}`:a}return[f,g,h].filter(Boolean).join(" ")}({firstName:a,middleName:d,lastName:e,order:"first-last"}),b(f)].filter(Boolean).join(" ").trim();return j||function({fallback:a,fallbackEmail:c,fallbackLabel:d}){let e=b(a);if(e)return e;let f=b(c);return f?function(a,{fallbackLabel:c="User",maxTokens:d=3}={}){let e=b(a).toLowerCase(),f=b(c)||"User";if(!e.includes("@"))return f;let g=(e.split("@")[0]||"").split(/[._-]+/g).map(a=>{let c;return(c=b(a).toLowerCase())?`${c.charAt(0).toUpperCase()}${c.slice(1)}`:""}).filter(Boolean).slice(0,Math.max(1,Number.isFinite(d)?d:3));return 0===g.length?f:g.join(" ")}(f,{fallbackLabel:d}):b(d)||"User"}({fallback:g,fallbackEmail:h,fallbackLabel:i})}a.s(["formatPersonName",()=>c])},39748,a=>{"use strict";let b;var c=a.i(66680),d=a.i(2157),e=a.i(50227);a.i(2446);var f=a.i(73004),g=a.i(83982),h=a.i(70767);let i=e.default.join(process.cwd(),"data"),j=e.default.join(i,"user-accounts.json"),k=new Set(["pending","active","disabled"]),l=new Set(["sent","otp_sent","verified","revoked","expired"]),m=new Set(g.ROLES.map(a=>a.id)),n="EMPLOYEE_L1",o=new Set(["superadmin@clio.local","temp.admin@clio.local","hr@clio.local","grc@clio.local","ea@clio.local"]);function p(){return new Date().toISOString()}function q(a){if("string"!=typeof a)return"";let b=new Date(a);return Number.isNaN(b.getTime())?"":b.toISOString()}function r(a){return String(a||"").trim().toLowerCase()}function s(a,b=1){let c=Number.parseInt(String(a??""),10);return!Number.isFinite(c)||c<1?b:c}function t(a){return o.has(r(a))}function u(a){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r(a))}function v(a,{allowEmpty:b=!0}={}){let c=String(a||"").trim().replace(/\s+/g," ");if(!c)return b?"":null;if(c.length>80)throw Error("invalid_name");return c}function w(a,b,{min:c,max:d}={}){let e=Number.parseInt(String(process.env[a]||"").trim(),10);return Number.isFinite(e)?Number.isFinite(c)&&e<c?c:Number.isFinite(d)&&e>d?d:e:b}function x(){return w("CLIO_SMS_OTP_MAX_ATTEMPTS",5,{min:1,max:10})}function y(a){let b=String(a?.deviceId||"").trim();if(!b)return null;let c=q(a?.firstSeenAt)||p(),d=q(a?.lastSeenAt)||c,e=String(a?.label||"").trim()||"Unknown device",f=String(a?.userAgent||"").trim()||"unknown",g=String(a?.lastIp||"").trim()||"unknown",h=!!a?.trusted;return{deviceId:b,label:e,userAgent:f,lastIp:g,firstSeenAt:c,lastSeenAt:d,trusted:h,deniedAt:q(a?.deniedAt)||null,deniedReason:"string"==typeof a?.deniedReason?a.deniedReason:null}}function z(a,b=[]){return"string"!=typeof a||0===a.trim().length?b.map(r).filter(Boolean):a.split(",").map(r).filter(Boolean)}function A(a){let b,c=String(a||"").trim().toUpperCase();return c?"EMPLOYEE"===c?n:m.has(c)?"EMPLOYEE"===(b=String(c||"").trim().toUpperCase())||b.startsWith("EMPLOYEE_")?n:c:"":""}function B(a,b="HR"){let c=A(a);return c||A(b)||"HR"}function C(){return[{role:"SUPER_ADMIN",emails:z(process.env.SUPER_ADMIN_EMAILS,[])},{role:"HR",emails:z(process.env.HR_EMAILS,[])},{role:"GRC",emails:z(process.env.GRC_EMAILS,[])},{role:"EA",emails:z(process.env.EA_EMAILS,[])},{role:"EMPLOYEE_L1",emails:z(process.env.EMPLOYEE_L1_EMAILS,[])},{role:"EMPLOYEE_L2",emails:z(process.env.EMPLOYEE_L2_EMAILS,[])},{role:"EMPLOYEE_L3",emails:z(process.env.EMPLOYEE_L3_EMAILS,[])}].flatMap(a=>a.emails.map(b=>({email:b,role:A(a.role)||a.role})))}function D(a){var b;let c=r(a?.email);if(!u(c))return null;let d=B(a?.role,"HR"),e=k.has(a?.status)?a.status:"pending",f="string"==typeof a?.invitedAt?a.invitedAt:p(),g="string"==typeof a?.updatedAt?a.updatedAt:f,h=q(a?.archivedAt),i=function({archivedAt:a,retentionDeleteAt:b}){let c,d=q(b);if(d)return d;var e=!Number.isFinite(c=Number.parseInt(String(process.env.CLIO_RETENTION_YEARS||"").trim(),10))||c<1?5:Math.min(c,25);let f=new Date(a);if(Number.isNaN(f.getTime())){let a=new Date;return a.setUTCFullYear(a.getUTCFullYear()+e),a.toISOString()}return f.setUTCFullYear(f.getUTCFullYear()+e),f.toISOString()}({archivedAt:h||f,retentionDeleteAt:a?.retentionDeleteAt}),j=r(a?.archivedBy)||null,l="string"==typeof a?.archiveReason?a.archiveReason:null,m="",n="",o="",t=null,w=null;try{m=v(a?.firstName),n=v(a?.middleName),o=v(a?.lastName)}catch{m="",n="",o=""}try{t=function(a){if(null==a||""===a)return null;let b=String(a).trim();if(!b)return null;if(/^data:image\/(png|jpeg|jpg|webp);base64,/i.test(b)){if(b.length>15e5)throw Error("invalid_profile_photo");return b}if(!/^https?:\/\/[^\s]+$/i.test(b)||b.length>2048)throw Error("invalid_profile_photo");return b}(a?.profilePhotoDataUrl)}catch{t=null}try{w=function(a){if(null==a||""===a)return null;let b=String(a).trim().replace(/^\/+/,"");if(!b)return null;if(b.length>512||b.includes("..")||b.includes("\\")||!/^clio\/[a-z0-9/_\-.\s]+$/i.test(b))throw Error("invalid_storage_path");return b}(a?.profilePhotoStoragePath)}catch{w=null}let z=a?.loginMfa&&"object"==typeof a.loginMfa?a.loginMfa:null,A="string"==typeof z?.challengeTokenHash?z.challengeTokenHash:null,C=q(z?.challengeExpiresAt),D=A?{challengeTokenHash:A,challengeExpiresAt:C||null,phoneMasked:"string"==typeof z?.phoneMasked?z.phoneMasked:null,phoneLast4:"string"==typeof z?.phoneLast4?z.phoneLast4:null,phoneHash:"string"==typeof z?.phoneHash?z.phoneHash:null,otpHash:"string"==typeof z?.otpHash?z.otpHash:null,otpExpiresAt:q(z?.otpExpiresAt)||null,otpRequestedAt:q(z?.otpRequestedAt)||null,otpAttemptCount:Number.isFinite(z?.otpAttemptCount)?Math.max(0,z.otpAttemptCount):0,otpMaxAttempts:Number.isFinite(z?.otpMaxAttempts)?Math.max(1,z.otpMaxAttempts):x(),resendAvailableAt:q(z?.resendAvailableAt)||null,updatedAt:q(z?.updatedAt)||null}:null,E=(Array.isArray(b=a?.knownDevices)?b:[]).map(y).filter(Boolean).sort((a,b)=>new Date(b.lastSeenAt||0).getTime()-new Date(a.lastSeenAt||0).getTime()).slice(0,12);return{id:"string"==typeof a?.id&&a.id.trim().length>0?a.id:c,email:c,role:d,status:e,sessionVersion:s(a?.sessionVersion,1),invitedBy:r(a?.invitedBy)||"system.clio@gmail.com",invitedAt:f,activatedAt:"string"==typeof a?.activatedAt?a.activatedAt:null,emailVerifiedAt:"string"==typeof a?.emailVerifiedAt?a.emailVerifiedAt:null,lastLoginAt:"string"==typeof a?.lastLoginAt?a.lastLoginAt:null,phoneVerifiedAt:"string"==typeof a?.phoneVerifiedAt?a.phoneVerifiedAt:null,phoneLast4:"string"==typeof a?.phoneLast4?a.phoneLast4:null,phoneHash:"string"==typeof a?.phoneHash?a.phoneHash:null,smsMfaEnabled:function(a,b=!1){if("boolean"==typeof a)return a;let c=String(a||"").trim().toLowerCase();return c?"true"===c||"1"===c||"yes"===c:b}(a?.smsMfaEnabled,!1),verificationMethod:["sms","email"].includes(a?.verificationMethod)?a.verificationMethod:null,archivedAt:h||null,archivedBy:j,archiveReason:l,isArchived:!!(a?.isArchived||h),retentionDeleteAt:h?i:q(a?.retentionDeleteAt)||null,firstName:m,middleName:n,lastName:o,profilePhotoDataUrl:t,profilePhotoStoragePath:w,profileUpdatedAt:"string"==typeof a?.profileUpdatedAt?a.profileUpdatedAt:null,knownDevices:E,loginMfa:D,updatedAt:g,source:a?.source==="bootstrap"?"bootstrap":"invite"}}function E(a){let b=r(a?.email);if(!u(b))return null;let d=B(a?.role,"HR"),e="string"==typeof a?.invitedAt?a.invitedAt:p(),f="string"==typeof a?.expiresAt?a.expiresAt:new Date(Date.now()+24*w("CLIO_INVITE_EXPIRATION_DAYS",7,{min:1,max:90})*36e5).toISOString(),g=l.has(a?.status)?a.status:"sent",h="string"==typeof a?.verification?.phoneMasked?a.verification.phoneMasked:null,i="string"==typeof a?.verification?.phoneLast4?a.verification.phoneLast4:null,j="string"==typeof a?.verification?.otpHash?a.verification.otpHash:null,k="string"==typeof a?.verification?.otpExpiresAt?a.verification.otpExpiresAt:null,m="string"==typeof a?.verification?.otpRequestedAt?a.verification.otpRequestedAt:null,n=Number.isFinite(a?.verification?.otpAttemptCount)?Math.max(0,a.verification.otpAttemptCount):0,o=Number.isFinite(a?.verification?.otpMaxAttempts)?Math.max(1,a.verification.otpMaxAttempts):x(),q="string"==typeof a?.verification?.resendAvailableAt?a.verification.resendAvailableAt:null,s="string"==typeof a?.verification?.verifiedAt?a.verification.verifiedAt:null,t="string"==typeof a?.verification?.phoneHash?a.verification.phoneHash:null,v="string"==typeof a?.createdAt?a.createdAt:e,y="string"==typeof a?.updatedAt?a.updatedAt:e;return{id:"string"==typeof a?.id&&a.id.trim().length>0?a.id:`INV-${Date.now()}-${Math.random().toString(36).slice(2,8).toUpperCase()}`,email:b,role:d,invitedBy:r(a?.invitedBy)||"system.clio@gmail.com",invitedAt:e,expiresAt:f,token:"string"==typeof a?.token&&a.token.trim().length>0?a.token:(0,c.randomBytes)(20).toString("hex"),status:g,createdAt:v,updatedAt:y,verification:{phoneMasked:h,phoneLast4:i,phoneHash:t,otpHash:j,otpExpiresAt:k,otpRequestedAt:m,otpAttemptCount:n,otpMaxAttempts:o,resendAvailableAt:q,verifiedAt:s}}}function F(a){let b=Array.isArray(a?.users)?a.users:[],c=Array.isArray(a?.invites)?a.invites:[],d=new Map;return b.map(D).filter(Boolean).forEach(a=>{d.has(a.email)||d.set(a.email,a)}),{users:Array.from(d.values()),invites:c.map(E).filter(Boolean)}}function G(a){let b={users:[...a.users],invites:[...a.invites]},c=new Set(b.users.map(a=>a.email)),d=p(),e=!1;for(let a of C())c.has(a.email)||(b.users.push({id:a.email,email:a.email,role:a.role,status:"active",sessionVersion:1,invitedBy:"system.clio@gmail.com",invitedAt:d,activatedAt:d,emailVerifiedAt:d,lastLoginAt:null,phoneVerifiedAt:d,phoneLast4:null,phoneHash:null,verificationMethod:"email",updatedAt:d,source:"bootstrap"}),c.add(a.email),e=!0);return{store:b,changed:e}}function H(a){let b=a.users.filter(a=>!t(a?.email)),c=a.invites.filter(a=>!t(a?.email)),d=b.length!==a.users.length||c.length!==a.invites.length;return{store:{users:b,invites:c},changed:d}}function I(a){return[...a].sort((a,b)=>{let c=new Date(a.updatedAt||a.invitedAt).getTime();return new Date(b.updatedAt||b.invitedAt).getTime()-c})}function J(a){return{id:a.id,email:a.email,role:a.role,status:a.status,sessionVersion:s(a?.sessionVersion,1),invitedBy:a.invitedBy,invitedAt:a.invitedAt,activatedAt:a.activatedAt,emailVerifiedAt:a.emailVerifiedAt,lastLoginAt:a.lastLoginAt,phoneVerifiedAt:a.phoneVerifiedAt,phoneLast4:a.phoneLast4,smsMfaEnabled:!!a?.smsMfaEnabled,verificationMethod:a.verificationMethod,archivedAt:a.archivedAt||null,archivedBy:a.archivedBy||null,archiveReason:a.archiveReason||null,isArchived:!!(a.isArchived||a.archivedAt),retentionDeleteAt:a.retentionDeleteAt||null,firstName:a.firstName||"",middleName:a.middleName||"",lastName:a.lastName||"",profilePhotoDataUrl:a.profilePhotoDataUrl||null,profilePhotoStoragePath:a.profilePhotoStoragePath||null,profileUpdatedAt:a.profileUpdatedAt||null,updatedAt:a.updatedAt,source:a.source}}function K(){return String(process.env.CLIO_FIRESTORE_USERS_COLLECTION||"clio_users").trim()||"clio_users"}async function L(){return(0,h.isFirestoreEnabled)()?(0,h.getFirestoreDb)():null}function M(a,b="user_accounts"){let c=Error("firestore_operation_failed");throw c.cause=a,c.operation=b,c.firestoreReason=a instanceof Error?a.message:"unknown_firestore_error",c}function N(a,b){return D({id:a,...b})}async function O(a){let b=K(),c=p();for(let d of C()){let e=r(d.email);if(!e)continue;let g=(0,f.doc)(a,b,e);(await (0,f.getDoc)(g)).exists()||await (0,f.setDoc)(g,{id:e,email:e,role:d.role,status:"active",sessionVersion:1,invitedBy:"system.clio@gmail.com",invitedAt:c,activatedAt:c,emailVerifiedAt:c,lastLoginAt:null,phoneVerifiedAt:c,phoneLast4:null,phoneHash:null,verificationMethod:"email",updatedAt:c,source:"bootstrap"})}}async function P(a){let b=K(),c=String(process.env.CLIO_FIRESTORE_INVITES_COLLECTION||"clio_user_invites").trim()||"clio_user_invites",d=Array.from(o);for(let c of d)try{let d=(0,f.doc)(a,b,c);(await (0,f.getDoc)(d)).exists()&&await (0,f.deleteDoc)(d)}catch{}try{let b=(0,f.query)((0,f.collection)(a,c),(0,f.where)("email","in",d),(0,f.limit)(20));for(let d of(await (0,f.getDocs)(b)).docs){let b=d.data()||{},e=r(b.email);o.has(e)&&await (0,f.deleteDoc)((0,f.doc)(a,c,d.id))}}catch{}}async function Q(a){await P(a),await O(a)}async function R(a){return await Q(a),I((await (0,f.getDocs)((0,f.collection)(a,K()))).docs.map(a=>N(a.id,a.data())).filter(Boolean).filter(a=>!t(a.email)).map(J))}async function S(a,b){if(t(b))return null;await Q(a);let c=(0,f.doc)(a,K(),b),d=await (0,f.getDoc)(c);if(!d.exists())return null;let e=N(d.id,d.data());return e?J(e):null}async function T(a){await d.promises.writeFile(j,`${JSON.stringify(a,null,2)}
`,"utf8")}async function U(){let a=await d.promises.readFile(j,"utf8").catch(()=>"");if(!a.trim())return{users:[],invites:[]};try{return JSON.parse(a)}catch{return{users:[],invites:[]}}}async function V(){return b||(b=(async()=>{await d.promises.mkdir(i,{recursive:!0});let{store:a}=H(F(await U())),{store:b}=G(a);await T(b)})()),b}async function W(){await V();let{store:a,changed:b}=H(F(await U())),{store:c,changed:d}=G(a);return(b||d)&&await T(c),c}async function X(){return I((await W()).users).filter(a=>!t(a.email)).map(J)}async function Y(a){let b=r(a);if(!b||t(b))return null;let c=(await W()).users.find(a=>a.email===b);return c?J(c):null}async function Z(){let a=await L();if(a)try{return await R(a)}catch(a){M(a,"list_user_accounts")}return await X()}async function $(a){let b=r(a);if(!b)return null;let c=await L();if(c)try{return await S(c,b)}catch(a){M(a,"get_login_account")}return await Y(b)}a.s(["getLoginAccount",()=>$,"listUserAccounts",()=>Z],39748)}];

//# sourceMappingURL=_1677a0e3._.js.map