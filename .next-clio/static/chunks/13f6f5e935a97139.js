(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,77135,e=>{"use strict";var t=e.i(43476),a=e.i(932),s=e.i(80064);let i={critical:"bg-rose-100 text-rose-700 ring-1 ring-rose-200",high:"bg-orange-100 text-orange-700 ring-1 ring-orange-200",medium:"bg-amber-100 text-amber-700 ring-1 ring-amber-200",low:"bg-emerald-100 text-emerald-700 ring-1 ring-emerald-200",open:"bg-cyan-100 text-cyan-700 ring-1 ring-cyan-200",containment:"bg-blue-100 text-blue-700 ring-1 ring-blue-200",investigating:"bg-indigo-100 text-indigo-700 ring-1 ring-indigo-200",escalated:"bg-violet-100 text-violet-700 ring-1 ring-violet-200","regulatory review":"bg-fuchsia-100 text-fuchsia-700 ring-1 ring-fuchsia-200",resolved:"bg-teal-100 text-teal-700 ring-1 ring-teal-200",closed:"bg-slate-200 text-slate-700 ring-1 ring-slate-300",active:"bg-emerald-100 text-emerald-700",approved:"bg-emerald-100 text-emerald-700",completed:"bg-sky-100 text-sky-700",exported:"bg-sky-100 text-sky-700",pending:"bg-amber-100 text-amber-700",rejected:"bg-rose-100 text-rose-700",failed:"bg-rose-100 text-rose-700",archived:"bg-slate-200 text-slate-700","in progress":"bg-indigo-100 text-indigo-700"};function n(e){let n,r,l=(0,a.c)(6),{value:o,className:d}=e,c=i[String(o||"").trim().toLowerCase()]||"bg-slate-100 text-slate-700";l[0]!==d||l[1]!==c?(n=(0,s.cn)("inline-flex rounded-md px-2 py-1 text-xs font-medium",c,d),l[0]=d,l[1]=c,l[2]=n):n=l[2];let m=o||"N/A";return l[3]!==n||l[4]!==m?(r=(0,t.jsx)("span",{className:n,children:m}),l[3]=n,l[4]=m,l[5]=r):r=l[5],r}e.s(["default",()=>n])},46670,e=>{"use strict";var t=e.i(43476),a=e.i(932),s=e.i(80064);function i(e){let i,n,r,l=(0,a.c)(12),{tabs:o,value:d,onChange:c,className:m}=e;if(l[0]!==m?(i=(0,s.cn)("flex flex-wrap gap-2",m),l[0]=m,l[1]=i):i=l[1],l[2]!==c||l[3]!==o||l[4]!==d){let e;l[6]!==c||l[7]!==d?(e=e=>{let a=e.id===d;return(0,t.jsx)("button",{type:"button",onClick:()=>c(e.id),className:(0,s.cn)("rounded-lg border px-3 py-1.5 text-xs font-medium transition",a?"border-sky-300 bg-sky-50 text-sky-700":"border-slate-300 bg-white text-slate-700 hover:bg-slate-50"),children:e.label},e.id)},l[6]=c,l[7]=d,l[8]=e):e=l[8],n=o.map(e),l[2]=c,l[3]=o,l[4]=d,l[5]=n}else n=l[5];return l[9]!==i||l[10]!==n?(r=(0,t.jsx)("div",{className:i,children:n}),l[9]=i,l[10]=n,l[11]=r):r=l[11],r}e.s(["default",()=>i])},38418,e=>{"use strict";var t=e.i(43476),a=e.i(932),s=e.i(80064);function i(e){let i,n,r,l=(0,a.c)(10),{title:o,subtitle:d,className:c,children:m,action:u}=e;return l[0]!==c?(i=(0,s.cn)("rounded-2xl border border-slate-200 bg-white p-5 shadow-[0_12px_30px_-24px_rgba(15,23,42,0.55)]",c),l[0]=c,l[1]=i):i=l[1],l[2]!==u||l[3]!==d||l[4]!==o?(n=(o||d||u)&&(0,t.jsxs)("header",{className:"mb-4 flex items-start justify-between gap-3",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[o&&(0,t.jsx)("h2",{className:"text-base font-semibold text-slate-900",children:o}),d&&(0,t.jsx)("p",{className:"text-sm text-slate-600",children:d})]}),u]}),l[2]=u,l[3]=d,l[4]=o,l[5]=n):n=l[5],l[6]!==m||l[7]!==i||l[8]!==n?(r=(0,t.jsxs)("section",{className:i,children:[n,m]}),l[6]=m,l[7]=i,l[8]=n,l[9]=r):r=l[9],r}e.s(["default",()=>i])},97256,e=>{"use strict";function t(e={}){let a=new URLSearchParams;Object.entries(e).forEach(([e,t])=>{if(null==t)return;let s=String(t).trim();s&&a.set(e,s)});let s=a.toString();return s?`?${s}`:""}async function a(e){if((e.headers.get("content-type")||"").includes("text/csv"))return await e.text();let t=await e.json().catch(()=>({}));if(!e.ok)throw Error(t?.message||"Request failed.");return t}async function s(e,t={}){let i=await fetch(e,{...t,headers:{"Content-Type":"application/json",...t.headers||{}},cache:"no-store"});return await a(i)}async function i(e,t={}){let a=await fetch(e,{...t,cache:"no-store"});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error(e?.message||"Export failed.")}return await a.text()}e.s(["hrisApi",0,{employees:{list:async(e={})=>await s(`/api/hris/employees${t(e)}`,{method:"GET"}),get:async e=>await s(`/api/hris/employees/${encodeURIComponent(e)}`,{method:"GET"}),create:async e=>await s("/api/hris/employees",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>await s(`/api/hris/employees/${encodeURIComponent(e)}`,{method:"PATCH",body:JSON.stringify(t)}),archive:async e=>await s(`/api/hris/employees/${encodeURIComponent(e)}`,{method:"PATCH",body:JSON.stringify({status:"Archived"})}),logDocumentAccess:async(e,t)=>await s(`/api/hris/employees/${encodeURIComponent(e)}/documents/access`,{method:"POST",body:JSON.stringify(t||{})})},lifecycle:{list:async(e={})=>await s(`/api/hris/lifecycle${t(e)}`,{method:"GET"}),get:async e=>await s(`/api/hris/lifecycle/${encodeURIComponent(e)}`,{method:"GET"}),create:async e=>await s("/api/hris/lifecycle",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>await s(`/api/hris/lifecycle/${encodeURIComponent(e)}`,{method:"PATCH",body:JSON.stringify(t)}),offboard:async(e,t={})=>await s(`/api/hris/lifecycle/${encodeURIComponent(e)}/offboard`,{method:"POST",body:JSON.stringify(t)}),approve:async(e,t={})=>await s(`/api/hris/lifecycle/${encodeURIComponent(e)}/approve`,{method:"POST",body:JSON.stringify(t)})},attendance:{list:async(e={})=>await s(`/api/hris/attendance${t(e)}`,{method:"GET"}),create:async e=>await s("/api/hris/attendance",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>await s(`/api/hris/attendance/${encodeURIComponent(e)}`,{method:"PATCH",body:JSON.stringify(t)})},leave:{list:async(e={})=>await s(`/api/hris/attendance/leave-requests${t(e)}`,{method:"GET"}),create:async e=>await s("/api/hris/attendance/leave-requests",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>await s(`/api/hris/attendance/leave-requests/${encodeURIComponent(e)}`,{method:"PATCH",body:JSON.stringify(t)}),approve:async(e,{approved:t,approvalNote:a})=>await s(`/api/hris/attendance/leave-requests/${encodeURIComponent(e)}`,{method:"PATCH",body:JSON.stringify({status:t?"Approved":"Rejected",approvalNote:a||""})})},performance:{list:async(e={})=>await s(`/api/hris/performance${t(e)}`,{method:"GET"}),create:async e=>await s("/api/hris/performance",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>await s(`/api/hris/performance/${encodeURIComponent(e)}`,{method:"PATCH",body:JSON.stringify(t)})},templates:{list:async(e={})=>await s(`/api/hris/templates${t(e)}`,{method:"GET"}),create:async e=>await s("/api/hris/templates",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>await s(`/api/hris/templates/${encodeURIComponent(e)}`,{method:"PATCH",body:JSON.stringify(t)}),archive:async e=>await s(`/api/hris/templates/${encodeURIComponent(e)}`,{method:"DELETE"})},activityLogs:{list:async(e={})=>await s(`/api/hris/activity-logs${t(e)}`,{method:"GET"}),async exportCsv(e={}){let a=t({...e,export:"csv"});return await i(`/api/hris/activity-logs${a}`,{method:"GET"})}},exports:{list:async(e={})=>await s(`/api/hris/exports${t(e)}`,{method:"GET"}),create:async e=>await s("/api/hris/exports",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>await s(`/api/hris/exports/${encodeURIComponent(e)}`,{method:"PATCH",body:JSON.stringify(t)}),approve:async(e,t)=>await s(`/api/hris/exports/${encodeURIComponent(e)}/approve`,{method:"POST",body:JSON.stringify(t)}),execute:async e=>await i(`/api/hris/exports/${encodeURIComponent(e)}/execute`,{method:"POST"})},retention:{list:async(e={})=>await s(`/api/hris/retention${t(e)}`,{method:"GET"}),purge:async(e={})=>await s("/api/hris/retention",{method:"POST",body:JSON.stringify(e)})},incidents:{list:async(e={})=>await s(`/api/hris/incidents${t(e)}`,{method:"GET"}),get:async e=>await s(`/api/hris/incidents/${encodeURIComponent(e)}`,{method:"GET"}),create:async e=>await s("/api/hris/incidents",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>await s(`/api/hris/incidents/${encodeURIComponent(e)}`,{method:"PATCH",body:JSON.stringify(t)})},settings:{referenceData:{list:async()=>await s("/api/hris/settings/reference-data",{method:"GET"}),create:async e=>await s("/api/hris/settings/reference-data",{method:"POST",body:JSON.stringify(e)}),remove:async e=>await s("/api/hris/settings/reference-data",{method:"DELETE",body:JSON.stringify(e)})}}}])},93096,e=>{"use strict";var t=e.i(43476),a=e.i(932);function s(e){let s,i,n,r=(0,a.c)(7),{title:l,subtitle:o}=e;return r[0]!==l?(s=(0,t.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:l}),r[0]=l,r[1]=s):s=r[1],r[2]!==o?(i=o?(0,t.jsx)("p",{className:"mt-1 text-xs text-slate-600",children:o}):null,r[2]=o,r[3]=i):i=r[3],r[4]!==s||r[5]!==i?(n=(0,t.jsxs)("div",{className:"rounded-xl border border-dashed border-slate-300 bg-slate-50/80 px-4 py-5 text-center",children:[s,i]}),r[4]=s,r[5]=i,r[6]=n):n=r[6],n}e.s(["default",()=>s])},91034,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(38418),i=e.i(93096),n=e.i(46670),r=e.i(77135),l=e.i(74923),o=e.i(32295),d=e.i(97256),c=e.i(9968);let m=[{id:"escalation-plan",label:"Escalation Plan"},{id:"regulatory-72-hour-notification",label:"72-Hour Notification"},{id:"forensic-logging",label:"Forensic Logging"}],u=["Low","Medium","High","Critical"],x=["Open","Containment","Investigating","Escalated","Regulatory Review","Resolved","Closed"],p=["Not Started","In Progress","Contained"],h=["Pending","In Progress","Completed"],g=["Unauthorized Access","Data Exposure","Credential Compromise","Insider Misuse","Malware / Ransomware","Policy Violation","System Misconfiguration","Other"],b=["Not Required","Pending","Notified","Overdue"],y={q:"",status:"all",severity:"all",incidentType:"all",regulatoryStatus:"all",restrictedPii:"all",page:1,pageSize:12},f={title:"",summary:"",incidentType:"Unauthorized Access",severity:"Medium",detectedAt:"",ownerEmail:"",affectedEmployeeEmail:"",restrictedPiiInvolved:!1,executiveNotificationRequired:!1,regulatoryNotificationRequired:!1,documentationLocation:"",notes:"",classificationStandard:"CLIO-IR-SEVERITY-V1"};function v(e){let t=new Date(e||"");return Number.isNaN(t.getTime())?"-":new Intl.DateTimeFormat("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(t)}function N(e){let t=new Date(e||Date.now());if(Number.isNaN(t.getTime()))return"";let a=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),n=String(t.getHours()).padStart(2,"0"),r=String(t.getMinutes()).padStart(2,"0");return`${a}-${s}-${i}T${n}:${r}`}function j(e){let t=String(e||"").trim();if(!t)return"";let a=new Date(t);return Number.isNaN(a.getTime())?"":a.toISOString()}function w(){return new Date().toISOString()}function S(e){return String(e?.title||"").trim()||String(e?.incidentCode||"").trim()||"Incident"}function k({session:e}){let k=(0,l.useToast)(),C=String(e?.role||"").trim().toUpperCase(),E="GRC"===C||"SUPER_ADMIN"===C,[A,I]=(0,a.useState)("escalation-plan"),[R,T]=(0,a.useState)(y),[P,O]=(0,a.useState)([]),[$,L]=(0,a.useState)({total:0,openCases:0,criticalOpen:0,containmentPending:0,dueWithin72Hours:0,overdue72HourNotifications:0}),[U,D]=(0,a.useState)({page:1,pageSize:12,total:0,totalPages:1}),[q,J]=(0,a.useState)(!0),[M,G]=(0,a.useState)(!1),[H,W]=(0,a.useState)(!1),[z,B]=(0,a.useState)({...f,ownerEmail:String(e?.email||"").trim().toLowerCase()}),[_,F]=(0,a.useState)(""),[V,Y]=(0,a.useState)(null),[K,Q]=(0,a.useState)(null),[X,Z]=(0,a.useState)(!1),[ee,et]=(0,a.useState)(!1),[ea,es]=(0,a.useState)(!1),ei=(0,a.useRef)(null),en=(0,a.useCallback)(async()=>{J(!0);try{let e=await d.hrisApi.incidents.list(R),t=Array.isArray(e?.records)?e.records:[];t.sort((e,t)=>new Date(t?.updatedAt||t?.createdAt||0).getTime()-new Date(e?.updatedAt||e?.createdAt||0).getTime()),O(t),L(e?.summary||{}),D(e?.pagination||{page:1,pageSize:12,total:0,totalPages:1})}catch(e){O([]),k.error(e.message||"Unable to load incident records.")}finally{J(!1)}},[R,k]),er=(0,a.useCallback)(async e=>{let t=String(e||"").trim();if(t){Z(!0);try{let e=await d.hrisApi.incidents.get(t),a=e?.record||null;Y(a),Q(a?{title:String(a?.title||""),summary:String(a?.summary||""),incidentType:String(a?.incidentType||"Other"),severity:String(a?.severity||"Medium"),status:String(a?.status||"Open"),containmentStatus:String(a?.containmentStatus||"Not Started"),containmentSummary:String(a?.containmentSummary||""),impactAssessmentStatus:String(a?.impactAssessmentStatus||"Pending"),impactSummary:String(a?.impactSummary||""),ownerEmail:String(a?.ownerEmail||""),affectedEmployeeEmail:String(a?.affectedEmployeeEmail||""),restrictedPiiInvolved:!!a?.restrictedPiiInvolved,executiveNotificationRequired:!!a?.executiveNotificationRequired,regulatoryNotificationRequired:!!a?.regulatoryNotificationRequired,documentationRetained:!!a?.documentationRetained,documentationLocation:String(a?.documentationLocation||""),notes:String(a?.notes||""),classificationStandard:String(a?.classificationStandard||"CLIO-IR-SEVERITY-V1"),forensicWindowStart:N(a?.forensicWindowStart),forensicWindowEnd:N(a?.forensicWindowEnd)}:null)}catch(e){k.error(e.message||"Unable to load incident details.")}finally{Z(!1)}}},[k]);(0,a.useEffect)(()=>{en()},[en]),(0,a.useEffect)(()=>{_&&er(_)},[_,er]),(0,a.useEffect)(()=>{let e=(e=window.location.hash)=>{let t=String(e||"").replace(/^#/,"").trim().toLowerCase();if(!t)return;let a=m.find(e=>(0,o.toSubTabAnchor)(e.id)===t);a&&I(a.id)},t=t=>{if(t?.detail?.moduleId&&"incident-management"!==t.detail.moduleId)return;let a=t?.detail?.anchor;a&&e(`#${a}`)};return e(),window.addEventListener("hashchange",e),window.addEventListener("popstate",e),window.addEventListener("clio:subtab-anchor",t),()=>{window.removeEventListener("hashchange",e),window.removeEventListener("popstate",e),window.removeEventListener("clio:subtab-anchor",t)}},[]);let el=(e,t)=>{T(a=>({...a,[e]:t,page:1}))},eo=(0,a.useCallback)(async(e,t)=>{if(E&&_){et(!0);try{await d.hrisApi.incidents.update(_,e),await er(_),await en(),t&&k.success(t)}catch(e){k.error(e.message||"Unable to update incident.")}finally{et(!1)}}},[E,_,er,en,k]),ed=async e=>{if(e.preventDefault(),E){if(!String(z.title||"").trim())return void k.error("Incident title is required.");W(!0);try{let e={...z,detectedAt:j(z.detectedAt)||w(),ownerEmail:String(z.ownerEmail||"").trim().toLowerCase(),affectedEmployeeEmail:String(z.affectedEmployeeEmail||"").trim().toLowerCase()},t=await d.hrisApi.incidents.create(e);k.success("Incident record created."),G(!1),await en(),t?.record?.id&&F(t.record.id)}catch(e){k.error(e.message||"Unable to create incident.")}finally{W(!1)}}},ec=async()=>{E&&K&&await eo({...K,ownerEmail:String(K.ownerEmail||"").trim().toLowerCase(),affectedEmployeeEmail:String(K.affectedEmployeeEmail||"").trim().toLowerCase(),forensicWindowStart:j(K.forensicWindowStart),forensicWindowEnd:j(K.forensicWindowEnd)},"Incident workflow updated.")},em=async(e,t,a={})=>{await eo({[e]:w(),...a},t)},eu=async t=>{let a=t.target.files?.[0];if(t.target.value="",a&&V&&E){es(!0);try{let t=await (0,c.uploadIncidentEvidenceToStorage)({file:a,incidentRecordId:V.id,affectedEmployeeEmail:V.affectedEmployeeEmail}),s=[...Array.isArray(V.evidenceDocuments)?V.evidenceDocuments:[],{id:`${Date.now()}-${Math.random().toString(36).slice(2,7)}`,name:a.name||"Incident Evidence",type:"Incident Evidence",ref:t.downloadUrl,storagePath:t.storagePath,contentType:t.contentType||a.type||"",fileExtension:String(a.name||"").split(".").pop()||"",sizeBytes:t.sizeBytes,uploadedAt:w(),uploadedBy:String(e?.email||"").trim().toLowerCase()}];await eo({evidenceDocuments:s,documentationRetained:!0},"Incident evidence uploaded.")}catch(e){k.error(e.message||"Unable to upload evidence.")}finally{es(!1)}}},ex=async e=>{var t;if(!V||!E||(t=`Remove evidence "${String(e?.name||"file")}"?`,!window.confirm(t)))return;let a=(Array.isArray(V.evidenceDocuments)?V.evidenceDocuments:[]).filter(t=>String(t?.id||"").trim()!==String(e?.id||"").trim());await eo({evidenceDocuments:a},"Evidence removed."),e?.storagePath&&await (0,c.removeStorageObjectByPath)(e.storagePath)},ep=(0,a.useMemo)(()=>"regulatory-72-hour-notification"===A?P.filter(e=>!!e?.regulatoryNotificationRequired||!!e?.restrictedPiiInvolved):"forensic-logging"===A?P.filter(e=>Number(e?.forensicSummary?.totalScopedLogs||0)>0||!!e?.forensicSnapshot):P,[P,A]),eh=(0,a.useMemo)(()=>"regulatory-72-hour-notification"===A?[{key:"total",label:"Total Incidents",value:$.total||0},{key:"due",label:"Due Within 72h",value:$.dueWithin72Hours||0},{key:"overdue",label:"Overdue Notifications",value:$.overdue72HourNotifications||0}]:"forensic-logging"===A?[{key:"total",label:"Total Incidents",value:$.total||0},{key:"logs",label:"Selected Scoped Logs",value:Number(V?.forensicSummary?.totalScopedLogs||0)},{key:"deletions",label:"Selected Deletion Logs",value:Number(V?.forensicSummary?.deletionActivitiesCount||0)}]:[{key:"total",label:"Total Incidents",value:$.total||0},{key:"open",label:"Open Cases",value:$.openCases||0},{key:"critical",label:"Critical Open",value:$.criticalOpen||0},{key:"containment",label:"Containment Pending",value:$.containmentPending||0}],[A,$,V]),eg=0===U.total?0:(U.page-1)*U.pageSize+1,eb=Math.min(U.total||0,U.page*U.pageSize),ey=Array.isArray(V?.evidenceDocuments)?V.evidenceDocuments:[];return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(n.default,{tabs:m,value:A,onChange:e=>{I(e);{let t=(0,o.toSubTabAnchor)(e);window.history.pushState(null,"",`${window.location.pathname}#${t}`),window.dispatchEvent(new CustomEvent("clio:subtab-anchor",{detail:{moduleId:"incident-management",anchor:t}}))}}}),(0,t.jsx)(s.default,{title:"escalation-plan"===A?"Defined Escalation Plan":"regulatory-72-hour-notification"===A?"72-Hour Regulatory Notification":"Forensic Logging",subtitle:"escalation-plan"===A?"Severity-based escalation and containment prioritization.":"regulatory-72-hour-notification"===A?"PII breach notification window and compliance timeline.":"Access/export/admin/deletion traces for incident investigation.",children:(0,t.jsx)("div",{className:`grid gap-3 ${eh.length>3?"sm:grid-cols-2 lg:grid-cols-4":"sm:grid-cols-3"}`,children:eh.map(e=>(0,t.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500",children:e.label}),(0,t.jsx)("p",{className:"mt-0.5 text-lg font-semibold text-slate-900",children:e.value})]},e.key))})}),(0,t.jsxs)(s.default,{title:"Incident Records",subtitle:"Response workflow, escalation actions, and forensic-ready incident traceability.",action:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[E?(0,t.jsx)("button",{type:"button",onClick:()=>{B({...f,ownerEmail:String(e?.email||"").trim().toLowerCase(),detectedAt:N(w())}),G(!0)},className:"inline-flex h-9 items-center rounded-lg bg-sky-600 px-4 text-xs font-semibold text-white transition hover:bg-sky-700",children:"Create Incident"}):null,(0,t.jsx)("button",{type:"button",onClick:en,disabled:q,className:"inline-flex h-9 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60",children:"Refresh"})]}),children:[(0,t.jsxs)("div",{className:"grid gap-2 md:grid-cols-3 lg:grid-cols-6",children:[(0,t.jsx)("input",{value:R.q,onChange:e=>el("q",e.target.value),placeholder:"Search incident",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 placeholder:text-slate-400 focus:border-sky-400 focus:outline-none md:col-span-2"}),(0,t.jsxs)("select",{value:R.status,onChange:e=>el("status",e.target.value),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:[(0,t.jsx)("option",{value:"all",children:"All Status"}),x.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]}),(0,t.jsxs)("select",{value:R.severity,onChange:e=>el("severity",e.target.value),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:[(0,t.jsx)("option",{value:"all",children:"All Severity"}),u.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]}),(0,t.jsxs)("select",{value:R.incidentType,onChange:e=>el("incidentType",e.target.value),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:[(0,t.jsx)("option",{value:"all",children:"All Types"}),g.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]}),(0,t.jsxs)("select",{value:R.regulatoryStatus,onChange:e=>el("regulatoryStatus",e.target.value),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:[(0,t.jsx)("option",{value:"all",children:"All Regulatory"}),b.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]}),(0,t.jsxs)("select",{value:R.restrictedPii,onChange:e=>el("restrictedPii",e.target.value),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:[(0,t.jsx)("option",{value:"all",children:"PII: All"}),(0,t.jsx)("option",{value:"yes",children:"PII: Yes"}),(0,t.jsx)("option",{value:"no",children:"PII: No"})]})]}),(0,t.jsx)("div",{className:"mt-4",children:q?(0,t.jsx)("div",{className:"flex justify-center py-6",children:(0,t.jsx)("span",{className:"inline-flex h-6 w-6 animate-spin rounded-full border-2 border-slate-300 border-t-sky-600","aria-hidden":"true"})}):0===ep.length?(0,t.jsx)(i.default,{title:"No incident records found",subtitle:"Create incidents or adjust filters to continue."}):(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full text-left text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-slate-200 text-xs uppercase tracking-[0.1em] text-slate-500",children:[(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"Incident"}),(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"Severity"}),(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"Status"}),(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"Escalation"}),(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"Regulatory"}),(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"Updated"}),(0,t.jsx)("th",{className:"px-2 py-3 font-medium text-right",children:"Action"})]})}),(0,t.jsx)("tbody",{children:ep.map(e=>(0,t.jsxs)("tr",{className:"border-b border-slate-100 text-slate-700 last:border-b-0",children:[(0,t.jsxs)("td",{className:"px-2 py-3",children:[(0,t.jsx)("p",{className:"font-medium text-slate-900",children:S(e)}),(0,t.jsx)("p",{className:"text-xs text-slate-500",children:String(e?.incidentCode||"N/A")})]}),(0,t.jsx)("td",{className:"px-2 py-3",children:(0,t.jsx)(r.default,{value:e?.severity||"Medium"})}),(0,t.jsx)("td",{className:"px-2 py-3",children:(0,t.jsx)(r.default,{value:e?.status||"Open"})}),(0,t.jsxs)("td",{className:"px-2 py-3 text-xs",children:[(0,t.jsx)("p",{className:"font-medium text-slate-800",children:String(e?.escalationLevel||"-")}),(0,t.jsxs)("p",{className:"text-slate-500",children:["GRC: ",e?.grcAlertedAt?"Yes":"No"]})]}),(0,t.jsxs)("td",{className:"px-2 py-3 text-xs",children:[(0,t.jsx)("p",{className:"font-medium text-slate-800",children:String(e?.regulatoryStatus||"Not Required")}),(0,t.jsxs)("p",{className:"text-slate-500",children:["Due: ",v(e?.regulatoryDueAt)]})]}),(0,t.jsx)("td",{className:"px-2 py-3 text-xs text-slate-600",children:v(e?.updatedAt||e?.createdAt)}),(0,t.jsx)("td",{className:"px-2 py-3 text-right",children:(0,t.jsx)("button",{type:"button",onClick:()=>F(e.id),className:"inline-flex h-8 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-medium text-slate-700 transition hover:bg-slate-50",children:"Open"})})]},e.id))})]})})}),(0,t.jsxs)("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-600",children:[(0,t.jsxs)("p",{children:["Showing ",eg,"-",eb," of ",U.total||0," records"]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{type:"button",onClick:()=>T(e=>({...e,page:Math.max(1,e.page-1)})),disabled:1>=(U.page||1)||q,className:"inline-flex h-8 items-center rounded-lg border border-slate-300 bg-white px-3 font-medium text-slate-700 transition hover:bg-slate-100 disabled:opacity-60",children:"Previous"}),(0,t.jsxs)("span",{children:["Page ",U.page||1," of ",Math.max(1,U.totalPages||1)]}),(0,t.jsx)("button",{type:"button",onClick:()=>T(e=>({...e,page:Math.min(Math.max(1,U.totalPages||1),e.page+1)})),disabled:(U.page||1)>=(U.totalPages||1)||q,className:"inline-flex h-8 items-center rounded-lg border border-slate-300 bg-white px-3 font-medium text-slate-700 transition hover:bg-slate-100 disabled:opacity-60",children:"Next"})]})]})]}),M?(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/45 p-4",role:"dialog","aria-modal":"true","aria-label":"Create Incident",onClick:()=>!H&&G(!1),children:(0,t.jsxs)("div",{className:"w-full max-w-4xl rounded-2xl border border-slate-200 bg-white p-4 shadow-2xl sm:p-5",onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"mb-3 flex items-start justify-between gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-base font-semibold text-slate-900",children:"Create Incident"}),(0,t.jsx)("p",{className:"mt-0.5 text-sm text-slate-600",children:"Capture incident details and initialize compliance workflow."})]}),(0,t.jsx)("button",{type:"button",onClick:()=>!H&&G(!1),disabled:H,className:"inline-flex h-8 w-8 items-center justify-center rounded-lg border border-slate-300 bg-white text-slate-600 transition hover:bg-slate-50 disabled:opacity-60","aria-label":"Close create incident",children:(0,t.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.9",className:"h-4 w-4","aria-hidden":"true",children:(0,t.jsx)("path",{d:"m6 6 12 12M18 6 6 18"})})})]}),(0,t.jsxs)("form",{className:"space-y-3",onSubmit:ed,children:[(0,t.jsxs)("div",{className:"grid gap-2 md:grid-cols-2",children:[(0,t.jsx)("input",{required:!0,value:z.title,onChange:e=>B(t=>({...t,title:e.target.value})),placeholder:"Incident title",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none md:col-span-2"}),(0,t.jsx)("select",{value:z.severity,onChange:e=>B(t=>({...t,severity:e.target.value})),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:u.map(e=>(0,t.jsx)("option",{value:e,children:e},`create-severity-${e}`))}),(0,t.jsx)("select",{value:z.incidentType,onChange:e=>B(t=>({...t,incidentType:e.target.value})),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:g.map(e=>(0,t.jsx)("option",{value:e,children:e},`create-type-${e}`))}),(0,t.jsx)("input",{type:"datetime-local",value:z.detectedAt,onChange:e=>B(t=>({...t,detectedAt:e.target.value})),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,t.jsx)("input",{value:z.ownerEmail,onChange:e=>B(t=>({...t,ownerEmail:e.target.value})),placeholder:"Owner email",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,t.jsx)("input",{value:z.affectedEmployeeEmail,onChange:e=>B(t=>({...t,affectedEmployeeEmail:e.target.value})),placeholder:"Affected employee email",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none md:col-span-2"}),(0,t.jsx)("textarea",{rows:3,value:z.summary,onChange:e=>B(t=>({...t,summary:e.target.value})),placeholder:"Incident summary",className:"rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none md:col-span-2"})]}),(0,t.jsxs)("div",{className:"grid gap-2 sm:grid-cols-3",children:[(0,t.jsxs)("label",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:z.restrictedPiiInvolved,onChange:e=>B(t=>({...t,restrictedPiiInvolved:e.target.checked})),className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),(0,t.jsx)("span",{className:"text-xs text-slate-700",children:"Restricted PII"})]}),(0,t.jsxs)("label",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:z.executiveNotificationRequired,onChange:e=>B(t=>({...t,executiveNotificationRequired:e.target.checked})),className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),(0,t.jsx)("span",{className:"text-xs text-slate-700",children:"Executive Notice"})]}),(0,t.jsxs)("label",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:z.regulatoryNotificationRequired,onChange:e=>B(t=>({...t,regulatoryNotificationRequired:e.target.checked})),className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),(0,t.jsx)("span",{className:"text-xs text-slate-700",children:"Regulatory Notice"})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-2 border-t border-slate-200 pt-3",children:[(0,t.jsx)("button",{type:"button",onClick:()=>G(!1),disabled:H,className:"inline-flex h-9 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-70",children:"Cancel"}),(0,t.jsx)("button",{type:"submit",disabled:H,className:"inline-flex h-9 items-center rounded-lg bg-sky-600 px-4 text-xs font-semibold text-white transition hover:bg-sky-700 disabled:opacity-70",children:H?"Creating...":"Create Incident"})]})]})]})}):null,_?(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/45 p-4",role:"dialog","aria-modal":"true","aria-label":"Incident Workbench",onClick:()=>!ee&&!ea&&F(""),children:(0,t.jsxs)("div",{className:"w-full max-w-6xl rounded-2xl border border-slate-200 bg-white p-4 shadow-2xl sm:p-5",onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{className:"mb-3 flex items-start justify-between gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-base font-semibold text-slate-900",children:"Incident Workbench"}),(0,t.jsx)("p",{className:"mt-0.5 text-sm text-slate-600",children:"Escalation, 72-hour actions, and forensic evidence."})]}),(0,t.jsx)("button",{type:"button",onClick:()=>!ee&&!ea&&F(""),disabled:ee||ea,className:"inline-flex h-8 w-8 items-center justify-center rounded-lg border border-slate-300 bg-white text-slate-600 transition hover:bg-slate-50 disabled:opacity-60","aria-label":"Close incident workbench",children:(0,t.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.9",className:"h-4 w-4","aria-hidden":"true",children:(0,t.jsx)("path",{d:"m6 6 12 12M18 6 6 18"})})})]}),!X&&V&&K?(0,t.jsxs)("div",{className:"max-h-[72vh] space-y-3 overflow-y-auto pr-1",children:[(0,t.jsxs)("div",{className:"grid gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2.5 sm:grid-cols-2 lg:grid-cols-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500",children:"Incident"}),(0,t.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:S(V)}),(0,t.jsx)("p",{className:"text-xs text-slate-500",children:String(V?.incidentCode||"N/A")})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500",children:"Detected"}),(0,t.jsx)("p",{className:"text-xs text-slate-700",children:v(V?.detectedAt)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500",children:"Regulatory Due"}),(0,t.jsx)("p",{className:"text-xs text-slate-700",children:v(V?.regulatoryDueAt)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500",children:"Regulatory Status"}),(0,t.jsx)(r.default,{value:V?.regulatoryStatus||"Not Required"})]})]}),(0,t.jsxs)("div",{className:"grid gap-3 lg:grid-cols-2",children:[(0,t.jsxs)(s.default,{title:"Workflow Control",subtitle:"Severity, containment, impact, and status updates",children:[(0,t.jsxs)("div",{className:"grid gap-2 sm:grid-cols-2",children:[(0,t.jsx)("select",{value:K.severity,onChange:e=>Q(t=>({...t,severity:e.target.value})),disabled:!E||ee,className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100",children:u.map(e=>(0,t.jsx)("option",{value:e,children:e},`d-sev-${e}`))}),(0,t.jsx)("select",{value:K.status,onChange:e=>Q(t=>({...t,status:e.target.value})),disabled:!E||ee,className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100",children:x.map(e=>(0,t.jsx)("option",{value:e,children:e},`d-status-${e}`))}),(0,t.jsx)("select",{value:K.containmentStatus,onChange:e=>Q(t=>({...t,containmentStatus:e.target.value})),disabled:!E||ee,className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100",children:p.map(e=>(0,t.jsx)("option",{value:e,children:e},`d-cont-${e}`))}),(0,t.jsx)("select",{value:K.impactAssessmentStatus,onChange:e=>Q(t=>({...t,impactAssessmentStatus:e.target.value})),disabled:!E||ee,className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100",children:h.map(e=>(0,t.jsx)("option",{value:e,children:e},`d-impact-${e}`))})]}),(0,t.jsx)("textarea",{value:K.summary,onChange:e=>Q(t=>({...t,summary:e.target.value})),rows:2,placeholder:"Incident summary",disabled:!E||ee,className:"mt-2 w-full rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100"}),(0,t.jsx)("textarea",{value:K.containmentSummary,onChange:e=>Q(t=>({...t,containmentSummary:e.target.value})),rows:2,placeholder:"Containment summary",disabled:!E||ee,className:"mt-2 w-full rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100"}),(0,t.jsx)("textarea",{value:K.impactSummary,onChange:e=>Q(t=>({...t,impactSummary:e.target.value})),rows:2,placeholder:"Impact summary",disabled:!E||ee,className:"mt-2 w-full rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100"})]}),(0,t.jsxs)(s.default,{title:"72-Hour Controls",subtitle:"Regulatory, executive, and affected-individual notifications",children:[(0,t.jsxs)("div",{className:"grid gap-2 sm:grid-cols-2",children:[(0,t.jsxs)("label",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:K.regulatoryNotificationRequired,onChange:e=>Q(t=>({...t,regulatoryNotificationRequired:e.target.checked})),disabled:!E||ee,className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),(0,t.jsx)("span",{className:"text-xs text-slate-700",children:"Regulatory required"})]}),(0,t.jsxs)("label",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsx)("input",{type:"checkbox",checked:K.documentationRetained,onChange:e=>Q(t=>({...t,documentationRetained:e.target.checked})),disabled:!E||ee,className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),(0,t.jsx)("span",{className:"text-xs text-slate-700",children:"Documentation retained"})]})]}),(0,t.jsxs)("div",{className:"mt-2 grid gap-2 sm:grid-cols-2",children:[(0,t.jsx)("input",{value:K.documentationLocation,onChange:e=>Q(t=>({...t,documentationLocation:e.target.value})),placeholder:"Documentation location",disabled:!E||ee,className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100"}),(0,t.jsx)("input",{value:K.classificationStandard,onChange:e=>Q(t=>({...t,classificationStandard:e.target.value})),placeholder:"Classification standard",disabled:!E||ee,className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100"})]}),(0,t.jsxs)("div",{className:"mt-2 grid gap-2 sm:grid-cols-2 lg:grid-cols-3",children:[(0,t.jsx)("button",{type:"button",onClick:()=>em("grcAlertedAt","GRC alerted.",{escalationRequired:!0}),disabled:!E||ee,className:"inline-flex h-8 items-center justify-center rounded-md border border-slate-300 bg-white px-3 text-[11px] font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60",children:"Mark GRC Alerted"}),(0,t.jsx)("button",{type:"button",onClick:()=>em("executiveNotifiedAt","Executive notification recorded.",{executiveNotificationRequired:!0}),disabled:!E||ee,className:"inline-flex h-8 items-center justify-center rounded-md border border-slate-300 bg-white px-3 text-[11px] font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60",children:"Mark Executive Notified"}),(0,t.jsx)("button",{type:"button",onClick:()=>em("regulatoryNotifiedAt","Regulatory notification recorded.",{regulatoryNotificationRequired:!0,status:"Regulatory Review"}),disabled:!E||ee,className:"inline-flex h-8 items-center justify-center rounded-md border border-slate-300 bg-white px-3 text-[11px] font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60",children:"Mark Regulator Notified"}),(0,t.jsx)("button",{type:"button",onClick:()=>em("affectedIndividualsNotifiedAt","Affected individuals notification recorded."),disabled:!E||ee,className:"inline-flex h-8 items-center justify-center rounded-md border border-slate-300 bg-white px-3 text-[11px] font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60",children:"Mark Affected Individuals"}),(0,t.jsx)("button",{type:"button",onClick:()=>eo({refreshForensicSnapshot:!0},"Forensic snapshot refreshed."),disabled:!E||ee,className:"inline-flex h-8 items-center justify-center rounded-md border border-sky-200 bg-sky-50 px-3 text-[11px] font-semibold text-sky-700 transition hover:bg-sky-100 disabled:opacity-60",children:"Refresh Forensic"})]})]})]}),(0,t.jsxs)(s.default,{title:"Incident Evidence",subtitle:"Retained case documents and attachments",children:[(0,t.jsx)("input",{ref:ei,type:"file",className:"hidden",onChange:eu}),(0,t.jsx)("div",{className:"mb-2 flex justify-end",children:E?(0,t.jsx)("button",{type:"button",onClick:()=>ei.current?.click(),disabled:ea||ee,className:"inline-flex h-8 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60",children:ea?"Uploading...":"Upload Evidence"}):null}),0===ey.length?(0,t.jsx)(i.default,{title:"No evidence files attached",subtitle:"Upload incident files to retain case evidence."}):(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full text-left text-sm",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-slate-200 text-xs uppercase tracking-[0.1em] text-slate-500",children:[(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"Document"}),(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"Uploaded At"}),(0,t.jsx)("th",{className:"px-2 py-3 font-medium",children:"Uploaded By"}),(0,t.jsx)("th",{className:"px-2 py-3 font-medium text-right",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:ey.map((e,a)=>(0,t.jsxs)("tr",{className:"border-b border-slate-100 text-slate-700 last:border-b-0",children:[(0,t.jsxs)("td",{className:"px-2 py-3",children:[(0,t.jsx)("p",{className:"font-medium text-slate-900",children:String(e?.name||"Incident Evidence")}),(0,t.jsx)("p",{className:"text-xs text-slate-500",children:String(e?.type||"Incident Evidence")})]}),(0,t.jsx)("td",{className:"px-2 py-3 text-xs text-slate-600",children:v(e?.uploadedAt)}),(0,t.jsx)("td",{className:"px-2 py-3 text-xs text-slate-600",children:String(e?.uploadedBy||"-")}),(0,t.jsx)("td",{className:"px-2 py-3 text-right",children:(0,t.jsxs)("div",{className:"inline-flex items-center gap-2",children:[e?.ref?(0,t.jsx)("a",{href:e.ref,target:"_blank",rel:"noreferrer",className:"inline-flex h-8 items-center rounded-lg border border-sky-200 bg-sky-50 px-3 text-xs font-semibold text-sky-700 transition hover:bg-sky-100",children:"Open"}):null,E?(0,t.jsx)("button",{type:"button",onClick:()=>ex(e),disabled:ee||ea,className:"inline-flex h-8 items-center rounded-lg border border-rose-200 bg-rose-50 px-3 text-xs font-semibold text-rose-700 transition hover:bg-rose-100 disabled:opacity-60",children:"Remove"}):null]})})]},`${e?.id||"evidence"}-${a}`))})]})})]}),(0,t.jsxs)(s.default,{title:"Forensic Logging",subtitle:"Scoped logs for access, export, administrative, and deletion events",children:[(0,t.jsxs)("div",{className:"grid gap-2 sm:grid-cols-2 lg:grid-cols-5",children:[(0,t.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Scoped Logs"}),(0,t.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:Number(V?.forensicSummary?.totalScopedLogs||0)})]}),(0,t.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Access"}),(0,t.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:Number(V?.forensicSummary?.accessLogsCount||0)})]}),(0,t.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Exports"}),(0,t.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:Number(V?.forensicSummary?.exportLogsCount||0)})]}),(0,t.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Administrative"}),(0,t.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:Number(V?.forensicSummary?.administrativeActionsCount||0)})]}),(0,t.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,t.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Deletion"}),(0,t.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:Number(V?.forensicSummary?.deletionActivitiesCount||0)})]})]}),(0,t.jsx)("div",{className:"mt-3 grid gap-3 lg:grid-cols-2",children:[{key:"accessLogs",label:"Access Logs"},{key:"exportLogs",label:"Export Logs"},{key:"administrativeActions",label:"Administrative Actions"},{key:"deletionActivities",label:"Deletion Activities"}].map(e=>{let a=Array.isArray(V?.forensicSnapshot?.[e.key])?V.forensicSnapshot[e.key].slice(0,20):[];return(0,t.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white",children:[(0,t.jsx)("div",{className:"border-b border-slate-200 px-3 py-2",children:(0,t.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.08em] text-slate-500",children:e.label})}),0===a.length?(0,t.jsx)("p",{className:"px-3 py-3 text-xs text-slate-500",children:"No entries."}):(0,t.jsx)("div",{className:"max-h-52 overflow-auto",children:(0,t.jsxs)("table",{className:"min-w-full text-left text-xs",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"border-b border-slate-200 text-[11px] uppercase tracking-[0.08em] text-slate-500",children:[(0,t.jsx)("th",{className:"px-3 py-2 font-medium",children:"Action"}),(0,t.jsx)("th",{className:"px-3 py-2 font-medium",children:"Module"}),(0,t.jsx)("th",{className:"px-3 py-2 font-medium",children:"When"}),(0,t.jsx)("th",{className:"px-3 py-2 font-medium",children:"By"})]})}),(0,t.jsx)("tbody",{children:a.map((a,s)=>(0,t.jsxs)("tr",{className:"border-b border-slate-100 text-slate-700 last:border-b-0",children:[(0,t.jsx)("td",{className:"px-3 py-2",children:String(a?.activityName||"-")}),(0,t.jsx)("td",{className:"px-3 py-2",children:String(a?.module||"-")}),(0,t.jsx)("td",{className:"px-3 py-2",children:v(a?.occurredAt)}),(0,t.jsx)("td",{className:"px-3 py-2",children:String(a?.performedBy||"-")})]},`${e.key}-${a.id||a.occurredAt||"row"}-${s}`))})]})})]},e.key)})})]}),(0,t.jsx)(s.default,{title:"Notes",subtitle:"Additional incident context",children:(0,t.jsx)("textarea",{value:K.notes,onChange:e=>Q(t=>({...t,notes:e.target.value})),rows:3,disabled:!E||ee,className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100"})}),E?(0,t.jsx)("div",{className:"sticky bottom-0 z-10 flex items-center justify-end gap-2 border-t border-slate-200 bg-white pt-3",children:(0,t.jsx)("button",{type:"button",onClick:ec,disabled:ee||ea,className:"inline-flex h-9 items-center rounded-lg bg-sky-600 px-4 text-xs font-semibold text-white transition hover:bg-sky-700 disabled:opacity-70",children:ee?"Saving...":"Save Incident Updates"})}):null]}):(0,t.jsx)("div",{className:"flex justify-center py-8",children:(0,t.jsx)("span",{className:"inline-flex h-6 w-6 animate-spin rounded-full border-2 border-slate-300 border-t-sky-600","aria-hidden":"true"})})]})}):null]})}e.s(["default",()=>k])}]);