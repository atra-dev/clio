module.exports=[44036,a=>{"use strict";var b=a.i(87924),c=a.i(97630);function d({title:a,subtitle:d,className:e,children:f,action:g}){return(0,b.jsxs)("section",{className:(0,c.cn)("rounded-2xl border border-slate-200 bg-white p-5 shadow-[0_12px_30px_-24px_rgba(15,23,42,0.55)]",e),children:[(a||d||g)&&(0,b.jsxs)("header",{className:"mb-4 flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[a&&(0,b.jsx)("h2",{className:"text-base font-semibold text-slate-900",children:a}),d&&(0,b.jsx)("p",{className:"text-sm text-slate-600",children:d})]}),g]}),f]})}a.s(["default",()=>d])},9864,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(44036),e=a.i(5603);let f="EMPLOYEE_L1",g=new Set(["EMPLOYEE","EMPLOYEE_L1","EMPLOYEE_L2","EMPLOYEE_L3"]),h=new Set(["SUPER_ADMIN","GRC","HR","EA",f]),i=new Map(e.ROLES.map(a=>[a.id,a.label]));function j(a){let b=String(a||"").trim().toUpperCase();return g.has(b)?f:b}let k=(()=>{let a=new Map;for(let b of e.ROLES){let c=j(b.id);!h.has(c)||a.has(c)||a.set(c,{id:c,label:c===f?"Employee":b.label})}return Array.from(a.values())})(),l={email:"",role:"HR"};function m(a){if(!a)return"-";let b=new Date(a);return Number.isNaN(b.getTime())?"-":new Intl.DateTimeFormat("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(b)}function n(a){let b=j(a);return b===f?"Employee":i.get(b)||a}function o(){let[a,e]=(0,c.useState)([]),[f,g]=(0,c.useState)({}),[h,i]=(0,c.useState)(!0),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)(""),[y,z]=(0,c.useState)(null),[A,B]=(0,c.useState)(l),C=(0,c.useCallback)(async()=>{v("");try{let a=await fetch("/api/admin/users",{method:"GET"});if(!a.ok){let b=await a.json().catch(()=>({}));throw Error(b.message||"Unable to load user directory.")}let b=await a.json(),c=Array.isArray(b.users)?b.users:[];e(c),g(c.reduce((a,b)=>(a[b.id]=j(b.role),a),{}))}catch(a){v(a.message||"Unable to load user directory.")}finally{i(!1)}},[]);(0,c.useEffect)(()=>{C()},[C]);let D=a=>b=>{B(c=>({...c,[a]:b.target.value}))},E=async a=>{a.preventDefault(),p(!0),v(""),x(""),z(null);try{let a=await fetch("/api/admin/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(A)});if(!a.ok){let b=await a.json().catch(()=>({}));throw Error(b.message||"Unable to send invitation.")}let b=await a.json(),c="string"==typeof b?.delivery?.status?b.delivery.status:"",d="string"==typeof b?.warning?b.warning:"";"failed"===c?x(d||`Invite created for ${b.user.email}. Email delivery failed.`):x(`Invitation email with verification link sent to ${b.user.email}.`),z(b.invite||null),B(l),await C()}catch(a){v(a.message||"Unable to send invitation.")}finally{p(!1)}},F=async a=>{r(a.id),v(""),x("");try{var b;let c=await fetch(`/api/admin/users/${encodeURIComponent(a.id)}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:(b=a.status,"active"===b?"disabled":"active")})});if(!c.ok){let a=await c.json().catch(()=>({}));throw Error(a.message||"Unable to update account status.")}let d=await c.json();e(a=>a.map(a=>a.id===d.user.id?d.user:a)),x(`Account status updated: ${d.user.email} is ${d.user.status}.`)}catch(a){v(a.message||"Unable to update account status.")}finally{r("")}},G=async a=>{let b=j(f[a.id]||a.role),c=j(a.role);if(b&&b!==c){t(a.id),v(""),x("");try{let c=await fetch(`/api/admin/users/${encodeURIComponent(a.id)}/role`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({role:b})});if(!c.ok){let a=await c.json().catch(()=>({}));throw Error(a.message||"Unable to update user role.")}let d=await c.json();e(a=>a.map(a=>a.id===d.user.id?d.user:a)),g(a=>({...a,[d.user.id]:j(d.user.role)})),x(`Role updated: ${d.user.email} is now ${n(d.user.role)}.`)}catch(a){v(a.message||"Unable to update user role.")}finally{t("")}}},H=(0,c.useMemo)(()=>[...a].sort((a,b)=>new Date(b.updatedAt||b.invitedAt).getTime()-new Date(a.updatedAt||a.invitedAt).getTime()),[a]);return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)(d.default,{title:"Invite User",subtitle:"No sign-up form. Invited users must verify email from the invite link before Google sign-in.",children:[(0,b.jsxs)("form",{className:"grid gap-3 sm:grid-cols-[minmax(0,1fr)_180px_auto]",onSubmit:E,children:[(0,b.jsxs)("label",{className:"space-y-1",children:[(0,b.jsx)("span",{className:"text-xs font-medium uppercase tracking-[0.08em] text-slate-600",children:"Work Email"}),(0,b.jsx)("input",{type:"email",required:!0,value:A.email,onChange:D("email"),placeholder:"employee@gmail.com",className:"h-10 w-full rounded-lg border border-slate-300 bg-white px-3 text-sm text-slate-900 placeholder:text-slate-400 focus:border-sky-400 focus:outline-none"})]}),(0,b.jsxs)("label",{className:"space-y-1",children:[(0,b.jsx)("span",{className:"text-xs font-medium uppercase tracking-[0.08em] text-slate-600",children:"Role"}),(0,b.jsx)("select",{value:A.role,onChange:D("role"),className:"h-10 w-full rounded-lg border border-slate-300 bg-white px-3 text-sm text-slate-900 focus:border-sky-400 focus:outline-none",children:k.map(a=>(0,b.jsx)("option",{value:a.id,children:a.label},a.id))})]}),(0,b.jsx)("button",{type:"submit",disabled:o,className:"mt-6 inline-flex h-10 items-center justify-center rounded-lg bg-sky-600 px-4 text-sm font-semibold text-white transition hover:bg-sky-700 disabled:cursor-not-allowed disabled:opacity-70",children:o?"Sending...":"Send invite"})]}),y?(0,b.jsxs)("div",{className:"mt-4 rounded-xl border border-sky-200 bg-sky-50 px-4 py-3 text-xs text-sky-800",children:[(0,b.jsx)("p",{className:"font-semibold",children:"Invite recorded"}),(0,b.jsxs)("p",{className:"mt-1",children:["Invite ID: ",y.id||"-"]}),(0,b.jsxs)("p",{className:"mt-1",children:["Expires: ",m(y.expiresAt)]})]}):null,u?(0,b.jsx)("p",{className:"mt-4 rounded-lg border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700",children:u}):null,w?(0,b.jsx)("p",{className:"mt-4 rounded-lg border border-emerald-200 bg-emerald-50 px-3 py-2 text-xs text-emerald-700",children:w}):null]}),(0,b.jsx)(d.default,{title:"User Directory",subtitle:"Review account states and manage access by role.",children:h?(0,b.jsx)("p",{className:"text-sm text-slate-600",children:"Loading user accounts..."}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full text-left text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-slate-200 text-xs uppercase tracking-[0.1em] text-slate-500",children:[(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Email"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Role"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Status"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Invited"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Last Login"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Change Role"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium text-right",children:"Action"})]})}),(0,b.jsx)("tbody",{children:H.map(a=>{var c;let d;return(0,b.jsxs)("tr",{className:"border-b border-slate-100 text-slate-700 last:border-b-0",children:[(0,b.jsxs)("td",{className:"px-2 py-3",children:[(0,b.jsx)("p",{className:"font-medium text-slate-900",children:a.email}),(0,b.jsxs)("p",{className:"text-xs text-slate-500",children:["By: ",a.invitedBy]})]}),(0,b.jsx)("td",{className:"px-2 py-3",children:n(a.role)}),(0,b.jsx)("td",{className:"px-2 py-3",children:(0,b.jsx)("span",{className:`rounded-md px-2 py-1 text-xs font-semibold ${"active"===(c=a.status)?"bg-emerald-100 text-emerald-700":"disabled"===c?"bg-rose-100 text-rose-700":"bg-amber-100 text-amber-700"}`,children:a.status})}),(0,b.jsx)("td",{className:"px-2 py-3 text-xs text-slate-600",children:m(a.invitedAt)}),(0,b.jsx)("td",{className:"px-2 py-3 text-xs text-slate-600",children:m(a.lastLoginAt)}),(0,b.jsx)("td",{className:"px-2 py-3",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("select",{value:j(f[a.id]||a.role),onChange:(d=a.id,a=>{let b=j(a.target.value);g(a=>({...a,[d]:b}))}),disabled:s===a.id,className:"h-8 min-w-[132px] rounded-lg border border-slate-300 bg-white px-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:opacity-70",children:k.map(a=>(0,b.jsx)("option",{value:a.id,children:a.label},a.id))}),(0,b.jsx)("button",{type:"button",onClick:()=>G(a),disabled:s===a.id||!f[a.id]||j(f[a.id])===j(a.role),className:"rounded-lg border border-sky-300 bg-sky-50 px-2.5 py-1.5 text-xs font-medium text-sky-700 transition hover:bg-sky-100 disabled:cursor-not-allowed disabled:opacity-70",children:s===a.id?"Saving...":"Change Role"})]})}),(0,b.jsx)("td",{className:"px-2 py-3 text-right",children:(0,b.jsx)("button",{type:"button",onClick:()=>F(a),disabled:q===a.id||s===a.id,className:"rounded-lg border border-slate-300 bg-white px-3 py-1.5 text-xs font-medium text-slate-700 transition hover:bg-slate-100 disabled:cursor-not-allowed disabled:opacity-70",children:q===a.id?"Updating...":"active"===a.status?"Disable":"Open account"})})]},a.id)})})]})})})]})}a.s(["default",()=>o])}];

//# sourceMappingURL=src_components_hris_20dbdbf3._.js.map