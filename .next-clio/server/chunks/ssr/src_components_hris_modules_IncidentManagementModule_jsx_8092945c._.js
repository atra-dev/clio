module.exports=[4956,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(44036),e=a.i(63824),f=a.i(38014),g=a.i(3427),h=a.i(98719);a.i(68248);var i=a.i(63609),j=a.i(74404);let k=[{id:"escalation-plan",label:"Escalation Plan"},{id:"regulatory-72-hour-notification",label:"72-Hour Notification"},{id:"forensic-logging",label:"Forensic Logging"}],l=["Low","Medium","High","Critical"],m=["Open","Containment","Investigating","Escalated","Regulatory Review","Resolved","Closed"],n=["Not Started","In Progress","Contained"],o=["Pending","In Progress","Completed"],p=["Unauthorized Access","Data Exposure","Credential Compromise","Insider Misuse","Malware / Ransomware","Policy Violation","System Misconfiguration","Other"],q=["Not Required","Pending","Notified","Overdue"],r={q:"",status:"all",severity:"all",incidentType:"all",regulatoryStatus:"all",restrictedPii:"all",page:1,pageSize:12},s={title:"",summary:"",incidentType:"Unauthorized Access",severity:"Medium",detectedAt:"",ownerEmail:"",affectedEmployeeEmail:"",restrictedPiiInvolved:!1,executiveNotificationRequired:!1,regulatoryNotificationRequired:!1,documentationLocation:"",notes:"",classificationStandard:"CLIO-IR-SEVERITY-V1"};function t(a){let b=new Date(a||"");return Number.isNaN(b.getTime())?"-":new Intl.DateTimeFormat("en-US",{month:"short",day:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(b)}function u(a){let b=new Date(a||Date.now());if(Number.isNaN(b.getTime()))return"";let c=b.getFullYear(),d=String(b.getMonth()+1).padStart(2,"0"),e=String(b.getDate()).padStart(2,"0"),f=String(b.getHours()).padStart(2,"0"),g=String(b.getMinutes()).padStart(2,"0");return`${c}-${d}-${e}T${f}:${g}`}function v(a){let b=String(a||"").trim();if(!b)return"";let c=new Date(b);return Number.isNaN(c.getTime())?"":c.toISOString()}function w(){return new Date().toISOString()}function x(a){return String(a?.title||"").trim()||String(a?.incidentCode||"").trim()||"Incident"}function y({session:a}){let y=(0,h.useToast)(),z=String(a?.role||"").trim().toUpperCase(),A="GRC"===z||"SUPER_ADMIN"===z,[B,C]=(0,c.useState)("escalation-plan"),[D,E]=(0,c.useState)(r),[F,G]=(0,c.useState)([]),[H,I]=(0,c.useState)({total:0,openCases:0,criticalOpen:0,containmentPending:0,dueWithin72Hours:0,overdue72HourNotifications:0}),[J,K]=(0,c.useState)({page:1,pageSize:12,total:0,totalPages:1}),[L,M]=(0,c.useState)(!0),[N,O]=(0,c.useState)(!1),[P,Q]=(0,c.useState)(!1),[R,S]=(0,c.useState)({...s,ownerEmail:String(a?.email||"").trim().toLowerCase()}),[T,U]=(0,c.useState)(""),[V,W]=(0,c.useState)(null),[X,Y]=(0,c.useState)(null),[Z,$]=(0,c.useState)(!1),[_,aa]=(0,c.useState)(!1),[ab,ac]=(0,c.useState)(!1),ad=(0,c.useRef)(null),ae=(0,c.useCallback)(async()=>{M(!0);try{let a=await i.hrisApi.incidents.list(D),b=Array.isArray(a?.records)?a.records:[];b.sort((a,b)=>new Date(b?.updatedAt||b?.createdAt||0).getTime()-new Date(a?.updatedAt||a?.createdAt||0).getTime()),G(b),I(a?.summary||{}),K(a?.pagination||{page:1,pageSize:12,total:0,totalPages:1})}catch(a){G([]),y.error(a.message||"Unable to load incident records.")}finally{M(!1)}},[D,y]),af=(0,c.useCallback)(async a=>{let b=String(a||"").trim();if(b){$(!0);try{let a=await i.hrisApi.incidents.get(b),c=a?.record||null;W(c),Y(c?{title:String(c?.title||""),summary:String(c?.summary||""),incidentType:String(c?.incidentType||"Other"),severity:String(c?.severity||"Medium"),status:String(c?.status||"Open"),containmentStatus:String(c?.containmentStatus||"Not Started"),containmentSummary:String(c?.containmentSummary||""),impactAssessmentStatus:String(c?.impactAssessmentStatus||"Pending"),impactSummary:String(c?.impactSummary||""),ownerEmail:String(c?.ownerEmail||""),affectedEmployeeEmail:String(c?.affectedEmployeeEmail||""),restrictedPiiInvolved:!!c?.restrictedPiiInvolved,executiveNotificationRequired:!!c?.executiveNotificationRequired,regulatoryNotificationRequired:!!c?.regulatoryNotificationRequired,documentationRetained:!!c?.documentationRetained,documentationLocation:String(c?.documentationLocation||""),notes:String(c?.notes||""),classificationStandard:String(c?.classificationStandard||"CLIO-IR-SEVERITY-V1"),forensicWindowStart:u(c?.forensicWindowStart),forensicWindowEnd:u(c?.forensicWindowEnd)}:null)}catch(a){y.error(a.message||"Unable to load incident details.")}finally{$(!1)}}},[y]);(0,c.useEffect)(()=>{ae()},[ae]),(0,c.useEffect)(()=>{T&&af(T)},[T,af]),(0,c.useEffect)(()=>{},[]);let ag=(a,b)=>{E(c=>({...c,[a]:b,page:1}))},ah=(0,c.useCallback)(async(a,b)=>{if(A&&T){aa(!0);try{await i.hrisApi.incidents.update(T,a),await af(T),await ae(),b&&y.success(b)}catch(a){y.error(a.message||"Unable to update incident.")}finally{aa(!1)}}},[A,T,af,ae,y]),ai=async a=>{if(a.preventDefault(),A){if(!String(R.title||"").trim())return void y.error("Incident title is required.");Q(!0);try{let a={...R,detectedAt:v(R.detectedAt)||w(),ownerEmail:String(R.ownerEmail||"").trim().toLowerCase(),affectedEmployeeEmail:String(R.affectedEmployeeEmail||"").trim().toLowerCase()},b=await i.hrisApi.incidents.create(a);y.success("Incident record created."),O(!1),await ae(),b?.record?.id&&U(b.record.id)}catch(a){y.error(a.message||"Unable to create incident.")}finally{Q(!1)}}},aj=async()=>{A&&X&&await ah({...X,ownerEmail:String(X.ownerEmail||"").trim().toLowerCase(),affectedEmployeeEmail:String(X.affectedEmployeeEmail||"").trim().toLowerCase(),forensicWindowStart:v(X.forensicWindowStart),forensicWindowEnd:v(X.forensicWindowEnd)},"Incident workflow updated.")},ak=async(a,b,c={})=>{await ah({[a]:w(),...c},b)},al=async b=>{let c=b.target.files?.[0];if(b.target.value="",c&&V&&A){ac(!0);try{let b=await (0,j.uploadIncidentEvidenceToStorage)({file:c,incidentRecordId:V.id,affectedEmployeeEmail:V.affectedEmployeeEmail}),d=[...Array.isArray(V.evidenceDocuments)?V.evidenceDocuments:[],{id:`${Date.now()}-${Math.random().toString(36).slice(2,7)}`,name:c.name||"Incident Evidence",type:"Incident Evidence",ref:b.downloadUrl,storagePath:b.storagePath,contentType:b.contentType||c.type||"",fileExtension:String(c.name||"").split(".").pop()||"",sizeBytes:b.sizeBytes,uploadedAt:w(),uploadedBy:String(a?.email||"").trim().toLowerCase()}];await ah({evidenceDocuments:d,documentationRetained:!0},"Incident evidence uploaded.")}catch(a){y.error(a.message||"Unable to upload evidence.")}finally{ac(!1)}}},am=async a=>{if(!V||!A)return;String(a?.name||"file");let b=(Array.isArray(V.evidenceDocuments)?V.evidenceDocuments:[]).filter(b=>String(b?.id||"").trim()!==String(a?.id||"").trim());await ah({evidenceDocuments:b},"Evidence removed."),a?.storagePath&&await (0,j.removeStorageObjectByPath)(a.storagePath)},an=(0,c.useMemo)(()=>"regulatory-72-hour-notification"===B?F.filter(a=>!!a?.regulatoryNotificationRequired||!!a?.restrictedPiiInvolved):"forensic-logging"===B?F.filter(a=>Number(a?.forensicSummary?.totalScopedLogs||0)>0||!!a?.forensicSnapshot):F,[F,B]),ao=(0,c.useMemo)(()=>"regulatory-72-hour-notification"===B?[{key:"total",label:"Total Incidents",value:H.total||0},{key:"due",label:"Due Within 72h",value:H.dueWithin72Hours||0},{key:"overdue",label:"Overdue Notifications",value:H.overdue72HourNotifications||0}]:"forensic-logging"===B?[{key:"total",label:"Total Incidents",value:H.total||0},{key:"logs",label:"Selected Scoped Logs",value:Number(V?.forensicSummary?.totalScopedLogs||0)},{key:"deletions",label:"Selected Deletion Logs",value:Number(V?.forensicSummary?.deletionActivitiesCount||0)}]:[{key:"total",label:"Total Incidents",value:H.total||0},{key:"open",label:"Open Cases",value:H.openCases||0},{key:"critical",label:"Critical Open",value:H.criticalOpen||0},{key:"containment",label:"Containment Pending",value:H.containmentPending||0}],[B,H,V]),ap=0===J.total?0:(J.page-1)*J.pageSize+1,aq=Math.min(J.total||0,J.page*J.pageSize),ar=Array.isArray(V?.evidenceDocuments)?V.evidenceDocuments:[];return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(f.default,{tabs:k,value:B,onChange:a=>{C(a)}}),(0,b.jsx)(d.default,{title:"escalation-plan"===B?"Defined Escalation Plan":"regulatory-72-hour-notification"===B?"72-Hour Regulatory Notification":"Forensic Logging",subtitle:"escalation-plan"===B?"Severity-based escalation and containment prioritization.":"regulatory-72-hour-notification"===B?"PII breach notification window and compliance timeline.":"Access/export/admin/deletion traces for incident investigation.",children:(0,b.jsx)("div",{className:`grid gap-3 ${ao.length>3?"sm:grid-cols-2 lg:grid-cols-4":"sm:grid-cols-3"}`,children:ao.map(a=>(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500",children:a.label}),(0,b.jsx)("p",{className:"mt-0.5 text-lg font-semibold text-slate-900",children:a.value})]},a.key))})}),(0,b.jsxs)(d.default,{title:"Incident Records",subtitle:"Response workflow, escalation actions, and forensic-ready incident traceability.",action:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[A?(0,b.jsx)("button",{type:"button",onClick:()=>{S({...s,ownerEmail:String(a?.email||"").trim().toLowerCase(),detectedAt:u(w())}),O(!0)},className:"inline-flex h-9 items-center rounded-lg bg-sky-600 px-4 text-xs font-semibold text-white transition hover:bg-sky-700",children:"Create Incident"}):null,(0,b.jsx)("button",{type:"button",onClick:ae,disabled:L,className:"inline-flex h-9 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60",children:"Refresh"})]}),children:[(0,b.jsxs)("div",{className:"grid gap-2 md:grid-cols-3 lg:grid-cols-6",children:[(0,b.jsx)("input",{value:D.q,onChange:a=>ag("q",a.target.value),placeholder:"Search incident",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 placeholder:text-slate-400 focus:border-sky-400 focus:outline-none md:col-span-2"}),(0,b.jsxs)("select",{value:D.status,onChange:a=>ag("status",a.target.value),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:[(0,b.jsx)("option",{value:"all",children:"All Status"}),m.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]}),(0,b.jsxs)("select",{value:D.severity,onChange:a=>ag("severity",a.target.value),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:[(0,b.jsx)("option",{value:"all",children:"All Severity"}),l.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]}),(0,b.jsxs)("select",{value:D.incidentType,onChange:a=>ag("incidentType",a.target.value),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:[(0,b.jsx)("option",{value:"all",children:"All Types"}),p.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]}),(0,b.jsxs)("select",{value:D.regulatoryStatus,onChange:a=>ag("regulatoryStatus",a.target.value),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:[(0,b.jsx)("option",{value:"all",children:"All Regulatory"}),q.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]}),(0,b.jsxs)("select",{value:D.restrictedPii,onChange:a=>ag("restrictedPii",a.target.value),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:[(0,b.jsx)("option",{value:"all",children:"PII: All"}),(0,b.jsx)("option",{value:"yes",children:"PII: Yes"}),(0,b.jsx)("option",{value:"no",children:"PII: No"})]})]}),(0,b.jsx)("div",{className:"mt-4",children:L?(0,b.jsx)("div",{className:"flex justify-center py-6",children:(0,b.jsx)("span",{className:"inline-flex h-6 w-6 animate-spin rounded-full border-2 border-slate-300 border-t-sky-600","aria-hidden":"true"})}):0===an.length?(0,b.jsx)(e.default,{title:"No incident records found",subtitle:"Create incidents or adjust filters to continue."}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full text-left text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-slate-200 text-xs uppercase tracking-[0.1em] text-slate-500",children:[(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Incident"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Severity"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Status"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Escalation"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Regulatory"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Updated"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium text-right",children:"Action"})]})}),(0,b.jsx)("tbody",{children:an.map(a=>(0,b.jsxs)("tr",{className:"border-b border-slate-100 text-slate-700 last:border-b-0",children:[(0,b.jsxs)("td",{className:"px-2 py-3",children:[(0,b.jsx)("p",{className:"font-medium text-slate-900",children:x(a)}),(0,b.jsx)("p",{className:"text-xs text-slate-500",children:String(a?.incidentCode||"N/A")})]}),(0,b.jsx)("td",{className:"px-2 py-3",children:(0,b.jsx)(g.default,{value:a?.severity||"Medium"})}),(0,b.jsx)("td",{className:"px-2 py-3",children:(0,b.jsx)(g.default,{value:a?.status||"Open"})}),(0,b.jsxs)("td",{className:"px-2 py-3 text-xs",children:[(0,b.jsx)("p",{className:"font-medium text-slate-800",children:String(a?.escalationLevel||"-")}),(0,b.jsxs)("p",{className:"text-slate-500",children:["GRC: ",a?.grcAlertedAt?"Yes":"No"]})]}),(0,b.jsxs)("td",{className:"px-2 py-3 text-xs",children:[(0,b.jsx)("p",{className:"font-medium text-slate-800",children:String(a?.regulatoryStatus||"Not Required")}),(0,b.jsxs)("p",{className:"text-slate-500",children:["Due: ",t(a?.regulatoryDueAt)]})]}),(0,b.jsx)("td",{className:"px-2 py-3 text-xs text-slate-600",children:t(a?.updatedAt||a?.createdAt)}),(0,b.jsx)("td",{className:"px-2 py-3 text-right",children:(0,b.jsx)("button",{type:"button",onClick:()=>U(a.id),className:"inline-flex h-8 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-medium text-slate-700 transition hover:bg-slate-50",children:"Open"})})]},a.id))})]})})}),(0,b.jsxs)("div",{className:"mt-4 flex flex-wrap items-center justify-between gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-600",children:[(0,b.jsxs)("p",{children:["Showing ",ap,"-",aq," of ",J.total||0," records"]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{type:"button",onClick:()=>E(a=>({...a,page:Math.max(1,a.page-1)})),disabled:1>=(J.page||1)||L,className:"inline-flex h-8 items-center rounded-lg border border-slate-300 bg-white px-3 font-medium text-slate-700 transition hover:bg-slate-100 disabled:opacity-60",children:"Previous"}),(0,b.jsxs)("span",{children:["Page ",J.page||1," of ",Math.max(1,J.totalPages||1)]}),(0,b.jsx)("button",{type:"button",onClick:()=>E(a=>({...a,page:Math.min(Math.max(1,J.totalPages||1),a.page+1)})),disabled:(J.page||1)>=(J.totalPages||1)||L,className:"inline-flex h-8 items-center rounded-lg border border-slate-300 bg-white px-3 font-medium text-slate-700 transition hover:bg-slate-100 disabled:opacity-60",children:"Next"})]})]})]}),N?(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/45 p-4",role:"dialog","aria-modal":"true","aria-label":"Create Incident",onClick:()=>!P&&O(!1),children:(0,b.jsxs)("div",{className:"w-full max-w-4xl rounded-2xl border border-slate-200 bg-white p-4 shadow-2xl sm:p-5",onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"mb-3 flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-base font-semibold text-slate-900",children:"Create Incident"}),(0,b.jsx)("p",{className:"mt-0.5 text-sm text-slate-600",children:"Capture incident details and initialize compliance workflow."})]}),(0,b.jsx)("button",{type:"button",onClick:()=>!P&&O(!1),disabled:P,className:"inline-flex h-8 w-8 items-center justify-center rounded-lg border border-slate-300 bg-white text-slate-600 transition hover:bg-slate-50 disabled:opacity-60","aria-label":"Close create incident",children:(0,b.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.9",className:"h-4 w-4","aria-hidden":"true",children:(0,b.jsx)("path",{d:"m6 6 12 12M18 6 6 18"})})})]}),(0,b.jsxs)("form",{className:"space-y-3",onSubmit:ai,children:[(0,b.jsxs)("div",{className:"grid gap-2 md:grid-cols-2",children:[(0,b.jsx)("input",{required:!0,value:R.title,onChange:a=>S(b=>({...b,title:a.target.value})),placeholder:"Incident title",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none md:col-span-2"}),(0,b.jsx)("select",{value:R.severity,onChange:a=>S(b=>({...b,severity:a.target.value})),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:l.map(a=>(0,b.jsx)("option",{value:a,children:a},`create-severity-${a}`))}),(0,b.jsx)("select",{value:R.incidentType,onChange:a=>S(b=>({...b,incidentType:a.target.value})),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none",children:p.map(a=>(0,b.jsx)("option",{value:a,children:a},`create-type-${a}`))}),(0,b.jsx)("input",{type:"datetime-local",value:R.detectedAt,onChange:a=>S(b=>({...b,detectedAt:a.target.value})),className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,b.jsx)("input",{value:R.ownerEmail,onChange:a=>S(b=>({...b,ownerEmail:a.target.value})),placeholder:"Owner email",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none"}),(0,b.jsx)("input",{value:R.affectedEmployeeEmail,onChange:a=>S(b=>({...b,affectedEmployeeEmail:a.target.value})),placeholder:"Affected employee email",className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none md:col-span-2"}),(0,b.jsx)("textarea",{rows:3,value:R.summary,onChange:a=>S(b=>({...b,summary:a.target.value})),placeholder:"Incident summary",className:"rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none md:col-span-2"})]}),(0,b.jsxs)("div",{className:"grid gap-2 sm:grid-cols-3",children:[(0,b.jsxs)("label",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:R.restrictedPiiInvolved,onChange:a=>S(b=>({...b,restrictedPiiInvolved:a.target.checked})),className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),(0,b.jsx)("span",{className:"text-xs text-slate-700",children:"Restricted PII"})]}),(0,b.jsxs)("label",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:R.executiveNotificationRequired,onChange:a=>S(b=>({...b,executiveNotificationRequired:a.target.checked})),className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),(0,b.jsx)("span",{className:"text-xs text-slate-700",children:"Executive Notice"})]}),(0,b.jsxs)("label",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:R.regulatoryNotificationRequired,onChange:a=>S(b=>({...b,regulatoryNotificationRequired:a.target.checked})),className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),(0,b.jsx)("span",{className:"text-xs text-slate-700",children:"Regulatory Notice"})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2 border-t border-slate-200 pt-3",children:[(0,b.jsx)("button",{type:"button",onClick:()=>O(!1),disabled:P,className:"inline-flex h-9 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-70",children:"Cancel"}),(0,b.jsx)("button",{type:"submit",disabled:P,className:"inline-flex h-9 items-center rounded-lg bg-sky-600 px-4 text-xs font-semibold text-white transition hover:bg-sky-700 disabled:opacity-70",children:P?"Creating...":"Create Incident"})]})]})]})}):null,T?(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/45 p-4",role:"dialog","aria-modal":"true","aria-label":"Incident Workbench",onClick:()=>!_&&!ab&&U(""),children:(0,b.jsxs)("div",{className:"w-full max-w-6xl rounded-2xl border border-slate-200 bg-white p-4 shadow-2xl sm:p-5",onClick:a=>a.stopPropagation(),children:[(0,b.jsxs)("div",{className:"mb-3 flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-base font-semibold text-slate-900",children:"Incident Workbench"}),(0,b.jsx)("p",{className:"mt-0.5 text-sm text-slate-600",children:"Escalation, 72-hour actions, and forensic evidence."})]}),(0,b.jsx)("button",{type:"button",onClick:()=>!_&&!ab&&U(""),disabled:_||ab,className:"inline-flex h-8 w-8 items-center justify-center rounded-lg border border-slate-300 bg-white text-slate-600 transition hover:bg-slate-50 disabled:opacity-60","aria-label":"Close incident workbench",children:(0,b.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.9",className:"h-4 w-4","aria-hidden":"true",children:(0,b.jsx)("path",{d:"m6 6 12 12M18 6 6 18"})})})]}),!Z&&V&&X?(0,b.jsxs)("div",{className:"max-h-[72vh] space-y-3 overflow-y-auto pr-1",children:[(0,b.jsxs)("div",{className:"grid gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2.5 sm:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500",children:"Incident"}),(0,b.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:x(V)}),(0,b.jsx)("p",{className:"text-xs text-slate-500",children:String(V?.incidentCode||"N/A")})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500",children:"Detected"}),(0,b.jsx)("p",{className:"text-xs text-slate-700",children:t(V?.detectedAt)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500",children:"Regulatory Due"}),(0,b.jsx)("p",{className:"text-xs text-slate-700",children:t(V?.regulatoryDueAt)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500",children:"Regulatory Status"}),(0,b.jsx)(g.default,{value:V?.regulatoryStatus||"Not Required"})]})]}),(0,b.jsxs)("div",{className:"grid gap-3 lg:grid-cols-2",children:[(0,b.jsxs)(d.default,{title:"Workflow Control",subtitle:"Severity, containment, impact, and status updates",children:[(0,b.jsxs)("div",{className:"grid gap-2 sm:grid-cols-2",children:[(0,b.jsx)("select",{value:X.severity,onChange:a=>Y(b=>({...b,severity:a.target.value})),disabled:!A||_,className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100",children:l.map(a=>(0,b.jsx)("option",{value:a,children:a},`d-sev-${a}`))}),(0,b.jsx)("select",{value:X.status,onChange:a=>Y(b=>({...b,status:a.target.value})),disabled:!A||_,className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100",children:m.map(a=>(0,b.jsx)("option",{value:a,children:a},`d-status-${a}`))}),(0,b.jsx)("select",{value:X.containmentStatus,onChange:a=>Y(b=>({...b,containmentStatus:a.target.value})),disabled:!A||_,className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100",children:n.map(a=>(0,b.jsx)("option",{value:a,children:a},`d-cont-${a}`))}),(0,b.jsx)("select",{value:X.impactAssessmentStatus,onChange:a=>Y(b=>({...b,impactAssessmentStatus:a.target.value})),disabled:!A||_,className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100",children:o.map(a=>(0,b.jsx)("option",{value:a,children:a},`d-impact-${a}`))})]}),(0,b.jsx)("textarea",{value:X.summary,onChange:a=>Y(b=>({...b,summary:a.target.value})),rows:2,placeholder:"Incident summary",disabled:!A||_,className:"mt-2 w-full rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100"}),(0,b.jsx)("textarea",{value:X.containmentSummary,onChange:a=>Y(b=>({...b,containmentSummary:a.target.value})),rows:2,placeholder:"Containment summary",disabled:!A||_,className:"mt-2 w-full rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100"}),(0,b.jsx)("textarea",{value:X.impactSummary,onChange:a=>Y(b=>({...b,impactSummary:a.target.value})),rows:2,placeholder:"Impact summary",disabled:!A||_,className:"mt-2 w-full rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100"})]}),(0,b.jsxs)(d.default,{title:"72-Hour Controls",subtitle:"Regulatory, executive, and affected-individual notifications",children:[(0,b.jsxs)("div",{className:"grid gap-2 sm:grid-cols-2",children:[(0,b.jsxs)("label",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:X.regulatoryNotificationRequired,onChange:a=>Y(b=>({...b,regulatoryNotificationRequired:a.target.checked})),disabled:!A||_,className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),(0,b.jsx)("span",{className:"text-xs text-slate-700",children:"Regulatory required"})]}),(0,b.jsxs)("label",{className:"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:X.documentationRetained,onChange:a=>Y(b=>({...b,documentationRetained:a.target.checked})),disabled:!A||_,className:"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500"}),(0,b.jsx)("span",{className:"text-xs text-slate-700",children:"Documentation retained"})]})]}),(0,b.jsxs)("div",{className:"mt-2 grid gap-2 sm:grid-cols-2",children:[(0,b.jsx)("input",{value:X.documentationLocation,onChange:a=>Y(b=>({...b,documentationLocation:a.target.value})),placeholder:"Documentation location",disabled:!A||_,className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100"}),(0,b.jsx)("input",{value:X.classificationStandard,onChange:a=>Y(b=>({...b,classificationStandard:a.target.value})),placeholder:"Classification standard",disabled:!A||_,className:"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100"})]}),(0,b.jsxs)("div",{className:"mt-2 grid gap-2 sm:grid-cols-2 lg:grid-cols-3",children:[(0,b.jsx)("button",{type:"button",onClick:()=>ak("grcAlertedAt","GRC alerted.",{escalationRequired:!0}),disabled:!A||_,className:"inline-flex h-8 items-center justify-center rounded-md border border-slate-300 bg-white px-3 text-[11px] font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60",children:"Mark GRC Alerted"}),(0,b.jsx)("button",{type:"button",onClick:()=>ak("executiveNotifiedAt","Executive notification recorded.",{executiveNotificationRequired:!0}),disabled:!A||_,className:"inline-flex h-8 items-center justify-center rounded-md border border-slate-300 bg-white px-3 text-[11px] font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60",children:"Mark Executive Notified"}),(0,b.jsx)("button",{type:"button",onClick:()=>ak("regulatoryNotifiedAt","Regulatory notification recorded.",{regulatoryNotificationRequired:!0,status:"Regulatory Review"}),disabled:!A||_,className:"inline-flex h-8 items-center justify-center rounded-md border border-slate-300 bg-white px-3 text-[11px] font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60",children:"Mark Regulator Notified"}),(0,b.jsx)("button",{type:"button",onClick:()=>ak("affectedIndividualsNotifiedAt","Affected individuals notification recorded."),disabled:!A||_,className:"inline-flex h-8 items-center justify-center rounded-md border border-slate-300 bg-white px-3 text-[11px] font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60",children:"Mark Affected Individuals"}),(0,b.jsx)("button",{type:"button",onClick:()=>ah({refreshForensicSnapshot:!0},"Forensic snapshot refreshed."),disabled:!A||_,className:"inline-flex h-8 items-center justify-center rounded-md border border-sky-200 bg-sky-50 px-3 text-[11px] font-semibold text-sky-700 transition hover:bg-sky-100 disabled:opacity-60",children:"Refresh Forensic"})]})]})]}),(0,b.jsxs)(d.default,{title:"Incident Evidence",subtitle:"Retained case documents and attachments",children:[(0,b.jsx)("input",{ref:ad,type:"file",className:"hidden",onChange:al}),(0,b.jsx)("div",{className:"mb-2 flex justify-end",children:A?(0,b.jsx)("button",{type:"button",onClick:()=>ad.current?.click(),disabled:ab||_,className:"inline-flex h-8 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60",children:ab?"Uploading...":"Upload Evidence"}):null}),0===ar.length?(0,b.jsx)(e.default,{title:"No evidence files attached",subtitle:"Upload incident files to retain case evidence."}):(0,b.jsx)("div",{className:"overflow-x-auto",children:(0,b.jsxs)("table",{className:"min-w-full text-left text-sm",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-slate-200 text-xs uppercase tracking-[0.1em] text-slate-500",children:[(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Document"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Uploaded At"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium",children:"Uploaded By"}),(0,b.jsx)("th",{className:"px-2 py-3 font-medium text-right",children:"Actions"})]})}),(0,b.jsx)("tbody",{children:ar.map((a,c)=>(0,b.jsxs)("tr",{className:"border-b border-slate-100 text-slate-700 last:border-b-0",children:[(0,b.jsxs)("td",{className:"px-2 py-3",children:[(0,b.jsx)("p",{className:"font-medium text-slate-900",children:String(a?.name||"Incident Evidence")}),(0,b.jsx)("p",{className:"text-xs text-slate-500",children:String(a?.type||"Incident Evidence")})]}),(0,b.jsx)("td",{className:"px-2 py-3 text-xs text-slate-600",children:t(a?.uploadedAt)}),(0,b.jsx)("td",{className:"px-2 py-3 text-xs text-slate-600",children:String(a?.uploadedBy||"-")}),(0,b.jsx)("td",{className:"px-2 py-3 text-right",children:(0,b.jsxs)("div",{className:"inline-flex items-center gap-2",children:[a?.ref?(0,b.jsx)("a",{href:a.ref,target:"_blank",rel:"noreferrer",className:"inline-flex h-8 items-center rounded-lg border border-sky-200 bg-sky-50 px-3 text-xs font-semibold text-sky-700 transition hover:bg-sky-100",children:"Open"}):null,A?(0,b.jsx)("button",{type:"button",onClick:()=>am(a),disabled:_||ab,className:"inline-flex h-8 items-center rounded-lg border border-rose-200 bg-rose-50 px-3 text-xs font-semibold text-rose-700 transition hover:bg-rose-100 disabled:opacity-60",children:"Remove"}):null]})})]},`${a?.id||"evidence"}-${c}`))})]})})]}),(0,b.jsxs)(d.default,{title:"Forensic Logging",subtitle:"Scoped logs for access, export, administrative, and deletion events",children:[(0,b.jsxs)("div",{className:"grid gap-2 sm:grid-cols-2 lg:grid-cols-5",children:[(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Scoped Logs"}),(0,b.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:Number(V?.forensicSummary?.totalScopedLogs||0)})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Access"}),(0,b.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:Number(V?.forensicSummary?.accessLogsCount||0)})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Exports"}),(0,b.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:Number(V?.forensicSummary?.exportLogsCount||0)})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Administrative"}),(0,b.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:Number(V?.forensicSummary?.administrativeActionsCount||0)})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] uppercase tracking-[0.08em] text-slate-500",children:"Deletion"}),(0,b.jsx)("p",{className:"text-sm font-semibold text-slate-900",children:Number(V?.forensicSummary?.deletionActivitiesCount||0)})]})]}),(0,b.jsx)("div",{className:"mt-3 grid gap-3 lg:grid-cols-2",children:[{key:"accessLogs",label:"Access Logs"},{key:"exportLogs",label:"Export Logs"},{key:"administrativeActions",label:"Administrative Actions"},{key:"deletionActivities",label:"Deletion Activities"}].map(a=>{let c=Array.isArray(V?.forensicSnapshot?.[a.key])?V.forensicSnapshot[a.key].slice(0,20):[];return(0,b.jsxs)("div",{className:"rounded-lg border border-slate-200 bg-white",children:[(0,b.jsx)("div",{className:"border-b border-slate-200 px-3 py-2",children:(0,b.jsx)("p",{className:"text-xs font-semibold uppercase tracking-[0.08em] text-slate-500",children:a.label})}),0===c.length?(0,b.jsx)("p",{className:"px-3 py-3 text-xs text-slate-500",children:"No entries."}):(0,b.jsx)("div",{className:"max-h-52 overflow-auto",children:(0,b.jsxs)("table",{className:"min-w-full text-left text-xs",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{className:"border-b border-slate-200 text-[11px] uppercase tracking-[0.08em] text-slate-500",children:[(0,b.jsx)("th",{className:"px-3 py-2 font-medium",children:"Action"}),(0,b.jsx)("th",{className:"px-3 py-2 font-medium",children:"Module"}),(0,b.jsx)("th",{className:"px-3 py-2 font-medium",children:"When"}),(0,b.jsx)("th",{className:"px-3 py-2 font-medium",children:"By"})]})}),(0,b.jsx)("tbody",{children:c.map((c,d)=>(0,b.jsxs)("tr",{className:"border-b border-slate-100 text-slate-700 last:border-b-0",children:[(0,b.jsx)("td",{className:"px-3 py-2",children:String(c?.activityName||"-")}),(0,b.jsx)("td",{className:"px-3 py-2",children:String(c?.module||"-")}),(0,b.jsx)("td",{className:"px-3 py-2",children:t(c?.occurredAt)}),(0,b.jsx)("td",{className:"px-3 py-2",children:String(c?.performedBy||"-")})]},`${a.key}-${c.id||c.occurredAt||"row"}-${d}`))})]})})]},a.key)})})]}),(0,b.jsx)(d.default,{title:"Notes",subtitle:"Additional incident context",children:(0,b.jsx)("textarea",{value:X.notes,onChange:a=>Y(b=>({...b,notes:a.target.value})),rows:3,disabled:!A||_,className:"w-full rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100"})}),A?(0,b.jsx)("div",{className:"sticky bottom-0 z-10 flex items-center justify-end gap-2 border-t border-slate-200 bg-white pt-3",children:(0,b.jsx)("button",{type:"button",onClick:aj,disabled:_||ab,className:"inline-flex h-9 items-center rounded-lg bg-sky-600 px-4 text-xs font-semibold text-white transition hover:bg-sky-700 disabled:opacity-70",children:_?"Saving...":"Save Incident Updates"})}):null]}):(0,b.jsx)("div",{className:"flex justify-center py-8",children:(0,b.jsx)("span",{className:"inline-flex h-6 w-6 animate-spin rounded-full border-2 border-slate-300 border-t-sky-600","aria-hidden":"true"})})]})}):null]})}a.s(["default",()=>y])}];

//# sourceMappingURL=src_components_hris_modules_IncidentManagementModule_jsx_8092945c._.js.map