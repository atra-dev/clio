{"version":3,"sources":["../../../src/lib/hris-backend.js"],"sourcesContent":["import {\n  addDoc,\n  collection,\n  deleteField,\n  deleteDoc,\n  doc,\n  getDoc,\n  getDocs,\n  query,\n  updateDoc,\n  where,\n} from \"firebase/firestore/lite\";\nimport { getFirestoreDb, isFirestoreEnabled } from \"@/lib/firebase\";\nimport {\n  archiveUserAccount,\n  getLoginAccount,\n  inviteUserAccount,\n  listUserAccounts,\n  purgeDueArchivedUserAccounts,\n  revokeInviteById,\n  updateUserAccountRole,\n  updateUserAccountStatus,\n} from \"@/lib/user-accounts\";\nimport { deliverInviteEmail } from \"@/lib/invite-delivery\";\nimport { formatEmployeeName } from \"@/lib/name-utils\";\nimport { listAuditEvents } from \"@/lib/audit-log\";\n\nconst MAX_AUDIT_TRAIL_ITEMS = 80;\nconst DEFAULT_ARCHIVE_RETENTION_YEARS = 5;\nconst MAX_LIFECYCLE_CHECKLIST_ITEMS = 32;\nconst MAX_LIFECYCLE_EVIDENCE_ITEMS = 80;\nconst MAX_INCIDENT_EVIDENCE_ITEMS = 50;\nconst MAX_INCIDENT_FORENSIC_SAMPLES = 8;\nconst MAX_REFERENCE_LABEL_LENGTH = 72;\nconst MAX_REFERENCE_CATALOG_ITEMS = 256;\nconst ALLOWED_REFERENCE_KINDS = new Set([\"role\", \"department\"]);\nconst SYSTEM_REFERENCE_ROLES = [\n  { value: \"SUPER_ADMIN\", label: \"Super Admin\" },\n  { value: \"GRC\", label: \"GRC\" },\n  { value: \"HR\", label: \"HR\" },\n  { value: \"EA\", label: \"EA\" },\n  { value: \"EMPLOYEE_L1\", label: \"Employee (L1)\" },\n  { value: \"EMPLOYEE_L2\", label: \"Employee (L2)\" },\n  { value: \"EMPLOYEE_L3\", label: \"Employee (L3)\" },\n];\nconst SYSTEM_REFERENCE_DEPARTMENTS = [\n  \"Governance, Risk, and Compliance (GRC)\",\n  \"Research and Development (R&D)\",\n  \"Cyber Security Operations Center (CSOC)\",\n  \"Threat Intelligence (TI)\",\n];\nconst LIFECYCLE_ROLE_ALIAS = new Map([\n  [\"SUPER_ADMIN\", \"SUPER_ADMIN\"],\n  [\"SUPERADMIN\", \"SUPER_ADMIN\"],\n  [\"ADMIN\", \"SUPER_ADMIN\"],\n  [\"GRC\", \"GRC\"],\n  [\"HR\", \"HR\"],\n  [\"EA\", \"EA\"],\n  [\"EMPLOYEE\", \"EMPLOYEE_L1\"],\n  [\"EMPLOYEE_L1\", \"EMPLOYEE_L1\"],\n  [\"EMPLOYEE_L2\", \"EMPLOYEE_L2\"],\n  [\"EMPLOYEE_L3\", \"EMPLOYEE_L3\"],\n  [\"L1\", \"EMPLOYEE_L1\"],\n  [\"L2\", \"EMPLOYEE_L2\"],\n  [\"L3\", \"EMPLOYEE_L3\"],\n]);\n\nconst LIFECYCLE_WORKFLOW_TEMPLATES = {\n  onboarding: {\n    type: \"onboarding\",\n    category: \"Onboarding\",\n    stages: [\"Initiated\", \"Document Verification\", \"Access Provisioning\", \"Activation\"],\n    checklist: [\n      { id: \"profile-intake\", label: \"Collect employee profile and contacts\", required: true, slaHours: 12 },\n      { id: \"contract-check\", label: \"Validate contract and onboarding requirements\", required: true, slaHours: 24 },\n      { id: \"account-activation\", label: \"Activate employee account\", required: true, slaHours: 48 },\n    ],\n    approverRoles: [\"HR\", \"GRC\"],\n    slaHours: 72,\n  },\n  \"role-change\": {\n    type: \"role-change\",\n    category: \"Role Change\",\n    stages: [\"Initiated\", \"Approval Review\", \"Role Sync\", \"Completed\"],\n    checklist: [\n      { id: \"movement-justification\", label: \"Attach role-change justification\", required: true, slaHours: 24 },\n      { id: \"effective-date-review\", label: \"Validate effective date and scope\", required: true, slaHours: 24 },\n      { id: \"permission-sync\", label: \"Apply role and permission sync\", required: true, slaHours: 48 },\n    ],\n    approverRoles: [\"HR\", \"GRC\"],\n    slaHours: 96,\n  },\n  disciplinary: {\n    type: \"disciplinary\",\n    category: \"Disciplinary\",\n    stages: [\"Case Opened\", \"Investigation\", \"Decision\", \"Closed\"],\n    checklist: [\n      { id: \"incident-report\", label: \"Record incident report\", required: true, slaHours: 24 },\n      { id: \"evidence-review\", label: \"Attach and review case evidence\", required: true, slaHours: 48 },\n      { id: \"decision-log\", label: \"Finalize disciplinary decision\", required: true, slaHours: 72 },\n    ],\n    approverRoles: [\"HR\", \"GRC\"],\n    slaHours: 120,\n  },\n  offboarding: {\n    type: \"offboarding\",\n    category: \"Offboarding\",\n    stages: [\"Initiated\", \"Clearance\", \"Access Revocation\", \"Archived\"],\n    checklist: [\n      { id: \"clearance-init\", label: \"Start employee clearance checklist\", required: true, slaHours: 12 },\n      { id: \"access-revoked\", label: \"Disable account and revoke access\", required: true, slaHours: 24 },\n      { id: \"archive-records\", label: \"Archive employee records\", required: true, slaHours: 48 },\n    ],\n    approverRoles: [\"HR\", \"GRC\"],\n    slaHours: 72,\n  },\n};\n\nconst LIFECYCLE_PRIVILEGED_TARGET_ROLES = new Set([\"SUPER_ADMIN\", \"GRC\", \"HR\", \"EA\"]);\nconst LIFECYCLE_ASSIGNABLE_BY_PRIVILEGED = new Set([\"EMPLOYEE_L1\", \"EMPLOYEE_L2\", \"EMPLOYEE_L3\"]);\nconst LIFECYCLE_ASSIGNABLE_BY_GRC = new Set([\"GRC\", \"HR\", \"EA\", \"EMPLOYEE_L1\", \"EMPLOYEE_L2\", \"EMPLOYEE_L3\"]);\nconst INCIDENT_SEVERITY_LEVELS = [\"Low\", \"Medium\", \"High\", \"Critical\"];\nconst INCIDENT_STATUS_VALUES = [\"Open\", \"Containment\", \"Investigating\", \"Escalated\", \"Regulatory Review\", \"Resolved\", \"Closed\"];\nconst INCIDENT_CONTAINMENT_STATUS_VALUES = [\"Not Started\", \"In Progress\", \"Contained\"];\nconst INCIDENT_IMPACT_STATUS_VALUES = [\"Pending\", \"In Progress\", \"Completed\"];\nconst INCIDENT_TYPE_VALUES = [\n  \"Unauthorized Access\",\n  \"Data Exposure\",\n  \"Credential Compromise\",\n  \"Insider Misuse\",\n  \"Malware / Ransomware\",\n  \"Policy Violation\",\n  \"System Misconfiguration\",\n  \"Other\",\n];\nconst DEFAULT_INCIDENT_EVIDENCE_MAX_BYTES = 10 * 1024 * 1024;\nconst DEFAULT_INCIDENT_EVIDENCE_ALLOWED_EXTENSIONS = new Set([\n  \"pdf\",\n  \"png\",\n  \"jpg\",\n  \"jpeg\",\n  \"webp\",\n  \"doc\",\n  \"docx\",\n  \"xls\",\n  \"xlsx\",\n  \"csv\",\n  \"txt\",\n]);\nconst DEFAULT_INCIDENT_EVIDENCE_ALLOWED_MIME_TYPES = new Set([\n  \"application/pdf\",\n  \"image/png\",\n  \"image/jpeg\",\n  \"image/webp\",\n  \"application/msword\",\n  \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\",\n  \"application/vnd.ms-excel\",\n  \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\",\n  \"text/csv\",\n  \"text/plain\",\n]);\n\nfunction env(name, fallback) {\n  const value = String(process.env[name] || \"\").trim();\n  return value || fallback;\n}\n\nfunction parseBooleanEnv(name, fallbackValue = false) {\n  const raw = String(process.env[name] || \"\")\n    .trim()\n    .toLowerCase();\n  if (!raw) {\n    return fallbackValue;\n  }\n  return raw === \"true\" || raw === \"1\" || raw === \"yes\";\n}\n\nfunction parseCsvSet(value, fallbackSet) {\n  const normalized = String(value || \"\")\n    .split(\",\")\n    .map((item) => String(item || \"\").trim().toLowerCase())\n    .filter(Boolean);\n  if (normalized.length === 0) {\n    return new Set([...fallbackSet]);\n  }\n  return new Set(normalized);\n}\n\nfunction parseIntegerEnv(name, fallbackValue, { min = 1, max = Number.MAX_SAFE_INTEGER } = {}) {\n  const parsed = Number.parseInt(String(process.env[name] || \"\").trim(), 10);\n  if (!Number.isFinite(parsed)) {\n    return fallbackValue;\n  }\n  return Math.min(max, Math.max(min, parsed));\n}\n\nfunction getIncidentEvidenceValidationConfig() {\n  return {\n    maxBytes: parseIntegerEnv(\"CLIO_INCIDENT_EVIDENCE_MAX_BYTES\", DEFAULT_INCIDENT_EVIDENCE_MAX_BYTES, {\n      min: 128 * 1024,\n      max: 50 * 1024 * 1024,\n    }),\n    allowedExtensions: parseCsvSet(\n      process.env.CLIO_INCIDENT_EVIDENCE_ALLOWED_EXTENSIONS,\n      DEFAULT_INCIDENT_EVIDENCE_ALLOWED_EXTENSIONS,\n    ),\n    allowedMimeTypes: parseCsvSet(\n      process.env.CLIO_INCIDENT_EVIDENCE_ALLOWED_MIME_TYPES,\n      DEFAULT_INCIDENT_EVIDENCE_ALLOWED_MIME_TYPES,\n    ),\n  };\n}\n\nfunction isInviteDeliveryRequired() {\n  const defaultRequired = process.env.NODE_ENV === \"production\";\n  return parseBooleanEnv(\"CLIO_REQUIRE_EMAIL_DELIVERY\", defaultRequired);\n}\n\nfunction extractDeliveryErrorInfo(reason) {\n  const normalized = String(reason || \"\").trim();\n  if (normalized.startsWith(\"email_delivery_failed:\")) {\n    return {\n      code: \"email_delivery_failed\",\n      providerMessage: normalized.slice(\"email_delivery_failed:\".length).trim(),\n    };\n  }\n\n  return {\n    code: normalized || \"email_delivery_failed\",\n    providerMessage: \"\",\n  };\n}\n\nfunction nowIso() {\n  return new Date().toISOString();\n}\n\nfunction addYearsToIso(isoTimestamp, years) {\n  const base = new Date(isoTimestamp);\n  if (Number.isNaN(base.getTime())) {\n    const fallback = new Date();\n    fallback.setUTCFullYear(fallback.getUTCFullYear() + years);\n    return fallback.toISOString();\n  }\n  base.setUTCFullYear(base.getUTCFullYear() + years);\n  return base.toISOString();\n}\n\nfunction getArchiveRetentionYears() {\n  const raw = Number.parseInt(String(process.env.CLIO_RETENTION_YEARS || \"\").trim(), 10);\n  if (!Number.isFinite(raw) || raw < 1) {\n    return DEFAULT_ARCHIVE_RETENTION_YEARS;\n  }\n  return Math.min(raw, 25);\n}\n\nfunction asString(value, fallback = \"\") {\n  const normalized = String(value ?? \"\").trim();\n  return normalized || fallback;\n}\n\nfunction normalizeText(value) {\n  return String(value || \"\")\n    .trim()\n    .toLowerCase();\n}\n\nfunction normalizeEmail(value) {\n  return String(value || \"\").trim().toLowerCase();\n}\n\nfunction normalizeRoleKey(value) {\n  return String(value || \"\")\n    .trim()\n    .toUpperCase()\n    .replace(/[^A-Z0-9]+/g, \"_\")\n    .replace(/^_+|_+$/g, \"\");\n}\n\nfunction normalizeReferenceKind(value) {\n  const normalized = String(value || \"\")\n    .trim()\n    .toLowerCase();\n  return ALLOWED_REFERENCE_KINDS.has(normalized) ? normalized : \"\";\n}\n\nfunction normalizeReferenceLabel(value) {\n  return String(value || \"\")\n    .trim()\n    .replace(/\\s+/g, \" \");\n}\n\nfunction normalizeDepartmentKey(value) {\n  return String(value || \"\")\n    .trim()\n    .toLowerCase()\n    .replace(/[^a-z0-9]+/g, \"-\")\n    .replace(/^-+|-+$/g, \"\");\n}\n\nfunction normalizeReferenceKey(kind, value) {\n  const normalizedKind = normalizeReferenceKind(kind);\n  if (!normalizedKind) {\n    return \"\";\n  }\n  if (normalizedKind === \"role\") {\n    return normalizeRoleKey(value);\n  }\n  return normalizeDepartmentKey(value);\n}\n\nfunction buildSystemReferenceCatalog() {\n  const roles = SYSTEM_REFERENCE_ROLES.map((entry) => {\n    const value = asString(entry.value);\n    const label = asString(entry.label, value);\n    const key = normalizeReferenceKey(\"role\", value || label);\n    return {\n      id: `system-role-${key}`,\n      kind: \"role\",\n      key,\n      value,\n      label,\n      isSystem: true,\n      createdAt: \"\",\n      updatedAt: \"\",\n    };\n  });\n\n  const departments = SYSTEM_REFERENCE_DEPARTMENTS.map((entry) => {\n    const label = asString(entry);\n    const key = normalizeReferenceKey(\"department\", label);\n    return {\n      id: `system-department-${key}`,\n      kind: \"department\",\n      key,\n      value: label,\n      label,\n      isSystem: true,\n      createdAt: \"\",\n      updatedAt: \"\",\n    };\n  });\n\n  return {\n    roles,\n    departments,\n  };\n}\n\nfunction sortReferenceCatalogItems(items) {\n  return [...items].sort((left, right) => {\n    if (Boolean(left?.isSystem) !== Boolean(right?.isSystem)) {\n      return left?.isSystem ? -1 : 1;\n    }\n    return String(left?.label || \"\").localeCompare(String(right?.label || \"\"), undefined, {\n      sensitivity: \"base\",\n    });\n  });\n}\n\nfunction asArray(value) {\n  return Array.isArray(value) ? value : [];\n}\n\nfunction asObject(value, fallback = {}) {\n  if (value && typeof value === \"object\" && !Array.isArray(value)) {\n    return value;\n  }\n  return fallback;\n}\n\nfunction asBoolean(value, fallback = false) {\n  if (typeof value === \"boolean\") {\n    return value;\n  }\n  if (typeof value === \"number\") {\n    return value !== 0;\n  }\n  if (typeof value === \"string\") {\n    const normalized = value.trim().toLowerCase();\n    if (!normalized) {\n      return fallback;\n    }\n    if ([\"true\", \"1\", \"yes\", \"y\", \"on\"].includes(normalized)) {\n      return true;\n    }\n    if ([\"false\", \"0\", \"no\", \"n\", \"off\"].includes(normalized)) {\n      return false;\n    }\n  }\n  return fallback;\n}\n\nfunction normalizeEmployeeDocumentsPayload(documents, { actorEmail, now } = {}) {\n  const fallbackActor = normalizeEmail(actorEmail) || \"system@gmail.com\";\n  const fallbackAt = asString(now, nowIso());\n  return asArray(documents)\n    .map((entry, index) => {\n      const source = asObject(entry, {});\n      const uploadedAt = asString(source.uploadedAt, fallbackAt);\n      const uploadedBy = normalizeEmail(source.uploadedBy || fallbackActor) || fallbackActor;\n      const sizeRaw = Number(source.sizeBytes);\n      return {\n        id: asString(source.id),\n        name: asString(source.name, \"Employee Document\"),\n        type: asString(source.type, \"General\"),\n        ref: asString(source.ref),\n        storagePath: asString(source.storagePath),\n        contentType: asString(source.contentType),\n        sizeBytes: Number.isFinite(sizeRaw) && sizeRaw >= 0 ? sizeRaw : 0,\n        uploadedAt,\n        uploadedBy,\n        order: Number.isFinite(Number(source.order)) ? Number(source.order) : index,\n      };\n    })\n    .filter((entry) => entry.ref || entry.name);\n}\n\nasync function listEmployeeDocumentSubcollectionById(recordId, { db } = {}) {\n  const normalizedId = asString(recordId);\n  if (!normalizedId) {\n    return [];\n  }\n\n  const database = db || getDbOrThrow();\n  const employeesCollection = getCollectionName(\"employees\");\n  const subcollectionName = getEmployeeDocumentsSubcollectionName();\n  const snapshot = await getDocs(collection(database, employeesCollection, normalizedId, subcollectionName));\n  return snapshot.docs\n    .map((item, index) => {\n      const payload = normalizeEmployeeDocumentsPayload([item.data()], {\n        now: nowIso(),\n      })[0];\n      if (!payload) {\n        return null;\n      }\n      return {\n        ...payload,\n        id: item.id,\n        recordId: item.id,\n        order: Number.isFinite(Number(payload.order)) ? Number(payload.order) : index,\n      };\n    })\n    .filter(Boolean)\n    .sort((left, right) => {\n      const leftTime = new Date(left.uploadedAt || 0).getTime();\n      const rightTime = new Date(right.uploadedAt || 0).getTime();\n      if (Number.isFinite(leftTime) && Number.isFinite(rightTime) && rightTime !== leftTime) {\n        return rightTime - leftTime;\n      }\n      return Number(left.order || 0) - Number(right.order || 0);\n    });\n}\n\nasync function deleteEmployeeDocumentSubcollectionById(recordId, { db } = {}) {\n  const normalizedId = asString(recordId);\n  if (!normalizedId) {\n    return 0;\n  }\n\n  const database = db || getDbOrThrow();\n  const employeesCollection = getCollectionName(\"employees\");\n  const subcollectionName = getEmployeeDocumentsSubcollectionName();\n  const snapshot = await getDocs(collection(database, employeesCollection, normalizedId, subcollectionName));\n  let removed = 0;\n  for (const item of snapshot.docs) {\n    await deleteDoc(item.ref);\n    removed += 1;\n  }\n  return removed;\n}\n\nasync function replaceEmployeeDocumentSubcollectionById(recordId, documents, { actorEmail, db } = {}) {\n  const normalizedId = asString(recordId);\n  if (!normalizedId) {\n    throw new Error(\"invalid_record_id\");\n  }\n\n  const database = db || getDbOrThrow();\n  const employeesCollection = getCollectionName(\"employees\");\n  const subcollectionName = getEmployeeDocumentsSubcollectionName();\n  const collectionRef = collection(database, employeesCollection, normalizedId, subcollectionName);\n  const normalizedDocuments = normalizeEmployeeDocumentsPayload(documents, {\n    actorEmail,\n    now: nowIso(),\n  });\n\n  await deleteEmployeeDocumentSubcollectionById(normalizedId, { db: database });\n  const created = [];\n  for (const item of normalizedDocuments) {\n    const payload = {\n      name: item.name,\n      type: item.type,\n      ref: item.ref,\n      storagePath: item.storagePath,\n      contentType: item.contentType,\n      sizeBytes: item.sizeBytes,\n      uploadedAt: item.uploadedAt,\n      uploadedBy: item.uploadedBy,\n      order: item.order,\n    };\n    const createdRef = await addDoc(collectionRef, payload);\n    created.push({\n      ...payload,\n      id: createdRef.id,\n      recordId: createdRef.id,\n    });\n  }\n\n  return created\n    .sort((left, right) => new Date(right.uploadedAt || 0).getTime() - new Date(left.uploadedAt || 0).getTime())\n    .map((item, index) => ({\n      ...item,\n      order: Number.isFinite(Number(item.order)) ? Number(item.order) : index,\n    }));\n}\n\nfunction resolveEmployeeDocumentsForResponse(record, subcollectionDocs = []) {\n  if (Array.isArray(subcollectionDocs) && subcollectionDocs.length > 0) {\n    return subcollectionDocs;\n  }\n  return normalizeEmployeeDocumentsPayload(record?.documents, {\n    actorEmail: record?.updatedBy || record?.createdBy,\n    now: record?.updatedAt || record?.createdAt || nowIso(),\n  });\n}\n\nfunction withEmployeeDocuments(record, documents = []) {\n  const normalized = Array.isArray(documents) ? documents : [];\n  return {\n    ...record,\n    documents: normalized,\n    documentsCount: normalized.length,\n  };\n}\n\nasync function resolveAndMigrateEmployeeDocuments(record, { db } = {}) {\n  if (!record?.id) {\n    return [];\n  }\n\n  const documentsFromSubcollection = await listEmployeeDocumentSubcollectionById(record.id, { db });\n  if (documentsFromSubcollection.length > 0) {\n    return documentsFromSubcollection;\n  }\n\n  const legacyDocuments = resolveEmployeeDocumentsForResponse(record, []);\n  if (legacyDocuments.length === 0) {\n    return [];\n  }\n\n  const migrated = await replaceEmployeeDocumentSubcollectionById(record.id, legacyDocuments, {\n    actorEmail: record.updatedBy || record.createdBy,\n    db,\n  });\n  await clearLegacyEmployeeDocumentsField(record.id, {\n    documentsCount: migrated.length,\n    db,\n  });\n  return migrated;\n}\n\nasync function clearLegacyEmployeeDocumentsField(recordId, { documentsCount, db } = {}) {\n  const normalizedId = asString(recordId);\n  if (!normalizedId) {\n    return;\n  }\n\n  const database = db || getDbOrThrow();\n  const patch = {\n    documents: deleteField(),\n  };\n  if (Number.isFinite(Number(documentsCount))) {\n    patch.documentsCount = Math.max(0, Number(documentsCount));\n  }\n  await updateDoc(doc(database, getCollectionName(\"employees\"), normalizedId), patch);\n}\n\nfunction toEmployeeDocumentMergeKey(document) {\n  const storagePath = asString(document?.storagePath);\n  if (storagePath) {\n    return `path:${storagePath}`;\n  }\n  const ref = asString(document?.ref);\n  if (ref) {\n    return `ref:${ref}`;\n  }\n  return `fallback:${asString(document?.name)}|${Number.isFinite(Number(document?.sizeBytes)) ? Number(document.sizeBytes) : 0}|${asString(\n    document?.uploadedAt,\n  )}`;\n}\n\nfunction mergeEmployeeDocuments(existingDocuments, incomingDocuments) {\n  const merged = [];\n  const seen = new Set();\n  let addedCount = 0;\n\n  const pushUnique = (entry, trackAdded = false) => {\n    const normalized = normalizeEmployeeDocumentsPayload([entry], {\n      actorEmail: entry?.uploadedBy,\n      now: entry?.uploadedAt,\n    })[0];\n    if (!normalized) {\n      return;\n    }\n    const key = toEmployeeDocumentMergeKey(normalized);\n    if (seen.has(key)) {\n      return;\n    }\n    seen.add(key);\n    merged.push(normalized);\n    if (trackAdded) {\n      addedCount += 1;\n    }\n  };\n\n  asArray(existingDocuments).forEach((entry) => pushUnique(entry, false));\n  asArray(incomingDocuments).forEach((entry) => pushUnique(entry, true));\n\n  return {\n    merged,\n    addedCount,\n  };\n}\n\nfunction toOnboardingEvidenceDocuments(evidence, actorEmail) {\n  const now = nowIso();\n  const mapped = asArray(evidence).map((item) => {\n    const source = asObject(item, {});\n    return {\n      id: asString(source.id),\n      name: asString(source.name, \"Onboarding Document\"),\n      type: asString(source.type, \"Onboarding\"),\n      ref: asString(source.ref),\n      storagePath: asString(source.storagePath),\n      contentType: asString(source.contentType),\n      sizeBytes: Number.isFinite(Number(source.sizeBytes)) ? Number(source.sizeBytes) : 0,\n      uploadedAt: asString(source.uploadedAt, now),\n      uploadedBy: asString(source.uploadedBy, actorEmail),\n    };\n  });\n  return normalizeEmployeeDocumentsPayload(mapped, {\n    actorEmail,\n    now,\n  });\n}\n\nasync function syncOnboardingEvidenceToEmployeeDocuments(record, actorEmail) {\n  const category = asString(record?.category).toLowerCase();\n  if (!category.includes(\"onboarding\")) {\n    return {\n      synced: false,\n      addedCount: 0,\n    };\n  }\n\n  const employeeEmail = normalizeEmail(record?.employeeEmail);\n  if (!employeeEmail) {\n    return {\n      synced: false,\n      addedCount: 0,\n    };\n  }\n\n  const onboardingDocuments = toOnboardingEvidenceDocuments(record?.evidence, actorEmail);\n  if (onboardingDocuments.length === 0) {\n    return {\n      synced: false,\n      addedCount: 0,\n    };\n  }\n\n  const employeeRows = await listCollectionRecords(getCollectionName(\"employees\"), {\n    filterField: \"email\",\n    filterValue: employeeEmail,\n  });\n  const employeeRecord = employeeRows[0];\n  if (!employeeRecord?.id) {\n    return {\n      synced: false,\n      addedCount: 0,\n    };\n  }\n\n  const existingDocuments = await resolveAndMigrateEmployeeDocuments(employeeRecord);\n  const { merged, addedCount } = mergeEmployeeDocuments(existingDocuments, onboardingDocuments);\n  if (addedCount <= 0) {\n    return {\n      synced: false,\n      addedCount: 0,\n    };\n  }\n\n  const syncedDocuments = await replaceEmployeeDocumentSubcollectionById(employeeRecord.id, merged, {\n    actorEmail,\n  });\n  await clearLegacyEmployeeDocumentsField(employeeRecord.id, {\n    documentsCount: syncedDocuments.length,\n  });\n\n  return {\n    synced: true,\n    addedCount,\n    documentsCount: syncedDocuments.length,\n    employeeRecordId: employeeRecord.id,\n  };\n}\n\nasync function collectOnboardingEvidenceDocumentsByEmployeeEmail(employeeEmail, actorEmail) {\n  const normalizedEmail = normalizeEmail(employeeEmail);\n  if (!normalizedEmail) {\n    return [];\n  }\n\n  const lifecycleRows = await listCollectionRecords(getCollectionName(\"lifecycle\"), {\n    filterField: \"employeeEmail\",\n    filterValue: normalizedEmail,\n  });\n\n  const onboardingEvidenceDocuments = lifecycleRows\n    .filter((row) => asString(row?.category).toLowerCase().includes(\"onboarding\"))\n    .flatMap((row) => toOnboardingEvidenceDocuments(row?.evidence, actorEmail));\n\n  return mergeEmployeeDocuments([], onboardingEvidenceDocuments).merged;\n}\n\nfunction composeEmployeeName({ firstName, middleName, lastName, suffix, fallback }) {\n  return formatEmployeeName({\n    firstName: asString(firstName),\n    middleName: asString(middleName),\n    lastName: asString(lastName),\n    suffix: asString(suffix),\n    fallback: asString(fallback),\n    fallbackLabel: \"Employee\",\n  });\n}\n\nfunction normalizeLifecycleType(value) {\n  const normalized = String(value || \"\")\n    .trim()\n    .toLowerCase();\n  if (!normalized) {\n    return \"onboarding\";\n  }\n  if (normalized.includes(\"role\") || normalized.includes(\"promotion\")) {\n    return \"role-change\";\n  }\n  if (normalized.includes(\"disciplin\")) {\n    return \"disciplinary\";\n  }\n  if (normalized.includes(\"offboard\") || normalized.includes(\"resign\") || normalized.includes(\"terminate\")) {\n    return \"offboarding\";\n  }\n  if (normalized.includes(\"onboard\")) {\n    return \"onboarding\";\n  }\n  return \"onboarding\";\n}\n\nfunction getLifecycleTemplateByCategory(category) {\n  const type = normalizeLifecycleType(category);\n  return LIFECYCLE_WORKFLOW_TEMPLATES[type] || LIFECYCLE_WORKFLOW_TEMPLATES.onboarding;\n}\n\nfunction addHoursToIso(isoValue, hours) {\n  const timestamp = Number.isFinite(Number(hours)) ? Number(hours) : 0;\n  const base = new Date(isoValue || nowIso());\n  if (Number.isNaN(base.getTime())) {\n    return nowIso();\n  }\n  base.setTime(base.getTime() + Math.max(0, timestamp) * 60 * 60 * 1000);\n  return base.toISOString();\n}\n\nfunction normalizeRoleId(value) {\n  return String(value || \"\")\n    .trim()\n    .toUpperCase()\n    .replace(/[^A-Z0-9_]+/g, \"\");\n}\n\nfunction normalizeDecision(value) {\n  const normalized = String(value || \"\")\n    .trim()\n    .toLowerCase();\n  if (normalized === \"approve\" || normalized === \"approved\") {\n    return \"approved\";\n  }\n  if (normalized === \"reject\" || normalized === \"rejected\") {\n    return \"rejected\";\n  }\n  return \"\";\n}\n\nfunction buildChecklistFromTemplate(template, { atIso }) {\n  return asArray(template?.checklist)\n    .slice(0, MAX_LIFECYCLE_CHECKLIST_ITEMS)\n    .map((task, index) => {\n      const id = asString(task?.id, `task-${index + 1}`);\n      const slaHours = Number.parseInt(String(task?.slaHours || \"\"), 10);\n      return {\n        id,\n        label: asString(task?.label, id),\n        required: task?.required !== false,\n        status: \"Pending\",\n        dueAt: addHoursToIso(atIso, Number.isFinite(slaHours) && slaHours > 0 ? slaHours : 24),\n        completedAt: \"\",\n        completedBy: \"\",\n      };\n    });\n}\n\nfunction mergeChecklistWithTemplate(baseChecklist, templateChecklist) {\n  const existing = new Map();\n  asArray(baseChecklist).forEach((task) => {\n    const key = asString(task?.id);\n    if (key) {\n      existing.set(key, task);\n    }\n  });\n\n  return templateChecklist.map((task) => {\n    const previous = existing.get(task.id);\n    if (!previous) {\n      return task;\n    }\n    return {\n      ...task,\n      status: asString(previous.status, task.status),\n      dueAt: asString(previous.dueAt, task.dueAt),\n      completedAt: asString(previous.completedAt),\n      completedBy: asString(previous.completedBy),\n    };\n  });\n}\n\nfunction buildApprovalChain(requiredRoles, existingChain) {\n  const existingByRole = new Map();\n  asArray(existingChain).forEach((entry) => {\n    const role = normalizeRoleId(entry?.role);\n    if (role) {\n      existingByRole.set(role, entry);\n    }\n  });\n\n  return requiredRoles.map((role, index) => {\n    const previous = existingByRole.get(role);\n    return {\n      order: index + 1,\n      role,\n      status: asString(previous?.status, \"Pending\"),\n      decidedAt: asString(previous?.decidedAt),\n      decidedBy: asString(previous?.decidedBy),\n      note: asString(previous?.note),\n    };\n  });\n}\n\nfunction resolveApprovalState(approvalChain) {\n  const chain = asArray(approvalChain);\n  if (chain.length === 0) {\n    return \"Not Required\";\n  }\n  if (chain.some((step) => normalizeText(step?.status) === \"rejected\")) {\n    return \"Rejected\";\n  }\n  if (chain.length > 0 && chain.every((step) => normalizeText(step?.status) === \"approved\")) {\n    return \"Approved\";\n  }\n  return \"Pending\";\n}\n\nfunction summarizeChecklistProgress(checklist) {\n  const requiredTasks = checklist.filter((task) => task.required !== false);\n  const completedRequired = requiredTasks.filter((task) => normalizeText(task.status) === \"completed\").length;\n  const totalRequired = requiredTasks.length;\n  return {\n    completedRequired,\n    totalRequired,\n    percent: totalRequired === 0 ? 0 : Math.round((completedRequired / totalRequired) * 100),\n  };\n}\n\nfunction sanitizeWorkflowStageIndex(stageIndex, stagesLength) {\n  const parsed = Number.parseInt(String(stageIndex ?? \"\"), 10);\n  if (!Number.isFinite(parsed)) {\n    return 0;\n  }\n  return Math.max(0, Math.min(parsed, Math.max(0, stagesLength - 1)));\n}\n\nfunction resolveRequiredApproverRoles() {\n  return [];\n}\n\nfunction validateLifecycleTargetRolePermission({ actorRole, targetRole }) {\n  if (!targetRole) {\n    return;\n  }\n\n  const normalizedActorRole = normalizeRoleId(actorRole);\n  const normalizedTargetRole = normalizeRoleId(targetRole);\n\n  if (normalizedActorRole === \"SUPER_ADMIN\") {\n    return;\n  }\n\n  if (normalizedActorRole === \"GRC\") {\n    if (normalizedTargetRole === \"SUPER_ADMIN\") {\n      throw new Error(\"forbidden_target_role\");\n    }\n    if (!LIFECYCLE_ASSIGNABLE_BY_GRC.has(normalizedTargetRole)) {\n      throw new Error(\"invalid_target_role\");\n    }\n    return;\n  }\n\n  if (normalizedActorRole === \"HR\" || normalizedActorRole === \"EA\") {\n    if (!LIFECYCLE_ASSIGNABLE_BY_PRIVILEGED.has(normalizedTargetRole)) {\n      throw new Error(\"forbidden_target_role\");\n    }\n    return;\n  }\n\n  if (LIFECYCLE_PRIVILEGED_TARGET_ROLES.has(normalizedTargetRole)) {\n    throw new Error(\"forbidden_target_role\");\n  }\n\n  if (!LIFECYCLE_ASSIGNABLE_BY_PRIVILEGED.has(normalizedTargetRole)) {\n    throw new Error(\"invalid_target_role\");\n  }\n}\n\nfunction buildInitialLifecycleWorkflow({\n  template,\n  baseWorkflow,\n  requiredApprovers,\n  atIso,\n  actorEmail,\n}) {\n  const templateChecklist = buildChecklistFromTemplate(template, { atIso });\n  const checklist = mergeChecklistWithTemplate(baseWorkflow?.checklist, templateChecklist);\n  const approvalChain = buildApprovalChain(requiredApprovers, baseWorkflow?.approvalChain);\n  const stages = asArray(template?.stages).map((stage) => asString(stage)).filter(Boolean);\n  const stageIndex = sanitizeWorkflowStageIndex(baseWorkflow?.stageIndex ?? 0, stages.length);\n  const stage = asString(stages[stageIndex], \"Initiated\");\n  const stageHistory = appendTrail(baseWorkflow?.stageHistory, {\n    at: atIso,\n    by: actorEmail,\n    stage,\n  });\n  const progress = summarizeChecklistProgress(checklist);\n\n  return {\n    type: asString(template?.type, \"onboarding\"),\n    stageIndex,\n    stage,\n    stages,\n    checklist,\n    stageHistory,\n    approvalChain,\n    approvalState: resolveApprovalState(approvalChain),\n    progress,\n    slaDueAt: asString(baseWorkflow?.slaDueAt, addHoursToIso(atIso, Number.parseInt(String(template?.slaHours || 72), 10))),\n    slaBreached: false,\n    updatedAt: atIso,\n  };\n}\n\nfunction applyLifecycleWorkflowAction({\n  workflow,\n  evidence,\n  action,\n  actorEmail,\n  atIso,\n}) {\n  const nextWorkflow = {\n    ...workflow,\n    checklist: asArray(workflow.checklist).map((task) => ({ ...task })),\n    stageHistory: asArray(workflow.stageHistory).map((entry) => ({ ...entry })),\n  };\n  let nextEvidence = asArray(evidence).map((item) => ({ ...item }));\n  const actionType = normalizeText(action?.type);\n\n  if (!actionType) {\n    return {\n      workflow: nextWorkflow,\n      evidence: nextEvidence,\n    };\n  }\n\n  if (actionType === \"toggle-task\") {\n    const taskId = asString(action?.taskId);\n    if (!taskId) {\n      throw new Error(\"invalid_workflow_action\");\n    }\n\n    let matched = false;\n    nextWorkflow.checklist = nextWorkflow.checklist.map((task) => {\n      if (task.id !== taskId) {\n        return task;\n      }\n      matched = true;\n      const completed = Boolean(action?.completed);\n      return {\n        ...task,\n        status: completed ? \"Completed\" : \"Pending\",\n        completedAt: completed ? atIso : \"\",\n        completedBy: completed ? actorEmail : \"\",\n      };\n    });\n    if (!matched) {\n      throw new Error(\"invalid_workflow_action\");\n    }\n  } else if (actionType === \"set-stage\") {\n    const nextIndex = sanitizeWorkflowStageIndex(action?.stageIndex, asArray(nextWorkflow.stages).length);\n    const nextStage = asString(nextWorkflow.stages?.[nextIndex], nextWorkflow.stage);\n    nextWorkflow.stageIndex = nextIndex;\n    nextWorkflow.stage = nextStage;\n    nextWorkflow.stageHistory = appendTrail(nextWorkflow.stageHistory, {\n      at: atIso,\n      by: actorEmail,\n      stage: nextStage,\n      action: \"stage-update\",\n    });\n  } else if (actionType === \"add-evidence\") {\n    const evidenceEntry = asObject(action?.evidence, null);\n    if (!evidenceEntry) {\n      throw new Error(\"invalid_workflow_action\");\n    }\n    const evidenceId = asString(evidenceEntry.id, `evidence-${Date.now()}-${Math.random().toString(36).slice(2, 8)}`);\n    nextEvidence = [\n      ...nextEvidence,\n      {\n        id: evidenceId,\n        name: asString(evidenceEntry.name, \"Evidence File\"),\n        ref: asString(evidenceEntry.ref),\n        storagePath: asString(evidenceEntry.storagePath),\n        contentType: asString(evidenceEntry.contentType),\n        sizeBytes: Number.isFinite(Number(evidenceEntry.sizeBytes)) ? Number(evidenceEntry.sizeBytes) : 0,\n        uploadedAt: asString(evidenceEntry.uploadedAt, atIso),\n        uploadedBy: asString(evidenceEntry.uploadedBy, actorEmail),\n        note: asString(evidenceEntry.note),\n      },\n    ].slice(-MAX_LIFECYCLE_EVIDENCE_ITEMS);\n  } else if (actionType === \"remove-evidence\") {\n    const evidenceId = asString(action?.evidenceId);\n    if (!evidenceId) {\n      throw new Error(\"invalid_workflow_action\");\n    }\n    nextEvidence = nextEvidence.filter((item) => asString(item?.id) !== evidenceId);\n  } else {\n    throw new Error(\"invalid_workflow_action\");\n  }\n\n  const progress = summarizeChecklistProgress(nextWorkflow.checklist);\n  nextWorkflow.progress = progress;\n  nextWorkflow.updatedAt = atIso;\n  nextWorkflow.slaBreached =\n    Boolean(nextWorkflow.slaDueAt) &&\n    new Date(nextWorkflow.slaDueAt).getTime() < new Date(atIso).getTime() &&\n    progress.completedRequired < progress.totalRequired;\n\n  return {\n    workflow: nextWorkflow,\n    evidence: nextEvidence,\n  };\n}\n\nfunction applyApprovalDecision({\n  workflow,\n  actorRole,\n  actorEmail,\n  decision,\n  note,\n  atIso,\n}) {\n  const normalizedDecision = normalizeDecision(decision);\n  if (!normalizedDecision) {\n    throw new Error(\"invalid_approval_decision\");\n  }\n\n  const chain = asArray(workflow?.approvalChain).map((step) => ({ ...step }));\n  const pendingIndex = chain.findIndex((step) => normalizeText(step?.status) === \"pending\");\n  if (pendingIndex < 0) {\n    throw new Error(\"no_pending_approval_step\");\n  }\n\n  const actorRoleId = normalizeRoleId(actorRole);\n  const expectedRole = normalizeRoleId(chain[pendingIndex]?.role);\n  if (!actorRoleId || actorRoleId !== expectedRole) {\n    throw new Error(\"approval_not_allowed_for_role\");\n  }\n\n  chain[pendingIndex] = {\n    ...chain[pendingIndex],\n    status: normalizedDecision === \"approved\" ? \"Approved\" : \"Rejected\",\n    decidedAt: atIso,\n    decidedBy: actorEmail,\n    note: asString(note),\n  };\n\n  if (normalizedDecision === \"rejected\") {\n    return {\n      workflow: {\n        ...workflow,\n        approvalChain: chain,\n        approvalState: \"Rejected\",\n        updatedAt: atIso,\n      },\n      status: \"Rejected\",\n    };\n  }\n\n  const approvalState = resolveApprovalState(chain);\n  const nextWorkflow = {\n    ...workflow,\n    approvalChain: chain,\n    approvalState,\n    updatedAt: atIso,\n  };\n\n  const nextStatus = approvalState === \"Approved\" ? \"Approved\" : asString(workflow?.status, \"Pending Approval\");\n  return {\n    workflow: nextWorkflow,\n    status: nextStatus,\n  };\n}\n\nfunction appendTrail(currentValue, entry) {\n  const trail = [...asArray(currentValue), entry];\n  if (trail.length <= MAX_AUDIT_TRAIL_ITEMS) {\n    return trail;\n  }\n  return trail.slice(trail.length - MAX_AUDIT_TRAIL_ITEMS);\n}\n\nfunction byRecentUpdated(a, b) {\n  return new Date(b.updatedAt || b.createdAt || 0).getTime() - new Date(a.updatedAt || a.createdAt || 0).getTime();\n}\n\nfunction getCollectionName(key) {\n  const map = {\n    employees: env(\"CLIO_FIRESTORE_EMPLOYEES_COLLECTION\", \"employees\"),\n    lifecycle: env(\"CLIO_FIRESTORE_LIFECYCLE_COLLECTION\", \"employment_lifecycle\"),\n    attendance: env(\"CLIO_FIRESTORE_ATTENDANCE_COLLECTION\", \"attendance\"),\n    leave: env(\"CLIO_FIRESTORE_LEAVE_COLLECTION\", \"leave_requests\"),\n    performance: env(\"CLIO_FIRESTORE_PERFORMANCE_COLLECTION\", \"performance_records\"),\n    templates: env(\"CLIO_FIRESTORE_TEMPLATES_COLLECTION\", \"document_templates\"),\n    exports: env(\"CLIO_FIRESTORE_EXPORTS_COLLECTION\", \"export_requests\"),\n    incidents: env(\"CLIO_FIRESTORE_INCIDENTS_COLLECTION\", \"security_incidents\"),\n    settingsReference: env(\"CLIO_FIRESTORE_SETTINGS_REFERENCE_COLLECTION\", \"settings_reference_data\"),\n  };\n  return map[key] || key;\n}\n\nfunction getEmployeeDocumentsSubcollectionName() {\n  return env(\"CLIO_FIRESTORE_EMPLOYEE_DOCUMENTS_SUBCOLLECTION\", \"documents\");\n}\n\nfunction getDbOrThrow() {\n  if (!isFirestoreEnabled()) {\n    throw new Error(\"firestore_not_configured\");\n  }\n  const db = getFirestoreDb();\n  if (!db) {\n    throw new Error(\"firestore_not_configured\");\n  }\n  return db;\n}\n\nasync function listCollectionRecords(collectionName, { filterField, filterValue } = {}) {\n  const db = getDbOrThrow();\n  const ref = collection(db, collectionName);\n  let snapshot;\n  if (filterField && typeof filterValue === \"string\" && filterValue.trim()) {\n    snapshot = await getDocs(query(ref, where(filterField, \"==\", filterValue.trim())));\n  } else {\n    snapshot = await getDocs(ref);\n  }\n\n  return snapshot.docs\n    .map((item) => ({\n      ...item.data(),\n      id: item.id,\n      recordId: item.id,\n    }))\n    .sort(byRecentUpdated);\n}\n\nasync function getCollectionRecordById(collectionName, recordId) {\n  const db = getDbOrThrow();\n  const normalizedId = asString(recordId);\n  if (!normalizedId) {\n    throw new Error(\"invalid_record_id\");\n  }\n\n  const ref = doc(db, collectionName, normalizedId);\n  const snapshot = await getDoc(ref);\n  if (!snapshot.exists()) {\n    return null;\n  }\n  return {\n    ...snapshot.data(),\n    id: snapshot.id,\n    recordId: snapshot.id,\n  };\n}\n\nasync function createCollectionRecord(collectionName, payload) {\n  const db = getDbOrThrow();\n  const ref = await addDoc(collection(db, collectionName), payload);\n  return {\n    ...payload,\n    id: ref.id,\n    recordId: ref.id,\n  };\n}\n\nasync function updateCollectionRecord(collectionName, recordId, payload) {\n  const db = getDbOrThrow();\n  const normalizedId = asString(recordId);\n  if (!normalizedId) {\n    throw new Error(\"invalid_record_id\");\n  }\n\n  const ref = doc(db, collectionName, normalizedId);\n  const snapshot = await getDoc(ref);\n  if (!snapshot.exists()) {\n    return null;\n  }\n\n  const current = snapshot.data() || {};\n  const next = {\n    ...current,\n    ...payload,\n  };\n  await updateDoc(ref, next);\n  return {\n    ...next,\n    id: snapshot.id,\n    recordId: snapshot.id,\n  };\n}\n\nasync function updateCollectionRecordsByField(collectionName, filterField, filterValue, buildPatch) {\n  const db = getDbOrThrow();\n  const normalized = asString(filterValue);\n  if (!normalized) {\n    return 0;\n  }\n\n  const snapshot = await getDocs(\n    query(collection(db, collectionName), where(filterField, \"==\", normalized)),\n  );\n\n  let updatedCount = 0;\n  for (const recordSnapshot of snapshot.docs) {\n    const current = recordSnapshot.data() || {};\n    const patch = buildPatch(current, recordSnapshot.id);\n    if (!patch || typeof patch !== \"object\" || Object.keys(patch).length === 0) {\n      continue;\n    }\n    await updateDoc(doc(db, collectionName, recordSnapshot.id), patch);\n    updatedCount += 1;\n  }\n\n  return updatedCount;\n}\n\nasync function deleteCollectionRecord(collectionName, recordId) {\n  const db = getDbOrThrow();\n  const normalizedId = asString(recordId);\n  if (!normalizedId) {\n    throw new Error(\"invalid_record_id\");\n  }\n\n  const ref = doc(db, collectionName, normalizedId);\n  const snapshot = await getDoc(ref);\n  if (!snapshot.exists()) {\n    return null;\n  }\n\n  await deleteDoc(ref);\n  return {\n    ...snapshot.data(),\n    id: snapshot.id,\n    recordId: snapshot.id,\n  };\n}\n\nfunction toReferenceCatalogItem(raw, kind) {\n  const normalizedKind = normalizeReferenceKind(kind || raw?.kind);\n  if (!normalizedKind) {\n    return null;\n  }\n\n  const valueSource = asString(raw?.value || raw?.label);\n  const labelSource = asString(raw?.label || raw?.value);\n  const value = valueSource || labelSource;\n  const label = labelSource || valueSource;\n  const key = normalizeReferenceKey(normalizedKind, value || label);\n  if (!value || !label || !key) {\n    return null;\n  }\n\n  return {\n    id: asString(raw?.id || raw?.recordId),\n    kind: normalizedKind,\n    key,\n    value,\n    label,\n    isSystem: Boolean(raw?.isSystem),\n    createdAt: asString(raw?.createdAt),\n    updatedAt: asString(raw?.updatedAt),\n  };\n}\n\nexport async function listSettingsReferenceCatalogBackend() {\n  const collectionName = getCollectionName(\"settingsReference\");\n  const baseCatalog = buildSystemReferenceCatalog();\n  const rows = (await listCollectionRecords(collectionName)).slice(0, MAX_REFERENCE_CATALOG_ITEMS);\n\n  const roleByKey = new Map(baseCatalog.roles.map((item) => [item.key, item]));\n  const departmentByKey = new Map(baseCatalog.departments.map((item) => [item.key, item]));\n\n  rows.forEach((row) => {\n    const item = toReferenceCatalogItem(row);\n    if (!item) {\n      return;\n    }\n\n    if (item.kind === \"role\") {\n      if (!roleByKey.has(item.key)) {\n        roleByKey.set(item.key, item);\n      }\n      return;\n    }\n\n    if (!departmentByKey.has(item.key)) {\n      departmentByKey.set(item.key, item);\n    }\n  });\n\n  return {\n    roles: sortReferenceCatalogItems([...roleByKey.values()]),\n    departments: sortReferenceCatalogItems([...departmentByKey.values()]),\n  };\n}\n\nexport async function createSettingsReferenceItemBackend({ kind, label }, actorEmail) {\n  const normalizedKind = normalizeReferenceKind(kind);\n  if (!normalizedKind) {\n    throw new Error(\"invalid_reference_kind\");\n  }\n\n  const normalizedLabel = normalizeReferenceLabel(label);\n  if (!normalizedLabel || normalizedLabel.length > MAX_REFERENCE_LABEL_LENGTH) {\n    throw new Error(\"invalid_reference_label\");\n  }\n\n  const key = normalizeReferenceKey(normalizedKind, normalizedLabel);\n  if (!key) {\n    throw new Error(\"invalid_reference_label\");\n  }\n\n  const catalog = await listSettingsReferenceCatalogBackend();\n  const targetRows = normalizedKind === \"role\" ? catalog.roles : catalog.departments;\n  const alreadyExists = targetRows.some((entry) => entry.key === key);\n  if (alreadyExists) {\n    throw new Error(\"duplicate_reference_value\");\n  }\n\n  const timestamp = nowIso();\n  const payload = {\n    kind: normalizedKind,\n    key,\n    value: normalizedLabel,\n    label: normalizedLabel,\n    isSystem: false,\n    createdAt: timestamp,\n    createdBy: actorEmail,\n    updatedAt: timestamp,\n    updatedBy: actorEmail,\n  };\n\n  const created = await createCollectionRecord(getCollectionName(\"settingsReference\"), payload);\n  const item = toReferenceCatalogItem(created, normalizedKind);\n  if (!item) {\n    throw new Error(\"invalid_reference_label\");\n  }\n  return item;\n}\n\nexport async function deleteSettingsReferenceItemBackend({ kind, recordId }) {\n  const normalizedKind = normalizeReferenceKind(kind);\n  if (!normalizedKind) {\n    throw new Error(\"invalid_reference_kind\");\n  }\n\n  const normalizedRecordId = asString(recordId);\n  if (!normalizedRecordId || normalizedRecordId.startsWith(\"system-\")) {\n    throw new Error(\"immutable_reference_item\");\n  }\n\n  const current = await getCollectionRecordById(getCollectionName(\"settingsReference\"), normalizedRecordId);\n  if (!current) {\n    return null;\n  }\n\n  const currentKind = normalizeReferenceKind(current.kind);\n  if (!currentKind || currentKind !== normalizedKind || current.isSystem === true) {\n    throw new Error(\"immutable_reference_item\");\n  }\n\n  const deleted = await deleteCollectionRecord(getCollectionName(\"settingsReference\"), normalizedRecordId);\n  return toReferenceCatalogItem(deleted, normalizedKind);\n}\n\nfunction normalizeEmployeeWritePayload(payload, actorEmail, { base } = {}) {\n  const timestamp = nowIso();\n  const employeeEmail = normalizeEmail(payload?.email || base?.email);\n  if (!employeeEmail) {\n    throw new Error(\"invalid_employee_email\");\n  }\n\n  const baseGovernmentIds = asObject(base?.governmentIds, {});\n  const incomingGovernmentIds = asObject(payload?.governmentIds, {});\n  const governmentIds = {\n    ...baseGovernmentIds,\n    ...incomingGovernmentIds,\n  };\n\n  const basePayrollInformation = asObject(base?.payrollInformation, {});\n  const incomingPayrollInformation = asObject(payload?.payrollInformation, {});\n  const payrollInformation = {\n    ...basePayrollInformation,\n    ...incomingPayrollInformation,\n  };\n\n  const managerEmail = normalizeEmail(payload?.managerEmail || base?.managerEmail);\n  const contact = asString(payload?.contact, asString(base?.contact, \"-\"));\n  const address = asString(payload?.address, asString(base?.address, \"-\"));\n  const emergencyContact = asString(payload?.emergencyContact, asString(base?.emergencyContact, \"-\"));\n  const govId = asString(payload?.govId, asString(base?.govId, \"Masked\"));\n  const firstName = asString(payload?.firstName, asString(base?.firstName, \"\"));\n  const middleName = asString(payload?.middleName, asString(base?.middleName, \"\"));\n  const lastName = asString(payload?.lastName, asString(base?.lastName, \"\"));\n  const suffix = asString(payload?.suffix, asString(base?.suffix, \"\"));\n  const legacyName = asString(payload?.name, asString(base?.name, employeeEmail));\n  const composedName = composeEmployeeName({\n    firstName,\n    middleName,\n    lastName,\n    suffix,\n    fallback: legacyName || employeeEmail,\n  });\n\n  if (!governmentIds.primaryId) {\n    governmentIds.primaryId = govId;\n  }\n\n  const payloadHasDocuments = Object.prototype.hasOwnProperty.call(asObject(payload, {}), \"documents\");\n  const payloadDocuments = payloadHasDocuments ? asArray(payload?.documents) : null;\n  const baseDocumentsCountRaw = Number(base?.documentsCount);\n  const baseDocumentsCount = Number.isFinite(baseDocumentsCountRaw)\n    ? Math.max(0, baseDocumentsCountRaw)\n    : asArray(base?.documents).length;\n  const documentsCount = payloadDocuments ? payloadDocuments.length : baseDocumentsCount;\n\n  return {\n    employeeId: asString(payload?.employeeId, asString(base?.employeeId, `CL-${Date.now().toString().slice(-6)}`)),\n    name: composedName,\n    firstName,\n    middleName,\n    lastName,\n    suffix,\n    email: employeeEmail,\n    role: asString(payload?.role, asString(base?.role, \"EMPLOYEE_L1\")),\n    department: asString(payload?.department, asString(base?.department, \"-\")),\n    jobTitle: asString(payload?.jobTitle, asString(base?.jobTitle, \"-\")),\n    managerEmail,\n    hireDate: asString(payload?.hireDate, asString(base?.hireDate, \"\")),\n    employmentStatus: asString(payload?.employmentStatus, asString(base?.employmentStatus, \"Active Employee\")),\n    status: asString(payload?.status, asString(base?.status, \"Active\")),\n    governmentIds,\n    govId,\n    contact,\n    address,\n    emergencyContact,\n    contactInformation: {\n      primaryPhone: contact,\n      address,\n      emergencyContact,\n    },\n    payrollInformation,\n    payrollGroup: asString(payload?.payrollGroup, asString(base?.payrollGroup, \"-\")),\n    documentsCount,\n    classification: \"Restricted PII\",\n    createdAt: asString(base?.createdAt, timestamp),\n    createdBy: asString(base?.createdBy, actorEmail),\n    updatedAt: timestamp,\n    updatedBy: actorEmail,\n    activityHistory: appendTrail(base?.activityHistory, {\n      at: timestamp,\n      by: actorEmail,\n      action: base ? \"update\" : \"create\",\n    }),\n  };\n}\n\nexport async function listEmployeeRecordsBackend({ ownerEmail, includeDocuments = false } = {}) {\n  const rows = await listCollectionRecords(getCollectionName(\"employees\"), {\n    filterField: ownerEmail ? \"email\" : undefined,\n    filterValue: ownerEmail ? normalizeEmail(ownerEmail) : undefined,\n  });\n  if (!includeDocuments) {\n    return rows;\n  }\n\n  const enriched = await Promise.all(\n    rows.map(async (record) => {\n      const documents = await resolveAndMigrateEmployeeDocuments(record);\n      return withEmployeeDocuments(record, documents);\n    }),\n  );\n  return enriched;\n}\n\nexport async function getEmployeeRecordBackend(recordId, { includeDocuments = true } = {}) {\n  const record = await getCollectionRecordById(getCollectionName(\"employees\"), recordId);\n  if (!record || !includeDocuments) {\n    return record;\n  }\n\n  let documents = await resolveAndMigrateEmployeeDocuments(record);\n  if (documents.length === 0) {\n    const backfilledDocuments = await collectOnboardingEvidenceDocumentsByEmployeeEmail(\n      record.email,\n      record.updatedBy || record.createdBy,\n    );\n    if (backfilledDocuments.length > 0) {\n      documents = await replaceEmployeeDocumentSubcollectionById(record.id, backfilledDocuments, {\n        actorEmail: record.updatedBy || record.createdBy,\n      });\n      await clearLegacyEmployeeDocumentsField(record.id, {\n        documentsCount: documents.length,\n      });\n    }\n  }\n  return withEmployeeDocuments(record, documents);\n}\n\nexport async function createEmployeeRecordBackend(payload, actorEmail) {\n  const normalized = normalizeEmployeeWritePayload(payload, actorEmail);\n  const created = await createCollectionRecord(getCollectionName(\"employees\"), normalized);\n  const payloadDocuments = asArray(payload?.documents);\n  if (payloadDocuments.length === 0) {\n    return withEmployeeDocuments(created, []);\n  }\n\n  const syncedDocuments = await replaceEmployeeDocumentSubcollectionById(created.id, payloadDocuments, {\n    actorEmail,\n  });\n  await clearLegacyEmployeeDocumentsField(created.id, {\n    documentsCount: syncedDocuments.length,\n  });\n  return withEmployeeDocuments(created, syncedDocuments);\n}\n\nexport async function updateEmployeeRecordBackend(recordId, payload, actorEmail) {\n  const current = await getEmployeeRecordBackend(recordId, { includeDocuments: true });\n  if (!current) {\n    return null;\n  }\n  const payloadHasDocuments = Object.prototype.hasOwnProperty.call(asObject(payload, {}), \"documents\");\n  const payloadDocuments = payloadHasDocuments ? asArray(payload?.documents) : null;\n  const normalized = normalizeEmployeeWritePayload(payload, actorEmail, { base: current });\n  const updated = await updateCollectionRecord(getCollectionName(\"employees\"), recordId, normalized);\n  if (!updated) {\n    return null;\n  }\n\n  if (payloadDocuments) {\n    const syncedDocuments = await replaceEmployeeDocumentSubcollectionById(recordId, payloadDocuments, {\n      actorEmail,\n    });\n    await clearLegacyEmployeeDocumentsField(recordId, {\n      documentsCount: syncedDocuments.length,\n    });\n    return withEmployeeDocuments(updated, syncedDocuments);\n  }\n\n  const documents = await resolveAndMigrateEmployeeDocuments(updated);\n  return withEmployeeDocuments(updated, documents);\n}\n\nexport async function deleteEmployeeRecordBackend(recordId) {\n  await deleteEmployeeDocumentSubcollectionById(recordId);\n  return await deleteCollectionRecord(getCollectionName(\"employees\"), recordId);\n}\n\nfunction normalizeLifecyclePayload(payload, actorEmail, actorRole, { base } = {}) {\n  const timestamp = nowIso();\n  const category = asString(payload?.category, asString(base?.category, \"Onboarding\"));\n  const employeeEmail = normalizeEmail(payload?.employeeEmail || base?.employeeEmail);\n  if (!employeeEmail) {\n    throw new Error(\"invalid_employee_email\");\n  }\n\n  const baseDetails = asObject(base?.details, {});\n  const incomingDetails = asObject(payload?.details, {});\n  const details = {\n    ...baseDetails,\n    ...incomingDetails,\n  };\n\n  const template = getLifecycleTemplateByCategory(category);\n  const requiredApprovers = resolveRequiredApproverRoles(template, details);\n  const baseWorkflow = asObject(base?.workflow, {});\n  const workflowPatch = asObject(payload?.workflow, {});\n  const workflowSeed = {\n    ...baseWorkflow,\n    ...workflowPatch,\n  };\n\n  const workflow = buildInitialLifecycleWorkflow({\n    template,\n    baseWorkflow: workflowSeed,\n    requiredApprovers,\n    atIso: timestamp,\n    actorEmail,\n  });\n\n  const action = payload?.workflowAction && typeof payload.workflowAction === \"object\" ? payload.workflowAction : null;\n  const withAction = applyLifecycleWorkflowAction({\n    workflow,\n    evidence: asArray(base?.evidence),\n    action,\n    actorEmail,\n    atIso: timestamp,\n  });\n\n  const progress = summarizeChecklistProgress(withAction.workflow.checklist);\n  withAction.workflow.progress = progress;\n  withAction.workflow.slaBreached =\n    Boolean(withAction.workflow.slaDueAt) &&\n    new Date(withAction.workflow.slaDueAt).getTime() < new Date(timestamp).getTime() &&\n    progress.completedRequired < progress.totalRequired;\n  withAction.workflow.approvalState = resolveApprovalState(withAction.workflow.approvalChain);\n\n  const requestedStatus = asString(payload?.status, asString(base?.status, \"In Progress\"));\n  const status = requestedStatus;\n\n  return {\n    employeeEmail,\n    employee: asString(payload?.employee, asString(base?.employee, employeeEmail || \"Unknown Employee\")),\n    category,\n    workflowType: asString(template.type, \"onboarding\"),\n    owner: asString(payload?.owner, asString(base?.owner, \"HR Operations\")),\n    details,\n    evidence: withAction.evidence,\n    workflow: withAction.workflow,\n    status,\n    createdAt: asString(base?.createdAt, timestamp),\n    createdBy: asString(base?.createdBy, actorEmail),\n    updatedAt: timestamp,\n    updatedBy: actorEmail,\n    traceability: appendTrail(base?.traceability, {\n      at: timestamp,\n      by: actorEmail,\n      action: base ? \"update\" : \"create\",\n      category,\n      status,\n      stage: withAction.workflow.stage,\n      checklistProgress: withAction.workflow.progress.percent,\n      approvalState: withAction.workflow.approvalState,\n    }),\n  };\n}\n\nfunction shouldTriggerAccessRevocation(record) {\n  const category = asString(record?.category).toLowerCase();\n  const status = asString(record?.status).toLowerCase();\n  return (\n    category.includes(\"offboarding\") ||\n    status.includes(\"resign\") ||\n    status.includes(\"terminated\") ||\n    status.includes(\"access revoked\")\n  );\n}\n\nfunction shouldApplyLifecycleRoleSync(record) {\n  const category = asString(record?.category).toLowerCase();\n  const status = asString(record?.status).toLowerCase();\n  const isRoleMovement = category.includes(\"role change\") || category.includes(\"promotion\");\n  const isFinalized = status.includes(\"approved\") || status.includes(\"completed\");\n  return isRoleMovement && isFinalized;\n}\n\nfunction shouldApplyLifecycleArchivePolicy(record) {\n  const category = asString(record?.category).toLowerCase();\n  const status = asString(record?.status).toLowerCase();\n  const exitStatusDetected =\n    status.includes(\"resign\") || status.includes(\"terminated\") || status.includes(\"access revoked\");\n  const finalizedOffboarding =\n    category.includes(\"offboarding\") &&\n    (status.includes(\"approved\") || status.includes(\"completed\") || status.includes(\"revoked\"));\n  return exitStatusDetected || finalizedOffboarding;\n}\n\nfunction shouldApplyOnboardingActivation(record) {\n  const category = asString(record?.category).toLowerCase();\n  const status = asString(record?.status).toLowerCase();\n  const isOnboarding = category.includes(\"onboarding\");\n  const isFinalized = status.includes(\"approved\") || status.includes(\"completed\");\n  return isOnboarding && isFinalized;\n}\n\nfunction shouldTriggerOnboardingInvite(record) {\n  const category = asString(record?.category).toLowerCase();\n  return category.includes(\"onboarding\");\n}\n\nfunction resolveLifecycleInviteRole(record) {\n  const details = asObject(record?.details, {});\n  const roleRaw = asString(details?.roleTo || details?.role || details?.roleFrom);\n  if (!roleRaw) {\n    return \"EMPLOYEE_L1\";\n  }\n  const normalized = normalizeRoleKey(roleRaw);\n  if (!normalized) {\n    return \"EMPLOYEE_L1\";\n  }\n  return LIFECYCLE_ROLE_ALIAS.get(normalized) || normalized || \"EMPLOYEE_L1\";\n}\n\nasync function triggerOnboardingInvite(record, actorEmail, actorRole) {\n  const normalizedEmail = normalizeEmail(record?.employeeEmail);\n  if (!normalizedEmail) {\n    throw new Error(\"invalid_employee_email\");\n  }\n\n  const existingAccount = await getLoginAccount(normalizedEmail).catch(() => null);\n  const existingStatus = asString(existingAccount?.status).toLowerCase();\n  if (existingStatus === \"active\") {\n    return {\n      type: \"onboarding-invite-skipped\",\n      message: \"User account is already active. Invite was not reissued.\",\n      accountStatus: \"active\",\n    };\n  }\n\n  const inviteRole = resolveLifecycleInviteRole(record);\n  validateLifecycleTargetRolePermission({\n    actorRole,\n    targetRole: inviteRole,\n  });\n  const result = await inviteUserAccount({\n    email: normalizedEmail,\n    role: inviteRole,\n    invitedBy: actorEmail,\n  });\n\n  const enforceDelivery = isInviteDeliveryRequired();\n  let delivery = null;\n  try {\n    delivery = await deliverInviteEmail({\n      toEmail: result.user.email,\n      role: result.user.role,\n      invitedBy: actorEmail,\n      expiresAt: result.invite.expiresAt,\n      inviteToken: result.invite.token,\n    });\n  } catch (deliveryError) {\n    const rawReason = deliveryError instanceof Error ? deliveryError.message : \"email_delivery_failed\";\n    const deliveryErrorInfo = extractDeliveryErrorInfo(rawReason);\n    if (enforceDelivery) {\n      await revokeInviteById(result.invite.id).catch(() => null);\n      throw new Error(deliveryErrorInfo.code || \"email_delivery_failed\");\n    }\n\n    delivery = {\n      provider: \"unavailable\",\n      status: \"failed\",\n      messageId: null,\n      reason: deliveryErrorInfo.code || \"email_delivery_failed\",\n      providerMessage: deliveryErrorInfo.providerMessage || null,\n    };\n  }\n\n  return {\n    type: \"onboarding-invite\",\n    message:\n      delivery?.status === \"failed\"\n        ? \"Onboarding invite was created. Email delivery failed in test mode.\"\n        : \"Onboarding invite sent. User can verify email and activate access.\",\n    inviteId: result.invite.id,\n    inviteStatus: result.invite.status,\n    role: result.user.role,\n    deliveryProvider: delivery?.provider || \"unknown\",\n    deliveryStatus: delivery?.status || \"unknown\",\n  };\n}\n\nfunction resolveLifecycleRoleTarget(record) {\n  const details = asObject(record?.details, {});\n  const roleToRaw = asString(details?.roleTo);\n  if (!roleToRaw) {\n    return \"\";\n  }\n\n  const normalized = normalizeRoleKey(roleToRaw);\n  return LIFECYCLE_ROLE_ALIAS.get(normalized) || \"\";\n}\n\nfunction resolveArchiveReasonFromLifecycle(record) {\n  const details = asObject(record?.details, {});\n  const detailReason = asString(details?.offboardingReason || details?.reason || details?.note);\n  if (detailReason) {\n    return detailReason;\n  }\n\n  const category = asString(record?.category);\n  const status = asString(record?.status);\n  if (category || status) {\n    return [category, status].filter(Boolean).join(\" - \");\n  }\n\n  return \"Resigned\";\n}\n\nfunction buildArchivePatch(current, { actorEmail, archivedAt, reason, retentionDeleteAt, trailField }) {\n  const patch = {\n    isArchived: true,\n    archivedAt,\n    archivedBy: actorEmail,\n    archiveReason: reason,\n    retentionDeleteAt,\n    updatedAt: archivedAt,\n    updatedBy: actorEmail,\n  };\n\n  if (trailField) {\n    patch[trailField] = appendTrail(current?.[trailField], {\n      at: archivedAt,\n      by: actorEmail,\n      action: \"archive\",\n      reason,\n    });\n  }\n\n  return patch;\n}\n\nasync function syncUserRoleByLifecycle(record, actorRole) {\n  const normalizedEmail = normalizeEmail(record?.employeeEmail);\n  if (!normalizedEmail) {\n    throw new Error(\"invalid_employee_email\");\n  }\n\n  const targetRole = resolveLifecycleRoleTarget(record);\n  if (!targetRole) {\n    throw new Error(\"invalid_target_role\");\n  }\n  validateLifecycleTargetRolePermission({\n    actorRole,\n    targetRole,\n  });\n\n  const updated = await updateUserAccountRole({\n    userId: normalizedEmail,\n    role: targetRole,\n  });\n  if (!updated) {\n    throw new Error(\"role_sync_failed\");\n  }\n\n  return updated;\n}\n\nasync function syncEmployeeRecordRoleByLifecycle(record, actorEmail, actorRole) {\n  const normalizedEmail = normalizeEmail(record?.employeeEmail);\n  if (!normalizedEmail) {\n    throw new Error(\"invalid_employee_email\");\n  }\n\n  const targetRole = resolveLifecycleRoleTarget(record);\n  if (!targetRole) {\n    throw new Error(\"invalid_target_role\");\n  }\n  validateLifecycleTargetRolePermission({\n    actorRole,\n    targetRole,\n  });\n\n  const details = asObject(record?.details, {});\n  const nextDepartment = asString(details?.departmentTo);\n  const updatedAt = nowIso();\n  const updatedCount = await updateCollectionRecordsByField(\n    getCollectionName(\"employees\"),\n    \"email\",\n    normalizedEmail,\n    (current) => {\n      const patch = {\n        role: targetRole,\n        updatedAt,\n        updatedBy: actorEmail,\n        activityHistory: appendTrail(current?.activityHistory, {\n          at: updatedAt,\n          by: actorEmail,\n          action: \"lifecycle-role-sync\",\n          role: targetRole,\n        }),\n      };\n      if (nextDepartment) {\n        patch.department = nextDepartment;\n      }\n      return patch;\n    },\n  );\n\n  return updatedCount;\n}\n\nasync function revokeUserAccessByEmail(email) {\n  const normalizedEmail = normalizeEmail(email);\n  if (!normalizedEmail) {\n    throw new Error(\"invalid_employee_email\");\n  }\n\n  const updated = await updateUserAccountStatus({\n    userId: normalizedEmail,\n    status: \"disabled\",\n  });\n  if (!updated) {\n    throw new Error(\"employee_account_not_found\");\n  }\n  if (asString(updated.status).toLowerCase() !== \"disabled\") {\n    throw new Error(\"access_revocation_failed\");\n  }\n  return updated;\n}\n\nasync function activateUserAccessByEmail(email) {\n  const normalizedEmail = normalizeEmail(email);\n  if (!normalizedEmail) {\n    throw new Error(\"invalid_employee_email\");\n  }\n\n  const updated = await updateUserAccountStatus({\n    userId: normalizedEmail,\n    status: \"active\",\n  });\n  if (!updated) {\n    throw new Error(\"employee_account_not_found\");\n  }\n  if (asString(updated.status).toLowerCase() !== \"active\") {\n    throw new Error(\"account_activation_failed\");\n  }\n  return updated;\n}\n\nasync function activateEmployeeRecordByEmail(record, actorEmail) {\n  const normalizedEmail = normalizeEmail(record?.employeeEmail);\n  if (!normalizedEmail) {\n    throw new Error(\"invalid_employee_email\");\n  }\n\n  const details = asObject(record?.details, {});\n  const employeeId = asString(details?.employeeId || details?.employeeNumber);\n  const firstName = asString(details?.firstName);\n  const middleName = asString(details?.middleName);\n  const lastName = asString(details?.lastName);\n  const suffix = asString(details?.suffix);\n  const startDate = asString(details?.startDate);\n  const roleRaw = asString(details?.roleTo || details?.role || details?.roleFrom);\n  const roleNormalized = normalizeRoleKey(roleRaw);\n  const roleValue = LIFECYCLE_ROLE_ALIAS.get(roleNormalized) || roleNormalized || \"EMPLOYEE_L1\";\n  const departmentValue = asString(details?.departmentTo || details?.department);\n  const displayName = composeEmployeeName({\n    firstName,\n    middleName,\n    lastName,\n    suffix,\n    fallback: asString(record?.employee, normalizedEmail),\n  });\n  const updatedAt = nowIso();\n  const updatedCount = await updateCollectionRecordsByField(getCollectionName(\"employees\"), \"email\", normalizedEmail, (current) => {\n    const patch = {\n      status: \"Active\",\n      employmentStatus: \"Active Employee\",\n      isArchived: false,\n      updatedAt,\n      updatedBy: actorEmail,\n      activityHistory: appendTrail(current?.activityHistory, {\n        at: updatedAt,\n        by: actorEmail,\n        action: \"lifecycle-onboarding-sync\",\n        status: \"Active\",\n      }),\n    };\n    if (employeeId) {\n      patch.employeeId = employeeId;\n    }\n    if (firstName) {\n      patch.firstName = firstName;\n    }\n    if (middleName) {\n      patch.middleName = middleName;\n    }\n    if (lastName) {\n      patch.lastName = lastName;\n    }\n    if (suffix) {\n      patch.suffix = suffix;\n    }\n    if (displayName) {\n      patch.name = displayName;\n    }\n    if (departmentValue) {\n      patch.department = departmentValue;\n    }\n    if (roleValue) {\n      patch.role = roleValue;\n    }\n    if (startDate) {\n      patch.hireDate = startDate;\n    }\n    return patch;\n  });\n\n  if (updatedCount > 0) {\n    return updatedCount;\n  }\n\n  const createdPayload = normalizeEmployeeWritePayload(\n    {\n      employeeId,\n      email: normalizedEmail,\n      name: displayName,\n      firstName,\n      middleName,\n      lastName,\n      suffix,\n      role: roleValue || \"EMPLOYEE_L1\",\n      department: departmentValue || \"-\",\n      hireDate: startDate || \"\",\n      status: \"Active\",\n      employmentStatus: \"Active Employee\",\n    },\n    actorEmail,\n  );\n  await createCollectionRecord(getCollectionName(\"employees\"), createdPayload);\n  return 1;\n}\n\nasync function archiveEmployeeDataByEmail(record, actorEmail) {\n  const normalizedEmail = normalizeEmail(record?.employeeEmail);\n  if (!normalizedEmail) {\n    throw new Error(\"invalid_employee_email\");\n  }\n\n  const archivedAt = nowIso();\n  const retentionDeleteAt = addYearsToIso(archivedAt, getArchiveRetentionYears());\n  const reason = resolveArchiveReasonFromLifecycle(record);\n\n  const userArchive = await archiveUserAccount({\n    userId: normalizedEmail,\n    archivedBy: actorEmail,\n    reason,\n    retentionDeleteAt,\n  });\n\n  const employeesArchived = await updateCollectionRecordsByField(getCollectionName(\"employees\"), \"email\", normalizedEmail, (current) => ({\n    ...buildArchivePatch(current, {\n      actorEmail,\n      archivedAt,\n      reason,\n      retentionDeleteAt,\n      trailField: \"activityHistory\",\n    }),\n    status: \"Archived\",\n    employmentStatus: \"Resigned\",\n  }));\n\n  const lifecycleArchived = await updateCollectionRecordsByField(getCollectionName(\"lifecycle\"), \"employeeEmail\", normalizedEmail, (current) => ({\n    ...buildArchivePatch(current, {\n      actorEmail,\n      archivedAt,\n      reason,\n      retentionDeleteAt,\n      trailField: \"traceability\",\n    }),\n    archiveStatus: \"Archived\",\n  }));\n\n  const attendanceArchived = await updateCollectionRecordsByField(getCollectionName(\"attendance\"), \"employeeEmail\", normalizedEmail, (current) => ({\n    ...buildArchivePatch(current, {\n      actorEmail,\n      archivedAt,\n      reason,\n      retentionDeleteAt,\n      trailField: \"modificationTrail\",\n    }),\n    archiveStatus: \"Archived\",\n  }));\n\n  const leaveArchived = await updateCollectionRecordsByField(getCollectionName(\"leave\"), \"employeeEmail\", normalizedEmail, (current) => ({\n    ...buildArchivePatch(current, {\n      actorEmail,\n      archivedAt,\n      reason,\n      retentionDeleteAt,\n      trailField: \"modificationTrail\",\n    }),\n    archiveStatus: \"Archived\",\n  }));\n\n  const performanceArchived = await updateCollectionRecordsByField(getCollectionName(\"performance\"), \"employeeEmail\", normalizedEmail, (current) => ({\n    ...buildArchivePatch(current, {\n      actorEmail,\n      archivedAt,\n      reason,\n      retentionDeleteAt,\n      trailField: \"traceability\",\n    }),\n    archiveStatus: \"Archived\",\n  }));\n\n  const exportsArchived = await updateCollectionRecordsByField(getCollectionName(\"exports\"), \"requestedBy\", normalizedEmail, (current) => ({\n    ...buildArchivePatch(current, {\n      actorEmail,\n      archivedAt,\n      reason,\n      retentionDeleteAt,\n      trailField: \"history\",\n    }),\n    archiveStatus: \"Archived\",\n  }));\n\n  return {\n    archivedAt,\n    retentionDeleteAt,\n    reason,\n    userStatus: userArchive?.status || \"disabled\",\n    counts: {\n      employees: employeesArchived,\n      lifecycle: lifecycleArchived,\n      attendance: attendanceArchived,\n      leave: leaveArchived,\n      performance: performanceArchived,\n      exports: exportsArchived,\n    },\n  };\n}\n\nasync function applyLifecycleAutomations(record, actorEmail, actorRole) {\n  const effects = [];\n  if (shouldApplyOnboardingActivation(record)) {\n    const activatedAccount = await activateUserAccessByEmail(record.employeeEmail);\n    const activatedEmployeeRecords = await activateEmployeeRecordByEmail(record, actorEmail);\n    effects.push({\n      type: \"onboarding-activation\",\n      message: \"User account and employee profile activated.\",\n      accountStatus: activatedAccount?.status || \"active\",\n      employeeRecordsUpdated: activatedEmployeeRecords,\n    });\n  }\n  if (shouldApplyLifecycleRoleSync(record)) {\n    const employeeRecordsUpdated = await syncEmployeeRecordRoleByLifecycle(record, actorEmail, actorRole);\n    const account = await syncUserRoleByLifecycle(record, actorRole);\n    effects.push({\n      type: \"role-sync\",\n      message: `Role synchronized to ${account?.role || \"target role\"}.`,\n      role: account?.role || null,\n      employeeRecordsUpdated,\n    });\n  }\n  if (shouldTriggerAccessRevocation(record)) {\n    const account = await revokeUserAccessByEmail(record.employeeEmail);\n    effects.push({\n      type: \"access-revocation\",\n      message: \"User account access revoked.\",\n      accountStatus: account?.status || \"disabled\",\n    });\n  }\n  if (shouldApplyLifecycleArchivePolicy(record)) {\n    const archiveResult = await archiveEmployeeDataByEmail(record, actorEmail);\n    effects.push({\n      type: \"archive-policy\",\n      message: `Employee data archived until ${archiveResult.retentionDeleteAt}.`,\n      retentionDeleteAt: archiveResult.retentionDeleteAt,\n      archivedAt: archiveResult.archivedAt,\n      counts: archiveResult.counts,\n    });\n  }\n  return effects;\n}\n\nexport async function listLifecycleRecordsBackend() {\n  return await listCollectionRecords(getCollectionName(\"lifecycle\"));\n}\n\nexport async function getLifecycleRecordBackend(recordId) {\n  return await getCollectionRecordById(getCollectionName(\"lifecycle\"), recordId);\n}\n\nexport async function createLifecycleRecordBackend(payload, actorEmail, actorRole = \"\") {\n  const normalized = normalizeLifecyclePayload(payload, actorEmail, actorRole);\n  const effects = [];\n  if (shouldTriggerOnboardingInvite(normalized)) {\n    const inviteEffect = await triggerOnboardingInvite(normalized, actorEmail, actorRole);\n    if (inviteEffect) {\n      effects.push(inviteEffect);\n    }\n  }\n  const automationEffects = await applyLifecycleAutomations(normalized, actorEmail, actorRole);\n  effects.push(...automationEffects);\n\n  const created = await createCollectionRecord(getCollectionName(\"lifecycle\"), {\n    ...normalized,\n    lastAutomationEffects: effects,\n    lastAutomationAt: nowIso(),\n    lastAutomationBy: actorEmail,\n  });\n\n  await syncOnboardingEvidenceToEmployeeDocuments(created, actorEmail).catch(() => null);\n\n  return {\n    record: created,\n    effects,\n  };\n}\n\nexport async function updateLifecycleRecordBackend(recordId, payload, actorEmail, actorRole = \"\") {\n  const current = await getLifecycleRecordBackend(recordId);\n  if (!current) {\n    return null;\n  }\n  const normalized = normalizeLifecyclePayload(payload, actorEmail, actorRole, { base: current });\n  const effects = await applyLifecycleAutomations(normalized, actorEmail, actorRole);\n\n  const updated = await updateCollectionRecord(getCollectionName(\"lifecycle\"), recordId, {\n    ...normalized,\n    lastAutomationEffects: effects,\n    lastAutomationAt: nowIso(),\n    lastAutomationBy: actorEmail,\n  });\n\n  await syncOnboardingEvidenceToEmployeeDocuments(updated, actorEmail).catch(() => null);\n\n  return {\n    record: updated,\n    effects,\n  };\n}\n\nexport async function forceOffboardLifecycleRecordBackend(recordId, actorEmail, reason, actorRole = \"\") {\n  return await updateLifecycleRecordBackend(\n    recordId,\n    {\n      category: \"Offboarding\",\n      status: \"Access Revoked\",\n      details: {\n        offboardingReason: asString(reason, \"Resignation\"),\n      },\n    },\n    actorEmail,\n    actorRole,\n  );\n}\n\nexport async function approveLifecycleRecordBackend(\n  recordId,\n  { decision, note } = {},\n  actorEmail,\n  actorRole = \"\",\n) {\n  const current = await getLifecycleRecordBackend(recordId);\n  if (!current) {\n    return null;\n  }\n\n  const timestamp = nowIso();\n  const baseWorkflow = asObject(current.workflow, {});\n  const approvalResult = applyApprovalDecision({\n    workflow: baseWorkflow,\n    actorRole,\n    actorEmail,\n    decision,\n    note,\n    atIso: timestamp,\n  });\n\n  const normalized = normalizeLifecyclePayload(\n    {\n      status: approvalResult.status,\n      workflow: approvalResult.workflow,\n    },\n    actorEmail,\n    actorRole,\n    { base: current },\n  );\n\n  const effects = await applyLifecycleAutomations(normalized, actorEmail, actorRole);\n  const updated = await updateCollectionRecord(getCollectionName(\"lifecycle\"), recordId, {\n    ...normalized,\n    lastAutomationEffects: effects,\n    lastAutomationAt: nowIso(),\n    lastAutomationBy: actorEmail,\n  });\n\n  await syncOnboardingEvidenceToEmployeeDocuments(updated, actorEmail).catch(() => null);\n\n  return {\n    record: updated,\n    effects,\n  };\n}\n\nfunction normalizeAttendancePayload(payload, actorEmail, { base } = {}) {\n  const timestamp = nowIso();\n  const employeeEmail = normalizeEmail(payload?.employeeEmail || base?.employeeEmail);\n  if (!employeeEmail) {\n    throw new Error(\"invalid_employee_email\");\n  }\n\n  const next = {\n    employeeEmail,\n    employee: asString(payload?.employee, asString(base?.employee, employeeEmail)),\n    date: asString(payload?.date, asString(base?.date, timestamp.slice(0, 10))),\n    checkIn: asString(payload?.checkIn, asString(base?.checkIn, \"-\")),\n    checkOut: asString(payload?.checkOut, asString(base?.checkOut, \"-\")),\n    status: asString(payload?.status, asString(base?.status, \"Recorded\")),\n    reason: asString(payload?.reason, asString(base?.reason, \"\")),\n    createdAt: asString(base?.createdAt, timestamp),\n    createdBy: asString(base?.createdBy, actorEmail),\n    updatedAt: timestamp,\n    updatedBy: actorEmail,\n  };\n\n  next.modificationTrail = appendTrail(base?.modificationTrail, {\n    at: timestamp,\n    by: actorEmail,\n    action: base ? \"update\" : \"create\",\n    status: next.status,\n    checkIn: next.checkIn,\n    checkOut: next.checkOut,\n    reason: next.reason,\n  });\n\n  return next;\n}\n\nfunction normalizeLeavePayload(payload, actorEmail, { base } = {}) {\n  const timestamp = nowIso();\n  const employeeEmail = normalizeEmail(payload?.employeeEmail || base?.employeeEmail);\n  if (!employeeEmail) {\n    throw new Error(\"invalid_employee_email\");\n  }\n\n  const status = asString(payload?.status, asString(base?.status, \"Pending\"));\n  const next = {\n    employeeEmail,\n    employee: asString(payload?.employee, asString(base?.employee, employeeEmail)),\n    leaveType: asString(payload?.leaveType, asString(base?.leaveType, \"Leave\")),\n    startDate: asString(payload?.startDate, asString(base?.startDate, \"\")),\n    endDate: asString(payload?.endDate, asString(base?.endDate, \"\")),\n    reason: asString(payload?.reason, asString(base?.reason, \"\")),\n    status,\n    approver: asString(payload?.approver, asString(base?.approver, \"\")),\n    approvalNote: asString(payload?.approvalNote, asString(base?.approvalNote, \"\")),\n    createdAt: asString(base?.createdAt, timestamp),\n    createdBy: asString(base?.createdBy, actorEmail),\n    updatedAt: timestamp,\n    updatedBy: actorEmail,\n  };\n\n  next.modificationTrail = appendTrail(base?.modificationTrail, {\n    at: timestamp,\n    by: actorEmail,\n    action: base ? \"update\" : \"create\",\n    status,\n    leaveType: next.leaveType,\n  });\n\n  return next;\n}\n\nexport async function listAttendanceLogsBackend({ ownerEmail } = {}) {\n  return await listCollectionRecords(getCollectionName(\"attendance\"), {\n    filterField: ownerEmail ? \"employeeEmail\" : undefined,\n    filterValue: ownerEmail ? normalizeEmail(ownerEmail) : undefined,\n  });\n}\n\nexport async function getAttendanceLogBackend(recordId) {\n  return await getCollectionRecordById(getCollectionName(\"attendance\"), recordId);\n}\n\nexport async function createAttendanceLogBackend(payload, actorEmail) {\n  const normalized = normalizeAttendancePayload(payload, actorEmail);\n  return await createCollectionRecord(getCollectionName(\"attendance\"), normalized);\n}\n\nexport async function updateAttendanceLogBackend(recordId, payload, actorEmail) {\n  const current = await getAttendanceLogBackend(recordId);\n  if (!current) {\n    return null;\n  }\n  const normalized = normalizeAttendancePayload(payload, actorEmail, { base: current });\n  return await updateCollectionRecord(getCollectionName(\"attendance\"), recordId, normalized);\n}\n\nexport async function listLeaveRequestsBackend({ ownerEmail } = {}) {\n  return await listCollectionRecords(getCollectionName(\"leave\"), {\n    filterField: ownerEmail ? \"employeeEmail\" : undefined,\n    filterValue: ownerEmail ? normalizeEmail(ownerEmail) : undefined,\n  });\n}\n\nexport async function getLeaveRequestBackend(recordId) {\n  return await getCollectionRecordById(getCollectionName(\"leave\"), recordId);\n}\n\nexport async function createLeaveRequestBackend(payload, actorEmail) {\n  const normalized = normalizeLeavePayload(payload, actorEmail);\n  return await createCollectionRecord(getCollectionName(\"leave\"), normalized);\n}\n\nexport async function updateLeaveRequestBackend(recordId, payload, actorEmail) {\n  const current = await getLeaveRequestBackend(recordId);\n  if (!current) {\n    return null;\n  }\n  const normalized = normalizeLeavePayload(payload, actorEmail, { base: current });\n  return await updateCollectionRecord(getCollectionName(\"leave\"), recordId, normalized);\n}\n\nfunction normalizePerformancePayload(payload, actorEmail, { base } = {}) {\n  const timestamp = nowIso();\n  const employeeEmail = normalizeEmail(payload?.employeeEmail || base?.employeeEmail);\n  if (!employeeEmail) {\n    throw new Error(\"invalid_employee_email\");\n  }\n\n  return {\n    employeeEmail,\n    employee: asString(payload?.employee, asString(base?.employee, employeeEmail)),\n    period: asString(payload?.period, asString(base?.period, \"\")),\n    kpiScore: asString(payload?.kpiScore, asString(base?.kpiScore, \"\")),\n    evaluationForm: payload?.evaluationForm ?? base?.evaluationForm ?? {},\n    reviewHistory: asArray(payload?.reviewHistory ?? base?.reviewHistory),\n    promotionJustification: asString(payload?.promotionJustification, asString(base?.promotionJustification, \"\")),\n    reviewer: asString(payload?.reviewer, asString(base?.reviewer, \"\")),\n    rating: asString(payload?.rating, asString(base?.rating, \"\")),\n    status: asString(payload?.status, asString(base?.status, \"Draft\")),\n    createdAt: asString(base?.createdAt, timestamp),\n    createdBy: asString(base?.createdBy, actorEmail),\n    updatedAt: timestamp,\n    updatedBy: actorEmail,\n    traceability: appendTrail(base?.traceability, {\n      at: timestamp,\n      by: actorEmail,\n      action: base ? \"update\" : \"create\",\n      period: asString(payload?.period, asString(base?.period, \"\")),\n    }),\n  };\n}\n\nexport async function listPerformanceRecordsBackend({ ownerEmail } = {}) {\n  return await listCollectionRecords(getCollectionName(\"performance\"), {\n    filterField: ownerEmail ? \"employeeEmail\" : undefined,\n    filterValue: ownerEmail ? normalizeEmail(ownerEmail) : undefined,\n  });\n}\n\nexport async function getPerformanceRecordBackend(recordId) {\n  return await getCollectionRecordById(getCollectionName(\"performance\"), recordId);\n}\n\nexport async function createPerformanceRecordBackend(payload, actorEmail) {\n  const normalized = normalizePerformancePayload(payload, actorEmail);\n  return await createCollectionRecord(getCollectionName(\"performance\"), normalized);\n}\n\nexport async function updatePerformanceRecordBackend(recordId, payload, actorEmail) {\n  const current = await getPerformanceRecordBackend(recordId);\n  if (!current) {\n    return null;\n  }\n  const normalized = normalizePerformancePayload(payload, actorEmail, { base: current });\n  return await updateCollectionRecord(getCollectionName(\"performance\"), recordId, normalized);\n}\n\nfunction normalizeTemplatePayload(payload, actorEmail, { base } = {}) {\n  const timestamp = nowIso();\n  const version = asString(payload?.version, asString(base?.version, \"v1.0\"));\n  const templateName = asString(payload?.templateName, asString(base?.templateName));\n  if (!templateName) {\n    throw new Error(\"invalid_template_name\");\n  }\n\n  const previousVersionEntry = base\n    ? {\n        version: asString(base.version, \"v1.0\"),\n        changedAt: timestamp,\n        changedBy: actorEmail,\n        note: asString(payload?.changeNote, \"Template updated\"),\n      }\n    : null;\n\n  const currentHistory = asArray(base?.versionHistory);\n  const nextHistory = previousVersionEntry ? appendTrail(currentHistory, previousVersionEntry) : currentHistory;\n\n  const modificationLog = appendTrail(base?.modificationLog, {\n    at: timestamp,\n    by: actorEmail,\n    action: base ? \"update\" : \"upload\",\n    version,\n  });\n\n  return {\n    templateName,\n    category: asString(payload?.category, asString(base?.category, \"HR Template\")),\n    classification: asString(payload?.classification, asString(base?.classification, \"Restricted PII\")),\n    documentType: asString(payload?.documentType, asString(base?.documentType, \"Template\")),\n    tags: asArray(payload?.tags ?? base?.tags),\n    version,\n    status: asString(payload?.status, asString(base?.status, \"Active\")),\n    contentRef: asString(payload?.contentRef, asString(base?.contentRef, \"\")),\n    acknowledgments: asArray(payload?.acknowledgments ?? base?.acknowledgments),\n    usageLogs: asArray(payload?.usageLogs ?? base?.usageLogs),\n    versionHistory: nextHistory,\n    modificationLog,\n    createdAt: asString(base?.createdAt, timestamp),\n    createdBy: asString(base?.createdBy, actorEmail),\n    updatedAt: timestamp,\n    updatedBy: actorEmail,\n  };\n}\n\nexport async function listDocumentTemplatesBackend() {\n  return await listCollectionRecords(getCollectionName(\"templates\"));\n}\n\nexport async function getDocumentTemplateBackend(recordId) {\n  return await getCollectionRecordById(getCollectionName(\"templates\"), recordId);\n}\n\nexport async function createDocumentTemplateBackend(payload, actorEmail) {\n  const normalized = normalizeTemplatePayload(payload, actorEmail);\n  return await createCollectionRecord(getCollectionName(\"templates\"), normalized);\n}\n\nexport async function updateDocumentTemplateBackend(recordId, payload, actorEmail) {\n  const current = await getDocumentTemplateBackend(recordId);\n  if (!current) {\n    return null;\n  }\n  const normalized = normalizeTemplatePayload(payload, actorEmail, { base: current });\n  return await updateCollectionRecord(getCollectionName(\"templates\"), recordId, normalized);\n}\n\nexport async function deleteDocumentTemplateBackend(recordId, actorEmail) {\n  const current = await getDocumentTemplateBackend(recordId);\n  if (!current) {\n    return null;\n  }\n  return await updateCollectionRecord(getCollectionName(\"templates\"), recordId, {\n    ...current,\n    status: \"Archived\",\n    archivedAt: nowIso(),\n    archivedBy: actorEmail,\n    updatedAt: nowIso(),\n    updatedBy: actorEmail,\n    modificationLog: appendTrail(current.modificationLog, {\n      at: nowIso(),\n      by: actorEmail,\n      action: \"archive\",\n      version: asString(current.version, \"v1.0\"),\n    }),\n  });\n}\n\nfunction normalizeExportRequestPayload(payload, actorEmail, { base } = {}) {\n  const timestamp = nowIso();\n  const dataset = asString(payload?.dataset, asString(base?.dataset, \"Employee Dataset\"));\n  if (!dataset) {\n    throw new Error(\"invalid_export_dataset\");\n  }\n\n  const format = asString(payload?.format, asString(base?.format, \"CSV\")).toUpperCase();\n  const requestedBy = normalizeEmail(payload?.requestedBy || base?.requestedBy || actorEmail);\n  const scope = asString(payload?.scope, asString(base?.scope, \"full\"));\n  const status = asString(payload?.status, asString(base?.status, \"Pending\"));\n  const estimateVolume = asString(payload?.estimateVolume, asString(base?.estimateVolume, \"0\"));\n  const justification = asString(payload?.justification, asString(base?.justification));\n\n  return {\n    dataset,\n    format,\n    requestedBy,\n    scope,\n    estimateVolume,\n    justification,\n    status,\n    reviewer: asString(payload?.reviewer, asString(base?.reviewer, \"\")),\n    reviewNote: asString(payload?.reviewNote, asString(base?.reviewNote, \"\")),\n    reviewedAt: asString(payload?.reviewedAt, asString(base?.reviewedAt, \"\")),\n    exportedAt: asString(payload?.exportedAt, asString(base?.exportedAt, \"\")),\n    exportedBy: asString(payload?.exportedBy, asString(base?.exportedBy, \"\")),\n    alert: asString(payload?.alert, asString(base?.alert, \"\")),\n    createdAt: asString(base?.createdAt, timestamp),\n    createdBy: asString(base?.createdBy, actorEmail),\n    updatedAt: timestamp,\n    updatedBy: actorEmail,\n    history: appendTrail(base?.history, {\n      at: timestamp,\n      by: actorEmail,\n      action: base ? \"update\" : \"create\",\n      status,\n    }),\n  };\n}\n\nexport async function listExportRequestsBackend({ ownerEmail } = {}) {\n  return await listCollectionRecords(getCollectionName(\"exports\"), {\n    filterField: ownerEmail ? \"requestedBy\" : undefined,\n    filterValue: ownerEmail ? normalizeEmail(ownerEmail) : undefined,\n  });\n}\n\nexport async function getExportRequestBackend(recordId) {\n  return await getCollectionRecordById(getCollectionName(\"exports\"), recordId);\n}\n\nexport async function createExportRequestBackend(payload, actorEmail) {\n  const normalized = normalizeExportRequestPayload(payload, actorEmail);\n  return await createCollectionRecord(getCollectionName(\"exports\"), normalized);\n}\n\nexport async function updateExportRequestBackend(recordId, payload, actorEmail) {\n  const current = await getExportRequestBackend(recordId);\n  if (!current) {\n    return null;\n  }\n  const normalized = normalizeExportRequestPayload(payload, actorEmail, { base: current });\n  return await updateCollectionRecord(getCollectionName(\"exports\"), recordId, normalized);\n}\n\nexport async function approveExportRequestBackend(recordId, actorEmail, { approved, note } = {}) {\n  const status = approved ? \"Approved\" : \"Rejected\";\n  return await updateExportRequestBackend(\n    recordId,\n    {\n      status,\n      reviewer: actorEmail,\n      reviewNote: asString(note, \"\"),\n      reviewedAt: nowIso(),\n    },\n    actorEmail,\n  );\n}\n\nexport async function markExportAsCompletedBackend(recordId, actorEmail) {\n  return await updateExportRequestBackend(\n    recordId,\n    {\n      status: \"Exported\",\n      exportedBy: actorEmail,\n      exportedAt: nowIso(),\n    },\n    actorEmail,\n  );\n}\n\nfunction normalizeIncidentSeverity(value, fallback = \"Medium\") {\n  const normalized = asString(value, fallback).toLowerCase();\n  const matched = INCIDENT_SEVERITY_LEVELS.find((entry) => entry.toLowerCase() === normalized);\n  return matched || \"Medium\";\n}\n\nfunction normalizeIncidentStatus(value, fallback = \"Open\") {\n  const normalized = asString(value, fallback).toLowerCase();\n  const matched = INCIDENT_STATUS_VALUES.find((entry) => entry.toLowerCase() === normalized);\n  return matched || \"Open\";\n}\n\nfunction normalizeIncidentContainmentStatus(value, fallback = \"Not Started\") {\n  const normalized = asString(value, fallback).toLowerCase();\n  const matched = INCIDENT_CONTAINMENT_STATUS_VALUES.find((entry) => entry.toLowerCase() === normalized);\n  return matched || \"Not Started\";\n}\n\nfunction normalizeIncidentImpactStatus(value, fallback = \"Pending\") {\n  const normalized = asString(value, fallback).toLowerCase();\n  const matched = INCIDENT_IMPACT_STATUS_VALUES.find((entry) => entry.toLowerCase() === normalized);\n  return matched || \"Pending\";\n}\n\nfunction normalizeIncidentType(value, fallback = \"Other\") {\n  const normalized = asString(value, fallback).toLowerCase();\n  const matched = INCIDENT_TYPE_VALUES.find((entry) => entry.toLowerCase() === normalized);\n  return matched || \"Other\";\n}\n\nfunction buildIncidentCode(isoValue = nowIso()) {\n  const date = new Date(isoValue || nowIso());\n  if (Number.isNaN(date.getTime())) {\n    return `INC-${Date.now().toString().slice(-10)}`;\n  }\n  const yyyy = String(date.getUTCFullYear());\n  const mm = String(date.getUTCMonth() + 1).padStart(2, \"0\");\n  const dd = String(date.getUTCDate()).padStart(2, \"0\");\n  const hh = String(date.getUTCHours()).padStart(2, \"0\");\n  const mi = String(date.getUTCMinutes()).padStart(2, \"0\");\n  const random = Math.random().toString(36).slice(2, 5).toUpperCase();\n  return `INC-${yyyy}${mm}${dd}-${hh}${mi}${random}`;\n}\n\nfunction extractEvidenceExtension(value) {\n  const normalized = asString(value).toLowerCase();\n  if (!normalized) {\n    return \"\";\n  }\n  const clean = normalized.split(\"?\")[0].split(\"#\")[0];\n  const token = clean.split(\".\").pop() || \"\";\n  if (!/^[a-z0-9]{2,10}$/.test(token)) {\n    return \"\";\n  }\n  return token;\n}\n\nfunction sanitizeIncidentEvidenceDocuments(value, actorEmail, fallbackNowIso) {\n  const timestamp = asString(fallbackNowIso, nowIso());\n  const config = getIncidentEvidenceValidationConfig();\n  return asArray(value)\n    .map((entry, index) => {\n      const source = asObject(entry, {});\n      const uploadedAt = toIsoOrEmpty(source.uploadedAt || timestamp) || timestamp;\n      const uploadedBy = normalizeEmail(source.uploadedBy || actorEmail);\n      const name = asString(source.name, `Incident Evidence ${index + 1}`);\n      const type = asString(source.type, \"Incident Evidence\");\n      const ref = asString(source.ref);\n      const storagePath = asString(source.storagePath);\n      const fileExtension = extractEvidenceExtension(source.fileExtension || name || storagePath || ref);\n      const contentType = normalizeText(source.contentType);\n      const sizeBytes = Number.isFinite(Number(source.sizeBytes)) ? Number(source.sizeBytes) : 0;\n      const id = asString(source.id || source.recordId || storagePath || `${index + 1}`);\n      if (!name && !ref && !storagePath) {\n        return null;\n      }\n      if (fileExtension && !config.allowedExtensions.has(fileExtension)) {\n        throw new Error(\"invalid_incident_evidence_extension\");\n      }\n      if (contentType && !config.allowedMimeTypes.has(contentType)) {\n        throw new Error(\"invalid_incident_evidence_content_type\");\n      }\n      if (sizeBytes > config.maxBytes) {\n        throw new Error(\"invalid_incident_evidence_size\");\n      }\n      return {\n        id,\n        name: name || \"Incident Evidence\",\n        type: type || \"Incident Evidence\",\n        ref,\n        storagePath,\n        fileExtension,\n        contentType,\n        sizeBytes,\n        scanStatus: asString(source.scanStatus),\n        scanReference: asString(source.scanReference),\n        scannedAt: toIsoOrEmpty(source.scannedAt || \"\"),\n        uploadedAt,\n        uploadedBy: uploadedBy || actorEmail,\n      };\n    })\n    .filter(Boolean)\n    .slice(0, MAX_INCIDENT_EVIDENCE_ITEMS);\n}\n\nfunction resolveIncidentEscalationLevel({ severity, restrictedPiiInvolved, executiveNotificationRequired }) {\n  if (severity === \"Critical\" || executiveNotificationRequired) {\n    return \"Executive\";\n  }\n  if (severity === \"High\" || restrictedPiiInvolved) {\n    return \"GRC\";\n  }\n  return \"Operational\";\n}\n\nfunction resolveIncidentRegulatoryStatus({\n  regulatoryNotificationRequired,\n  regulatoryNotifiedAt,\n  regulatoryDueAt,\n  nowIsoValue = nowIso(),\n}) {\n  if (!regulatoryNotificationRequired) {\n    return \"Not Required\";\n  }\n  if (toTimeMs(regulatoryNotifiedAt)) {\n    return \"Notified\";\n  }\n  const dueAtMs = toTimeMs(regulatoryDueAt);\n  const nowMs = toTimeMs(nowIsoValue) || Date.now();\n  if (Number.isFinite(dueAtMs) && dueAtMs < nowMs) {\n    return \"Overdue\";\n  }\n  return \"Pending\";\n}\n\nfunction incidentSeverityRank(value) {\n  const severity = normalizeIncidentSeverity(value);\n  switch (severity) {\n    case \"Critical\":\n      return 3;\n    case \"High\":\n      return 2;\n    case \"Medium\":\n      return 1;\n    default:\n      return 0;\n  }\n}\n\nfunction isIncidentAccessEvent(row) {\n  const method = normalizeText(row?.requestMethod);\n  const activity = normalizeText(row?.activityName);\n  return method === \"get\" || activity.includes(\"viewed\") || activity.includes(\"listed\") || activity.includes(\"access\");\n}\n\nfunction isIncidentExportEvent(row) {\n  const moduleName = normalizeText(row?.module);\n  const path = normalizeText(row?.requestPath);\n  const activity = normalizeText(row?.activityName);\n  return moduleName.includes(\"export\") || path.includes(\"/api/hris/exports\") || activity.includes(\"export\");\n}\n\nfunction isIncidentDeletionEvent(row) {\n  const method = normalizeText(row?.requestMethod);\n  const activity = normalizeText(row?.activityName);\n  return (\n    method === \"delete\" ||\n    activity.includes(\"delete\") ||\n    activity.includes(\"purge\") ||\n    activity.includes(\"removed\") ||\n    activity.includes(\"archive\")\n  );\n}\n\nfunction isIncidentAdministrativeEvent(row) {\n  const moduleName = normalizeText(row?.module);\n  const method = normalizeText(row?.requestMethod);\n  const activity = normalizeText(row?.activityName);\n  return (\n    moduleName.includes(\"authorization\") ||\n    moduleName.includes(\"user management\") ||\n    moduleName.includes(\"access management\") ||\n    method === \"patch\" ||\n    method === \"post\" ||\n    activity.includes(\"approve\") ||\n    activity.includes(\"revok\") ||\n    activity.includes(\"invite\") ||\n    activity.includes(\"role\")\n  );\n}\n\nfunction normalizeIncidentForensicSample(row) {\n  return {\n    id: asString(row?.id),\n    activityName: asString(row?.activityName),\n    module: asString(row?.module),\n    status: asString(row?.status),\n    occurredAt: asString(row?.occurredAt),\n    performedBy: asString(row?.performedBy),\n    requestMethod: asString(row?.requestMethod),\n    requestPath: asString(row?.requestPath),\n  };\n}\n\nfunction incidentMatchesSubject(row, subjectEmail) {\n  const subject = normalizeEmail(subjectEmail);\n  if (!subject) {\n    return true;\n  }\n\n  const metadata = asObject(row?.metadata, {});\n  const candidates = [\n    row?.performedBy,\n    row?.performedByEmail,\n    metadata.employeeEmail,\n    metadata.ownerEmail,\n    metadata.requestedBy,\n    metadata.targetEmployeeEmail,\n    metadata.affectedEmployeeEmail,\n  ];\n  return candidates.some((value) => normalizeEmail(value) === subject);\n}\n\nasync function buildIncidentForensicSnapshot(record, { limit } = {}) {\n  const nowIsoValue = nowIso();\n  const windowStart = toIsoOrEmpty(record?.forensicWindowStart || record?.detectedAt) || nowIsoValue;\n  const windowEnd = toIsoOrEmpty(record?.forensicWindowEnd || nowIsoValue) || nowIsoValue;\n  const windowStartMs = toTimeMs(windowStart) || 0;\n  const windowEndMs = toTimeMs(windowEnd) || Date.now();\n  const subjectEmail = normalizeEmail(record?.affectedEmployeeEmail || record?.employeeEmail || \"\");\n  const safeLimit = Number.isFinite(Number(limit)) ? Number(limit) : 1800;\n\n  let rows = [];\n  try {\n    rows = await listAuditEvents({ limit: Math.max(100, Math.min(5000, safeLimit)) });\n  } catch {\n    rows = [];\n  }\n\n  const scopedRows = rows.filter((row) => {\n    const occurredAtMs = toTimeMs(row?.occurredAt || row?.loggedAt);\n    if (!Number.isFinite(occurredAtMs)) {\n      return false;\n    }\n    if (occurredAtMs < windowStartMs || occurredAtMs > windowEndMs) {\n      return false;\n    }\n    return incidentMatchesSubject(row, subjectEmail);\n  });\n\n  const buckets = {\n    accessLogs: [],\n    exportLogs: [],\n    administrativeActions: [],\n    deletionActivities: [],\n  };\n\n  scopedRows.forEach((row) => {\n    const sample = normalizeIncidentForensicSample(row);\n    if (isIncidentDeletionEvent(row)) {\n      buckets.deletionActivities.push(sample);\n      return;\n    }\n    if (isIncidentExportEvent(row)) {\n      buckets.exportLogs.push(sample);\n      return;\n    }\n    if (isIncidentAdministrativeEvent(row)) {\n      buckets.administrativeActions.push(sample);\n      return;\n    }\n    if (isIncidentAccessEvent(row)) {\n      buckets.accessLogs.push(sample);\n    }\n  });\n\n  return {\n    generatedAt: nowIsoValue,\n    windowStart,\n    windowEnd,\n    scopedSubjectEmail: subjectEmail || \"\",\n    totalScopedLogs: scopedRows.length,\n    accessLogsCount: buckets.accessLogs.length,\n    exportLogsCount: buckets.exportLogs.length,\n    administrativeActionsCount: buckets.administrativeActions.length,\n    deletionActivitiesCount: buckets.deletionActivities.length,\n    accessLogs: buckets.accessLogs.slice(0, MAX_INCIDENT_FORENSIC_SAMPLES),\n    exportLogs: buckets.exportLogs.slice(0, MAX_INCIDENT_FORENSIC_SAMPLES),\n    administrativeActions: buckets.administrativeActions.slice(0, MAX_INCIDENT_FORENSIC_SAMPLES),\n    deletionActivities: buckets.deletionActivities.slice(0, MAX_INCIDENT_FORENSIC_SAMPLES),\n  };\n}\n\nfunction normalizeIncidentWritePayload(payload, actorEmail, { base } = {}) {\n  const timestamp = nowIso();\n  const title = asString(payload?.title, asString(base?.title));\n  if (!title) {\n    throw new Error(\"invalid_incident_title\");\n  }\n\n  const detectedAt = toIsoOrEmpty(payload?.detectedAt || base?.detectedAt || timestamp) || timestamp;\n  const severity = normalizeIncidentSeverity(payload?.severity, asString(base?.severity, \"Medium\"));\n  const incidentType = normalizeIncidentType(payload?.incidentType, asString(base?.incidentType, \"Other\"));\n  const restrictedPiiInvolved = asBoolean(payload?.restrictedPiiInvolved, asBoolean(base?.restrictedPiiInvolved, false));\n  const executiveNotificationRequired = asBoolean(\n    payload?.executiveNotificationRequired,\n    severity === \"Critical\" || asBoolean(base?.executiveNotificationRequired, false),\n  );\n  const escalationRequired = asBoolean(\n    payload?.escalationRequired,\n    executiveNotificationRequired ||\n      restrictedPiiInvolved ||\n      incidentSeverityRank(severity) >= incidentSeverityRank(\"High\") ||\n      asBoolean(base?.escalationRequired, false),\n  );\n  const escalationLevel = resolveIncidentEscalationLevel({\n    severity,\n    restrictedPiiInvolved,\n    executiveNotificationRequired,\n  });\n\n  const status = normalizeIncidentStatus(payload?.status, asString(base?.status, \"Open\"));\n  const containmentStatus = normalizeIncidentContainmentStatus(\n    payload?.containmentStatus,\n    asString(base?.containmentStatus, \"Not Started\"),\n  );\n  const impactAssessmentStatus = normalizeIncidentImpactStatus(\n    payload?.impactAssessmentStatus,\n    asString(base?.impactAssessmentStatus, \"Pending\"),\n  );\n\n  const regulatoryNotificationRequired = asBoolean(\n    payload?.regulatoryNotificationRequired,\n    restrictedPiiInvolved || asBoolean(base?.regulatoryNotificationRequired, false),\n  );\n  const regulatoryDueAt = regulatoryNotificationRequired\n    ? asString(base?.regulatoryDueAt, addHoursToIso(detectedAt, 72))\n    : \"\";\n  const regulatoryNotifiedAt = toIsoOrEmpty(payload?.regulatoryNotifiedAt || base?.regulatoryNotifiedAt || \"\");\n  const affectedIndividualsNotifiedAt = toIsoOrEmpty(\n    payload?.affectedIndividualsNotifiedAt || base?.affectedIndividualsNotifiedAt || \"\",\n  );\n  const regulatoryStatus = resolveIncidentRegulatoryStatus({\n    regulatoryNotificationRequired,\n    regulatoryNotifiedAt,\n    regulatoryDueAt,\n    nowIsoValue: timestamp,\n  });\n\n  const documentationRetained = asBoolean(payload?.documentationRetained, asBoolean(base?.documentationRetained, false));\n  const documentationRetainedAt = documentationRetained\n    ? toIsoOrEmpty(payload?.documentationRetainedAt || base?.documentationRetainedAt || timestamp) || timestamp\n    : \"\";\n  const executiveNotifiedAt = toIsoOrEmpty(payload?.executiveNotifiedAt || base?.executiveNotifiedAt || \"\");\n  const grcAlertedAt = escalationRequired\n    ? toIsoOrEmpty(payload?.grcAlertedAt || base?.grcAlertedAt || timestamp) || timestamp\n    : \"\";\n\n  const containmentStartedAt =\n    containmentStatus === \"In Progress\" || containmentStatus === \"Contained\"\n      ? toIsoOrEmpty(payload?.containmentStartedAt || base?.containmentStartedAt || timestamp) || timestamp\n      : toIsoOrEmpty(payload?.containmentStartedAt || base?.containmentStartedAt || \"\");\n  const containmentCompletedAt =\n    containmentStatus === \"Contained\"\n      ? toIsoOrEmpty(payload?.containmentCompletedAt || base?.containmentCompletedAt || timestamp) || timestamp\n      : toIsoOrEmpty(payload?.containmentCompletedAt || base?.containmentCompletedAt || \"\");\n  const impactAssessmentCompletedAt =\n    impactAssessmentStatus === \"Completed\"\n      ? toIsoOrEmpty(payload?.impactAssessmentCompletedAt || base?.impactAssessmentCompletedAt || timestamp) || timestamp\n      : toIsoOrEmpty(payload?.impactAssessmentCompletedAt || base?.impactAssessmentCompletedAt || \"\");\n\n  const forensicWindowStart = toIsoOrEmpty(payload?.forensicWindowStart || base?.forensicWindowStart || detectedAt) || detectedAt;\n  const forensicWindowEnd = toIsoOrEmpty(payload?.forensicWindowEnd || base?.forensicWindowEnd || timestamp) || timestamp;\n  const evidenceDocuments = sanitizeIncidentEvidenceDocuments(\n    Object.prototype.hasOwnProperty.call(asObject(payload, {}), \"evidenceDocuments\")\n      ? payload?.evidenceDocuments\n      : base?.evidenceDocuments,\n    actorEmail,\n    timestamp,\n  );\n  const detectionWindowStart = toIsoOrEmpty(payload?.detectionWindowStart || base?.detectionWindowStart || \"\");\n  const detectionWindowEnd = toIsoOrEmpty(payload?.detectionWindowEnd || base?.detectionWindowEnd || \"\");\n  const alertRecipients = asArray(payload?.alertRecipients || base?.alertRecipients)\n    .map((value) => normalizeEmail(value))\n    .filter(Boolean)\n    .slice(0, 40);\n\n  return {\n    incidentCode: asString(base?.incidentCode, buildIncidentCode(detectedAt)),\n    title,\n    summary: asString(payload?.summary, asString(base?.summary)),\n    incidentType,\n    severity,\n    status,\n    restrictedPiiInvolved,\n    affectedEmployeeEmail: normalizeEmail(payload?.affectedEmployeeEmail || base?.affectedEmployeeEmail),\n    ownerEmail: normalizeEmail(payload?.ownerEmail || base?.ownerEmail || actorEmail),\n    escalationRequired,\n    escalationLevel,\n    executiveNotificationRequired,\n    executiveNotifiedAt,\n    grcAlertedAt,\n    containmentStatus,\n    containmentSummary: asString(payload?.containmentSummary, asString(base?.containmentSummary)),\n    containmentStartedAt,\n    containmentCompletedAt,\n    impactAssessmentStatus,\n    impactSummary: asString(payload?.impactSummary, asString(base?.impactSummary)),\n    impactAssessmentCompletedAt,\n    regulatoryNotificationRequired,\n    regulatoryDueAt,\n    regulatoryNotifiedAt,\n    affectedIndividualsNotifiedAt,\n    regulatoryStatus,\n    documentationRetained,\n    documentationRetainedAt,\n    documentationLocation: asString(payload?.documentationLocation, asString(base?.documentationLocation)),\n    forensicWindowStart,\n    forensicWindowEnd,\n    evidenceDocuments,\n    evidenceDocumentsCount: evidenceDocuments.length,\n    notes: asString(payload?.notes, asString(base?.notes)),\n    classificationStandard: asString(payload?.classificationStandard, asString(base?.classificationStandard, \"CLIO-IR-SEVERITY-V1\")),\n    autoGenerated: asBoolean(payload?.autoGenerated, asBoolean(base?.autoGenerated, false)),\n    detectionRuleId: asString(payload?.detectionRuleId, asString(base?.detectionRuleId)),\n    detectionFingerprint: asString(payload?.detectionFingerprint, asString(base?.detectionFingerprint)),\n    detectionWindowStart,\n    detectionWindowEnd,\n    sourceSystem: asString(payload?.sourceSystem, asString(base?.sourceSystem)),\n    sourceEventId: asString(payload?.sourceEventId, asString(base?.sourceEventId)),\n    sourceEventModule: asString(payload?.sourceEventModule, asString(base?.sourceEventModule)),\n    sourceEventPath: asString(payload?.sourceEventPath, asString(base?.sourceEventPath)),\n    sourceIp: asString(payload?.sourceIp, asString(base?.sourceIp)),\n    alertRecipients,\n    alertDispatchSummary: asObject(payload?.alertDispatchSummary, asObject(base?.alertDispatchSummary, {})),\n    externalIntegrations: asObject(payload?.externalIntegrations, asObject(base?.externalIntegrations, {})),\n    lastAlertDispatchAt: toIsoOrEmpty(payload?.lastAlertDispatchAt || base?.lastAlertDispatchAt || \"\"),\n    detectedAt,\n    resolvedAt: toIsoOrEmpty(payload?.resolvedAt || base?.resolvedAt || (status === \"Resolved\" ? timestamp : \"\")),\n    closedAt: toIsoOrEmpty(payload?.closedAt || base?.closedAt || (status === \"Closed\" ? timestamp : \"\")),\n    createdAt: asString(base?.createdAt, timestamp),\n    createdBy: asString(base?.createdBy, actorEmail),\n    updatedAt: timestamp,\n    updatedBy: actorEmail,\n    traceability: appendTrail(base?.traceability, {\n      at: timestamp,\n      by: actorEmail,\n      action: base ? \"update\" : \"create\",\n      status,\n      severity,\n      escalationLevel,\n      regulatoryStatus,\n    }),\n  };\n}\n\nfunction withIncidentForensic(record, forensicSnapshot, actorEmail) {\n  const snapshot = asObject(forensicSnapshot, {});\n  return {\n    ...record,\n    forensicSnapshot: snapshot,\n    forensicSummary: {\n      accessLogsCount: Number(snapshot.accessLogsCount || 0),\n      exportLogsCount: Number(snapshot.exportLogsCount || 0),\n      administrativeActionsCount: Number(snapshot.administrativeActionsCount || 0),\n      deletionActivitiesCount: Number(snapshot.deletionActivitiesCount || 0),\n      totalScopedLogs: Number(snapshot.totalScopedLogs || 0),\n      generatedAt: asString(snapshot.generatedAt),\n      windowStart: asString(snapshot.windowStart),\n      windowEnd: asString(snapshot.windowEnd),\n    },\n    forensicLastUpdatedAt: asString(snapshot.generatedAt, nowIso()),\n    forensicLastUpdatedBy: actorEmail,\n  };\n}\n\nexport async function listIncidentRecordsBackend() {\n  return await listCollectionRecords(getCollectionName(\"incidents\"));\n}\n\nexport async function getIncidentRecordBackend(recordId) {\n  return await getCollectionRecordById(getCollectionName(\"incidents\"), recordId);\n}\n\nexport async function createIncidentRecordBackend(payload, actorEmail) {\n  const normalized = normalizeIncidentWritePayload(payload, actorEmail);\n  const forensicSnapshot = await buildIncidentForensicSnapshot(normalized, {\n    limit: Number.parseInt(env(\"CLIO_INCIDENT_FORENSIC_LOG_LIMIT\", \"1800\"), 10),\n  });\n  const withForensic = withIncidentForensic(normalized, forensicSnapshot, actorEmail);\n  return await createCollectionRecord(getCollectionName(\"incidents\"), withForensic);\n}\n\nexport async function updateIncidentRecordBackend(recordId, payload, actorEmail) {\n  const current = await getIncidentRecordBackend(recordId);\n  if (!current) {\n    return null;\n  }\n  const normalized = normalizeIncidentWritePayload(payload, actorEmail, { base: current });\n  const shouldRefreshForensic =\n    asBoolean(payload?.refreshForensicSnapshot, false) ||\n    Object.prototype.hasOwnProperty.call(asObject(payload, {}), \"forensicWindowStart\") ||\n    Object.prototype.hasOwnProperty.call(asObject(payload, {}), \"forensicWindowEnd\") ||\n    Object.prototype.hasOwnProperty.call(asObject(payload, {}), \"affectedEmployeeEmail\") ||\n    Object.prototype.hasOwnProperty.call(asObject(payload, {}), \"detectedAt\");\n\n  const forensicSnapshot = shouldRefreshForensic\n    ? await buildIncidentForensicSnapshot(normalized, {\n        limit: Number.parseInt(env(\"CLIO_INCIDENT_FORENSIC_LOG_LIMIT\", \"1800\"), 10),\n      })\n    : asObject(current.forensicSnapshot, {});\n  const withForensic = withIncidentForensic(normalized, forensicSnapshot, actorEmail);\n  return await updateCollectionRecord(getCollectionName(\"incidents\"), recordId, withForensic);\n}\n\nasync function purgeCollectionByRetention(collectionName, cutoff) {\n  const db = getDbOrThrow();\n  const snapshot = await getDocs(\n    query(collection(db, collectionName), where(\"retentionDeleteAt\", \"<=\", cutoff)),\n  );\n  let deleted = 0;\n  for (const recordSnapshot of snapshot.docs) {\n    await deleteDoc(doc(db, collectionName, recordSnapshot.id));\n    deleted += 1;\n  }\n  return deleted;\n}\n\nasync function purgeEmployeeCollectionByRetention(cutoff) {\n  const db = getDbOrThrow();\n  const employeesCollection = getCollectionName(\"employees\");\n  const snapshot = await getDocs(\n    query(collection(db, employeesCollection), where(\"retentionDeleteAt\", \"<=\", cutoff)),\n  );\n\n  let deleted = 0;\n  for (const recordSnapshot of snapshot.docs) {\n    await deleteEmployeeDocumentSubcollectionById(recordSnapshot.id, { db });\n    await deleteDoc(doc(db, employeesCollection, recordSnapshot.id));\n    deleted += 1;\n  }\n  return deleted;\n}\n\nexport async function purgeArchivedEmployeeDataBackend({ now } = {}) {\n  const cutoff = asString(now, nowIso());\n  const deletedByCollection = {\n    employees: await purgeEmployeeCollectionByRetention(cutoff),\n    lifecycle: await purgeCollectionByRetention(getCollectionName(\"lifecycle\"), cutoff),\n    attendance: await purgeCollectionByRetention(getCollectionName(\"attendance\"), cutoff),\n    leave: await purgeCollectionByRetention(getCollectionName(\"leave\"), cutoff),\n    performance: await purgeCollectionByRetention(getCollectionName(\"performance\"), cutoff),\n    exports: await purgeCollectionByRetention(getCollectionName(\"exports\"), cutoff),\n  };\n\n  const deletedUsers = await purgeDueArchivedUserAccounts({ now: cutoff });\n  return {\n    cutoff,\n    deletedByCollection,\n    deletedUsers,\n  };\n}\n\nfunction toTimeMs(value) {\n  const timestamp = new Date(value || \"\").getTime();\n  return Number.isNaN(timestamp) ? null : timestamp;\n}\n\nfunction toIsoOrEmpty(value) {\n  const timestamp = toTimeMs(value);\n  if (!Number.isFinite(timestamp)) {\n    return \"\";\n  }\n  return new Date(timestamp).toISOString();\n}\n\nfunction clampInt(value, fallback, { min = 0, max = Number.MAX_SAFE_INTEGER } = {}) {\n  const parsed = Number.parseInt(String(value ?? \"\"), 10);\n  if (!Number.isFinite(parsed)) {\n    return fallback;\n  }\n  return Math.min(max, Math.max(min, parsed));\n}\n\nfunction deriveRetentionState(retentionDeleteAt, nowMs, dueWithinMs) {\n  const retentionMs = toTimeMs(retentionDeleteAt);\n  if (!Number.isFinite(retentionMs)) {\n    return {\n      state: \"no_retention\",\n      daysToDeletion: null,\n    };\n  }\n\n  const daysToDeletion = Math.ceil((retentionMs - nowMs) / (24 * 60 * 60 * 1000));\n  if (retentionMs <= nowMs) {\n    return {\n      state: \"due\",\n      daysToDeletion,\n    };\n  }\n\n  if (retentionMs <= nowMs + dueWithinMs) {\n    return {\n      state: \"due_soon\",\n      daysToDeletion,\n    };\n  }\n\n  return {\n    state: \"scheduled\",\n    daysToDeletion,\n  };\n}\n\nfunction getRetentionRecordLabel(moduleId, row, moduleLabel) {\n  const recordId = asString(row?.recordId, asString(row?.id));\n  if (moduleId === \"employees\") {\n    return asString(row?.name, asString(row?.employeeId, asString(row?.email, recordId || `${moduleLabel} Record`)));\n  }\n  if (moduleId === \"lifecycle\") {\n    const employee = asString(row?.employee, asString(row?.employeeEmail));\n    const category = asString(row?.category);\n    return [employee || \"Employee\", category].filter(Boolean).join(\" - \");\n  }\n  if (moduleId === \"attendance\") {\n    return [asString(row?.employee, \"Employee\"), asString(row?.date)].filter(Boolean).join(\" - \");\n  }\n  if (moduleId === \"leave\") {\n    return [asString(row?.employee, \"Employee\"), asString(row?.leaveType, \"Leave\")].filter(Boolean).join(\" - \");\n  }\n  if (moduleId === \"performance\") {\n    return [asString(row?.employee, \"Employee\"), asString(row?.period, \"Performance\")].filter(Boolean).join(\" - \");\n  }\n  if (moduleId === \"exports\") {\n    return [asString(row?.dataset, \"Export Request\"), asString(row?.format)].filter(Boolean).join(\" - \");\n  }\n  if (moduleId === \"user_accounts\") {\n    return asString(row?.email, recordId || \"User Account\");\n  }\n\n  return asString(\n    row?.name,\n    asString(row?.employee, asString(row?.dataset, asString(row?.email, recordId || `${moduleLabel} Record`))),\n  );\n}\n\nfunction toRetentionArchiveRecord({ moduleId, moduleLabel, row, nowMs, dueWithinMs }) {\n  const archivedAt = toIsoOrEmpty(row?.archivedAt);\n  const retentionDeleteAt = toIsoOrEmpty(row?.retentionDeleteAt);\n  const normalizedStatus = normalizeText(row?.status);\n  const normalizedArchiveStatus = normalizeText(row?.archiveStatus);\n  const isArchived = Boolean(\n    row?.isArchived ||\n      archivedAt ||\n      retentionDeleteAt ||\n      normalizedStatus === \"archived\" ||\n      normalizedArchiveStatus === \"archived\",\n  );\n  if (!isArchived) {\n    return null;\n  }\n\n  const recordId = asString(row?.recordId, asString(row?.id));\n  const retention = deriveRetentionState(retentionDeleteAt, nowMs, dueWithinMs);\n  const label = getRetentionRecordLabel(moduleId, row, moduleLabel);\n  const ownerEmail = normalizeEmail(row?.employeeEmail || row?.email || row?.requestedBy || row?.ownerEmail);\n  const subtitleParts = [\n    asString(row?.employeeId),\n    ownerEmail,\n    asString(row?.department),\n    asString(row?.category),\n  ].filter(Boolean);\n\n  return {\n    id: `${moduleId}:${recordId || Math.random().toString(36).slice(2, 10)}`,\n    moduleId,\n    moduleLabel,\n    recordId: recordId || \"\",\n    title: label,\n    subtitle: subtitleParts.join(\" | \"),\n    ownerEmail: ownerEmail || \"\",\n    status: asString(row?.status, asString(row?.archiveStatus, \"Archived\")),\n    archiveReason: asString(row?.archiveReason, asString(row?.reason, asString(row?.reviewNote, \"\"))),\n    archivedAt,\n    retentionDeleteAt,\n    daysToDeletion: retention.daysToDeletion,\n    deletionState: retention.state,\n    updatedAt: toIsoOrEmpty(row?.updatedAt),\n  };\n}\n\nfunction summarizeRetentionRecords(records, { moduleCatalog, nowMs, dueWithinDays }) {\n  const dueCounts = {\n    due: 0,\n    dueSoon: 0,\n    scheduled: 0,\n    noRetention: 0,\n  };\n\n  const moduleCounts = moduleCatalog.map((module) => ({\n    id: module.id,\n    label: module.label,\n    count: 0,\n  }));\n  const moduleCountById = new Map(moduleCounts.map((item) => [item.id, item]));\n\n  let nextDeletionAt = \"\";\n  let oldestArchivedAt = \"\";\n\n  records.forEach((record) => {\n    if (record.deletionState === \"due\") {\n      dueCounts.due += 1;\n    } else if (record.deletionState === \"due_soon\") {\n      dueCounts.dueSoon += 1;\n    } else if (record.deletionState === \"scheduled\") {\n      dueCounts.scheduled += 1;\n    } else {\n      dueCounts.noRetention += 1;\n    }\n\n    const moduleCount = moduleCountById.get(record.moduleId);\n    if (moduleCount) {\n      moduleCount.count += 1;\n    }\n\n    if (record.retentionDeleteAt) {\n      if (!nextDeletionAt || toTimeMs(record.retentionDeleteAt) < toTimeMs(nextDeletionAt)) {\n        nextDeletionAt = record.retentionDeleteAt;\n      }\n    }\n\n    if (record.archivedAt) {\n      if (!oldestArchivedAt || toTimeMs(record.archivedAt) < toTimeMs(oldestArchivedAt)) {\n        oldestArchivedAt = record.archivedAt;\n      }\n    }\n  });\n\n  return {\n    generatedAt: new Date(nowMs).toISOString(),\n    totalArchived: records.length,\n    dueNow: dueCounts.due,\n    dueWithinWindow: dueCounts.due + dueCounts.dueSoon,\n    scheduledFuture: dueCounts.scheduled,\n    missingRetentionDate: dueCounts.noRetention,\n    nextDeletionAt: nextDeletionAt || null,\n    oldestArchivedAt: oldestArchivedAt || null,\n    dueWithinDays,\n    moduleBreakdown: moduleCounts.sort((left, right) => right.count - left.count),\n  };\n}\n\nfunction sortRetentionRecords(records) {\n  const stateRank = {\n    due: 0,\n    due_soon: 1,\n    scheduled: 2,\n    no_retention: 3,\n  };\n\n  return [...records].sort((left, right) => {\n    const leftRank = stateRank[left.deletionState] ?? 9;\n    const rightRank = stateRank[right.deletionState] ?? 9;\n    if (leftRank !== rightRank) {\n      return leftRank - rightRank;\n    }\n\n    const leftRetention = toTimeMs(left.retentionDeleteAt);\n    const rightRetention = toTimeMs(right.retentionDeleteAt);\n    if (Number.isFinite(leftRetention) && Number.isFinite(rightRetention) && leftRetention !== rightRetention) {\n      return leftRetention - rightRetention;\n    }\n    if (Number.isFinite(leftRetention) && !Number.isFinite(rightRetention)) {\n      return -1;\n    }\n    if (!Number.isFinite(leftRetention) && Number.isFinite(rightRetention)) {\n      return 1;\n    }\n\n    return (toTimeMs(right.archivedAt) || 0) - (toTimeMs(left.archivedAt) || 0);\n  });\n}\n\nexport async function listRetentionArchiveSnapshotBackend({\n  moduleId = \"all\",\n  status = \"all\",\n  queryText = \"\",\n  dueWithinDays = 30,\n  now,\n} = {}) {\n  const normalizedModuleId = normalizeText(moduleId) || \"all\";\n  const normalizedStatus = normalizeText(status) || \"all\";\n  const normalizedQuery = normalizeText(queryText);\n  const retentionYears = getArchiveRetentionYears();\n  const safeDueWithinDays = clampInt(dueWithinDays, 30, { min: 1, max: 365 });\n  const nowIsoValue = toIsoOrEmpty(now) || nowIso();\n  const nowMs = toTimeMs(nowIsoValue) || Date.now();\n  const dueWithinMs = safeDueWithinDays * 24 * 60 * 60 * 1000;\n\n  const moduleCatalog = [\n    { id: \"employees\", label: \"Employee Records\", loader: () => listEmployeeRecordsBackend() },\n    { id: \"lifecycle\", label: \"Employment Lifecycle\", loader: () => listLifecycleRecordsBackend() },\n    { id: \"attendance\", label: \"Attendance\", loader: () => listAttendanceLogsBackend() },\n    { id: \"leave\", label: \"Leave Requests\", loader: () => listLeaveRequestsBackend() },\n    { id: \"performance\", label: \"Performance\", loader: () => listPerformanceRecordsBackend() },\n    { id: \"exports\", label: \"Reports & Exports\", loader: () => listExportRequestsBackend() },\n    { id: \"user_accounts\", label: \"User Accounts\", loader: () => listUserAccounts() },\n  ];\n\n  const moduleIds = new Set(moduleCatalog.map((item) => item.id));\n  if (normalizedModuleId !== \"all\" && !moduleIds.has(normalizedModuleId)) {\n    throw new Error(\"invalid_retention_module\");\n  }\n\n  const supportedStatusFilters = new Set([\"all\", \"due\", \"due_soon\", \"scheduled\", \"no_retention\"]);\n  const effectiveStatus = supportedStatusFilters.has(normalizedStatus) ? normalizedStatus : \"all\";\n\n  const loaded = await Promise.all(\n    moduleCatalog.map(async (module) => {\n      const rows = await module.loader();\n      return {\n        ...module,\n        rows: Array.isArray(rows) ? rows : [],\n      };\n    }),\n  );\n\n  const archivedRecords = loaded.flatMap((module) =>\n    module.rows\n      .map((row) =>\n        toRetentionArchiveRecord({\n          moduleId: module.id,\n          moduleLabel: module.label,\n          row,\n          nowMs,\n          dueWithinMs,\n        }),\n      )\n      .filter(Boolean),\n  );\n\n  const moduleScopedRecords =\n    normalizedModuleId === \"all\"\n      ? archivedRecords\n      : archivedRecords.filter((record) => record.moduleId === normalizedModuleId);\n\n  const filteredRecords = moduleScopedRecords.filter((record) => {\n    const byStatus = effectiveStatus === \"all\" ? true : record.deletionState === effectiveStatus;\n    const textBlob = normalizeText(\n      [\n        record.moduleLabel,\n        record.recordId,\n        record.title,\n        record.subtitle,\n        record.ownerEmail,\n        record.archiveReason,\n      ].join(\" \"),\n    );\n    const byQuery = normalizedQuery ? textBlob.includes(normalizedQuery) : true;\n    return byStatus && byQuery;\n  });\n\n  return {\n    policy: {\n      retentionYears,\n      dueWithinDays: safeDueWithinDays,\n      generatedAt: nowIsoValue,\n      moduleCatalog: moduleCatalog.map((module) => ({\n        id: module.id,\n        label: module.label,\n      })),\n    },\n    summary: summarizeRetentionRecords(moduleScopedRecords, {\n      moduleCatalog,\n      nowMs,\n      dueWithinDays: safeDueWithinDays,\n    }),\n    records: sortRetentionRecords(filteredRecords),\n  };\n}\n"],"names":[],"mappings":"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"}