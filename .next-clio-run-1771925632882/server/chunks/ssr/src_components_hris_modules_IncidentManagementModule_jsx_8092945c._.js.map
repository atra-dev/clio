{"version":3,"sources":["../../../../src/components/hris/modules/IncidentManagementModule.jsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\r\nimport SurfaceCard from \"@/components/hris/SurfaceCard\";\r\nimport EmptyState from \"@/components/hris/shared/EmptyState\";\r\nimport ModuleTabs from \"@/components/hris/shared/ModuleTabs\";\r\nimport StatusBadge from \"@/components/hris/shared/StatusBadge\";\r\nimport { useToast } from \"@/components/ui/ToastProvider\";\r\nimport { toSubTabAnchor } from \"@/lib/subtab-anchor\";\r\nimport { hrisApi } from \"@/services/hris-api-client\";\r\nimport {\r\n  removeStorageObjectByPath,\r\n  uploadIncidentEvidenceToStorage,\r\n} from \"@/services/firebase-storage-client\";\r\n\r\nconst SECTION_TABS = [\r\n  { id: \"escalation-plan\", label: \"Escalation Plan\" },\r\n  { id: \"regulatory-72-hour-notification\", label: \"72-Hour Notification\" },\r\n  { id: \"forensic-logging\", label: \"Forensic Logging\" },\r\n];\r\n\r\nconst SEVERITY_OPTIONS = [\"Low\", \"Medium\", \"High\", \"Critical\"];\r\nconst STATUS_OPTIONS = [\"Open\", \"Containment\", \"Investigating\", \"Escalated\", \"Regulatory Review\", \"Resolved\", \"Closed\"];\r\nconst CONTAINMENT_OPTIONS = [\"Not Started\", \"In Progress\", \"Contained\"];\r\nconst IMPACT_OPTIONS = [\"Pending\", \"In Progress\", \"Completed\"];\r\nconst INCIDENT_TYPE_OPTIONS = [\r\n  \"Unauthorized Access\",\r\n  \"Data Exposure\",\r\n  \"Credential Compromise\",\r\n  \"Insider Misuse\",\r\n  \"Malware / Ransomware\",\r\n  \"Policy Violation\",\r\n  \"System Misconfiguration\",\r\n  \"Other\",\r\n];\r\nconst REGULATORY_STATUS_OPTIONS = [\"Not Required\", \"Pending\", \"Notified\", \"Overdue\"];\r\n\r\nconst initialFilters = {\r\n  q: \"\",\r\n  status: \"all\",\r\n  severity: \"all\",\r\n  incidentType: \"all\",\r\n  regulatoryStatus: \"all\",\r\n  restrictedPii: \"all\",\r\n  page: 1,\r\n  pageSize: 12,\r\n};\r\n\r\nconst initialCreateForm = {\r\n  title: \"\",\r\n  summary: \"\",\r\n  incidentType: \"Unauthorized Access\",\r\n  severity: \"Medium\",\r\n  detectedAt: \"\",\r\n  ownerEmail: \"\",\r\n  affectedEmployeeEmail: \"\",\r\n  restrictedPiiInvolved: false,\r\n  executiveNotificationRequired: false,\r\n  regulatoryNotificationRequired: false,\r\n  documentationLocation: \"\",\r\n  notes: \"\",\r\n  classificationStandard: \"CLIO-IR-SEVERITY-V1\",\r\n};\r\n\r\nfunction formatDateTime(value) {\r\n  const date = new Date(value || \"\");\r\n  if (Number.isNaN(date.getTime())) return \"-\";\r\n  return new Intl.DateTimeFormat(\"en-US\", {\r\n    month: \"short\",\r\n    day: \"2-digit\",\r\n    year: \"numeric\",\r\n    hour: \"2-digit\",\r\n    minute: \"2-digit\",\r\n  }).format(date);\r\n}\r\n\r\nfunction toLocalDateTimeInput(value) {\r\n  const date = new Date(value || Date.now());\r\n  if (Number.isNaN(date.getTime())) return \"\";\r\n  const year = date.getFullYear();\r\n  const month = String(date.getMonth() + 1).padStart(2, \"0\");\r\n  const day = String(date.getDate()).padStart(2, \"0\");\r\n  const hour = String(date.getHours()).padStart(2, \"0\");\r\n  const minute = String(date.getMinutes()).padStart(2, \"0\");\r\n  return `${year}-${month}-${day}T${hour}:${minute}`;\r\n}\r\n\r\nfunction toIsoFromLocalDateTime(value) {\r\n  const raw = String(value || \"\").trim();\r\n  if (!raw) return \"\";\r\n  const date = new Date(raw);\r\n  if (Number.isNaN(date.getTime())) return \"\";\r\n  return date.toISOString();\r\n}\r\n\r\nfunction nowIso() {\r\n  return new Date().toISOString();\r\n}\r\n\r\nfunction getRecordLabel(record) {\r\n  return String(record?.title || \"\").trim() || String(record?.incidentCode || \"\").trim() || \"Incident\";\r\n}\r\n\r\nfunction mapDraft(record) {\r\n  return {\r\n    title: String(record?.title || \"\"),\r\n    summary: String(record?.summary || \"\"),\r\n    incidentType: String(record?.incidentType || \"Other\"),\r\n    severity: String(record?.severity || \"Medium\"),\r\n    status: String(record?.status || \"Open\"),\r\n    containmentStatus: String(record?.containmentStatus || \"Not Started\"),\r\n    containmentSummary: String(record?.containmentSummary || \"\"),\r\n    impactAssessmentStatus: String(record?.impactAssessmentStatus || \"Pending\"),\r\n    impactSummary: String(record?.impactSummary || \"\"),\r\n    ownerEmail: String(record?.ownerEmail || \"\"),\r\n    affectedEmployeeEmail: String(record?.affectedEmployeeEmail || \"\"),\r\n    restrictedPiiInvolved: Boolean(record?.restrictedPiiInvolved),\r\n    executiveNotificationRequired: Boolean(record?.executiveNotificationRequired),\r\n    regulatoryNotificationRequired: Boolean(record?.regulatoryNotificationRequired),\r\n    documentationRetained: Boolean(record?.documentationRetained),\r\n    documentationLocation: String(record?.documentationLocation || \"\"),\r\n    notes: String(record?.notes || \"\"),\r\n    classificationStandard: String(record?.classificationStandard || \"CLIO-IR-SEVERITY-V1\"),\r\n    forensicWindowStart: toLocalDateTimeInput(record?.forensicWindowStart),\r\n    forensicWindowEnd: toLocalDateTimeInput(record?.forensicWindowEnd),\r\n  };\r\n}\r\n\r\nfunction requestActionConfirmation(message) {\r\n  if (typeof window === \"undefined\") return true;\r\n  return window.confirm(message);\r\n}\r\n\r\nexport default function IncidentManagementModule({ session }) {\r\n  const toast = useToast();\r\n  const actorRole = String(session?.role || \"\").trim().toUpperCase();\r\n  const canEdit = actorRole === \"GRC\" || actorRole === \"SUPER_ADMIN\";\r\n\r\n  const [section, setSection] = useState(\"escalation-plan\");\r\n  const [filters, setFilters] = useState(initialFilters);\r\n  const [records, setRecords] = useState([]);\r\n  const [summary, setSummary] = useState({\r\n    total: 0,\r\n    openCases: 0,\r\n    criticalOpen: 0,\r\n    containmentPending: 0,\r\n    dueWithin72Hours: 0,\r\n    overdue72HourNotifications: 0,\r\n  });\r\n  const [pagination, setPagination] = useState({ page: 1, pageSize: 12, total: 0, totalPages: 1 });\r\n  const [isLoading, setIsLoading] = useState(true);\r\n\r\n  const [isCreateModalOpen, setIsCreateModalOpen] = useState(false);\r\n  const [isSubmittingCreate, setIsSubmittingCreate] = useState(false);\r\n  const [createForm, setCreateForm] = useState({\r\n    ...initialCreateForm,\r\n    ownerEmail: String(session?.email || \"\").trim().toLowerCase(),\r\n  });\r\n\r\n  const [selectedRecordId, setSelectedRecordId] = useState(\"\");\r\n  const [selectedRecord, setSelectedRecord] = useState(null);\r\n  const [recordDraft, setRecordDraft] = useState(null);\r\n  const [isLoadingRecord, setIsLoadingRecord] = useState(false);\r\n  const [isSavingRecord, setIsSavingRecord] = useState(false);\r\n  const [isUploadingEvidence, setIsUploadingEvidence] = useState(false);\r\n  const evidenceInputRef = useRef(null);\r\n\r\n  const loadRecords = useCallback(async () => {\r\n    setIsLoading(true);\r\n    try {\r\n      const payload = await hrisApi.incidents.list(filters);\r\n      const rows = Array.isArray(payload?.records) ? payload.records : [];\r\n      rows.sort(\r\n        (a, b) =>\r\n          new Date(b?.updatedAt || b?.createdAt || 0).getTime() -\r\n          new Date(a?.updatedAt || a?.createdAt || 0).getTime(),\r\n      );\r\n      setRecords(rows);\r\n      setSummary(payload?.summary || {});\r\n      setPagination(payload?.pagination || { page: 1, pageSize: 12, total: 0, totalPages: 1 });\r\n    } catch (error) {\r\n      setRecords([]);\r\n      toast.error(error.message || \"Unable to load incident records.\");\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  }, [filters, toast]);\r\n\r\n  const loadSelectedRecord = useCallback(\r\n    async (recordId) => {\r\n      const id = String(recordId || \"\").trim();\r\n      if (!id) return;\r\n      setIsLoadingRecord(true);\r\n      try {\r\n        const payload = await hrisApi.incidents.get(id);\r\n        const record = payload?.record || null;\r\n        setSelectedRecord(record);\r\n        setRecordDraft(record ? mapDraft(record) : null);\r\n      } catch (error) {\r\n        toast.error(error.message || \"Unable to load incident details.\");\r\n      } finally {\r\n        setIsLoadingRecord(false);\r\n      }\r\n    },\r\n    [toast],\r\n  );\r\n\r\n  useEffect(() => {\r\n    loadRecords();\r\n  }, [loadRecords]);\r\n\r\n  useEffect(() => {\r\n    if (selectedRecordId) {\r\n      loadSelectedRecord(selectedRecordId);\r\n    }\r\n  }, [selectedRecordId, loadSelectedRecord]);\r\n\r\n  useEffect(() => {\r\n    if (typeof window === \"undefined\") return;\r\n    const syncFromHash = (rawHash = window.location.hash) => {\r\n      const hash = String(rawHash || \"\").replace(/^#/, \"\").trim().toLowerCase();\r\n      if (!hash) return;\r\n      const matched = SECTION_TABS.find((tab) => toSubTabAnchor(tab.id) === hash);\r\n      if (matched) setSection(matched.id);\r\n    };\r\n    const onAnchor = (event) => {\r\n      if (event?.detail?.moduleId && event.detail.moduleId !== \"incident-management\") return;\r\n      const nextAnchor = event?.detail?.anchor;\r\n      if (nextAnchor) syncFromHash(`#${nextAnchor}`);\r\n    };\r\n    syncFromHash();\r\n    window.addEventListener(\"hashchange\", syncFromHash);\r\n    window.addEventListener(\"popstate\", syncFromHash);\r\n    window.addEventListener(\"clio:subtab-anchor\", onAnchor);\r\n    return () => {\r\n      window.removeEventListener(\"hashchange\", syncFromHash);\r\n      window.removeEventListener(\"popstate\", syncFromHash);\r\n      window.removeEventListener(\"clio:subtab-anchor\", onAnchor);\r\n    };\r\n  }, []);\r\n\r\n  const handleSectionChange = (nextSection) => {\r\n    setSection(nextSection);\r\n    if (typeof window !== \"undefined\") {\r\n      const anchor = toSubTabAnchor(nextSection);\r\n      window.history.pushState(null, \"\", `${window.location.pathname}#${anchor}`);\r\n      window.dispatchEvent(new CustomEvent(\"clio:subtab-anchor\", { detail: { moduleId: \"incident-management\", anchor } }));\r\n    }\r\n  };\r\n\r\n  const setFilter = (field, value) => {\n    setFilters((current) => ({ ...current, [field]: value, page: 1 }));\n  };\n\n  const openCreateModal = () => {\n    setCreateForm({\n      ...initialCreateForm,\n      ownerEmail: String(session?.email || \"\").trim().toLowerCase(),\n      detectedAt: toLocalDateTimeInput(nowIso()),\n    });\n    setIsCreateModalOpen(true);\n  };\n\r\n  const patchSelected = useCallback(\r\n    async (payload, successMessage) => {\r\n      if (!canEdit || !selectedRecordId) return;\r\n      setIsSavingRecord(true);\r\n      try {\r\n        await hrisApi.incidents.update(selectedRecordId, payload);\r\n        await loadSelectedRecord(selectedRecordId);\r\n        await loadRecords();\r\n        if (successMessage) toast.success(successMessage);\r\n      } catch (error) {\r\n        toast.error(error.message || \"Unable to update incident.\");\r\n      } finally {\r\n        setIsSavingRecord(false);\r\n      }\r\n    },\r\n    [canEdit, selectedRecordId, loadSelectedRecord, loadRecords, toast],\r\n  );\r\n\r\n  const submitCreateIncident = async (event) => {\r\n    event.preventDefault();\r\n    if (!canEdit) return;\r\n    if (!String(createForm.title || \"\").trim()) {\r\n      toast.error(\"Incident title is required.\");\r\n      return;\r\n    }\r\n    setIsSubmittingCreate(true);\r\n    try {\r\n      const payload = {\r\n        ...createForm,\r\n        detectedAt: toIsoFromLocalDateTime(createForm.detectedAt) || nowIso(),\r\n        ownerEmail: String(createForm.ownerEmail || \"\").trim().toLowerCase(),\r\n        affectedEmployeeEmail: String(createForm.affectedEmployeeEmail || \"\").trim().toLowerCase(),\r\n      };\r\n      const response = await hrisApi.incidents.create(payload);\r\n      toast.success(\"Incident record created.\");\r\n      setIsCreateModalOpen(false);\r\n      await loadRecords();\r\n      if (response?.record?.id) {\r\n        setSelectedRecordId(response.record.id);\r\n      }\r\n    } catch (error) {\r\n      toast.error(error.message || \"Unable to create incident.\");\r\n    } finally {\r\n      setIsSubmittingCreate(false);\r\n    }\r\n  };\r\n\r\n  const saveRecordDraft = async () => {\r\n    if (!canEdit || !recordDraft) return;\r\n    await patchSelected(\r\n      {\r\n        ...recordDraft,\r\n        ownerEmail: String(recordDraft.ownerEmail || \"\").trim().toLowerCase(),\r\n        affectedEmployeeEmail: String(recordDraft.affectedEmployeeEmail || \"\").trim().toLowerCase(),\r\n        forensicWindowStart: toIsoFromLocalDateTime(recordDraft.forensicWindowStart),\r\n        forensicWindowEnd: toIsoFromLocalDateTime(recordDraft.forensicWindowEnd),\r\n      },\r\n      \"Incident workflow updated.\",\r\n    );\r\n  };\r\n\r\n  const markTimestampAction = async (field, successMessage, extraPayload = {}) => {\r\n    await patchSelected({ [field]: nowIso(), ...extraPayload }, successMessage);\r\n  };\r\n\r\n  const handleEvidenceUpload = async (event) => {\r\n    const file = event.target.files?.[0];\r\n    event.target.value = \"\";\r\n    if (!file || !selectedRecord || !canEdit) return;\r\n    setIsUploadingEvidence(true);\r\n    try {\r\n      const uploaded = await uploadIncidentEvidenceToStorage({\r\n        file,\r\n        incidentRecordId: selectedRecord.id,\r\n        affectedEmployeeEmail: selectedRecord.affectedEmployeeEmail,\r\n      });\r\n      const nextDocs = [\r\n        ...(Array.isArray(selectedRecord.evidenceDocuments) ? selectedRecord.evidenceDocuments : []),\r\n        {\n          id: `${Date.now()}-${Math.random().toString(36).slice(2, 7)}`,\n          name: file.name || \"Incident Evidence\",\n          type: \"Incident Evidence\",\n          ref: uploaded.downloadUrl,\n          storagePath: uploaded.storagePath,\n          contentType: uploaded.contentType || file.type || \"\",\n          fileExtension: String(file.name || \"\").split(\".\").pop() || \"\",\n          sizeBytes: uploaded.sizeBytes,\n          uploadedAt: nowIso(),\n          uploadedBy: String(session?.email || \"\").trim().toLowerCase(),\n        },\n      ];\n      await patchSelected({ evidenceDocuments: nextDocs, documentationRetained: true }, \"Incident evidence uploaded.\");\r\n    } catch (error) {\r\n      toast.error(error.message || \"Unable to upload evidence.\");\r\n    } finally {\r\n      setIsUploadingEvidence(false);\r\n    }\r\n  };\r\n\r\n  const removeEvidence = async (entry) => {\r\n    if (!selectedRecord || !canEdit) return;\r\n    if (!requestActionConfirmation(`Remove evidence \"${String(entry?.name || \"file\")}\"?`)) return;\r\n    const current = Array.isArray(selectedRecord.evidenceDocuments) ? selectedRecord.evidenceDocuments : [];\r\n    const next = current.filter((item) => String(item?.id || \"\").trim() !== String(entry?.id || \"\").trim());\r\n    await patchSelected({ evidenceDocuments: next }, \"Evidence removed.\");\r\n    if (entry?.storagePath) {\r\n      await removeStorageObjectByPath(entry.storagePath);\r\n    }\r\n  };\r\n\r\n  const filteredBySection = useMemo(() => {\r\n    if (section === \"regulatory-72-hour-notification\") {\r\n      return records.filter((row) => Boolean(row?.regulatoryNotificationRequired) || Boolean(row?.restrictedPiiInvolved));\r\n    }\r\n    if (section === \"forensic-logging\") {\r\n      return records.filter((row) => Number(row?.forensicSummary?.totalScopedLogs || 0) > 0 || Boolean(row?.forensicSnapshot));\r\n    }\r\n    return records;\r\n  }, [records, section]);\r\n\r\n  const summaryCards = useMemo(() => {\r\n    if (section === \"regulatory-72-hour-notification\") {\r\n      return [\r\n        { key: \"total\", label: \"Total Incidents\", value: summary.total || 0 },\r\n        { key: \"due\", label: \"Due Within 72h\", value: summary.dueWithin72Hours || 0 },\r\n        { key: \"overdue\", label: \"Overdue Notifications\", value: summary.overdue72HourNotifications || 0 },\r\n      ];\r\n    }\r\n    if (section === \"forensic-logging\") {\r\n      return [\r\n        { key: \"total\", label: \"Total Incidents\", value: summary.total || 0 },\r\n        { key: \"logs\", label: \"Selected Scoped Logs\", value: Number(selectedRecord?.forensicSummary?.totalScopedLogs || 0) },\r\n        { key: \"deletions\", label: \"Selected Deletion Logs\", value: Number(selectedRecord?.forensicSummary?.deletionActivitiesCount || 0) },\r\n      ];\r\n    }\r\n    return [\r\n      { key: \"total\", label: \"Total Incidents\", value: summary.total || 0 },\r\n      { key: \"open\", label: \"Open Cases\", value: summary.openCases || 0 },\r\n      { key: \"critical\", label: \"Critical Open\", value: summary.criticalOpen || 0 },\r\n      { key: \"containment\", label: \"Containment Pending\", value: summary.containmentPending || 0 },\r\n    ];\r\n  }, [section, summary, selectedRecord]);\r\n\r\n  const pageStart = pagination.total === 0 ? 0 : (pagination.page - 1) * pagination.pageSize + 1;\r\n  const pageEnd = Math.min(pagination.total || 0, pagination.page * pagination.pageSize);\r\n\r\n  const evidenceRows = Array.isArray(selectedRecord?.evidenceDocuments) ? selectedRecord.evidenceDocuments : [];\r\n\r\n  const forensicBuckets = [\r\n    { key: \"accessLogs\", label: \"Access Logs\" },\r\n    { key: \"exportLogs\", label: \"Export Logs\" },\r\n    { key: \"administrativeActions\", label: \"Administrative Actions\" },\r\n    { key: \"deletionActivities\", label: \"Deletion Activities\" },\r\n  ];\r\n\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      <ModuleTabs tabs={SECTION_TABS} value={section} onChange={handleSectionChange} />\r\n\r\n      <SurfaceCard\n        title={section === \"escalation-plan\" ? \"Defined Escalation Plan\" : section === \"regulatory-72-hour-notification\" ? \"72-Hour Regulatory Notification\" : \"Forensic Logging\"}\n        subtitle={section === \"escalation-plan\" ? \"Severity-based escalation and containment prioritization.\" : section === \"regulatory-72-hour-notification\" ? \"PII breach notification window and compliance timeline.\" : \"Access/export/admin/deletion traces for incident investigation.\"}\n      >\n        <div className={`grid gap-3 ${summaryCards.length > 3 ? \"sm:grid-cols-2 lg:grid-cols-4\" : \"sm:grid-cols-3\"}`}>\r\n          {summaryCards.map((card) => (\r\n            <div key={card.key} className=\"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2\">\r\n              <p className=\"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500\">{card.label}</p>\r\n              <p className=\"mt-0.5 text-lg font-semibold text-slate-900\">{card.value}</p>\r\n            </div>\r\n          ))}\r\n        </div>\n      </SurfaceCard>\n\n      <SurfaceCard\n        title=\"Incident Records\"\n        subtitle=\"Response workflow, escalation actions, and forensic-ready incident traceability.\"\n        action={\n          <div className=\"flex items-center gap-2\">\n            {canEdit ? (\n              <button\n                type=\"button\"\n                onClick={openCreateModal}\n                className=\"inline-flex h-9 items-center rounded-lg bg-sky-600 px-4 text-xs font-semibold text-white transition hover:bg-sky-700\"\n              >\n                Create Incident\n              </button>\n            ) : null}\n            <button\n              type=\"button\"\n              onClick={loadRecords}\n              disabled={isLoading}\n              className=\"inline-flex h-9 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60\"\n            >\n              Refresh\n            </button>\n          </div>\n        }\n      >\n        <div className=\"grid gap-2 md:grid-cols-3 lg:grid-cols-6\">\n          <input value={filters.q} onChange={(event) => setFilter(\"q\", event.target.value)} placeholder=\"Search incident\" className=\"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 placeholder:text-slate-400 focus:border-sky-400 focus:outline-none md:col-span-2\" />\n          <select value={filters.status} onChange={(event) => setFilter(\"status\", event.target.value)} className=\"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none\">\n            <option value=\"all\">All Status</option>\n            {STATUS_OPTIONS.map((status) => <option key={status} value={status}>{status}</option>)}\n          </select>\n          <select value={filters.severity} onChange={(event) => setFilter(\"severity\", event.target.value)} className=\"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none\">\n            <option value=\"all\">All Severity</option>\n            {SEVERITY_OPTIONS.map((severity) => <option key={severity} value={severity}>{severity}</option>)}\n          </select>\n          <select value={filters.incidentType} onChange={(event) => setFilter(\"incidentType\", event.target.value)} className=\"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none\">\n            <option value=\"all\">All Types</option>\n            {INCIDENT_TYPE_OPTIONS.map((type) => <option key={type} value={type}>{type}</option>)}\n          </select>\n          <select value={filters.regulatoryStatus} onChange={(event) => setFilter(\"regulatoryStatus\", event.target.value)} className=\"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none\">\n            <option value=\"all\">All Regulatory</option>\n            {REGULATORY_STATUS_OPTIONS.map((status) => <option key={status} value={status}>{status}</option>)}\n          </select>\n          <select value={filters.restrictedPii} onChange={(event) => setFilter(\"restrictedPii\", event.target.value)} className=\"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none\">\n            <option value=\"all\">PII: All</option>\n            <option value=\"yes\">PII: Yes</option>\n            <option value=\"no\">PII: No</option>\n          </select>\n        </div>\n\n        <div className=\"mt-4\">\n          {isLoading ? (\n            <div className=\"flex justify-center py-6\">\n              <span className=\"inline-flex h-6 w-6 animate-spin rounded-full border-2 border-slate-300 border-t-sky-600\" aria-hidden=\"true\" />\n            </div>\n          ) : filteredBySection.length === 0 ? (\n            <EmptyState title=\"No incident records found\" subtitle=\"Create incidents or adjust filters to continue.\" />\n          ) : (\n            <div className=\"overflow-x-auto\">\n              <table className=\"min-w-full text-left text-sm\">\n                <thead>\n                  <tr className=\"border-b border-slate-200 text-xs uppercase tracking-[0.1em] text-slate-500\">\n                    <th className=\"px-2 py-3 font-medium\">Incident</th>\n                    <th className=\"px-2 py-3 font-medium\">Severity</th>\n                    <th className=\"px-2 py-3 font-medium\">Status</th>\n                    <th className=\"px-2 py-3 font-medium\">Escalation</th>\n                    <th className=\"px-2 py-3 font-medium\">Regulatory</th>\n                    <th className=\"px-2 py-3 font-medium\">Updated</th>\n                    <th className=\"px-2 py-3 font-medium text-right\">Action</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {filteredBySection.map((record) => (\n                    <tr key={record.id} className=\"border-b border-slate-100 text-slate-700 last:border-b-0\">\n                      <td className=\"px-2 py-3\">\n                        <p className=\"font-medium text-slate-900\">{getRecordLabel(record)}</p>\n                        <p className=\"text-xs text-slate-500\">{String(record?.incidentCode || \"N/A\")}</p>\n                      </td>\n                      <td className=\"px-2 py-3\"><StatusBadge value={record?.severity || \"Medium\"} /></td>\n                      <td className=\"px-2 py-3\"><StatusBadge value={record?.status || \"Open\"} /></td>\n                      <td className=\"px-2 py-3 text-xs\">\n                        <p className=\"font-medium text-slate-800\">{String(record?.escalationLevel || \"-\")}</p>\n                        <p className=\"text-slate-500\">GRC: {record?.grcAlertedAt ? \"Yes\" : \"No\"}</p>\n                      </td>\n                      <td className=\"px-2 py-3 text-xs\">\n                        <p className=\"font-medium text-slate-800\">{String(record?.regulatoryStatus || \"Not Required\")}</p>\n                        <p className=\"text-slate-500\">Due: {formatDateTime(record?.regulatoryDueAt)}</p>\n                      </td>\n                      <td className=\"px-2 py-3 text-xs text-slate-600\">{formatDateTime(record?.updatedAt || record?.createdAt)}</td>\n                      <td className=\"px-2 py-3 text-right\">\n                        <button type=\"button\" onClick={() => setSelectedRecordId(record.id)} className=\"inline-flex h-8 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-medium text-slate-700 transition hover:bg-slate-50\">\n                          Open\n                        </button>\n                      </td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          )}\n        </div>\n\n        <div className=\"mt-4 flex flex-wrap items-center justify-between gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-600\">\n          <p>Showing {pageStart}-{pageEnd} of {pagination.total || 0} records</p>\n          <div className=\"flex items-center gap-2\">\n            <button type=\"button\" onClick={() => setFilters((current) => ({ ...current, page: Math.max(1, current.page - 1) }))} disabled={(pagination.page || 1) <= 1 || isLoading} className=\"inline-flex h-8 items-center rounded-lg border border-slate-300 bg-white px-3 font-medium text-slate-700 transition hover:bg-slate-100 disabled:opacity-60\">Previous</button>\n            <span>Page {pagination.page || 1} of {Math.max(1, pagination.totalPages || 1)}</span>\n            <button type=\"button\" onClick={() => setFilters((current) => ({ ...current, page: Math.min(Math.max(1, pagination.totalPages || 1), current.page + 1) }))} disabled={(pagination.page || 1) >= (pagination.totalPages || 1) || isLoading} className=\"inline-flex h-8 items-center rounded-lg border border-slate-300 bg-white px-3 font-medium text-slate-700 transition hover:bg-slate-100 disabled:opacity-60\">Next</button>\n          </div>\n        </div>\n      </SurfaceCard>\n\r\n      {isCreateModalOpen ? (\r\n        <div\r\n          className=\"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/45 p-4\"\r\n          role=\"dialog\"\r\n          aria-modal=\"true\"\r\n          aria-label=\"Create Incident\"\r\n          onClick={() => !isSubmittingCreate && setIsCreateModalOpen(false)}\r\n        >\r\n          <div\r\n            className=\"w-full max-w-4xl rounded-2xl border border-slate-200 bg-white p-4 shadow-2xl sm:p-5\"\r\n            onClick={(event) => event.stopPropagation()}\r\n          >\r\n            <div className=\"mb-3 flex items-start justify-between gap-3\">\r\n              <div>\r\n                <h2 className=\"text-base font-semibold text-slate-900\">Create Incident</h2>\r\n                <p className=\"mt-0.5 text-sm text-slate-600\">Capture incident details and initialize compliance workflow.</p>\r\n              </div>\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => !isSubmittingCreate && setIsCreateModalOpen(false)}\r\n                disabled={isSubmittingCreate}\r\n                className=\"inline-flex h-8 w-8 items-center justify-center rounded-lg border border-slate-300 bg-white text-slate-600 transition hover:bg-slate-50 disabled:opacity-60\"\r\n                aria-label=\"Close create incident\"\r\n              >\r\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.9\" className=\"h-4 w-4\" aria-hidden=\"true\">\r\n                  <path d=\"m6 6 12 12M18 6 6 18\" />\r\n                </svg>\r\n              </button>\r\n            </div>\r\n\r\n            <form className=\"space-y-3\" onSubmit={submitCreateIncident}>\r\n              <div className=\"grid gap-2 md:grid-cols-2\">\r\n                <input\r\n                  required\r\n                  value={createForm.title}\r\n                  onChange={(event) => setCreateForm((current) => ({ ...current, title: event.target.value }))}\r\n                  placeholder=\"Incident title\"\r\n                  className=\"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none md:col-span-2\"\r\n                />\r\n                <select\r\n                  value={createForm.severity}\r\n                  onChange={(event) => setCreateForm((current) => ({ ...current, severity: event.target.value }))}\r\n                  className=\"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none\"\r\n                >\r\n                  {SEVERITY_OPTIONS.map((severity) => (\r\n                    <option key={`create-severity-${severity}`} value={severity}>\r\n                      {severity}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n                <select\r\n                  value={createForm.incidentType}\r\n                  onChange={(event) => setCreateForm((current) => ({ ...current, incidentType: event.target.value }))}\r\n                  className=\"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none\"\r\n                >\r\n                  {INCIDENT_TYPE_OPTIONS.map((type) => (\r\n                    <option key={`create-type-${type}`} value={type}>\r\n                      {type}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n                <input\r\n                  type=\"datetime-local\"\r\n                  value={createForm.detectedAt}\r\n                  onChange={(event) => setCreateForm((current) => ({ ...current, detectedAt: event.target.value }))}\r\n                  className=\"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none\"\r\n                />\r\n                <input\r\n                  value={createForm.ownerEmail}\r\n                  onChange={(event) => setCreateForm((current) => ({ ...current, ownerEmail: event.target.value }))}\r\n                  placeholder=\"Owner email\"\r\n                  className=\"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none\"\r\n                />\r\n                <input\r\n                  value={createForm.affectedEmployeeEmail}\r\n                  onChange={(event) => setCreateForm((current) => ({ ...current, affectedEmployeeEmail: event.target.value }))}\r\n                  placeholder=\"Affected employee email\"\r\n                  className=\"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none md:col-span-2\"\r\n                />\r\n                <textarea\r\n                  rows={3}\r\n                  value={createForm.summary}\r\n                  onChange={(event) => setCreateForm((current) => ({ ...current, summary: event.target.value }))}\r\n                  placeholder=\"Incident summary\"\r\n                  className=\"rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none md:col-span-2\"\r\n                />\r\n              </div>\r\n\r\n              <div className=\"grid gap-2 sm:grid-cols-3\">\r\n                <label className=\"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={createForm.restrictedPiiInvolved}\r\n                    onChange={(event) => setCreateForm((current) => ({ ...current, restrictedPiiInvolved: event.target.checked }))}\r\n                    className=\"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500\"\r\n                  />\r\n                  <span className=\"text-xs text-slate-700\">Restricted PII</span>\r\n                </label>\r\n                <label className=\"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={createForm.executiveNotificationRequired}\r\n                    onChange={(event) => setCreateForm((current) => ({ ...current, executiveNotificationRequired: event.target.checked }))}\r\n                    className=\"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500\"\r\n                  />\r\n                  <span className=\"text-xs text-slate-700\">Executive Notice</span>\r\n                </label>\r\n                <label className=\"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2\">\r\n                  <input\r\n                    type=\"checkbox\"\r\n                    checked={createForm.regulatoryNotificationRequired}\r\n                    onChange={(event) => setCreateForm((current) => ({ ...current, regulatoryNotificationRequired: event.target.checked }))}\r\n                    className=\"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500\"\r\n                  />\r\n                  <span className=\"text-xs text-slate-700\">Regulatory Notice</span>\r\n                </label>\r\n              </div>\r\n\r\n              <div className=\"flex items-center justify-end gap-2 border-t border-slate-200 pt-3\">\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setIsCreateModalOpen(false)}\r\n                  disabled={isSubmittingCreate}\r\n                  className=\"inline-flex h-9 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-70\"\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  type=\"submit\"\r\n                  disabled={isSubmittingCreate}\r\n                  className=\"inline-flex h-9 items-center rounded-lg bg-sky-600 px-4 text-xs font-semibold text-white transition hover:bg-sky-700 disabled:opacity-70\"\r\n                >\r\n                  {isSubmittingCreate ? \"Creating...\" : \"Create Incident\"}\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      ) : null}\r\n\r\n      {selectedRecordId ? (\r\n        <div\r\n          className=\"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/45 p-4\"\r\n          role=\"dialog\"\r\n          aria-modal=\"true\"\r\n          aria-label=\"Incident Workbench\"\r\n          onClick={() => !isSavingRecord && !isUploadingEvidence && setSelectedRecordId(\"\")}\r\n        >\r\n          <div\r\n            className=\"w-full max-w-6xl rounded-2xl border border-slate-200 bg-white p-4 shadow-2xl sm:p-5\"\r\n            onClick={(event) => event.stopPropagation()}\r\n          >\r\n            <div className=\"mb-3 flex items-start justify-between gap-3\">\r\n              <div>\r\n                <h2 className=\"text-base font-semibold text-slate-900\">Incident Workbench</h2>\r\n                <p className=\"mt-0.5 text-sm text-slate-600\">Escalation, 72-hour actions, and forensic evidence.</p>\r\n              </div>\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => !isSavingRecord && !isUploadingEvidence && setSelectedRecordId(\"\")}\r\n                disabled={isSavingRecord || isUploadingEvidence}\r\n                className=\"inline-flex h-8 w-8 items-center justify-center rounded-lg border border-slate-300 bg-white text-slate-600 transition hover:bg-slate-50 disabled:opacity-60\"\r\n                aria-label=\"Close incident workbench\"\r\n              >\r\n                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"1.9\" className=\"h-4 w-4\" aria-hidden=\"true\">\r\n                  <path d=\"m6 6 12 12M18 6 6 18\" />\r\n                </svg>\r\n              </button>\r\n            </div>\r\n\r\n            {isLoadingRecord || !selectedRecord || !recordDraft ? (\r\n              <div className=\"flex justify-center py-8\">\r\n                <span className=\"inline-flex h-6 w-6 animate-spin rounded-full border-2 border-slate-300 border-t-sky-600\" aria-hidden=\"true\" />\r\n              </div>\r\n            ) : (\r\n              <div className=\"max-h-[72vh] space-y-3 overflow-y-auto pr-1\">\r\n                <div className=\"grid gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2.5 sm:grid-cols-2 lg:grid-cols-4\">\r\n                  <div>\r\n                    <p className=\"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500\">Incident</p>\r\n                    <p className=\"text-sm font-semibold text-slate-900\">{getRecordLabel(selectedRecord)}</p>\r\n                    <p className=\"text-xs text-slate-500\">{String(selectedRecord?.incidentCode || \"N/A\")}</p>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500\">Detected</p>\r\n                    <p className=\"text-xs text-slate-700\">{formatDateTime(selectedRecord?.detectedAt)}</p>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500\">Regulatory Due</p>\r\n                    <p className=\"text-xs text-slate-700\">{formatDateTime(selectedRecord?.regulatoryDueAt)}</p>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-[11px] font-semibold uppercase tracking-[0.08em] text-slate-500\">Regulatory Status</p>\r\n                    <StatusBadge value={selectedRecord?.regulatoryStatus || \"Not Required\"} />\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"grid gap-3 lg:grid-cols-2\">\r\n                  <SurfaceCard title=\"Workflow Control\" subtitle=\"Severity, containment, impact, and status updates\">\r\n                    <div className=\"grid gap-2 sm:grid-cols-2\">\r\n                      <select value={recordDraft.severity} onChange={(event) => setRecordDraft((current) => ({ ...current, severity: event.target.value }))} disabled={!canEdit || isSavingRecord} className=\"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100\">\r\n                        {SEVERITY_OPTIONS.map((severity) => <option key={`d-sev-${severity}`} value={severity}>{severity}</option>)}\r\n                      </select>\r\n                      <select value={recordDraft.status} onChange={(event) => setRecordDraft((current) => ({ ...current, status: event.target.value }))} disabled={!canEdit || isSavingRecord} className=\"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100\">\r\n                        {STATUS_OPTIONS.map((status) => <option key={`d-status-${status}`} value={status}>{status}</option>)}\r\n                      </select>\r\n                      <select value={recordDraft.containmentStatus} onChange={(event) => setRecordDraft((current) => ({ ...current, containmentStatus: event.target.value }))} disabled={!canEdit || isSavingRecord} className=\"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100\">\r\n                        {CONTAINMENT_OPTIONS.map((status) => <option key={`d-cont-${status}`} value={status}>{status}</option>)}\r\n                      </select>\r\n                      <select value={recordDraft.impactAssessmentStatus} onChange={(event) => setRecordDraft((current) => ({ ...current, impactAssessmentStatus: event.target.value }))} disabled={!canEdit || isSavingRecord} className=\"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100\">\r\n                        {IMPACT_OPTIONS.map((status) => <option key={`d-impact-${status}`} value={status}>{status}</option>)}\r\n                      </select>\r\n                    </div>\r\n                    <textarea value={recordDraft.summary} onChange={(event) => setRecordDraft((current) => ({ ...current, summary: event.target.value }))} rows={2} placeholder=\"Incident summary\" disabled={!canEdit || isSavingRecord} className=\"mt-2 w-full rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100\" />\r\n                    <textarea value={recordDraft.containmentSummary} onChange={(event) => setRecordDraft((current) => ({ ...current, containmentSummary: event.target.value }))} rows={2} placeholder=\"Containment summary\" disabled={!canEdit || isSavingRecord} className=\"mt-2 w-full rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100\" />\r\n                    <textarea value={recordDraft.impactSummary} onChange={(event) => setRecordDraft((current) => ({ ...current, impactSummary: event.target.value }))} rows={2} placeholder=\"Impact summary\" disabled={!canEdit || isSavingRecord} className=\"mt-2 w-full rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100\" />\r\n                  </SurfaceCard>\r\n\r\n                  <SurfaceCard title=\"72-Hour Controls\" subtitle=\"Regulatory, executive, and affected-individual notifications\">\r\n                    <div className=\"grid gap-2 sm:grid-cols-2\">\r\n                      <label className=\"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2\">\r\n                        <input type=\"checkbox\" checked={recordDraft.regulatoryNotificationRequired} onChange={(event) => setRecordDraft((current) => ({ ...current, regulatoryNotificationRequired: event.target.checked }))} disabled={!canEdit || isSavingRecord} className=\"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500\" />\r\n                        <span className=\"text-xs text-slate-700\">Regulatory required</span>\r\n                      </label>\r\n                      <label className=\"inline-flex items-center gap-2 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2\">\r\n                        <input type=\"checkbox\" checked={recordDraft.documentationRetained} onChange={(event) => setRecordDraft((current) => ({ ...current, documentationRetained: event.target.checked }))} disabled={!canEdit || isSavingRecord} className=\"h-4 w-4 rounded border-slate-300 text-sky-600 focus:ring-sky-500\" />\r\n                        <span className=\"text-xs text-slate-700\">Documentation retained</span>\r\n                      </label>\r\n                    </div>\r\n                    <div className=\"mt-2 grid gap-2 sm:grid-cols-2\">\r\n                      <input value={recordDraft.documentationLocation} onChange={(event) => setRecordDraft((current) => ({ ...current, documentationLocation: event.target.value }))} placeholder=\"Documentation location\" disabled={!canEdit || isSavingRecord} className=\"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100\" />\r\n                      <input value={recordDraft.classificationStandard} onChange={(event) => setRecordDraft((current) => ({ ...current, classificationStandard: event.target.value }))} placeholder=\"Classification standard\" disabled={!canEdit || isSavingRecord} className=\"h-9 rounded-lg border border-slate-300 px-3 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100\" />\r\n                    </div>\r\n                    <div className=\"mt-2 grid gap-2 sm:grid-cols-2 lg:grid-cols-3\">\r\n                      <button type=\"button\" onClick={() => markTimestampAction(\"grcAlertedAt\", \"GRC alerted.\", { escalationRequired: true })} disabled={!canEdit || isSavingRecord} className=\"inline-flex h-8 items-center justify-center rounded-md border border-slate-300 bg-white px-3 text-[11px] font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60\">Mark GRC Alerted</button>\r\n                      <button type=\"button\" onClick={() => markTimestampAction(\"executiveNotifiedAt\", \"Executive notification recorded.\", { executiveNotificationRequired: true })} disabled={!canEdit || isSavingRecord} className=\"inline-flex h-8 items-center justify-center rounded-md border border-slate-300 bg-white px-3 text-[11px] font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60\">Mark Executive Notified</button>\r\n                      <button type=\"button\" onClick={() => markTimestampAction(\"regulatoryNotifiedAt\", \"Regulatory notification recorded.\", { regulatoryNotificationRequired: true, status: \"Regulatory Review\" })} disabled={!canEdit || isSavingRecord} className=\"inline-flex h-8 items-center justify-center rounded-md border border-slate-300 bg-white px-3 text-[11px] font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60\">Mark Regulator Notified</button>\r\n                      <button type=\"button\" onClick={() => markTimestampAction(\"affectedIndividualsNotifiedAt\", \"Affected individuals notification recorded.\")} disabled={!canEdit || isSavingRecord} className=\"inline-flex h-8 items-center justify-center rounded-md border border-slate-300 bg-white px-3 text-[11px] font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60\">Mark Affected Individuals</button>\r\n                      <button type=\"button\" onClick={() => patchSelected({ refreshForensicSnapshot: true }, \"Forensic snapshot refreshed.\")} disabled={!canEdit || isSavingRecord} className=\"inline-flex h-8 items-center justify-center rounded-md border border-sky-200 bg-sky-50 px-3 text-[11px] font-semibold text-sky-700 transition hover:bg-sky-100 disabled:opacity-60\">Refresh Forensic</button>\r\n                    </div>\r\n                  </SurfaceCard>\r\n                </div>\r\n\r\n                <SurfaceCard title=\"Incident Evidence\" subtitle=\"Retained case documents and attachments\">\r\n                  <input ref={evidenceInputRef} type=\"file\" className=\"hidden\" onChange={handleEvidenceUpload} />\r\n                  <div className=\"mb-2 flex justify-end\">\r\n                    {canEdit ? (\r\n                      <button type=\"button\" onClick={() => evidenceInputRef.current?.click()} disabled={isUploadingEvidence || isSavingRecord} className=\"inline-flex h-8 items-center rounded-lg border border-slate-300 bg-white px-3 text-xs font-semibold text-slate-700 transition hover:bg-slate-50 disabled:opacity-60\">\r\n                        {isUploadingEvidence ? \"Uploading...\" : \"Upload Evidence\"}\r\n                      </button>\r\n                    ) : null}\r\n                  </div>\r\n\r\n                  {evidenceRows.length === 0 ? (\r\n                    <EmptyState title=\"No evidence files attached\" subtitle=\"Upload incident files to retain case evidence.\" />\r\n                  ) : (\r\n                    <div className=\"overflow-x-auto\">\r\n                      <table className=\"min-w-full text-left text-sm\">\r\n                        <thead>\r\n                          <tr className=\"border-b border-slate-200 text-xs uppercase tracking-[0.1em] text-slate-500\">\r\n                            <th className=\"px-2 py-3 font-medium\">Document</th>\r\n                            <th className=\"px-2 py-3 font-medium\">Uploaded At</th>\r\n                            <th className=\"px-2 py-3 font-medium\">Uploaded By</th>\r\n                            <th className=\"px-2 py-3 font-medium text-right\">Actions</th>\r\n                          </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                          {evidenceRows.map((entry, index) => (\r\n                            <tr key={`${entry?.id || \"evidence\"}-${index}`} className=\"border-b border-slate-100 text-slate-700 last:border-b-0\">\r\n                              <td className=\"px-2 py-3\">\r\n                                <p className=\"font-medium text-slate-900\">{String(entry?.name || \"Incident Evidence\")}</p>\r\n                                <p className=\"text-xs text-slate-500\">{String(entry?.type || \"Incident Evidence\")}</p>\r\n                              </td>\r\n                              <td className=\"px-2 py-3 text-xs text-slate-600\">{formatDateTime(entry?.uploadedAt)}</td>\r\n                              <td className=\"px-2 py-3 text-xs text-slate-600\">{String(entry?.uploadedBy || \"-\")}</td>\r\n                              <td className=\"px-2 py-3 text-right\">\r\n                                <div className=\"inline-flex items-center gap-2\">\r\n                                  {entry?.ref ? (\r\n                                    <a href={entry.ref} target=\"_blank\" rel=\"noreferrer\" className=\"inline-flex h-8 items-center rounded-lg border border-sky-200 bg-sky-50 px-3 text-xs font-semibold text-sky-700 transition hover:bg-sky-100\">Open</a>\r\n                                  ) : null}\r\n                                  {canEdit ? (\r\n                                    <button type=\"button\" onClick={() => removeEvidence(entry)} disabled={isSavingRecord || isUploadingEvidence} className=\"inline-flex h-8 items-center rounded-lg border border-rose-200 bg-rose-50 px-3 text-xs font-semibold text-rose-700 transition hover:bg-rose-100 disabled:opacity-60\">Remove</button>\r\n                                  ) : null}\r\n                                </div>\r\n                              </td>\r\n                            </tr>\r\n                          ))}\r\n                        </tbody>\r\n                      </table>\r\n                    </div>\r\n                  )}\r\n                </SurfaceCard>\r\n\r\n                <SurfaceCard title=\"Forensic Logging\" subtitle=\"Scoped logs for access, export, administrative, and deletion events\">\r\n                  <div className=\"grid gap-2 sm:grid-cols-2 lg:grid-cols-5\">\r\n                    <div className=\"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2\"><p className=\"text-[11px] uppercase tracking-[0.08em] text-slate-500\">Scoped Logs</p><p className=\"text-sm font-semibold text-slate-900\">{Number(selectedRecord?.forensicSummary?.totalScopedLogs || 0)}</p></div>\r\n                    <div className=\"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2\"><p className=\"text-[11px] uppercase tracking-[0.08em] text-slate-500\">Access</p><p className=\"text-sm font-semibold text-slate-900\">{Number(selectedRecord?.forensicSummary?.accessLogsCount || 0)}</p></div>\r\n                    <div className=\"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2\"><p className=\"text-[11px] uppercase tracking-[0.08em] text-slate-500\">Exports</p><p className=\"text-sm font-semibold text-slate-900\">{Number(selectedRecord?.forensicSummary?.exportLogsCount || 0)}</p></div>\r\n                    <div className=\"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2\"><p className=\"text-[11px] uppercase tracking-[0.08em] text-slate-500\">Administrative</p><p className=\"text-sm font-semibold text-slate-900\">{Number(selectedRecord?.forensicSummary?.administrativeActionsCount || 0)}</p></div>\r\n                    <div className=\"rounded-lg border border-slate-200 bg-slate-50 px-3 py-2\"><p className=\"text-[11px] uppercase tracking-[0.08em] text-slate-500\">Deletion</p><p className=\"text-sm font-semibold text-slate-900\">{Number(selectedRecord?.forensicSummary?.deletionActivitiesCount || 0)}</p></div>\r\n                  </div>\r\n\r\n                  <div className=\"mt-3 grid gap-3 lg:grid-cols-2\">\r\n                    {forensicBuckets.map((bucket) => {\r\n                      const rows = Array.isArray(selectedRecord?.forensicSnapshot?.[bucket.key])\r\n                        ? selectedRecord.forensicSnapshot[bucket.key].slice(0, 20)\r\n                        : [];\r\n                      return (\r\n                        <div key={bucket.key} className=\"rounded-lg border border-slate-200 bg-white\">\r\n                          <div className=\"border-b border-slate-200 px-3 py-2\">\r\n                            <p className=\"text-xs font-semibold uppercase tracking-[0.08em] text-slate-500\">{bucket.label}</p>\r\n                          </div>\r\n                          {rows.length === 0 ? (\r\n                            <p className=\"px-3 py-3 text-xs text-slate-500\">No entries.</p>\r\n                          ) : (\r\n                            <div className=\"max-h-52 overflow-auto\">\r\n                              <table className=\"min-w-full text-left text-xs\">\r\n                                <thead>\r\n                                  <tr className=\"border-b border-slate-200 text-[11px] uppercase tracking-[0.08em] text-slate-500\">\r\n                                    <th className=\"px-3 py-2 font-medium\">Action</th>\r\n                                    <th className=\"px-3 py-2 font-medium\">Module</th>\r\n                                    <th className=\"px-3 py-2 font-medium\">When</th>\r\n                                    <th className=\"px-3 py-2 font-medium\">By</th>\r\n                                  </tr>\r\n                                </thead>\r\n                                <tbody>\r\n                                  {rows.map((row, index) => (\r\n                                    <tr key={`${bucket.key}-${row.id || row.occurredAt || \"row\"}-${index}`} className=\"border-b border-slate-100 text-slate-700 last:border-b-0\">\r\n                                      <td className=\"px-3 py-2\">{String(row?.activityName || \"-\")}</td>\r\n                                      <td className=\"px-3 py-2\">{String(row?.module || \"-\")}</td>\r\n                                      <td className=\"px-3 py-2\">{formatDateTime(row?.occurredAt)}</td>\r\n                                      <td className=\"px-3 py-2\">{String(row?.performedBy || \"-\")}</td>\r\n                                    </tr>\r\n                                  ))}\r\n                                </tbody>\r\n                              </table>\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      );\r\n                    })}\r\n                  </div>\r\n                </SurfaceCard>\r\n\r\n                <SurfaceCard title=\"Notes\" subtitle=\"Additional incident context\">\r\n                  <textarea\r\n                    value={recordDraft.notes}\r\n                    onChange={(event) => setRecordDraft((current) => ({ ...current, notes: event.target.value }))}\r\n                    rows={3}\r\n                    disabled={!canEdit || isSavingRecord}\r\n                    className=\"w-full rounded-lg border border-slate-300 px-3 py-2 text-xs text-slate-900 focus:border-sky-400 focus:outline-none disabled:bg-slate-100\"\r\n                  />\r\n                </SurfaceCard>\r\n\r\n                {canEdit ? (\r\n                  <div className=\"sticky bottom-0 z-10 flex items-center justify-end gap-2 border-t border-slate-200 bg-white pt-3\">\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={saveRecordDraft}\r\n                      disabled={isSavingRecord || isUploadingEvidence}\r\n                      className=\"inline-flex h-9 items-center rounded-lg bg-sky-600 px-4 text-xs font-semibold text-white transition hover:bg-sky-700 disabled:opacity-70\"\r\n                    >\r\n                      {isSavingRecord ? \"Saving...\" : \"Save Incident Updates\"}\r\n                    </button>\r\n                  </div>\r\n                ) : null}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n      ) : null}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}